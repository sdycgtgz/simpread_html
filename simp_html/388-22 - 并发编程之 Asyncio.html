
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 22 | 并发编程之 Asyncio</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>22 | 并发编程之 Asyncio</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">今天这节课，我主要带你回顾一下字符串的常用操作，并对其中的一些小 tricks 详细地加以解释。</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0">22 | 并发编程之 Asyncio</h1><div><span>景霄</span> <span> 2019-06-28</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/5e/cc/5e74ec72cd7a5f320d534942754261cc.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：冯永吉</span><span>大小：7.28M</span><span> 时长：09:05</span></div></div><audio title="22 | 并发编程之Asyncio" src="https://res001.geekbang.org//media/audio/45/d4/45dc75a64d1633ef7c4508ae3f5d00d4/ld/ld.m3u8"></audio></div><div><div><div><div data-slate-editor="true" data-key="14561" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="14562"><span data-slate-object="text" data-key="14563"><span data-slate-leaf="true" data-offset-key="14563:0" data-first-offset="true"><span data-slate-string="true">你好，我是景霄。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14564"><span data-slate-object="text" data-key="14565"><span data-slate-leaf="true" data-offset-key="14565:0" data-first-offset="true"><span data-slate-string="true">上节课，我们一起学习了 Python 并发编程的一种实现 —— 多线程。今天这节课，我们继续学习 Python 并发编程的另一种实现方式 ——Asyncio。不同于协程那章，这节课我们更注重原理的理解。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14566"><span data-slate-object="text" data-key="14567"><span data-slate-leaf="true" data-offset-key="14567:0" data-first-offset="true"><span data-slate-string="true">通过上节课的学习，我们知道，在处理 I/O 操作时，使用多线程与普通的单线程相比，效率得到了极大的提高。你可能会想，既然这样，为什么还需要 Asyncio？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14568"><span data-slate-object="text" data-key="14569"><span data-slate-leaf="true" data-offset-key="14569:0" data-first-offset="true"><span data-slate-string="true">诚然，多线程有诸多优点且应用广泛，但也存在一定的局限性：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14570"><div data-slate-type="list-line" data-slate-object="block" data-key="14571"><span data-slate-object="text" data-key="14572"><span data-slate-leaf="true" data-offset-key="14572:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_b1a9eb05" data-attr-id="31355" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">比如，多线程运行过程容易被打断，因此有可能出现 race condition 的情况；</span></span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14573"><span data-slate-object="text" data-key="14574"><span data-slate-leaf="true" data-offset-key="14574:0" data-first-offset="true"><span data-slate-string="true">再如，</span></span><span data-slate-leaf="true" data-offset-key="14574:1"><span data-slate-object="annotation" data-annotation-key="gkann_ae927e35" data-attr-id="26372" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">线程切换本身存在一定的损耗，</span></span></span><span data-slate-leaf="true" data-offset-key="14574:2"><span data-slate-string="true">线程数不能无限增加，因此，如果你的 I/O 操作非常 heavy，多线程很有可能满足不了高效率、高质量的需求。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14575"><span data-slate-object="text" data-key="14576"><span data-slate-leaf="true" data-offset-key="14576:0" data-first-offset="true"><span data-slate-string="true">正是为了解决这些问题，Asyncio 应运而生。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14577" id="sr-toc-1"><span data-slate-object="text" data-key="14578"><span data-slate-leaf="true" data-offset-key="14578:0" data-first-offset="true"><span data-slate-string="true">什么是 Asyncio</span></span></span></h2><h3 data-slate-type="heading" data-slate-object="block" data-key="14579" id="sr-toc-2"><span data-slate-object="text" data-key="14580"><span data-slate-leaf="true" data-offset-key="14580:0" data-first-offset="true"><span data-slate-string="true">Sync VS Async</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="14581"><span data-slate-object="text" data-key="14582"><span data-slate-leaf="true" data-offset-key="14582:0" data-first-offset="true"><span data-slate-string="true">我们首先来区分一下 Sync（同步）和 Async（异步）的概念。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14583"><div data-slate-type="list-line" data-slate-object="block" data-key="14584"><span data-slate-object="text" data-key="14585"><span data-slate-leaf="true" data-offset-key="14585:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_269e09f6" data-attr-id="26373" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">所谓 Sync，是指操作一个接一个地执行，下一个操作必须等上一个操作完成后才能执行。</span></span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14586"><span data-slate-object="text" data-key="14587"><span data-slate-leaf="true" data-offset-key="14587:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_8684eaac" data-attr-id="20453" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">而 Async 是指不同操作间可以相互交替执行，如果其中的某个操作被 block 了，程序并不会等待，而是会找出可执行的操作继续执行。</span></span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14588"><span data-slate-object="text" data-key="14589"><span data-slate-leaf="true" data-offset-key="14589:0" data-first-offset="true"><span data-slate-string="true">举个简单的例子，你的老板让你做一份这个季度的报表，并且邮件发给他。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14590"><div data-slate-type="list-line" data-slate-object="block" data-key="14591"><span data-slate-object="text" data-key="14592"><span data-slate-leaf="true" data-offset-key="14592:0" data-first-offset="true"><span data-slate-string="true">如果按照 Sync 的方式，你会先向软件输入这个季度的各项数据，接下来等待 5min，等报表明细生成后，再写邮件发给他。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14593"><span data-slate-object="text" data-key="14594"><span data-slate-leaf="true" data-offset-key="14594:0" data-first-offset="true"><span data-slate-string="true">但如果按照 Async 的方式，再你输完这个季度的各项数据后，便会开始写邮件。等报表明细生成后，你会暂停邮件，先去查看报表，确认后继续写邮件直到发送完毕。</span></span></span></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="14595" id="sr-toc-3"><span data-slate-object="text" data-key="14596"><span data-slate-leaf="true" data-offset-key="14596:0" data-first-offset="true"><span data-slate-string="true">Asyncio 工作原理</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="14597"><span data-slate-object="text" data-key="14598"><span data-slate-leaf="true" data-offset-key="14598:0" data-first-offset="true"><span data-slate-string="true">明白了 Sync 和 Async，回到我们今天的主题，到底什么是 Asyncio 呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14599"><span data-slate-object="text" data-key="14600"><span data-slate-leaf="true" data-offset-key="14600:0" data-first-offset="true"><span data-slate-string="true">事实上，Asyncio 和其他 Python 程序一样，是单线程的，它只有一个主线程，但是可以进行多个不同的任务（task），这里的任务，就是特殊的 future 对象。这些不同的任务，</span></span><span data-slate-leaf="true" data-offset-key="14600:1"><span data-slate-object="annotation" data-annotation-key="gkann_b0437f93" data-attr-id="26374" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">被一个叫做 event loop 的对象所控制。</span></span></span><span data-slate-leaf="true" data-offset-key="14600:2"><span data-slate-string="true">你可以把这里的任务，类比成多线程版本里的多个线程。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14601"><span data-slate-object="text" data-key="14602"><span data-slate-leaf="true" data-offset-key="14602:0" data-first-offset="true"><span data-slate-string="true">为了简化讲解这个问题，我们可以假设任务只有两个状态：一是预备状态；二是等待状态。所谓的预备状态，是指任务目前空闲，但随时待命准备运行。而等待状态，是指任务已经运行，但正在等待外部的操作完成，比如 I/O 操作。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14603"><span data-slate-object="text" data-key="14604"><span data-slate-leaf="true" data-offset-key="14604:0" data-first-offset="true"><span data-slate-string="true">在这种情况下，event loop 会维护两个任务列表，分别对应这两种状态；并且选取预备状态的一个任务（具体选取哪个任务，和其等待的时间长短、占用的资源等等相关），使其运行，一直到这个任务把控制权交还给 event loop 为止。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14605"><span data-slate-object="text" data-key="14606"><span data-slate-leaf="true" data-offset-key="14606:0" data-first-offset="true"><span data-slate-string="true">当任务把控制权交还给 event loop 时，event loop 会根据其是否完成，把任务放到预备或等待状态的列表，然后遍历等待状态列表的任务，查看他们是否完成。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14607"><div data-slate-type="list-line" data-slate-object="block" data-key="14608"><span data-slate-object="text" data-key="14609"><span data-slate-leaf="true" data-offset-key="14609:0" data-first-offset="true"><span data-slate-string="true">如果完成，则将其放到预备状态的列表；</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14610"><span data-slate-object="text" data-key="14611"><span data-slate-leaf="true" data-offset-key="14611:0" data-first-offset="true"><span data-slate-string="true">如果未完成，则继续放在等待状态的列表。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14612"><span data-slate-object="text" data-key="14613"><span data-slate-leaf="true" data-offset-key="14613:0" data-first-offset="true"><span data-slate-string="true">而原先在预备状态列表的任务位置仍旧不变，因为它们还未运行。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14614"><span data-slate-object="text" data-key="14615"><span data-slate-leaf="true" data-offset-key="14615:0" data-first-offset="true"><span data-slate-string="true">这样，当所有任务被重新放置在合适的列表后，新一轮的循环又开始了：event loop 继续从预备状态的列表中选取一个任务使其执行… 如此周而复始，直到所有任务完成。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14616"><span data-slate-object="text" data-key="14617"><span data-slate-leaf="true" data-offset-key="14617:0" data-first-offset="true"><span data-slate-string="true">值得一提的是，</span></span><span data-slate-leaf="true" data-offset-key="14617:1"><span data-slate-object="annotation" data-annotation-key="gkann_2b48b086" data-attr-id="26376" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">对于 Asyncio 来说，它的任务在运行时不会被外部的一些因素打断，因此 Asyncio 内的操作不会出现 race condition 的情况，这样你就不需要担心线程安全的问题了。</span></span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="14618" id="sr-toc-4"><span data-slate-object="text" data-key="14619"><span data-slate-leaf="true" data-offset-key="14619:0" data-first-offset="true"><span data-slate-string="true">Asyncio 用法</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="14620"><span data-slate-object="text" data-key="14621"><span data-slate-leaf="true" data-offset-key="14621:0" data-first-offset="true"><span data-slate-string="true">讲完了 Asyncio 的原理，我们结合具体的代码来看一下它的用法。还是以上节课下载网站内容为例，用 Asyncio 的写法我放在了下面代码中（省略了异常处理的一些操作），接下来我们一起来看：</span></span></span></div><div data-code-language="rust" data-slate-type="pre" data-slate-object="block" data-key="14622"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div><div data-code-line-number="52"></div><div data-code-line-number="53"></div><div data-code-line-number="54"></div><div data-code-line-number="55"></div><div data-code-line-number="56"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14623"><span data-slate-object="text" data-key="14624"><span data-slate-leaf="true" data-offset-key="14624:0" data-first-offset="true"><span data-slate-string="true">import asyncio</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14625"><span data-slate-object="text" data-key="14626"><span data-slate-leaf="true" data-offset-key="14626:0" data-first-offset="true"><span data-slate-string="true">import aiohttp</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14627"><span data-slate-object="text" data-key="14628"><span data-slate-leaf="true" data-offset-key="14628:0" data-first-offset="true"><span data-slate-string="true">import time</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14629"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14630"><span data-slate-object="text" data-key="14631"><span data-slate-leaf="true" data-offset-key="14631:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">async</span></span></span></span><span data-slate-object="text" data-key="14632"><span data-slate-leaf="true" data-offset-key="14632:0" data-first-offset="true"><span data-slate-string="true"> def </span></span></span><span data-slate-object="text" data-key="14633"><span data-slate-leaf="true" data-offset-key="14633:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">download_one</span></span></span></span><span data-slate-object="text" data-key="14634"><span data-slate-leaf="true" data-offset-key="14634:0" data-first-offset="true"><span data-slate-string="true">(url):</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14635"><span data-slate-object="text" data-key="14636"><span data-slate-leaf="true" data-offset-key="14636:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">    </span></span></span></span><span data-slate-object="text" data-key="14637"><span data-slate-leaf="true" data-offset-key="14637:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">async</span></span></span></span></span><span data-slate-object="text" data-key="14638"><span data-slate-leaf="true" data-offset-key="14638:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true"> with aiohttp.</span></span></span></span><span data-slate-object="text" data-key="14639"><span data-slate-leaf="true" data-offset-key="14639:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">ClientSession</span></span></span></span></span><span data-slate-object="text" data-key="14640"><span data-slate-leaf="true" data-offset-key="14640:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">() </span></span></span></span><span data-slate-object="text" data-key="14641"><span data-slate-leaf="true" data-offset-key="14641:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">as</span></span></span></span></span><span data-slate-object="text" data-key="14642"><span data-slate-leaf="true" data-offset-key="14642:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_18e39bda" data-attr-id="32223" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true"> session:</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14643"><span data-slate-object="text" data-key="14644"><span data-slate-leaf="true" data-offset-key="14644:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14645"><span data-slate-leaf="true" data-offset-key="14645:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">async</span></span></span></span><span data-slate-object="text" data-key="14646"><span data-slate-leaf="true" data-offset-key="14646:0" data-first-offset="true"><span data-slate-string="true"> with session.</span></span></span><span data-slate-object="text" data-key="14647"><span data-slate-leaf="true" data-offset-key="14647:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">get</span></span></span></span><span data-slate-object="text" data-key="14648"><span data-slate-leaf="true" data-offset-key="14648:0" data-first-offset="true"><span data-slate-string="true">(url) </span></span></span><span data-slate-object="text" data-key="14649"><span data-slate-leaf="true" data-offset-key="14649:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">as</span></span></span></span><span data-slate-object="text" data-key="14650"><span data-slate-leaf="true" data-offset-key="14650:0" data-first-offset="true"><span data-slate-string="true"> resp:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14651"><span data-slate-object="text" data-key="14652"><span data-slate-leaf="true" data-offset-key="14652:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14653"><span data-slate-leaf="true" data-offset-key="14653:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="14654"><span data-slate-leaf="true" data-offset-key="14654:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14655"><span data-slate-leaf="true" data-offset-key="14655:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Read</span></span></span></span><span data-slate-object="text" data-key="14656"><span data-slate-leaf="true" data-offset-key="14656:0" data-first-offset="true"><span data-slate-string="true"> {} from {}'.</span></span></span><span data-slate-object="text" data-key="14657"><span data-slate-leaf="true" data-offset-key="14657:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">format</span></span></span></span><span data-slate-object="text" data-key="14658"><span data-slate-leaf="true" data-offset-key="14658:0" data-first-offset="true"><span data-slate-string="true">(resp.content_length, url))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14659"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14660"><span data-slate-object="text" data-key="14661"><span data-slate-leaf="true" data-offset-key="14661:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">async</span></span></span></span><span data-slate-object="text" data-key="14662"><span data-slate-leaf="true" data-offset-key="14662:0" data-first-offset="true"><span data-slate-string="true"> def </span></span></span><span data-slate-object="text" data-key="14663"><span data-slate-leaf="true" data-offset-key="14663:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">download_all</span></span></span></span><span data-slate-object="text" data-key="14664"><span data-slate-leaf="true" data-offset-key="14664:0" data-first-offset="true"><span data-slate-string="true">(sites):</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14665"><span data-slate-object="text" data-key="14666"><span data-slate-leaf="true" data-offset-key="14666:0" data-first-offset="true"><span data-slate-string="true">    tasks = [asyncio.</span></span></span><span data-slate-object="text" data-key="14667"><span data-slate-leaf="true" data-offset-key="14667:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">create_task</span></span></span></span><span data-slate-object="text" data-key="14668"><span data-slate-leaf="true" data-offset-key="14668:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14669"><span data-slate-leaf="true" data-offset-key="14669:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">download_one</span></span></span></span><span data-slate-object="text" data-key="14670"><span data-slate-leaf="true" data-offset-key="14670:0" data-first-offset="true"><span data-slate-string="true">(site)) </span></span></span><span data-slate-object="text" data-key="14671"><span data-slate-leaf="true" data-offset-key="14671:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="14672"><span data-slate-leaf="true" data-offset-key="14672:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14673"><span data-slate-leaf="true" data-offset-key="14673:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">site</span></span></span></span><span data-slate-object="text" data-key="14674"><span data-slate-leaf="true" data-offset-key="14674:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14675"><span data-slate-leaf="true" data-offset-key="14675:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">in</span></span></span></span><span data-slate-object="text" data-key="14676"><span data-slate-leaf="true" data-offset-key="14676:0" data-first-offset="true"><span data-slate-string="true"> sites]</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14677"><span data-slate-object="text" data-key="14678"><span data-slate-leaf="true" data-offset-key="14678:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14679"><span data-slate-leaf="true" data-offset-key="14679:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">await</span></span></span></span><span data-slate-object="text" data-key="14680"><span data-slate-leaf="true" data-offset-key="14680:0" data-first-offset="true"><span data-slate-string="true"> asyncio.</span></span></span><span data-slate-object="text" data-key="14681"><span data-slate-leaf="true" data-offset-key="14681:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">gather</span></span></span></span><span data-slate-object="text" data-key="14682"><span data-slate-leaf="true" data-offset-key="14682:0" data-first-offset="true"><span data-slate-string="true">(*tasks)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14683"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14684"><span data-slate-object="text" data-key="14685"><span data-slate-leaf="true" data-offset-key="14685:0" data-first-offset="true"><span data-slate-string="true">def </span></span></span><span data-slate-object="text" data-key="14686"><span data-slate-leaf="true" data-offset-key="14686:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span><span data-slate-object="text" data-key="14687"><span data-slate-leaf="true" data-offset-key="14687:0" data-first-offset="true"><span data-slate-string="true">():</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14688"><span data-slate-object="text" data-key="14689"><span data-slate-leaf="true" data-offset-key="14689:0" data-first-offset="true"><span data-slate-string="true">    sites = [</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14690"><span data-slate-object="text" data-key="14691"><span data-slate-leaf="true" data-offset-key="14691:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14692"><span data-slate-leaf="true" data-offset-key="14692:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14693"><span data-slate-leaf="true" data-offset-key="14693:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14694"><span data-slate-leaf="true" data-offset-key="14694:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Arts',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14695"><span data-slate-object="text" data-key="14696"><span data-slate-leaf="true" data-offset-key="14696:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14697"><span data-slate-leaf="true" data-offset-key="14697:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14698"><span data-slate-leaf="true" data-offset-key="14698:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14699"><span data-slate-leaf="true" data-offset-key="14699:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:History',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14700"><span data-slate-object="text" data-key="14701"><span data-slate-leaf="true" data-offset-key="14701:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14702"><span data-slate-leaf="true" data-offset-key="14702:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14703"><span data-slate-leaf="true" data-offset-key="14703:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14704"><span data-slate-leaf="true" data-offset-key="14704:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Society',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14705"><span data-slate-object="text" data-key="14706"><span data-slate-leaf="true" data-offset-key="14706:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14707"><span data-slate-leaf="true" data-offset-key="14707:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14708"><span data-slate-leaf="true" data-offset-key="14708:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14709"><span data-slate-leaf="true" data-offset-key="14709:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Biography',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14710"><span data-slate-object="text" data-key="14711"><span data-slate-leaf="true" data-offset-key="14711:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14712"><span data-slate-leaf="true" data-offset-key="14712:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14713"><span data-slate-leaf="true" data-offset-key="14713:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14714"><span data-slate-leaf="true" data-offset-key="14714:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Mathematics',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14715"><span data-slate-object="text" data-key="14716"><span data-slate-leaf="true" data-offset-key="14716:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14717"><span data-slate-leaf="true" data-offset-key="14717:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14718"><span data-slate-leaf="true" data-offset-key="14718:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14719"><span data-slate-leaf="true" data-offset-key="14719:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Technology',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14720"><span data-slate-object="text" data-key="14721"><span data-slate-leaf="true" data-offset-key="14721:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14722"><span data-slate-leaf="true" data-offset-key="14722:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14723"><span data-slate-leaf="true" data-offset-key="14723:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14724"><span data-slate-leaf="true" data-offset-key="14724:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Geography',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14725"><span data-slate-object="text" data-key="14726"><span data-slate-leaf="true" data-offset-key="14726:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14727"><span data-slate-leaf="true" data-offset-key="14727:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14728"><span data-slate-leaf="true" data-offset-key="14728:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14729"><span data-slate-leaf="true" data-offset-key="14729:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Science',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14730"><span data-slate-object="text" data-key="14731"><span data-slate-leaf="true" data-offset-key="14731:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14732"><span data-slate-leaf="true" data-offset-key="14732:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14733"><span data-slate-leaf="true" data-offset-key="14733:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14734"><span data-slate-leaf="true" data-offset-key="14734:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Computer_science',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14735"><span data-slate-object="text" data-key="14736"><span data-slate-leaf="true" data-offset-key="14736:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14737"><span data-slate-leaf="true" data-offset-key="14737:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14738"><span data-slate-leaf="true" data-offset-key="14738:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14739"><span data-slate-leaf="true" data-offset-key="14739:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Python_(programming_language)',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14740"><span data-slate-object="text" data-key="14741"><span data-slate-leaf="true" data-offset-key="14741:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14742"><span data-slate-leaf="true" data-offset-key="14742:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14743"><span data-slate-leaf="true" data-offset-key="14743:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14744"><span data-slate-leaf="true" data-offset-key="14744:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Java_(programming_language)',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14745"><span data-slate-object="text" data-key="14746"><span data-slate-leaf="true" data-offset-key="14746:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14747"><span data-slate-leaf="true" data-offset-key="14747:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14748"><span data-slate-leaf="true" data-offset-key="14748:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14749"><span data-slate-leaf="true" data-offset-key="14749:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/PHP',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14750"><span data-slate-object="text" data-key="14751"><span data-slate-leaf="true" data-offset-key="14751:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14752"><span data-slate-leaf="true" data-offset-key="14752:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14753"><span data-slate-leaf="true" data-offset-key="14753:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14754"><span data-slate-leaf="true" data-offset-key="14754:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Node.js',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14755"><span data-slate-object="text" data-key="14756"><span data-slate-leaf="true" data-offset-key="14756:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14757"><span data-slate-leaf="true" data-offset-key="14757:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14758"><span data-slate-leaf="true" data-offset-key="14758:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14759"><span data-slate-leaf="true" data-offset-key="14759:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/The_C_Programming_Language',</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14760"><span data-slate-object="text" data-key="14761"><span data-slate-leaf="true" data-offset-key="14761:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14762"><span data-slate-leaf="true" data-offset-key="14762:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'https</span></span></span></span><span data-slate-object="text" data-key="14763"><span data-slate-leaf="true" data-offset-key="14763:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="14764"><span data-slate-leaf="true" data-offset-key="14764:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Go_(programming_language)'</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14765"><span data-slate-object="text" data-key="14766"><span data-slate-leaf="true" data-offset-key="14766:0" data-first-offset="true"><span data-slate-string="true">    ]</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14767"><span data-slate-object="text" data-key="14768"><span data-slate-leaf="true" data-offset-key="14768:0" data-first-offset="true"><span data-slate-string="true">    start_time = time.</span></span></span><span data-slate-object="text" data-key="14769"><span data-slate-leaf="true" data-offset-key="14769:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perf_counter</span></span></span></span><span data-slate-object="text" data-key="14770"><span data-slate-leaf="true" data-offset-key="14770:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14771"><span data-slate-object="text" data-key="14772"><span data-slate-leaf="true" data-offset-key="14772:0" data-first-offset="true"><span data-slate-string="true">    asyncio.</span></span></span><span data-slate-object="text" data-key="14773"><span data-slate-leaf="true" data-offset-key="14773:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">run</span></span></span></span><span data-slate-object="text" data-key="14774"><span data-slate-leaf="true" data-offset-key="14774:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14775"><span data-slate-leaf="true" data-offset-key="14775:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">download_all</span></span></span></span><span data-slate-object="text" data-key="14776"><span data-slate-leaf="true" data-offset-key="14776:0" data-first-offset="true"><span data-slate-string="true">(sites))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14777"><span data-slate-object="text" data-key="14778"><span data-slate-leaf="true" data-offset-key="14778:0" data-first-offset="true"><span data-slate-string="true">    end_time = time.</span></span></span><span data-slate-object="text" data-key="14779"><span data-slate-leaf="true" data-offset-key="14779:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perf_counter</span></span></span></span><span data-slate-object="text" data-key="14780"><span data-slate-leaf="true" data-offset-key="14780:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14781"><span data-slate-object="text" data-key="14782"><span data-slate-leaf="true" data-offset-key="14782:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14783"><span data-slate-leaf="true" data-offset-key="14783:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="14784"><span data-slate-leaf="true" data-offset-key="14784:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14785"><span data-slate-leaf="true" data-offset-key="14785:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Download</span></span></span></span><span data-slate-object="text" data-key="14786"><span data-slate-leaf="true" data-offset-key="14786:0" data-first-offset="true"><span data-slate-string="true"> {} sites </span></span></span><span data-slate-object="text" data-key="14787"><span data-slate-leaf="true" data-offset-key="14787:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">in</span></span></span></span><span data-slate-object="text" data-key="14788"><span data-slate-leaf="true" data-offset-key="14788:0" data-first-offset="true"><span data-slate-string="true"> {} seconds'.</span></span></span><span data-slate-object="text" data-key="14789"><span data-slate-leaf="true" data-offset-key="14789:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">format</span></span></span></span><span data-slate-object="text" data-key="14790"><span data-slate-leaf="true" data-offset-key="14790:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14791"><span data-slate-leaf="true" data-offset-key="14791:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="14792"><span data-slate-leaf="true" data-offset-key="14792:0" data-first-offset="true"><span data-slate-string="true">(sites), end_time - start_time))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14793"><span data-slate-object="text" data-key="14794"><span data-slate-leaf="true" data-offset-key="14794:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14795"><span data-slate-object="text" data-key="14796"><span data-slate-leaf="true" data-offset-key="14796:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14797"><span data-slate-leaf="true" data-offset-key="14797:0" data-first-offset="true"><span data-slate-string="true"> __name__ == </span></span></span><span data-slate-object="text" data-key="14798"><span data-slate-leaf="true" data-offset-key="14798:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'__main__</span></span></span></span><span data-slate-object="text" data-key="14799"><span data-slate-leaf="true" data-offset-key="14799:0" data-first-offset="true"><span data-slate-string="true">':</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14800"><span data-slate-object="text" data-key="14801"><span data-slate-leaf="true" data-offset-key="14801:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14802"><span data-slate-leaf="true" data-offset-key="14802:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span><span data-slate-object="text" data-key="14803"><span data-slate-leaf="true" data-offset-key="14803:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14804"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14805"><span data-slate-object="text" data-key="14806"><span data-slate-leaf="true" data-offset-key="14806:0" data-first-offset="true"><span data-slate-string="true">## 输出</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14807"><span data-slate-object="text" data-key="14808"><span data-slate-leaf="true" data-offset-key="14808:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14809"><span data-slate-leaf="true" data-offset-key="14809:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">63153</span></span></span></span><span data-slate-object="text" data-key="14810"><span data-slate-leaf="true" data-offset-key="14810:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14811"><span data-slate-leaf="true" data-offset-key="14811:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Java_(programming_language)</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14812"><span data-slate-object="text" data-key="14813"><span data-slate-leaf="true" data-offset-key="14813:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14814"><span data-slate-leaf="true" data-offset-key="14814:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31461</span></span></span></span><span data-slate-object="text" data-key="14815"><span data-slate-leaf="true" data-offset-key="14815:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14816"><span data-slate-leaf="true" data-offset-key="14816:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Society</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14817"><span data-slate-object="text" data-key="14818"><span data-slate-leaf="true" data-offset-key="14818:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14819"><span data-slate-leaf="true" data-offset-key="14819:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">23965</span></span></span></span><span data-slate-object="text" data-key="14820"><span data-slate-leaf="true" data-offset-key="14820:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14821"><span data-slate-leaf="true" data-offset-key="14821:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Biography</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14822"><span data-slate-object="text" data-key="14823"><span data-slate-leaf="true" data-offset-key="14823:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14824"><span data-slate-leaf="true" data-offset-key="14824:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">36312</span></span></span></span><span data-slate-object="text" data-key="14825"><span data-slate-leaf="true" data-offset-key="14825:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14826"><span data-slate-leaf="true" data-offset-key="14826:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:History</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14827"><span data-slate-object="text" data-key="14828"><span data-slate-leaf="true" data-offset-key="14828:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14829"><span data-slate-leaf="true" data-offset-key="14829:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">25203</span></span></span></span><span data-slate-object="text" data-key="14830"><span data-slate-leaf="true" data-offset-key="14830:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14831"><span data-slate-leaf="true" data-offset-key="14831:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Arts</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14832"><span data-slate-object="text" data-key="14833"><span data-slate-leaf="true" data-offset-key="14833:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14834"><span data-slate-leaf="true" data-offset-key="14834:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">15160</span></span></span></span><span data-slate-object="text" data-key="14835"><span data-slate-leaf="true" data-offset-key="14835:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14836"><span data-slate-leaf="true" data-offset-key="14836:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/The_C_Programming_Language</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14837"><span data-slate-object="text" data-key="14838"><span data-slate-leaf="true" data-offset-key="14838:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14839"><span data-slate-leaf="true" data-offset-key="14839:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">28749</span></span></span></span><span data-slate-object="text" data-key="14840"><span data-slate-leaf="true" data-offset-key="14840:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14841"><span data-slate-leaf="true" data-offset-key="14841:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Mathematics</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14842"><span data-slate-object="text" data-key="14843"><span data-slate-leaf="true" data-offset-key="14843:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14844"><span data-slate-leaf="true" data-offset-key="14844:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">29587</span></span></span></span><span data-slate-object="text" data-key="14845"><span data-slate-leaf="true" data-offset-key="14845:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14846"><span data-slate-leaf="true" data-offset-key="14846:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Technology</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14847"><span data-slate-object="text" data-key="14848"><span data-slate-leaf="true" data-offset-key="14848:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14849"><span data-slate-leaf="true" data-offset-key="14849:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">79318</span></span></span></span><span data-slate-object="text" data-key="14850"><span data-slate-leaf="true" data-offset-key="14850:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14851"><span data-slate-leaf="true" data-offset-key="14851:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/PHP</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14852"><span data-slate-object="text" data-key="14853"><span data-slate-leaf="true" data-offset-key="14853:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14854"><span data-slate-leaf="true" data-offset-key="14854:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">30298</span></span></span></span><span data-slate-object="text" data-key="14855"><span data-slate-leaf="true" data-offset-key="14855:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14856"><span data-slate-leaf="true" data-offset-key="14856:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Geography</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14857"><span data-slate-object="text" data-key="14858"><span data-slate-leaf="true" data-offset-key="14858:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14859"><span data-slate-leaf="true" data-offset-key="14859:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">73914</span></span></span></span><span data-slate-object="text" data-key="14860"><span data-slate-leaf="true" data-offset-key="14860:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14861"><span data-slate-leaf="true" data-offset-key="14861:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Python_(programming_language)</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14862"><span data-slate-object="text" data-key="14863"><span data-slate-leaf="true" data-offset-key="14863:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14864"><span data-slate-leaf="true" data-offset-key="14864:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">62218</span></span></span></span><span data-slate-object="text" data-key="14865"><span data-slate-leaf="true" data-offset-key="14865:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14866"><span data-slate-leaf="true" data-offset-key="14866:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Go_(programming_language)</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14867"><span data-slate-object="text" data-key="14868"><span data-slate-leaf="true" data-offset-key="14868:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14869"><span data-slate-leaf="true" data-offset-key="14869:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">22318</span></span></span></span><span data-slate-object="text" data-key="14870"><span data-slate-leaf="true" data-offset-key="14870:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14871"><span data-slate-leaf="true" data-offset-key="14871:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Portal:Science</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14872"><span data-slate-object="text" data-key="14873"><span data-slate-leaf="true" data-offset-key="14873:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14874"><span data-slate-leaf="true" data-offset-key="14874:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">36800</span></span></span></span><span data-slate-object="text" data-key="14875"><span data-slate-leaf="true" data-offset-key="14875:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14876"><span data-slate-leaf="true" data-offset-key="14876:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Node.js</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14877"><span data-slate-object="text" data-key="14878"><span data-slate-leaf="true" data-offset-key="14878:0" data-first-offset="true"><span data-slate-string="true">Read </span></span></span><span data-slate-object="text" data-key="14879"><span data-slate-leaf="true" data-offset-key="14879:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">67028</span></span></span></span><span data-slate-object="text" data-key="14880"><span data-slate-leaf="true" data-offset-key="14880:0" data-first-offset="true"><span data-slate-string="true"> from https:</span></span></span><span data-slate-object="text" data-key="14881"><span data-slate-leaf="true" data-offset-key="14881:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//en.wikipedia.org/wiki/Computer_science</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14882"><span data-slate-object="text" data-key="14883"><span data-slate-leaf="true" data-offset-key="14883:0" data-first-offset="true"><span data-slate-string="true">Download </span></span></span><span data-slate-object="text" data-key="14884"><span data-slate-leaf="true" data-offset-key="14884:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">15</span></span></span></span><span data-slate-object="text" data-key="14885"><span data-slate-leaf="true" data-offset-key="14885:0" data-first-offset="true"><span data-slate-string="true"> sites </span></span></span><span data-slate-object="text" data-key="14886"><span data-slate-leaf="true" data-offset-key="14886:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">in</span></span></span></span><span data-slate-object="text" data-key="14887"><span data-slate-leaf="true" data-offset-key="14887:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14888"><span data-slate-leaf="true" data-offset-key="14888:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0.062144195078872144</span></span></span></span><span data-slate-object="text" data-key="14889"><span data-slate-leaf="true" data-offset-key="14889:0" data-first-offset="true"><span data-slate-string="true"> seconds</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14890"><span data-slate-object="text" data-key="14891"><span data-slate-leaf="true" data-offset-key="14891:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_c7deef37" data-attr-id="37298" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">这里的 Async 和 await 关键字是 Asyncio 的最新写法，表示这个语句 / 函数是 non-block 的，正好对应前面所讲的 event loop 的概念。</span></span></span><span data-slate-leaf="true" data-offset-key="14891:1"><span data-slate-string="true">如果任务执行的过程需要等待，则将其放入等待状态的列表中，然后继续执行预备状态列表里的任务。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14892"><span data-slate-object="text" data-key="14893"><span data-slate-leaf="true" data-offset-key="14893:0" data-first-offset="true"><span data-slate-string="true">主函数里的 asyncio.run (coro) 是 Asyncio 的 root call，表示拿到 event loop，运行输入的 coro，直到它结束，最后关闭这个 event loop。事实上，asyncio.run () 是 Python3.7+ 才引入的，相当于老版本的以下语句：</span></span></span></div><div data-code-language="rust" data-slate-type="pre" data-slate-object="block" data-key="14894"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14895"><span data-slate-object="text" data-key="14896"><span data-slate-leaf="true" data-offset-key="14896:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">loop</span></span></span></span><span data-slate-object="text" data-key="14897"><span data-slate-leaf="true" data-offset-key="14897:0" data-first-offset="true"><span data-slate-string="true"> = asyncio.</span></span></span><span data-slate-object="text" data-key="14898"><span data-slate-leaf="true" data-offset-key="14898:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">get_event_loop</span></span></span></span><span data-slate-object="text" data-key="14899"><span data-slate-leaf="true" data-offset-key="14899:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14900"><span data-slate-object="text" data-key="14901"><span data-slate-leaf="true" data-offset-key="14901:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">try</span></span></span></span><span data-slate-object="text" data-key="14902"><span data-slate-leaf="true" data-offset-key="14902:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14903"><span data-slate-object="text" data-key="14904"><span data-slate-leaf="true" data-offset-key="14904:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14905"><span data-slate-leaf="true" data-offset-key="14905:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">loop</span></span></span></span><span data-slate-object="text" data-key="14906"><span data-slate-leaf="true" data-offset-key="14906:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="14907"><span data-slate-leaf="true" data-offset-key="14907:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">run_until_complete</span></span></span></span><span data-slate-object="text" data-key="14908"><span data-slate-leaf="true" data-offset-key="14908:0" data-first-offset="true"><span data-slate-string="true">(coro)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14909"><span data-slate-object="text" data-key="14910"><span data-slate-leaf="true" data-offset-key="14910:0" data-first-offset="true"><span data-slate-string="true">finally:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14911"><span data-slate-object="text" data-key="14912"><span data-slate-leaf="true" data-offset-key="14912:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14913"><span data-slate-leaf="true" data-offset-key="14913:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">loop</span></span></span></span><span data-slate-object="text" data-key="14914"><span data-slate-leaf="true" data-offset-key="14914:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="14915"><span data-slate-leaf="true" data-offset-key="14915:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">close</span></span></span></span><span data-slate-object="text" data-key="14916"><span data-slate-leaf="true" data-offset-key="14916:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14917"><span data-slate-object="text" data-key="14918"><span data-slate-leaf="true" data-offset-key="14918:0" data-first-offset="true"><span data-slate-string="true">至于 Asyncio 版本的函数 download_all ()，和之前多线程版本有很大的区别：</span></span></span></div><div data-code-language="rust" data-slate-type="pre" data-slate-object="block" data-key="14919"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14920"><span data-slate-object="text" data-key="14921"><span data-slate-leaf="true" data-offset-key="14921:0" data-first-offset="true"><span data-slate-string="true">tasks = [asyncio.</span></span></span><span data-slate-object="text" data-key="14922"><span data-slate-leaf="true" data-offset-key="14922:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">create_task</span></span></span></span><span data-slate-object="text" data-key="14923"><span data-slate-leaf="true" data-offset-key="14923:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14924"><span data-slate-leaf="true" data-offset-key="14924:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">download_one</span></span></span></span><span data-slate-object="text" data-key="14925"><span data-slate-leaf="true" data-offset-key="14925:0" data-first-offset="true"><span data-slate-string="true">(site)) </span></span></span><span data-slate-object="text" data-key="14926"><span data-slate-leaf="true" data-offset-key="14926:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="14927"><span data-slate-leaf="true" data-offset-key="14927:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14928"><span data-slate-leaf="true" data-offset-key="14928:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">site</span></span></span></span><span data-slate-object="text" data-key="14929"><span data-slate-leaf="true" data-offset-key="14929:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14930"><span data-slate-leaf="true" data-offset-key="14930:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">in</span></span></span></span><span data-slate-object="text" data-key="14931"><span data-slate-leaf="true" data-offset-key="14931:0" data-first-offset="true"><span data-slate-string="true"> sites]</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14932"><span data-slate-object="text" data-key="14933"><span data-slate-leaf="true" data-offset-key="14933:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">await</span></span></span></span><span data-slate-object="text" data-key="14934"><span data-slate-leaf="true" data-offset-key="14934:0" data-first-offset="true"><span data-slate-string="true"> asyncio.</span></span></span><span data-slate-object="text" data-key="14935"><span data-slate-leaf="true" data-offset-key="14935:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">gather</span></span></span></span><span data-slate-object="text" data-key="14936"><span data-slate-leaf="true" data-offset-key="14936:0" data-first-offset="true"><span data-slate-string="true">(*task)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14937"><span data-slate-object="text" data-key="14938"><span data-slate-leaf="true" data-offset-key="14938:0" data-first-offset="true"><span data-slate-string="true">这里的</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14939"><span data-slate-object="text" data-key="14940"><span data-slate-leaf="true" data-offset-key="14940:0" data-first-offset="true"><span data-slate-string="true"> asyncio.create_task(coro)</span></span></span></span><span data-slate-object="text" data-key="14941"><span data-slate-leaf="true" data-offset-key="14941:0" data-first-offset="true"><span data-slate-string="true">，表示对输入的协程 coro 创建一个任务，安排它的执行，并返回此任务对象。这个函数也是 Python 3.7+ 新增的，如果是之前的版本，你可以用</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14942"><span data-slate-object="text" data-key="14943"><span data-slate-leaf="true" data-offset-key="14943:0" data-first-offset="true"><span data-slate-string="true"> asyncio.ensure_future(coro)</span></span></span></span><span data-slate-object="text" data-key="14944"><span data-slate-leaf="true" data-offset-key="14944:0" data-first-offset="true"><span data-slate-string="true"> 等效替代。可以看到，这里我们对每一个网站的下载，都创建了一个对应的任务。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14945"><span data-slate-object="text" data-key="14946"><span data-slate-leaf="true" data-offset-key="14946:0" data-first-offset="true"><span data-slate-string="true">再往下看，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14947"><span data-slate-object="text" data-key="14948"><span data-slate-leaf="true" data-offset-key="14948:0" data-first-offset="true"><span data-slate-string="true">asyncio.gather(*aws, loop=None, return_exception=False)</span></span></span></span><span data-slate-object="text" data-key="14949"><span data-slate-leaf="true" data-offset-key="14949:0" data-first-offset="true"><span data-slate-string="true">，则表示在 event loop 中运行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14950"><span data-slate-object="text" data-key="14951"><span data-slate-leaf="true" data-offset-key="14951:0" data-first-offset="true"><span data-slate-string="true"> aws 序列</span></span></span></span><span data-slate-object="text" data-key="14952"><span data-slate-leaf="true" data-offset-key="14952:0" data-first-offset="true"><span data-slate-string="true">的所有任务。当然，除了例子中用到的这几个函数，Asyncio 还提供了很多其他的用法，你可以查看  </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14953"><span data-slate-object="text" data-key="14954"><span data-slate-leaf="true" data-offset-key="14954:0" data-first-offset="true"><span data-slate-string="true">相应文档</span></span></span></a><span data-slate-object="text" data-key="14955"><span data-slate-leaf="true" data-offset-key="14955:0" data-first-offset="true"><span data-slate-string="true">  进行了解。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14956"><span data-slate-object="text" data-key="14957"><span data-slate-leaf="true" data-offset-key="14957:0" data-first-offset="true"><span data-slate-string="true">最后，我们再来看一下最后的输出结果 —— 用时只有 0.06s，效率比起之前的多线程版本，可以说是更上一层楼，充分体现其优势。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14958" id="sr-toc-5"><span data-slate-object="text" data-key="14959"><span data-slate-leaf="true" data-offset-key="14959:0" data-first-offset="true"><span data-slate-string="true">Asyncio 有缺陷吗？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14960"><span data-slate-object="text" data-key="14961"><span data-slate-leaf="true" data-offset-key="14961:0" data-first-offset="true"><span data-slate-string="true">学了这么多内容，我们认识到了 Asyncio 的强大，但你要清楚，任何一种方案都不是完美的，都存在一定的局限性，Asyncio 同样如此。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14962"><span data-slate-object="text" data-key="14963"><span data-slate-leaf="true" data-offset-key="14963:0" data-first-offset="true"><span data-slate-string="true">实际工作中，想用好 Asyncio，特别是发挥其强大的功能，很多情况下必须得有相应的 Python 库支持。你可能注意到了，上节课的多线程编程中，我们使用的是 requests 库，但今天我们并没有使用，而是用了 aiohttp 库，原因就是 requests 库并不兼容 Asyncio，但是 aiohttp 库兼容。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14964"><span data-slate-object="text" data-key="14965"><span data-slate-leaf="true" data-offset-key="14965:0" data-first-offset="true"><span data-slate-string="true">Asyncio 软件库的兼容性问题，在 Python3 的早期一直是个大问题，但是随着技术的发展，这个问题正逐步得到解决。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14966"><span data-slate-object="text" data-key="14967"><span data-slate-leaf="true" data-offset-key="14967:0" data-first-offset="true"><span data-slate-string="true">另外，使用 Asyncio 时，因为你在任务的调度方面有了更大的自主权，写代码时就得更加注意，不然很容易出错。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14968"><span data-slate-object="text" data-key="14969"><span data-slate-leaf="true" data-offset-key="14969:0" data-first-offset="true"><span data-slate-string="true">举个例子，如果你需要 await 一系列的操作，就得使用 asyncio.gather ()；如果只是单个的 future，或许只用 asyncio.wait () 就可以了。那么，对于你的 future，你是想要让它 run_until_complete () 还是 run_forever () 呢？诸如此类，都是你在面对具体问题时需要考虑的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14970" id="sr-toc-6"><span data-slate-object="text" data-key="14971"><span data-slate-leaf="true" data-offset-key="14971:0" data-first-offset="true"><span data-slate-string="true">多线程还是 Asyncio</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14972"><span data-slate-object="text" data-key="14973"><span data-slate-leaf="true" data-offset-key="14973:0" data-first-offset="true"><span data-slate-string="true">不知不觉，我们已经把并发编程的两种方式都给学习完了。不过，遇到实际问题时，多线程和 Asyncio 到底如何选择呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14974"><span data-slate-object="text" data-key="14975"><span data-slate-leaf="true" data-offset-key="14975:0" data-first-offset="true"><span data-slate-string="true">总的来说，你可以遵循以下伪代码的规范：</span></span></span></div><div data-code-language="python" data-slate-type="pre" data-slate-object="block" data-key="14976"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14977"><span data-slate-object="text" data-key="14978"><span data-slate-leaf="true" data-offset-key="14978:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14979"><span data-slate-leaf="true" data-offset-key="14979:0" data-first-offset="true"><span data-slate-string="true"> io_bound:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14980"><span data-slate-object="text" data-key="14981"><span data-slate-leaf="true" data-offset-key="14981:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14982"><span data-slate-leaf="true" data-offset-key="14982:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14983"><span data-slate-leaf="true" data-offset-key="14983:0" data-first-offset="true"><span data-slate-string="true"> io_slow:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14984"><span data-slate-object="text" data-key="14985"><span data-slate-leaf="true" data-offset-key="14985:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14986"><span data-slate-leaf="true" data-offset-key="14986:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="14987"><span data-slate-leaf="true" data-offset-key="14987:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14988"><span data-slate-leaf="true" data-offset-key="14988:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Use Asyncio'</span></span></span></span><span data-slate-object="text" data-key="14989"><span data-slate-leaf="true" data-offset-key="14989:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14990"><span data-slate-object="text" data-key="14991"><span data-slate-leaf="true" data-offset-key="14991:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="14992"><span data-slate-leaf="true" data-offset-key="14992:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">else</span></span></span></span><span data-slate-object="text" data-key="14993"><span data-slate-leaf="true" data-offset-key="14993:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14994"><span data-slate-object="text" data-key="14995"><span data-slate-leaf="true" data-offset-key="14995:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14996"><span data-slate-leaf="true" data-offset-key="14996:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="14997"><span data-slate-leaf="true" data-offset-key="14997:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14998"><span data-slate-leaf="true" data-offset-key="14998:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Use multi-threading'</span></span></span></span><span data-slate-object="text" data-key="14999"><span data-slate-leaf="true" data-offset-key="14999:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15000"><span data-slate-object="text" data-key="15001"><span data-slate-leaf="true" data-offset-key="15001:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">else</span></span></span></span><span data-slate-object="text" data-key="15002"><span data-slate-leaf="true" data-offset-key="15002:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="15003"><span data-slate-leaf="true" data-offset-key="15003:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="15004"><span data-slate-leaf="true" data-offset-key="15004:0" data-first-offset="true"><span data-slate-string="true"> cpu_bound:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15005"><span data-slate-object="text" data-key="15006"><span data-slate-leaf="true" data-offset-key="15006:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="15007"><span data-slate-leaf="true" data-offset-key="15007:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="15008"><span data-slate-leaf="true" data-offset-key="15008:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="15009"><span data-slate-leaf="true" data-offset-key="15009:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Use multi-processing'</span></span></span></span><span data-slate-object="text" data-key="15010"><span data-slate-leaf="true" data-offset-key="15010:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="15011"><div data-slate-type="list-line" data-slate-object="block" data-key="15012"><span data-slate-object="text" data-key="15013"><span data-slate-leaf="true" data-offset-key="15013:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_aa0beffe" data-attr-id="10138" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">如果是 I/O bound，并且 I/O 操作很慢，需要很多任务 / 线程协同实现，那么使用 Asyncio 更合适。</span></span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="15014"><span data-slate-object="text" data-key="15015"><span data-slate-leaf="true" data-offset-key="15015:0" data-first-offset="true"><span data-slate-string="true">如果是 I/O bound，但是 I/O 操作很快，</span></span><span data-slate-leaf="true" data-offset-key="15015:1"><span data-slate-object="annotation" data-annotation-key="gkann_d3562c88" data-attr-id="4543" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">只需要有限数量的任务 / 线程，</span></span></span><span data-slate-leaf="true" data-offset-key="15015:2"><span data-slate-string="true">那么使用多线程就可以了。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="15016"><span data-slate-object="text" data-key="15017"><span data-slate-leaf="true" data-offset-key="15017:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_4fc2a1d8" data-attr-id="10139" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">如果是 CPU bound，则需要使用多进程来提高程序运行效率。</span></span></span></span></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="15018" id="sr-toc-7"><span data-slate-object="text" data-key="15019"><span data-slate-leaf="true" data-offset-key="15019:0" data-first-offset="true"><span data-slate-string="true">总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="15020"><span data-slate-object="text" data-key="15021"><span data-slate-leaf="true" data-offset-key="15021:0" data-first-offset="true"><span data-slate-string="true">今天这节课，我们一起学习了 Asyncio 的原理和用法，并比较了 Asyncio 和多线程各自的优缺点。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15022"><span data-slate-object="text" data-key="15023"><span data-slate-leaf="true" data-offset-key="15023:0" data-first-offset="true"><span data-slate-string="true">不同于多线程，Asyncio 是单线程的，但其内部 event loop 的机制，可以让它并发地运行多个不同的任务，并且比多线程享有更大的自主控制权。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15024"><span data-slate-object="text" data-key="15025"><span data-slate-leaf="true" data-offset-key="15025:0" data-first-offset="true"><span data-slate-string="true">Asyncio 中的任务，在运行过程中不会被打断，因此不会出现 race condition 的情况。尤其是在 I/O 操作 heavy 的场景下，Asyncio 比多线程的运行效率更高。因为 Asyncio 内部任务切换的损耗，</span></span><span data-slate-leaf="true" data-offset-key="15025:1"><span data-slate-object="annotation" data-annotation-key="gkann_71b587e8" data-attr-id="37300" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">远比线程切换的损耗要小；并且 Asyncio 可以开启的任务数量，也比多线程中的线程数量多得多。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15026"><span data-slate-object="text" data-key="15027"><span data-slate-leaf="true" data-offset-key="15027:0" data-first-offset="true"><span data-slate-string="true">但需要注意的是，很多情况下，使用 Asyncio 需要特定第三方库的支持，比如前面示例中的 aiohttp。而如果 I/O 操作很快，并不 heavy，那么运用多线程，也能很有效地解决问题。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="15028" id="sr-toc-8"><span data-slate-object="text" data-key="15029"><span data-slate-leaf="true" data-offset-key="15029:0" data-first-offset="true"><span data-slate-string="true">思考题</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="15030"><span data-slate-object="text" data-key="15031"><span data-slate-leaf="true" data-offset-key="15031:0" data-first-offset="true"><span data-slate-string="true">这两节课，我们学习了并发编程的两种实现方式，也多次提到了并行编程（multi-processing），其适用于 CPU heavy 的场景。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15032"><span data-slate-object="text" data-key="15033"><span data-slate-leaf="true" data-offset-key="15033:0" data-first-offset="true"><span data-slate-string="true">现在有这么一个需求：输入一个列表，对于列表中的每个元素，我想计算 0 到这个元素的所有整数的平方和。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15034"><span data-slate-object="text" data-key="15035"><span data-slate-leaf="true" data-offset-key="15035:0" data-first-offset="true"><span data-slate-string="true">我把常规版本的写法放在了下面，你能通过查阅资料，写出它的多进程版本，并且比较程序的耗时吗？</span></span></span></div><div data-code-language="css" data-slate-type="pre" data-slate-object="block" data-key="15036"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="15037"><span data-slate-object="text" data-key="15038"><span data-slate-leaf="true" data-offset-key="15038:0" data-first-offset="true"><span data-slate-string="true">import </span></span></span><span data-slate-object="text" data-key="15039"><span data-slate-leaf="true" data-offset-key="15039:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">time</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15040"><span data-slate-object="text" data-key="15041"><span data-slate-leaf="true" data-offset-key="15041:0" data-first-offset="true"><span data-slate-string="true">def cpu_bound(number):</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15042"><span data-slate-object="text" data-key="15043"><span data-slate-leaf="true" data-offset-key="15043:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="15044"><span data-slate-leaf="true" data-offset-key="15044:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="15045"><span data-slate-leaf="true" data-offset-key="15045:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="15046"><span data-slate-leaf="true" data-offset-key="15046:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sum</span></span></span></span><span data-slate-object="text" data-key="15047"><span data-slate-leaf="true" data-offset-key="15047:0" data-first-offset="true"><span data-slate-string="true">(i * i for i in </span></span></span><span data-slate-object="text" data-key="15048"><span data-slate-leaf="true" data-offset-key="15048:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">range</span></span></span></span><span data-slate-object="text" data-key="15049"><span data-slate-leaf="true" data-offset-key="15049:0" data-first-offset="true"><span data-slate-string="true">(number)))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15050"></div><div data-slate-type="code-line" data-slate-object="block" data-key="15051"><span data-slate-object="text" data-key="15052"><span data-slate-leaf="true" data-offset-key="15052:0" data-first-offset="true"><span data-slate-string="true">def </span></span></span><span data-slate-object="text" data-key="15053"><span data-slate-leaf="true" data-offset-key="15053:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">calculate_sums</span></span></span></span><span data-slate-object="text" data-key="15054"><span data-slate-leaf="true" data-offset-key="15054:0" data-first-offset="true"><span data-slate-string="true">(numbers):</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15055"><span data-slate-object="text" data-key="15056"><span data-slate-leaf="true" data-offset-key="15056:0" data-first-offset="true"><span data-slate-string="true">    for number in numbers:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15057"><span data-slate-object="text" data-key="15058"><span data-slate-leaf="true" data-offset-key="15058:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="15059"><span data-slate-leaf="true" data-offset-key="15059:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cpu_bound</span></span></span></span><span data-slate-object="text" data-key="15060"><span data-slate-leaf="true" data-offset-key="15060:0" data-first-offset="true"><span data-slate-string="true">(number)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15061"></div><div data-slate-type="code-line" data-slate-object="block" data-key="15062"><span data-slate-object="text" data-key="15063"><span data-slate-leaf="true" data-offset-key="15063:0" data-first-offset="true"><span data-slate-string="true">def </span></span></span><span data-slate-object="text" data-key="15064"><span data-slate-leaf="true" data-offset-key="15064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span><span data-slate-object="text" data-key="15065"><span data-slate-leaf="true" data-offset-key="15065:0" data-first-offset="true"><span data-slate-string="true">():</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15066"><span data-slate-object="text" data-key="15067"><span data-slate-leaf="true" data-offset-key="15067:0" data-first-offset="true"><span data-slate-string="true">    start_time = time.</span></span></span><span data-slate-object="text" data-key="15068"><span data-slate-leaf="true" data-offset-key="15068:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perf_counter</span></span></span></span><span data-slate-object="text" data-key="15069"><span data-slate-leaf="true" data-offset-key="15069:0" data-first-offset="true"><span data-slate-string="true">()  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15070"><span data-slate-object="text" data-key="15071"><span data-slate-leaf="true" data-offset-key="15071:0" data-first-offset="true"><span data-slate-string="true">    numbers = [</span></span></span><span data-slate-object="text" data-key="15072"><span data-slate-leaf="true" data-offset-key="15072:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">10000000</span></span></span></span><span data-slate-object="text" data-key="15073"><span data-slate-leaf="true" data-offset-key="15073:0" data-first-offset="true"><span data-slate-string="true"> + x for x in </span></span></span><span data-slate-object="text" data-key="15074"><span data-slate-leaf="true" data-offset-key="15074:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">range</span></span></span></span><span data-slate-object="text" data-key="15075"><span data-slate-leaf="true" data-offset-key="15075:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="15076"><span data-slate-leaf="true" data-offset-key="15076:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">20</span></span></span></span><span data-slate-object="text" data-key="15077"><span data-slate-leaf="true" data-offset-key="15077:0" data-first-offset="true"><span data-slate-string="true">)]</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15078"><span data-slate-object="text" data-key="15079"><span data-slate-leaf="true" data-offset-key="15079:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="15080"><span data-slate-leaf="true" data-offset-key="15080:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">calculate_sums</span></span></span></span><span data-slate-object="text" data-key="15081"><span data-slate-leaf="true" data-offset-key="15081:0" data-first-offset="true"><span data-slate-string="true">(numbers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15082"><span data-slate-object="text" data-key="15083"><span data-slate-leaf="true" data-offset-key="15083:0" data-first-offset="true"><span data-slate-string="true">    end_time = time.</span></span></span><span data-slate-object="text" data-key="15084"><span data-slate-leaf="true" data-offset-key="15084:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perf_counter</span></span></span></span><span data-slate-object="text" data-key="15085"><span data-slate-leaf="true" data-offset-key="15085:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15086"><span data-slate-object="text" data-key="15087"><span data-slate-leaf="true" data-offset-key="15087:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="15088"><span data-slate-leaf="true" data-offset-key="15088:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">print</span></span></span></span><span data-slate-object="text" data-key="15089"><span data-slate-leaf="true" data-offset-key="15089:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="15090"><span data-slate-leaf="true" data-offset-key="15090:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Calculation takes {} seconds'</span></span></span></span><span data-slate-object="text" data-key="15091"><span data-slate-leaf="true" data-offset-key="15091:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="15092"><span data-slate-leaf="true" data-offset-key="15092:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">format</span></span></span></span><span data-slate-object="text" data-key="15093"><span data-slate-leaf="true" data-offset-key="15093:0" data-first-offset="true"><span data-slate-string="true">(end_time - start_time))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15094"><span data-slate-object="text" data-key="15095"><span data-slate-leaf="true" data-offset-key="15095:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15096"><span data-slate-object="text" data-key="15097"><span data-slate-leaf="true" data-offset-key="15097:0" data-first-offset="true"><span data-slate-string="true">if __name__ == </span></span></span><span data-slate-object="text" data-key="15098"><span data-slate-leaf="true" data-offset-key="15098:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'__main__'</span></span></span></span><span data-slate-object="text" data-key="15099"><span data-slate-leaf="true" data-offset-key="15099:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15100"><span data-slate-object="text" data-key="15101"><span data-slate-leaf="true" data-offset-key="15101:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="15102"><span data-slate-leaf="true" data-offset-key="15102:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span><span data-slate-object="text" data-key="15103"><span data-slate-leaf="true" data-offset-key="15103:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15104"><span data-slate-object="text" data-key="15105"><span data-slate-leaf="true" data-offset-key="15105:0" data-first-offset="true"><span data-slate-string="true">欢迎在留言区写下你的思考和答案，也欢迎你把今天的内容分享给你的同事朋友，我们一起交流、一起进步。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><span>18</span> 人觉得很赞<a href="javascript:void(0);">给文章提建议</a></p></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-9">精选留言 (69)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132"></div></div><div><div><div><span>Jingxiao</span></div><span>置顶</span></div><div>思考题答案：
import multiprocessing
import time


def cpu_bound (number):
    return sum (i * i for i in range (number))


def find_sums (numbers):
    with multiprocessing.Pool () as pool:
        pool.map (cpu_bound, numbers)


if __name__ == "__main__":
    numbers = [10000000 + x for x in range (20)]

    start_time = time.time ()
    find_sums (numbers)
    duration = time.time () - start_time
    print (f"Duration {duration} seconds")</div><div><div>2019-07-02</div><div><div><i></i><span>7</span></div><div><i></i><span>24</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>helloworld</span></div></div><div>总结多线程和协程之间的共同点和区别：
共同点：
都是并发操作，多线程同一时间点只能有一个线程在执行，协程同一时间点只能有一个任务在执行；
不同点：
多线程，是在 I/O 阻塞时通过切换线程来达到并发的效果，在什么情况下做线程切换是由操作系统来决定的，开发者不用操心，但会造成 race condition；
协程，只有一个线程，在 I/O 阻塞时通过在线程内切换任务来达到并发的效果，在什么情况下做任务切换是开发者决定的，不会有 race condition 的情况；
多线程的线程切换比协程的任务切换开销更大；
对于开发者而言，多线程并发的代码比协程并发的更容易书写。
一般情况下协程并发的处理效率比多线程并发更高。</div><div><div>2019-06-28</div><div><div><i></i><span>3</span></div><div><i></i><span>51</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div></div><div><div><div><span>hlz-123</span></div></div><div>1、单进程，老师的原程序，运行时间
     Calculation takes 15.305913339 seconds
2、CPU 并行方式，运行时间：
     Calculation takes 3.457259904 seconds
      def calculate_sums (numbers):    
             with concurrent.futures.ProcessPoolExecutor () as executor:
             executor.map (cpu_bound,numbers)
3、多线程，cocurrent.futures，运行时间
      Calculation takes 15.331446270999999 seconds
      def calculate_sums (numbers):
                with concurrent.futures.ThreadPoolExecutor (max_workers=5) as executor:
                executor.map (cpu_bound,numbers)
4、异步方式，asyncio
      Calculation takes 16.019983702999998 seconds
      async def cpu_bound (number):
            print (sum (i * i for i in range (number)))
      async def calculate_sums (numbers):
           tasks=[asyncio.create_task (cpu_bound (number)) for number in numbers]
           await asyncio.gather (*tasks)</div><div><div>2019-06-28</div><div><div><i></i><span>4</span></div><div><i></i><span>25</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/de/7d/61d76ae0.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>transformation</span></div></div><div>import time
from concurrent import futures


def cpu_bound (number):
    return sum (i * i for i in range (number))


def calculate_sums (numbers):
    for number in numbers:
        print (cpu_bound (number))


def main ():
    start_time = time.perf_counter ()
    numbers = [10000000 + x for x in range (20)]
    calculate_sums (numbers)
    end_time = time.perf_counter ()
    print ('Calculation takes {} seconds'.format (end_time - start_time))


def main_process ():
    start_time = time.perf_counter ()
    numbers = [10000000 + x for x in range (20)]
    with futures.ProcessPoolExecutor () as pe:
        result = pe.map (cpu_bound, numbers)
        print (f"result: {list (result)}")
    end_time = time.perf_counter ()
    print ('multiprocessing Calculation takes {} seconds'.format (end_time - start_time))


if __name__ == '__main__':
    main ()
    main_process ()
————————
输出：
333333283333335000000
333333383333335000000
333333483333355000001
333333583333395000005
333333683333455000014
333333783333535000030
333333883333635000055
333333983333755000091
333334083333895000140
333334183334055000204
333334283334235000285
333334383334435000385
333334483334655000506
333334583334895000650
333334683335155000819
333334783335435001015
333334883335735001240
333334983336055001496
333335083336395001785
333335183336755002109
Calculation takes 15.771127400000001 seconds
result: [333333283333335000000, 333333383333335000000, 333333483333355000001, 333333583333395000005, 333333683333455000014, 333333783333535000030, 333333883333635000055, 333333983333755000091, 333334083333895000140, 333334183334055000204, 333334283334235000285, 333334383334435000385, 333334483334655000506, 333334583334895000650, 333334683335155000819, 333334783335435001015, 333334883335735001240, 333334983336055001496, 333335083336395001785, 333335183336755002109]
multiprocessing Calculation takes 4.7333084 seconds
</div><div><div>2019-06-28</div><div><div><i></i><span>5</span></div><div><i></i><span>8</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/56/11/5d113d5c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 天凉好个秋</span></div></div><div>如果完成，则将其放到预备状态的列表；
如果未完成，则继续放在等待状态的列表。
这里是不是写的有问题？
PS: 想问一下，完成之后为什么还要放队列里？难道不应该从队列里移除吗？</div><div><div>2019-06-28</div><div><div><i></i><span>2</span></div><div><i></i><span>7</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 建强</span></div></div><div>上网查询资料后，初步了解了多进程的一些知识，按照资料中的方法简单改写了一下程序，由于多进程方式时，不知什么原因，cpu_bound 函数不能实时输出，所以就把 cpu_bound 改为返回字符串形式的结果，等所有的数计算完成后，再一并输出结果 ，程序中常规执行和多进程两种方式都有，并作了对比后发现，常规执行用时约 23 秒，多进程用时约 6 秒，两者相差 4 倍，程序如下，不足处请老师指正：
# 多进程演示
import multiprocessing
import time

def cpu_bound (number):
    return'sum ({}^2)={}'.format (number,sum (i * i for i in range (number)))

def calculate_sums (numbers):
    
    results = []

    print ('-'*10+'串行执行开始：'+'-'*10)

    for number in numbers:
        results.append (cpu_bound (number))

    print ('-'*10+'串行执行结束，结果如下：'+'-'*10)
    for res in results:
        print (res)

def multicalculate_sums (numbers):

    #创建有 4 个进程的进程池
    pool = multiprocessing.Pool (processes=4)

    results = []

    print ('-'*10+'多进程执行开始：'+'-'*10)

    #为每一个需要计算的元素创建一个进程
    for number in numbers:
        results.append (pool.apply_async (cpu_bound, (number,)))

    pool.close () #关闭进程池，不能往进程池添加进程
    pool.join ()  #等待进程池中的所有进程执行完毕

    print ('-'*10+'多进程执行结束，结果如下：'+'-'*10)
    for res in results:
        print (res.get ())
    
def main ():

    numbers = [10000000 + x for x in range (20)]

    #串行执行方式
    start_time = time.perf_counter ()  
    calculate_sums (numbers)
    end_time = time.perf_counter ()
    print ('串行执行用时：Calculation takes {} seconds'.format (end_time - start_time))

    #多进程执行方式
    start_time = time.perf_counter ()  
    multicalculate_sums (numbers)
    end_time = time.perf_counter ()
    print ('多进程执行用时：Calculation takes {} seconds'.format (end_time - start_time))
    
if __name__ == '__main__':
    main ()
</div><div><p>作者回复：很棒的例子，但是对计算密集型程序，你可以打开任务管理器的性能页，CPU 选择显示逻辑处理器，可以注意到串行执行和并行执行的不同。</p></div><div><div>2019-10-21</div><div><div><i></i><span>2</span></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div></div><div><div><div><span>Paul Shan</span></div></div><div>sync 是线性前后执行。
async 是穿插执行，之所以要穿插，代码需要的资源不同，有的代码需要 CPU，有的代码需要 IO（例如网络）, 穿插以后，同时需要 CPU 和网络的代码可以同时执行，充分利用硬件。

具体到关键字 async 是表示函数是异步的，也就是来回穿插的起点（进入预备队列），await 是表示调用需要 IO，也就是进入等待队列的入口（函数开始调用）和出口（函数调用结束，重新进入预备队列）。</div><div><div>2019-11-21</div><div><div><i></i><span></span></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKokKnHQKrAupdgYJ8mHPbZbeDxKR229qLYkaJt4pwvd1ZcdicgjTdqPKuJlO09ibtZSOvsSLAAnWJQ/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 唐哥</span></div></div><div>老师好，对于 Asyncio 来说，它的任务在运行时不会被外部的一些因素打断。不被打断是如何保证的？还有 event loop 是每次取出一个任务运行，当这个任务运行期间它就是只等待任务结束吗？不干其他事了吗？</div><div><div>2019-07-01</div><div><div><i></i><span>2</span></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/17/19/37/e0a9bf99.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Geek_59f23e</span></div></div><div>import time
from multiprocessing import Pool


def square (number):
    return sum (i * i for i in range (number))


def single_process (numbers):
    res = []
    for number in numbers:
        res.append (square (number))
    return res


def multi_process (numbers):
    with Pool () as pool:
        res = pool.map (square, numbers)
    return res


if __name__ == '__main__':
    numbers = [10000000 + x for x in range (20)]
    start1 = time.perf_counter ()
    single_process (numbers)
    print ('单进程用时：% f 秒' % (time.perf_counter () - start1))
    start2 = time.perf_counter ()
    multi_process (numbers)
    print ('多进程用时：% f 秒' % (time.perf_counter () - start2))

————————
输出：
单进程用时：29.382878 秒
多进程用时：10.354565 秒

[333333283333335000000, 333333383333335000000, 333333483333355000001, 333333583333395000005, 333333683333455000014, 333333783333535000030, 333333883333635000055, 333333983333755000091, 333334083333895000140, 333334183334055000204, 333334283334235000285, 333334383334435000385, 333334483334655000506, 333334583334895000650, 333334683335155000819, 333334783335435001015, 333334883335735001240, 333334983336055001496, 333335083336395001785, 333335183336755002109]
</div><div><div>2019-06-28</div><div><div><i></i><span></span></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>TKbook</span></div></div><div>race condition 是什么？</div><div><div>2019-06-28</div><div><div><i></i><span>2</span></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/21/53/79/327ef30e.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>sugar</span></div></div><div>asyncio 是不是跟 IO 多路复用一个道理啊</div><div><div>2021-03-17</div><div><div><i></i><span></span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 完美坚持</span></div></div><div>我在 jupyter notebook 中用下面的多进程地并行多次尝试只需要 0.2-0.9s 间，但是老师给的普通程序需要 30 多 s，而且老师在留言中给出的答案代码，不知道哪里不对，运行不出结果，没有报错但是一直出不来结果
import concurrent.futures
import time
def cpu_bound (number):
    return sum (i * i for i in range (number))

def calculate_sums (numbers):
    with concurrent.futures.ProcessPoolExecutor () as executor:
        executor.map (cpu_bound, numbers)

def main ():
    start_time = time.perf_counter ()  
    numbers = [10000000 + x for x in range (20)]
    calculate_sums (numbers)
    end_time = time.perf_counter ()
    print ('Calculation takes {} seconds'.format (end_time - start_time))
    
if __name__ == '__main__':
    main ()</div><div><div>2020-10-04</div><div><div><i></i><span>1</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1d/5b/13/6db9ba58.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Kevin</span></div></div><div>使用 resp.content_length 得到的 None

通过 text = await resp.text ()
len (text) 可以拿到资源大小但是很耗时</div><div><div>2020-06-29</div><div><div><i></i><span></span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Richard</span></div></div><div>看了很多提问都没有被回答，我也对 asyncio 有个很大的疑问，那就是我越来越感觉 asyncio 是一个很糟糕的名字，从内容上看只是解决并发问题，我没有看到针对 io 的描述，而且我目前的知识体系认为：Linux 上解决高并发大多是用的 io 多路复用和非阻塞，至于异步 io 很少使用，而且 Linux 仅仅实现了磁盘读写的异步 io，而网络 io 没有实现异步。所以我就自然对 Python 这个 asyncio 有疑问了？它和操作系统 io 是同一个层次概念么？至少我觉得这是个很糟糕的命名，我不知道初学者遇到异步 io 的概念时花大力气搞清楚阻塞非阻塞异步和同步之后，面对 Linux 上异步 io 支持以及应用有限的事实之后会作何感想！盼复！</div><div><div>2020-04-11</div><div><div><i></i><span>2</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/d8/4f/65abc6f0.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>KaitoShy</span></div></div><div>运行文章中出现的代码时出现‘aiohttp.client_exceptions.ClientConnectorCertificateError’的这个报错，我讲代码第 7 行更改成‘async with session.get (url, ssl=False) as resp’后运行成功，是否还有其他的解决方案？</div><div><div>2019-07-03</div><div><div><i></i><span>2</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/13/3d/e7/e4b4afcc.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 方向</span></div></div><div>如果完成，则放到预备状态列表，这句话不理解。这样一来，预备状态列表同时拥有两种形式的任务啊</div><div><div>2019-06-28</div><div><div><i></i><span>3</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/26/bf/52/59304c42.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 默默且听风</span></div></div><div>class WeiXinWeb:
# set (name, value, ex=None
    def __init__(self,appid,secret) -&gt; None:
        
        self.base_url = "https://api.weixin.qq.com/"
        self.appid = appid
        self.secret = secret

    async def access_token (self) -&gt;str:
        """获取基础 access_token"""
        # 判断 redis 中的基础 token
        if not await redis_conn.get ("access_token") :
            # 拼接基础 token 请求字符串
            url:str = f"{self.base_url} cgi-bin/token?grant_type=client_credential&amp;appid={self.appid}&amp;secret={self.secret}"
            # 异步请求基础 token
            async with ClientSession () as sess:
                async with sess.get (url) as r:
                    # 获取到的基础 token 存入 redis 中
                    res = await r.text ()
                    await redis_conn.set ("access_token", json.loads (res).get ("access_token",""), ex=3600)
        token = await redis_conn.get ("access_token")
        return str (token,"utf-8")

appid = ""secret =""</div><div><div>2022-04-13</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/ib3Rzem884S7icAGXsBzGKyricapL0sfax7wL7T4n1W1ZPZ0h7XNtGd5aqLlZQgZ3bZTPBmC4xa7ia8iaR0XBKMAuIQ/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Geek_63ad86</span></div></div><div>李金甲到此一游</div><div><div>2022-02-22</div><div><div><i></i><span></span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/23/c4/86/0658e993.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 涼白开</span></div></div><div>import multiprocessing
import time


def cpu_bound(number):
    return sum(i * i for i in range(number))


def find_sums(numbers):
    with multiprocessing.Pool() as pool:
        pool.map(cpu_bound, numbers)


if __name__ == "__main__":
    numbers = [10000000 + x for x in range(20)]

    start_time = time.time()
    find_sums(numbers)
    duration = time.time() - start_time
    print(f"Duration {duration} seconds")</div><div><div>2021-08-28</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/account/avatar/00/23/f9/3e/0d5f27c4.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>肥猫不开心</span></div></div><div>怎样把一个普通的同步方法封装成异步呢</div><div><div>2021-08-19</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1g"><outline class="toc-level-h1" data-reactid=".1g.0" style="width: 175px;"><active data-reactid=".1g.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1g.0.1"><span data-reactid=".1g.0.1.0">22 | 并发编程之 Asyncio</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.1" style="width: 165px;"><active data-reactid=".1g.1.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1g.1.1"><span data-reactid=".1g.1.1.0">什么是 Asyncio</span></a></outline><outline class="toc-level-h3" data-reactid=".1g.2" style="width: 155px;"><active data-reactid=".1g.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1g.2.1"><span data-reactid=".1g.2.1.0">Sync VS Async</span></a></outline><outline class="toc-level-h3" data-reactid=".1g.3" style="width: 155px;"><active data-reactid=".1g.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1g.3.1"><span data-reactid=".1g.3.1.0">Asyncio 工作原理</span></a></outline><outline class="toc-level-h3" data-reactid=".1g.4" style="width: 155px;"><active data-reactid=".1g.4.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".1g.4.1"><span data-reactid=".1g.4.1.0">Asyncio 用法</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.5" style="width: 165px;"><active data-reactid=".1g.5.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1g.5.1"><span data-reactid=".1g.5.1.0">Asyncio 有缺陷吗？</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.6" style="width: 165px;"><active data-reactid=".1g.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1g.6.1"><span data-reactid=".1g.6.1.0">多线程还是 Asyncio</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.7" style="width: 165px;"><active data-reactid=".1g.7.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1g.7.1"><span data-reactid=".1g.7.1.0">总结</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.8" style="width: 165px;"><active data-reactid=".1g.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1g.8.1"><span data-reactid=".1g.8.1.0">思考题</span></a></outline><outline class="toc-level-h2" data-reactid=".1g.9" style="width: 165px;"><active data-reactid=".1g.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1g.9.1"><span data-reactid=".1g.9.1.0">精选留言 (69)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/103358" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>