
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 17｜更真实的云原生：实际搭建多节点的 Kubernetes 集群</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>17｜更真实的云原生：实际搭建多节点的 Kubernetes 集群</sr-rd-title>
                    
                    <sr-rd-content><h1 id="sr-toc-0"> 17｜更真实的云原生：实际搭建多节点的 Kubernetes 集群</h1><div><span>Chrono</span> <span>2022-07-29</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/59/40/59499b897bec3764f904ea717e36ae40.jpeg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：Chrono</span><span> 大小：14.80M</span><span> 时长：16:12</span></div></div><audio title="17｜更真实的云原生：实际搭建多节点的Kubernetes集群" src="https://res001.geekbang.org/media/audio/94/02/9484943a2ae2e0a09cd6e6438be29902/ld/ld.m3u8" __idm_id__="884754"></audio></div><div><div><div><div data-slate-editor="true" data-key="7574" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="7575"><span data-slate-object="text" data-key="7576"><span data-slate-leaf="true" data-offset-key="7576:0" data-first-offset="true"><span data-slate-string="true">你好，我是 Chrono。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7577"><span data-slate-object="text" data-key="7578"><span data-slate-leaf="true" data-offset-key="7578:0" data-first-offset="true"><span data-slate-string="true">到今天，你学习这个专栏的进度就已经过半了，在前面的 “入门篇” 我们了解了 Docker 和容器技术，在 “初级篇” 我们掌握了 Kubernetes 的基本对象、原理和操作方法，一路走下来收获很多。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7579"><span data-slate-object="text" data-key="7580"><span data-slate-leaf="true" data-offset-key="7580:0" data-first-offset="true"><span data-slate-string="true">现在你应该对 Kubernetes 和容器编排有了一些初步的认识，那么接下来，让我们继续深入研究 Kubernetes 的其他 API 对象，也就是那些在 Docker 中不存在的但对云计算、集群管理至关重要的概念。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7581"><span data-slate-object="text" data-key="7582"><span data-slate-leaf="true" data-offset-key="7582:0" data-first-offset="true"><span data-slate-string="true">不过在那之前，我们还需要有一个比 minikube 更真实的 Kubernetes 环境，它应该是一个多节点的 Kubernetes 集群，这样更贴近现实中的生产系统，能够让我们尽快地拥有实际的集群使用经验。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7583"><span data-slate-object="text" data-key="7584"><span data-slate-leaf="true" data-offset-key="7584:0" data-first-offset="true"><span data-slate-string="true">所以在今天的这节课里，我们就来暂时忘掉 minikube，改用 kubeadm（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="7585"><span data-slate-object="text" data-key="7586"><span data-slate-leaf="true" data-offset-key="7586:0" data-first-offset="true"><span data-slate-string="true">https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/</span></span></span></a><span data-slate-object="text" data-key="7587"><span data-slate-leaf="true" data-offset-key="7587:0" data-first-offset="true"><span data-slate-string="true">）搭建出一个新的 Kubernetes 集群，一起来看看更真实的云原生环境。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7588" id="sr-toc-1"><span data-slate-object="text" data-key="7589"><span data-slate-leaf="true" data-offset-key="7589:0" data-first-offset="true"><span data-slate-string="true">什么是 kubeadm</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7590"><span data-slate-object="text" data-key="7591"><span data-slate-leaf="true" data-offset-key="7591:0" data-first-offset="true"><span data-slate-string="true">前面的几节课里我们使用的都是 minikube，它非常简单易用，不需要什么配置工作，就能够在单机环境里创建出一个功能完善的 Kubernetes 集群，给学习、开发、测试都带来了极大的便利。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7592"><span data-slate-object="text" data-key="7593"><span data-slate-leaf="true" data-offset-key="7593:0" data-first-offset="true"><span data-slate-string="true">不过 minikube 还是太 “迷你” 了，方便的同时也隐藏了很多细节，离真正生产环境里的计算集群有一些差距，毕竟许多需求、任务只有在多节点的大集群里才能够遇到，相比起来，minikube 真的只能算是一个 “玩具”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7594"><span data-slate-object="text" data-key="7595"><span data-slate-leaf="true" data-offset-key="7595:0" data-first-offset="true"><span data-slate-string="true">那么，多节点的 Kubernetes 集群是怎么从无到有地创建出来的呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7596"><a data-slate-type="link" data-slate-object="inline" data-key="7597"><span data-slate-object="text" data-key="7598"><span data-slate-leaf="true" data-offset-key="7598:0" data-first-offset="true"><span data-slate-string="true">第 10 讲</span></span></span></a><span data-slate-object="text" data-key="7599"><span data-slate-leaf="true" data-offset-key="7599:0" data-first-offset="true"><span data-slate-string="true">说过 Kubernetes 是很多模块构成的，而实现核心功能的组件像 apiserver、etcd、scheduler 等本质上都是可执行文件，所以也可以采用和其他系统差不多的方式，使用 Shell 脚本或者 Ansible 等工具打包发布到服务器上。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7600"><span data-slate-object="text" data-key="7601"><span data-slate-leaf="true" data-offset-key="7601:0" data-first-offset="true"><span data-slate-string="true">不过 Kubernetes 里的这些组件的配置和相互关系实在是太复杂了，用 Shell、Ansible 来部署的难度很高，需要具有相当专业的运维管理知识才能配置、搭建好集群，而且即使这样，搭建的过程也非常麻烦。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7602"><span data-slate-object="text" data-key="7603"><span data-slate-leaf="true" data-offset-key="7603:0" data-first-offset="true"><span data-slate-string="true">为了简化 Kubernetes 的部署工作，让它能够更 “接地气”，社区里就出现了一个专门用来在集群中安装 Kubernetes 的工具，名字就叫 “</span></span></span><span data-slate-object="text" data-key="7604"><span data-slate-leaf="true" data-offset-key="7604:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">kubeadm</span></span></span></span><span data-slate-object="text" data-key="7605"><span data-slate-leaf="true" data-offset-key="7605:0" data-first-offset="true"><span data-slate-string="true">”，意思就是 “Kubernetes 管理员”。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7606"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/f2/88/f27c7938cba21215621ac33635d63288.jpg?wh=1044x640"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7607"><span data-slate-object="text" data-key="7608"><span data-slate-leaf="true" data-offset-key="7608:0" data-first-offset="true"><span data-slate-string="true">kubeadm，原理和 minikube 类似，也是用容器和镜像来封装 Kubernetes 的各种组件，但它的目标不是单机部署，而是要能够轻松地在集群环境里部署 Kubernetes，并且让这个集群接近甚至达到生产级质量。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7609"><span data-slate-object="text" data-key="7610"><span data-slate-leaf="true" data-offset-key="7610:0" data-first-offset="true"><span data-slate-string="true">而在保持这个高水准的同时，kubeadm 还具有了和 minikube 一样的易用性，只要很少的几条命令，如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7611"><span data-slate-object="text" data-key="7612"><span data-slate-leaf="true" data-offset-key="7612:0" data-first-offset="true"><span data-slate-string="true">init</span></span></span></span><span data-slate-object="text" data-key="7613"><span data-slate-leaf="true" data-offset-key="7613:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7614"><span data-slate-object="text" data-key="7615"><span data-slate-leaf="true" data-offset-key="7615:0" data-first-offset="true"><span data-slate-string="true">join</span></span></span></span><span data-slate-object="text" data-key="7616"><span data-slate-leaf="true" data-offset-key="7616:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7617"><span data-slate-object="text" data-key="7618"><span data-slate-leaf="true" data-offset-key="7618:0" data-first-offset="true"><span data-slate-string="true">upgrade</span></span></span></span><span data-slate-object="text" data-key="7619"><span data-slate-leaf="true" data-offset-key="7619:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7620"><span data-slate-object="text" data-key="7621"><span data-slate-leaf="true" data-offset-key="7621:0" data-first-offset="true"><span data-slate-string="true">reset</span></span></span></span><span data-slate-object="text" data-key="7622"><span data-slate-leaf="true" data-offset-key="7622:0" data-first-offset="true"><span data-slate-string="true"> 就能够完成 Kubernetes 集群的管理维护工作，这让它不仅适用于集群管理员，也适用于开发、测试人员。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7623" id="sr-toc-2"><span data-slate-object="text" data-key="7624"><span data-slate-leaf="true" data-offset-key="7624:0" data-first-offset="true"><span data-slate-string="true">实验环境的架构是什么样的</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7625"><span data-slate-object="text" data-key="7626"><span data-slate-leaf="true" data-offset-key="7626:0" data-first-offset="true"><span data-slate-string="true">在使用 kubeadm 搭建实验环境之前，我们先来看看集群的架构设计，也就是说要准备好集群所需的硬件设施。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7627"><span data-slate-object="text" data-key="7628"><span data-slate-leaf="true" data-offset-key="7628:0" data-first-offset="true"><span data-slate-string="true">这里我画了一张系统架构图，图里一共有 3 台主机，当然它们都是使用虚拟机软件 VirtualBox/VMWare 虚拟出来的，下面我来详细说明一下：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7629"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/yy/3e/yyf5db64d398b4d5dyyd5e8e23ece53e.jpg?wh=1920x1294"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7630"><span data-slate-object="text" data-key="7631"><span data-slate-leaf="true" data-offset-key="7631:0" data-first-offset="true"><span data-slate-string="true">所谓的多节点集群，要求服务器应该有两台或者更多，为了简化我们只取最小值，所以这个 Kubernetes 集群就只有两台主机，一台是 Master 节点，另一台是 Worker 节点。当然，在完全掌握了 kubeadm 的用法之后，你可以在这个集群里添加更多的节点。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7632"><span data-slate-object="text" data-key="7633"><span data-slate-leaf="true" data-offset-key="7633:0" data-first-offset="true"><span data-slate-string="true">Master 节点需要运行 apiserver、etcd、scheduler、controller-manager 等组件，管理整个集群，所以对配置要求比较高，至少是 2 核 CPU、4GB 的内存。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7634"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/d1/3c/d19a8ceafd4db10a5yy35c623384ba3c.png?wh=1504x920"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7635"><span data-slate-object="text" data-key="7636"><span data-slate-leaf="true" data-offset-key="7636:0" data-first-offset="true"><span data-slate-string="true">而 Worker 节点没有管理工作，只运行业务应用，所以配置可以低一些，为了节省资源我给它分配了 1 核 CPU 和 1GB 的内存，可以说是低到不能再低了。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7637"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/ee/f3/eeee60b6e29d7b6c4c74f913ac663ef3.png?wh=1504x1024"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7638"><span data-slate-object="text" data-key="7639"><span data-slate-leaf="true" data-offset-key="7639:0" data-first-offset="true"><span data-slate-string="true">基于模拟生产环境的考虑，在 Kubernetes 集群之外还需要有一台起辅助作用的服务器。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7640"><span data-slate-object="text" data-key="7641"><span data-slate-leaf="true" data-offset-key="7641:0" data-first-offset="true"><span data-slate-string="true">它的名字叫 Console，意思是控制台，我们要在上面安装命令行工具 kubectl，所有对 Kubernetes 集群的管理命令都是从这台主机发出去的。这也比较符合实际情况，因为安全的原因，集群里的主机部署好之后应该尽量少直接登录上去操作。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7642"><span data-slate-object="text" data-key="7643"><span data-slate-leaf="true" data-offset-key="7643:0" data-first-offset="true"><span data-slate-string="true">要提醒你的是，Console 这台主机只是逻辑上的概念，不一定要是独立，你在实际安装部署的时候完全可以复用之前 minikube 的虚拟机，或者直接使用 Master/Worker 节点作为控制台。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7644"><span data-slate-object="text" data-key="7645"><span data-slate-leaf="true" data-offset-key="7645:0" data-first-offset="true"><span data-slate-string="true">这 3 台主机共同组成了我们的实验环境，所以在配置的时候要注意它们的网络选项，必须是在同一个网段，你可以再回顾一下</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="7646"><span data-slate-object="text" data-key="7647"><span data-slate-leaf="true" data-offset-key="7647:0" data-first-offset="true"><span data-slate-string="true">课前准备</span></span></span></a><span data-slate-object="text" data-key="7648"><span data-slate-leaf="true" data-offset-key="7648:0" data-first-offset="true"><span data-slate-string="true">，保证它们使用的是同一个 “Host-Only”（VirtualBox）或者 “自定”（VMWare Fusion）网络。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7649" id="sr-toc-3"><span data-slate-object="text" data-key="7650"><span data-slate-leaf="true" data-offset-key="7650:0" data-first-offset="true"><span data-slate-string="true">安装前的准备工作</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7651"><span data-slate-object="text" data-key="7652"><span data-slate-leaf="true" data-offset-key="7652:0" data-first-offset="true"><span data-slate-string="true">不过有了架构图里的这些主机之后，我们还不能立即开始使用 kubeadm 安装 Kubernetes，因为 Kubernetes 对系统有一些特殊要求，我们必须还要在 Master 和 Worker 节点上做一些准备。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7653"><span data-slate-object="text" data-key="7654"><span data-slate-leaf="true" data-offset-key="7654:0" data-first-offset="true"><span data-slate-string="true">这些工作的详细信息你都可以在 Kubernetes 的官网上找到，但它们分散在不同的文档里，比较凌乱，所以我把它们整合到了这里，包括改主机名、改 Docker 配置、改网络设置、改交换分区这四步。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7655"><span data-slate-object="text" data-key="7656"><span data-slate-leaf="true" data-offset-key="7656:0" data-first-offset="true"><span data-slate-string="true">第一，由于 Kubernetes 使用主机名来区分集群里的节点，所以每个节点的 hostname 必须不能重名。你需要修改 “</span></span></span><span data-slate-object="text" data-key="7657"><span data-slate-leaf="true" data-offset-key="7657:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">/etc/hostname</span></span></span></span><span data-slate-object="text" data-key="7658"><span data-slate-leaf="true" data-offset-key="7658:0" data-first-offset="true"><span data-slate-string="true">” 这个文件，把它改成容易辨识的名字，比如 Master 节点就叫 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7659"><span data-slate-object="text" data-key="7660"><span data-slate-leaf="true" data-offset-key="7660:0" data-first-offset="true"><span data-slate-string="true">master</span></span></span></span><span data-slate-object="text" data-key="7661"><span data-slate-leaf="true" data-offset-key="7661:0" data-first-offset="true"><span data-slate-string="true">，Worker 节点就叫 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7662"><span data-slate-object="text" data-key="7663"><span data-slate-leaf="true" data-offset-key="7663:0" data-first-offset="true"><span data-slate-string="true">worker</span></span></span></span><span data-slate-object="text" data-key="7664"><span data-slate-leaf="true" data-offset-key="7664:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7665"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7666"><span data-slate-object="text" data-key="7667"><span data-slate-leaf="true" data-offset-key="7667:0" data-first-offset="true"><span data-slate-string="true">sudo vi /etc/hostname</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7668"><span data-slate-object="text" data-key="7669"><span data-slate-leaf="true" data-offset-key="7669:0" data-first-offset="true"><span data-slate-string="true">第二，虽然 Kubernetes 目前支持多种容器运行时，但 Docker 还是最方便最易用的一种，所以我们仍然继续使用 Docker 作为 Kubernetes 的底层支持，使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7670"><span data-slate-object="text" data-key="7671"><span data-slate-leaf="true" data-offset-key="7671:0" data-first-offset="true"><span data-slate-string="true">apt</span></span></span></span><span data-slate-object="text" data-key="7672"><span data-slate-leaf="true" data-offset-key="7672:0" data-first-offset="true"><span data-slate-string="true"> 安装 Docker Engine（可参考</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="7673"><span data-slate-object="text" data-key="7674"><span data-slate-leaf="true" data-offset-key="7674:0" data-first-offset="true"><span data-slate-string="true">第 1 讲</span></span></span></a><span data-slate-object="text" data-key="7675"><span data-slate-leaf="true" data-offset-key="7675:0" data-first-offset="true"><span data-slate-string="true">）。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7676"><span data-slate-object="text" data-key="7677"><span data-slate-leaf="true" data-offset-key="7677:0" data-first-offset="true"><span data-slate-string="true">安装完成后需要你再对 Docker 的配置做一点修改，在 “</span></span></span><span data-slate-object="text" data-key="7678"><span data-slate-leaf="true" data-offset-key="7678:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">/etc/docker/daemon.json</span></span></span></span><span data-slate-object="text" data-key="7679"><span data-slate-leaf="true" data-offset-key="7679:0" data-first-offset="true"><span data-slate-string="true">” 里把 cgroup 的驱动程序改成 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7680"><span data-slate-object="text" data-key="7681"><span data-slate-leaf="true" data-offset-key="7681:0" data-first-offset="true"><span data-slate-string="true">systemd</span></span></span></span><span data-slate-object="text" data-key="7682"><span data-slate-leaf="true" data-offset-key="7682:0" data-first-offset="true"><span data-slate-string="true"> ，然后重启 Docker 的守护进程，具体的操作我列在了下面：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7683"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7684"><span data-slate-object="text" data-key="7685"><span data-slate-leaf="true" data-offset-key="7685:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cat</span></span></span></span><span data-slate-object="text" data-key="7686"><span data-slate-leaf="true" data-offset-key="7686:0" data-first-offset="true"><span data-slate-string="true"> &lt;&lt;</span></span></span><span data-slate-object="text" data-key="7687"><span data-slate-leaf="true" data-offset-key="7687:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">EOF | sudo tee /etc/docker/daemon.json</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7688"><span data-slate-object="text" data-key="7689"><span data-slate-leaf="true" data-offset-key="7689:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7690"><span data-slate-object="text" data-key="7691"><span data-slate-leaf="true" data-offset-key="7691:0" data-first-offset="true"><span data-slate-string="true">  "exec-opts": ["native.cgroupdriver=systemd"],</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7692"><span data-slate-object="text" data-key="7693"><span data-slate-leaf="true" data-offset-key="7693:0" data-first-offset="true"><span data-slate-string="true">  "log-driver": "json-file",</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7694"><span data-slate-object="text" data-key="7695"><span data-slate-leaf="true" data-offset-key="7695:0" data-first-offset="true"><span data-slate-string="true">  "log-opts": {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7696"><span data-slate-object="text" data-key="7697"><span data-slate-leaf="true" data-offset-key="7697:0" data-first-offset="true"><span data-slate-string="true">    "max-size": "100m"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7698"><span data-slate-object="text" data-key="7699"><span data-slate-leaf="true" data-offset-key="7699:0" data-first-offset="true"><span data-slate-string="true">  },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7700"><span data-slate-object="text" data-key="7701"><span data-slate-leaf="true" data-offset-key="7701:0" data-first-offset="true"><span data-slate-string="true">  "storage-driver": "overlay2"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7702"><span data-slate-object="text" data-key="7703"><span data-slate-leaf="true" data-offset-key="7703:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7704"><span data-slate-object="text" data-key="7705"><span data-slate-leaf="true" data-offset-key="7705:0" data-first-offset="true"><span data-slate-string="true">EOF</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7706"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7707"><span data-slate-object="text" data-key="7708"><span data-slate-leaf="true" data-offset-key="7708:0" data-first-offset="true"><span data-slate-string="true">sudo systemctl </span></span></span><span data-slate-object="text" data-key="7709"><span data-slate-leaf="true" data-offset-key="7709:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">enable</span></span></span></span><span data-slate-object="text" data-key="7710"><span data-slate-leaf="true" data-offset-key="7710:0" data-first-offset="true"><span data-slate-string="true"> docker</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7711"><span data-slate-object="text" data-key="7712"><span data-slate-leaf="true" data-offset-key="7712:0" data-first-offset="true"><span data-slate-string="true">sudo systemctl daemon-reload</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7713"><span data-slate-object="text" data-key="7714"><span data-slate-leaf="true" data-offset-key="7714:0" data-first-offset="true"><span data-slate-string="true">sudo systemctl restart docker</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7715"><span data-slate-object="text" data-key="7716"><span data-slate-leaf="true" data-offset-key="7716:0" data-first-offset="true"><span data-slate-string="true">第三，为了让 Kubernetes 能够检查、转发网络流量，你需要修改 iptables 的配置，启用 “br_netfilter” 模块：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7717"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7718"><span data-slate-object="text" data-key="7719"><span data-slate-leaf="true" data-offset-key="7719:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cat</span></span></span></span><span data-slate-object="text" data-key="7720"><span data-slate-leaf="true" data-offset-key="7720:0" data-first-offset="true"><span data-slate-string="true"> &lt;&lt;</span></span></span><span data-slate-object="text" data-key="7721"><span data-slate-leaf="true" data-offset-key="7721:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">EOF | sudo tee /etc/modules-load.d/k8s.conf</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7722"><span data-slate-object="text" data-key="7723"><span data-slate-leaf="true" data-offset-key="7723:0" data-first-offset="true"><span data-slate-string="true">br_netfilter</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7724"><span data-slate-object="text" data-key="7725"><span data-slate-leaf="true" data-offset-key="7725:0" data-first-offset="true"><span data-slate-string="true">EOF</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7726"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7727"><span data-slate-object="text" data-key="7728"><span data-slate-leaf="true" data-offset-key="7728:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cat</span></span></span></span><span data-slate-object="text" data-key="7729"><span data-slate-leaf="true" data-offset-key="7729:0" data-first-offset="true"><span data-slate-string="true"> &lt;&lt;</span></span></span><span data-slate-object="text" data-key="7730"><span data-slate-leaf="true" data-offset-key="7730:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">EOF | sudo tee /etc/sysctl.d/k8s.conf</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7731"><span data-slate-object="text" data-key="7732"><span data-slate-leaf="true" data-offset-key="7732:0" data-first-offset="true"><span data-slate-string="true">net.bridge.bridge-nf-call-ip6tables = 1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7733"><span data-slate-object="text" data-key="7734"><span data-slate-leaf="true" data-offset-key="7734:0" data-first-offset="true"><span data-slate-string="true">net.bridge.bridge-nf-call-iptables = 1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7735"><span data-slate-object="text" data-key="7736"><span data-slate-leaf="true" data-offset-key="7736:0" data-first-offset="true"><span data-slate-string="true">net.ipv4.ip_forward=1 # better than modify /etc/sysctl.conf</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7737"><span data-slate-object="text" data-key="7738"><span data-slate-leaf="true" data-offset-key="7738:0" data-first-offset="true"><span data-slate-string="true">EOF</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7739"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7740"><span data-slate-object="text" data-key="7741"><span data-slate-leaf="true" data-offset-key="7741:0" data-first-offset="true"><span data-slate-string="true">sudo sysctl --system</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7742"><span data-slate-object="text" data-key="7743"><span data-slate-leaf="true" data-offset-key="7743:0" data-first-offset="true"><span data-slate-string="true">第四，你需要修改 “</span></span></span><span data-slate-object="text" data-key="7744"><span data-slate-leaf="true" data-offset-key="7744:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">/etc/fstab</span></span></span></span><span data-slate-object="text" data-key="7745"><span data-slate-leaf="true" data-offset-key="7745:0" data-first-offset="true"><span data-slate-string="true">”，关闭 Linux 的 swap 分区，提升 Kubernetes 的性能：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7746"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7747"><span data-slate-object="text" data-key="7748"><span data-slate-leaf="true" data-offset-key="7748:0" data-first-offset="true"><span data-slate-string="true">sudo swapoff -a</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7749"><span data-slate-object="text" data-key="7750"><span data-slate-leaf="true" data-offset-key="7750:0" data-first-offset="true"><span data-slate-string="true">sudo sed -ri </span></span></span><span data-slate-object="text" data-key="7751"><span data-slate-leaf="true" data-offset-key="7751:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'/\sswap\s/s/^#?/#/'</span></span></span></span><span data-slate-object="text" data-key="7752"><span data-slate-leaf="true" data-offset-key="7752:0" data-first-offset="true"><span data-slate-string="true"> /etc/fstab</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7753"><span data-slate-object="text" data-key="7754"><span data-slate-leaf="true" data-offset-key="7754:0" data-first-offset="true"><span data-slate-string="true">完成之后，最好记得重启一下系统，然后给虚拟机拍个快照做备份，避免后续的操作失误导致重复劳动。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7755" id="sr-toc-4"><span data-slate-object="text" data-key="7756"><span data-slate-leaf="true" data-offset-key="7756:0" data-first-offset="true"><span data-slate-string="true">安装 kubeadm</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7757"><span data-slate-object="text" data-key="7758"><span data-slate-leaf="true" data-offset-key="7758:0" data-first-offset="true"><span data-slate-string="true">好，现在我们就要安装 kubeadm 了，在 Master 节点和 Worker 节点上都要做这一步。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7759"><span data-slate-object="text" data-key="7760"><span data-slate-leaf="true" data-offset-key="7760:0" data-first-offset="true"><span data-slate-string="true">kubeadm 可以直接从 Google 自己的软件仓库下载安装，但国内的网络不稳定，很难下载成功，需要改用其他的软件源，这里我选择了国内的某云厂商：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7761"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7762"><span data-slate-object="text" data-key="7763"><span data-slate-leaf="true" data-offset-key="7763:0" data-first-offset="true"><span data-slate-string="true">sudo apt install -y apt-transport-https ca-certificates curl</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7764"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7765"><span data-slate-object="text" data-key="7766"><span data-slate-leaf="true" data-offset-key="7766:0" data-first-offset="true"><span data-slate-string="true">curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7767"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7768"><span data-slate-object="text" data-key="7769"><span data-slate-leaf="true" data-offset-key="7769:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cat</span></span></span></span><span data-slate-object="text" data-key="7770"><span data-slate-leaf="true" data-offset-key="7770:0" data-first-offset="true"><span data-slate-string="true"> &lt;&lt;</span></span></span><span data-slate-object="text" data-key="7771"><span data-slate-leaf="true" data-offset-key="7771:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7772"><span data-slate-object="text" data-key="7773"><span data-slate-leaf="true" data-offset-key="7773:0" data-first-offset="true"><span data-slate-string="true">deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7774"><span data-slate-object="text" data-key="7775"><span data-slate-leaf="true" data-offset-key="7775:0" data-first-offset="true"><span data-slate-string="true">EOF</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7776"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7777"><span data-slate-object="text" data-key="7778"><span data-slate-leaf="true" data-offset-key="7778:0" data-first-offset="true"><span data-slate-string="true">sudo apt update</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7779"><span data-slate-object="text" data-key="7780"><span data-slate-leaf="true" data-offset-key="7780:0" data-first-offset="true"><span data-slate-string="true">更新了软件仓库，我们就可以用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7781"><span data-slate-object="text" data-key="7782"><span data-slate-leaf="true" data-offset-key="7782:0" data-first-offset="true"><span data-slate-string="true">apt install</span></span></span></span><span data-slate-object="text" data-key="7783"><span data-slate-leaf="true" data-offset-key="7783:0" data-first-offset="true"><span data-slate-string="true"> 获取 kubeadm、kubelet 和 kubectl 这三个安装必备工具了。apt 默认会下载最新版本，但我们也可以指定版本号，比如使用和 minikube 相同的 “1.23.3”：</span></span></span></div><div data-slate-type="pre" data-slate-object="block" data-key="7784"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7785"><span data-slate-object="text" data-key="7786"><span data-slate-leaf="true" data-offset-key="7786:0" data-first-offset="true"><span data-slate-string="true">sudo apt install -y kubeadm=1.23.3-00 kubelet=1.23.3-00 kubectl=1.23.3-00</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7787"><span data-slate-object="text" data-key="7788"><span data-slate-leaf="true" data-offset-key="7788:0" data-first-offset="true"><span data-slate-string="true">安装完成之后，你可以用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7789"><span data-slate-object="text" data-key="7790"><span data-slate-leaf="true" data-offset-key="7790:0" data-first-offset="true"><span data-slate-string="true">kubeadm version</span></span></span></span><span data-slate-object="text" data-key="7791"><span data-slate-leaf="true" data-offset-key="7791:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7792"><span data-slate-object="text" data-key="7793"><span data-slate-leaf="true" data-offset-key="7793:0" data-first-offset="true"><span data-slate-string="true">kubectl version</span></span></span></span><span data-slate-object="text" data-key="7794"><span data-slate-leaf="true" data-offset-key="7794:0" data-first-offset="true"><span data-slate-string="true"> 来验证版本是否正确：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="7795"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7796"><span data-slate-object="text" data-key="7797"><span data-slate-leaf="true" data-offset-key="7797:0" data-first-offset="true"><span data-slate-string="true">kubeadm version</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7798"><span data-slate-object="text" data-key="7799"><span data-slate-leaf="true" data-offset-key="7799:0" data-first-offset="true"><span data-slate-string="true">kubectl version </span></span></span><span data-slate-object="text" data-key="7800"><span data-slate-leaf="true" data-offset-key="7800:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--client</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="image" data-slate-object="block" data-key="7801"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/72/c9/72d79f46d9132af0dca110d982eff1c9.png?wh=1408x306"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7802"><span data-slate-object="text" data-key="7803"><span data-slate-leaf="true" data-offset-key="7803:0" data-first-offset="true"><span data-slate-string="true">另外按照 Kubernetes 官网的要求，我们最好再使用命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7804"><span data-slate-object="text" data-key="7805"><span data-slate-leaf="true" data-offset-key="7805:0" data-first-offset="true"><span data-slate-string="true">apt-mark hold</span></span></span></span><span data-slate-object="text" data-key="7806"><span data-slate-leaf="true" data-offset-key="7806:0" data-first-offset="true"><span data-slate-string="true"> ，锁定这三个软件的版本，避免意外升级导致版本错误：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="7807"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7808"><span data-slate-object="text" data-key="7809"><span data-slate-leaf="true" data-offset-key="7809:0" data-first-offset="true"><span data-slate-string="true">sudo apt</span></span></span><span data-slate-object="text" data-key="7810"><span data-slate-leaf="true" data-offset-key="7810:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-</span></span></span></span><span data-slate-object="text" data-key="7811"><span data-slate-leaf="true" data-offset-key="7811:0" data-first-offset="true"><span data-slate-string="true">mark </span></span></span><span data-slate-object="text" data-key="7812"><span data-slate-leaf="true" data-offset-key="7812:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">hold</span></span></span></span><span data-slate-object="text" data-key="7813"><span data-slate-leaf="true" data-offset-key="7813:0" data-first-offset="true"><span data-slate-string="true"> kubeadm kubelet kubectl</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7814" id="sr-toc-5"><span data-slate-object="text" data-key="7815"><span data-slate-leaf="true" data-offset-key="7815:0" data-first-offset="true"><span data-slate-string="true">下载 Kubernetes 组件镜像</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7816"><span data-slate-object="text" data-key="7817"><span data-slate-leaf="true" data-offset-key="7817:0" data-first-offset="true"><span data-slate-string="true">前面我说过，kubeadm 把 apiserver、etcd、scheduler 等组件都打包成了镜像，以容器的方式启动 Kubernetes，但这些镜像不是放在 Docker Hub 上，而是放在 Google 自己的镜像仓库网站 gcr.io，而它在国内的访问很困难，直接拉取镜像几乎是不可能的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7818"><span data-slate-object="text" data-key="7819"><span data-slate-leaf="true" data-offset-key="7819:0" data-first-offset="true"><span data-slate-string="true">所以我们需要采取一些变通措施，提前把镜像下载到本地。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7820"><span data-slate-object="text" data-key="7821"><span data-slate-leaf="true" data-offset-key="7821:0" data-first-offset="true"><span data-slate-string="true">使用命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7822"><span data-slate-object="text" data-key="7823"><span data-slate-leaf="true" data-offset-key="7823:0" data-first-offset="true"><span data-slate-string="true">kubeadm config images list</span></span></span></span><span data-slate-object="text" data-key="7824"><span data-slate-leaf="true" data-offset-key="7824:0" data-first-offset="true"><span data-slate-string="true"> 可以查看安装 Kubernetes 所需的镜像列表，参数 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7825"><span data-slate-object="text" data-key="7826"><span data-slate-leaf="true" data-offset-key="7826:0" data-first-offset="true"><span data-slate-string="true">--kubernetes-version</span></span></span></span><span data-slate-object="text" data-key="7827"><span data-slate-leaf="true" data-offset-key="7827:0" data-first-offset="true"><span data-slate-string="true"> 可以指定版本号：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7828"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7829"><span data-slate-object="text" data-key="7830"><span data-slate-leaf="true" data-offset-key="7830:0" data-first-offset="true"><span data-slate-string="true">kubeadm config images list --kubernetes-version v1.23.3</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7831"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7832"><span data-slate-object="text" data-key="7833"><span data-slate-leaf="true" data-offset-key="7833:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/kube-apiserver:v1.23.3</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7834"><span data-slate-object="text" data-key="7835"><span data-slate-leaf="true" data-offset-key="7835:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/kube-controller-manager:v1.23.3</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7836"><span data-slate-object="text" data-key="7837"><span data-slate-leaf="true" data-offset-key="7837:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/kube-scheduler:v1.23.3</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7838"><span data-slate-object="text" data-key="7839"><span data-slate-leaf="true" data-offset-key="7839:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/kube-proxy:v1.23.3</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7840"><span data-slate-object="text" data-key="7841"><span data-slate-leaf="true" data-offset-key="7841:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/pause:3.6</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7842"><span data-slate-object="text" data-key="7843"><span data-slate-leaf="true" data-offset-key="7843:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/etcd:3.5.1-0</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7844"><span data-slate-object="text" data-key="7845"><span data-slate-leaf="true" data-offset-key="7845:0" data-first-offset="true"><span data-slate-string="true">k8s.gcr.io/coredns/coredns:v1.8.6</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7846"><span data-slate-object="text" data-key="7847"><span data-slate-leaf="true" data-offset-key="7847:0" data-first-offset="true"><span data-slate-string="true">知道了镜像的名字和标签就好办了，我们有两种方法可以比较容易地获取这些镜像。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7848"><span data-slate-object="text" data-key="7849"><span data-slate-leaf="true" data-offset-key="7849:0" data-first-offset="true"><span data-slate-string="true">第一种方法是利用 minikube。因为 minikube 本身也打包了 Kubernetes 的组件镜像，所以完全可以从它的节点里把这些镜像导出之后再拷贝过来。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7850"><span data-slate-object="text" data-key="7851"><span data-slate-leaf="true" data-offset-key="7851:0" data-first-offset="true"><span data-slate-string="true">具体做法也很简单，先启动 minikube，然后 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7852"><span data-slate-object="text" data-key="7853"><span data-slate-leaf="true" data-offset-key="7853:0" data-first-offset="true"><span data-slate-string="true">minikube ssh</span></span></span></span><span data-slate-object="text" data-key="7854"><span data-slate-leaf="true" data-offset-key="7854:0" data-first-offset="true"><span data-slate-string="true"> 登录进虚拟节点，用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7855"><span data-slate-object="text" data-key="7856"><span data-slate-leaf="true" data-offset-key="7856:0" data-first-offset="true"><span data-slate-string="true">docker save -o</span></span></span></span><span data-slate-object="text" data-key="7857"><span data-slate-leaf="true" data-offset-key="7857:0" data-first-offset="true"><span data-slate-string="true"> 命令把相应版本的镜像都保存下来，再用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7858"><span data-slate-object="text" data-key="7859"><span data-slate-leaf="true" data-offset-key="7859:0" data-first-offset="true"><span data-slate-string="true">minikube cp</span></span></span></span><span data-slate-object="text" data-key="7860"><span data-slate-leaf="true" data-offset-key="7860:0" data-first-offset="true"><span data-slate-string="true"> 拷贝到本地，剩下的事情就不用我多说了：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7861"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/66/4f/6609a62525bbf5d77eb7331f9835244f.png?wh=1848x484"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7862"><span data-slate-object="text" data-key="7863"><span data-slate-leaf="true" data-offset-key="7863:0" data-first-offset="true"><span data-slate-string="true">这种方法安全可靠，不过操作上麻烦了些，所以就有了第二种方法，从国内的镜像网站下载然后再用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7864"><span data-slate-object="text" data-key="7865"><span data-slate-leaf="true" data-offset-key="7865:0" data-first-offset="true"><span data-slate-string="true">docker tag</span></span></span></span><span data-slate-object="text" data-key="7866"><span data-slate-leaf="true" data-offset-key="7866:0" data-first-offset="true"><span data-slate-string="true"> 改名，能够使用 Shell 编程实现自动化：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7867"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7868"><span data-slate-object="text" data-key="7869"><span data-slate-leaf="true" data-offset-key="7869:0" data-first-offset="true"><span data-slate-string="true">repo=registry.aliyuncs.com/google_containers</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7870"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7871"><span data-slate-object="text" data-key="7872"><span data-slate-leaf="true" data-offset-key="7872:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="7873"><span data-slate-leaf="true" data-offset-key="7873:0" data-first-offset="true"><span data-slate-string="true"> name </span></span></span><span data-slate-object="text" data-key="7874"><span data-slate-leaf="true" data-offset-key="7874:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">in</span></span></span></span><span data-slate-object="text" data-key="7875"><span data-slate-leaf="true" data-offset-key="7875:0" data-first-offset="true"><span data-slate-string="true"> `kubeadm config images list --kubernetes-version v1.23.3`; </span></span></span><span data-slate-object="text" data-key="7876"><span data-slate-leaf="true" data-offset-key="7876:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">do</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7877"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7878"><span data-slate-object="text" data-key="7879"><span data-slate-leaf="true" data-offset-key="7879:0" data-first-offset="true"><span data-slate-string="true">    src_name=</span></span></span><span data-slate-object="text" data-key="7880"><span data-slate-leaf="true" data-offset-key="7880:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">${name#k8s.gcr.io/}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7881"><span data-slate-object="text" data-key="7882"><span data-slate-leaf="true" data-offset-key="7882:0" data-first-offset="true"><span data-slate-string="true">    src_name=</span></span></span><span data-slate-object="text" data-key="7883"><span data-slate-leaf="true" data-offset-key="7883:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">${src_name#coredns/}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7884"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7885"><span data-slate-object="text" data-key="7886"><span data-slate-leaf="true" data-offset-key="7886:0" data-first-offset="true"><span data-slate-string="true">    docker pull </span></span></span><span data-slate-object="text" data-key="7887"><span data-slate-leaf="true" data-offset-key="7887:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$repo</span></span></span></span><span data-slate-object="text" data-key="7888"><span data-slate-leaf="true" data-offset-key="7888:0" data-first-offset="true"><span data-slate-string="true">/</span></span></span><span data-slate-object="text" data-key="7889"><span data-slate-leaf="true" data-offset-key="7889:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$src_name</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7890"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7891"><span data-slate-object="text" data-key="7892"><span data-slate-leaf="true" data-offset-key="7892:0" data-first-offset="true"><span data-slate-string="true">    docker tag </span></span></span><span data-slate-object="text" data-key="7893"><span data-slate-leaf="true" data-offset-key="7893:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$repo</span></span></span></span><span data-slate-object="text" data-key="7894"><span data-slate-leaf="true" data-offset-key="7894:0" data-first-offset="true"><span data-slate-string="true">/</span></span></span><span data-slate-object="text" data-key="7895"><span data-slate-leaf="true" data-offset-key="7895:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$src_name</span></span></span></span><span data-slate-object="text" data-key="7896"><span data-slate-leaf="true" data-offset-key="7896:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="7897"><span data-slate-leaf="true" data-offset-key="7897:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$name</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7898"><span data-slate-object="text" data-key="7899"><span data-slate-leaf="true" data-offset-key="7899:0" data-first-offset="true"><span data-slate-string="true">    docker rmi </span></span></span><span data-slate-object="text" data-key="7900"><span data-slate-leaf="true" data-offset-key="7900:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$repo</span></span></span></span><span data-slate-object="text" data-key="7901"><span data-slate-leaf="true" data-offset-key="7901:0" data-first-offset="true"><span data-slate-string="true">/</span></span></span><span data-slate-object="text" data-key="7902"><span data-slate-leaf="true" data-offset-key="7902:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$src_name</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7903"><span data-slate-object="text" data-key="7904"><span data-slate-leaf="true" data-offset-key="7904:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">done</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7905"><span data-slate-object="text" data-key="7906"><span data-slate-leaf="true" data-offset-key="7906:0" data-first-offset="true"><span data-slate-string="true">第二种方法速度快，但也有隐患，万一网站不提供服务，或者改动了镜像就比较危险了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7907"><span data-slate-object="text" data-key="7908"><span data-slate-leaf="true" data-offset-key="7908:0" data-first-offset="true"><span data-slate-string="true">所以你可以把这两种方法结合起来，先用脚本从国内镜像仓库下载，然后再用 minikube 里的镜像做对比，只要 IMAGE ID 是一样就说明镜像是正确的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7909"><span data-slate-object="text" data-key="7910"><span data-slate-leaf="true" data-offset-key="7910:0" data-first-offset="true"><span data-slate-string="true">这张截图就是 Kubernetes 1.23.3 的镜像列表（amd64/arm64），你在安装时可以参考：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="7911"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/11/5c/11d9d4c91b08d95e82e75406a4d3aa5c.png?wh=1920x353"></div><div>amd64</div></div><div data-slate-type="image" data-slate-object="block" data-key="7912"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/52/6c/528d9913620015f594988e648eeac66c.png?wh=1920x420"></div><div>arm64</div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="7913" id="sr-toc-6"><span data-slate-object="text" data-key="7914"><span data-slate-leaf="true" data-offset-key="7914:0" data-first-offset="true"><span data-slate-string="true">安装 Master 节点</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="7915"><span data-slate-object="text" data-key="7916"><span data-slate-leaf="true" data-offset-key="7916:0" data-first-offset="true"><span data-slate-string="true">准备工作都做好了，现在就可以开始正式安装 Kubernetes 了，我们先从 Master 节点开始。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7917"><span data-slate-object="text" data-key="7918"><span data-slate-leaf="true" data-offset-key="7918:0" data-first-offset="true"><span data-slate-string="true">kubeadm 的用法非常简单，只需要一个命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7919"><span data-slate-object="text" data-key="7920"><span data-slate-leaf="true" data-offset-key="7920:0" data-first-offset="true"><span data-slate-string="true">kubeadm init</span></span></span></span><span data-slate-object="text" data-key="7921"><span data-slate-leaf="true" data-offset-key="7921:0" data-first-offset="true"><span data-slate-string="true"> 就可以把组件在 Master 节点上运行起来，不过它还有很多参数用来调整集群的配置，你可以用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="7922"><span data-slate-object="text" data-key="7923"><span data-slate-leaf="true" data-offset-key="7923:0" data-first-offset="true"><span data-slate-string="true">-h</span></span></span></span><span data-slate-object="text" data-key="7924"><span data-slate-leaf="true" data-offset-key="7924:0" data-first-offset="true"><span data-slate-string="true"> 查看。这里我只说一下我们实验环境用到的 3 个参数：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="7925"><div data-slate-type="list-line" data-slate-object="block" data-key="7926"><span data-slate-object="text" data-key="7927"><span data-slate-leaf="true" data-offset-key="7927:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">--pod-network-cidr</span></span></span></span><span data-slate-object="text" data-key="7928"><span data-slate-leaf="true" data-offset-key="7928:0" data-first-offset="true"><span data-slate-string="true">，设置集群里 Pod 的 IP 地址段。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="7929"><span data-slate-object="text" data-key="7930"><span data-slate-leaf="true" data-offset-key="7930:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">--apiserver-advertise-address</span></span></span></span><span data-slate-object="text" data-key="7931"><span data-slate-leaf="true" data-offset-key="7931:0" data-first-offset="true"><span data-slate-string="true">，设置 apiserver 的 IP 地址，对于多网卡服务器来说很重要（比如 VirtualBox 虚拟机就用了两块网卡），可以指定 apiserver 在哪个网卡上对外提供服务。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="7932"><span data-slate-object="text" data-key="7933"><span data-slate-leaf="true" data-offset-key="7933:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">--kubernetes-version</span></span></span></span><span data-slate-object="text" data-key="7934"><span data-slate-leaf="true" data-offset-key="7934:0" data-first-offset="true"><span data-slate-string="true">，指定 Kubernetes 的版本号。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7935"><span data-slate-object="text" data-key="7936"><span data-slate-leaf="true" data-offset-key="7936:0" data-first-offset="true"><span data-slate-string="true">下面的这个安装命令里，我指定了 Pod 的地址段是 “10.10.0.0/16”，apiserver 的服务地址是 “192.168.10.210”，Kubernetes 的版本号是 “1.23.3”：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="7937"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7938"><span data-slate-object="text" data-key="7939"><span data-slate-leaf="true" data-offset-key="7939:0" data-first-offset="true"><span data-slate-string="true">sudo kubeadm init \</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7940"><span data-slate-object="text" data-key="7941"><span data-slate-leaf="true" data-offset-key="7941:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="7942"><span data-slate-leaf="true" data-offset-key="7942:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--pod-network-cidr=10.10.0.0/16 \</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7943"><span data-slate-object="text" data-key="7944"><span data-slate-leaf="true" data-offset-key="7944:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="7945"><span data-slate-leaf="true" data-offset-key="7945:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--apiserver-advertise-address=192.168.10.210 \</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7946"><span data-slate-object="text" data-key="7947"><span data-slate-leaf="true" data-offset-key="7947:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="7948"><span data-slate-leaf="true" data-offset-key="7948:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--kubernetes-version=v1.23.3</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7949"><span data-slate-object="text" data-key="7950"><span data-slate-leaf="true" data-offset-key="7950:0" data-first-offset="true"><span data-slate-string="true">因为我们已经提前把镜像下载到了本地，所以 kubeadm 的安装过程很快就完成了，它还会提示出接下来要做的工作：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="7951"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7952"><span data-slate-object="text" data-key="7953"><span data-slate-leaf="true" data-offset-key="7953:0" data-first-offset="true"><span data-slate-string="true">To start using your cluster, you need to run the following as a regular user:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7954"></div><div data-slate-type="code-line" data-slate-object="block" data-key="7955"><span data-slate-object="text" data-key="7956"><span data-slate-leaf="true" data-offset-key="7956:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="7957"><span data-slate-leaf="true" data-offset-key="7957:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">mkdir</span></span></span></span><span data-slate-object="text" data-key="7958"><span data-slate-leaf="true" data-offset-key="7958:0" data-first-offset="true"><span data-slate-string="true"> -p </span></span></span><span data-slate-object="text" data-key="7959"><span data-slate-leaf="true" data-offset-key="7959:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$HOME</span></span></span></span><span data-slate-object="text" data-key="7960"><span data-slate-leaf="true" data-offset-key="7960:0" data-first-offset="true"><span data-slate-string="true">/.kube</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7961"><span data-slate-object="text" data-key="7962"><span data-slate-leaf="true" data-offset-key="7962:0" data-first-offset="true"><span data-slate-string="true">  sudo </span></span></span><span data-slate-object="text" data-key="7963"><span data-slate-leaf="true" data-offset-key="7963:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cp</span></span></span></span><span data-slate-object="text" data-key="7964"><span data-slate-leaf="true" data-offset-key="7964:0" data-first-offset="true"><span data-slate-string="true"> -i /etc/kubernetes/admin.conf </span></span></span><span data-slate-object="text" data-key="7965"><span data-slate-leaf="true" data-offset-key="7965:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$HOME</span></span></span></span><span data-slate-object="text" data-key="7966"><span data-slate-leaf="true" data-offset-key="7966:0" data-first-offset="true"><span data-slate-string="true">/.kube/config</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="7967"><span data-slate-object="text" data-key="7968"><span data-slate-leaf="true" data-offset-key="7968:0" data-first-offset="true"><span data-slate-string="true">  sudo </span></span></span><span data-slate-object="text" data-key="7969"><span data-slate-leaf="true" data-offset-key="7969:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">chown</span></span></span></span><span data-slate-object="text" data-key="7970"><span data-slate-leaf="true" data-offset-key="7970:0" data-first-offset="true"><span data-slate-string="true"> $(</span></span></span><span data-slate-object="text" data-key="7971"><span data-slate-leaf="true" data-offset-key="7971:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">id</span></span></span></span><span data-slate-object="text" data-key="7972"><span data-slate-leaf="true" data-offset-key="7972:0" data-first-offset="true"><span data-slate-string="true"> -u):$(</span></span></span><span data-slate-object="text" data-key="7973"><span data-slate-leaf="true" data-offset-key="7973:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">id</span></span></span></span><span data-slate-object="text" data-key="7974"><span data-slate-leaf="true" data-offset-key="7974:0" data-first-offset="true"><span data-slate-string="true"> -g) </span></span></span><span data-slate-object="text" data-key="7975"><span data-slate-leaf="true" data-offset-key="7975:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$HOME</span></span></span></span><span data-slate-object="text" data-key="7976"><span data-slate-leaf="true" data-offset-key="7976:0" data-first-offset="true"><span data-slate-string="true">/.kube/config</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7977"><span data-slate-object="text" data-key="7978"><span data-slate-leaf="true" data-offset-key="7978:0" data-first-offset="true"><span data-slate-string="true">意思是要在本地建立一个 “</span></span></span><span data-slate-object="text" data-key="7979"><span data-slate-leaf="true" data-offset-key="7979:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">.kube</span></span></span></span><span data-slate-object="text" data-key="7980"><span data-slate-leaf="true" data-offset-key="7980:0" data-first-offset="true"><span data-slate-string="true">” 目录，然后拷贝 kubectl 的配置文件，你只要原样拷贝粘贴就行。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="7981"><span data-slate-object="text" data-key="7982"><span data-slate-leaf="true" data-offset-key="7982:0" data-first-offset="true"><span data-slate-string="true">另外还有一个很重要的 “</span></span></span><span data-slate-object="text" data-key="7983"><span data-slate-leaf="true" data-offset-key="7983:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">kubeadm join</span></span></span></span><span data-slate-object="text" data-key="7984"><span data-slate-leaf="true" data-offset-key="7984:0" data-first-offset="true"><span data-slate-string="true">” 提示，其他节点要加入集群必须要用指令里的 token 和 ca 证书，所以这条命令务必拷贝后保存好：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="7985"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="7986"><span data-slate-object="text" data-key="7987"><span data-slate-leaf="true" data-offset-key="7987:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">Then</span></span></span></span><span data-slate-object="text" data-key="7988"><span data-slate-leaf="true" data-offset-key="7988:0" data-first-offset="true"><span data-slate-string="true"> you can </span></span></span><span data-slate-object="text" data-key="7989"><span data-slate-leaf="true" data-offset-key="7989:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">join</span></span></span></span><span data-slate-object="text" data-key="7990"><span data-slate-leaf="true" data-offset-key="7990:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="7991"><span data-slate-leaf="true" data-offset-key="7991:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">any</span></span></span></span><span data-slate-object="text" data-key="7992"><span data-slate-leaf="true" data-offset-key="7992:0" data-first-offset="true"><span data-slate-string="true"> number </span></span></span><span data-slate-object="text" data-key="7993"><span data-slate-leaf="true" data-offset-key="7993:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">of</span></span></span></span><span data-slate-object="text" data-key="7994"><span data-slate-leaf="true" data-offset-key="7994:0" data-first-offset="true"><span data-slate-string="true"> worker nodes </span></span></span><span data-slate-object="text" data-key="7995"><span data-slate-leaf="true" data-offset-key="7995:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">by</span></span></span></span><span data-slate-object="text" data-key="7996"><span data-slate-leaf="true" data-offset-key="7996:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="7997"><span data-slate-leaf="true" data-offset-key="7997:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">running</span></span></span></span><span data-slate-object="text" data-key="7998"><span data-slate-leaf="true" data-offset-key="7998:0" data-first-offset="true"><span data-slate-string="true"> the following </span></span></span><span data-slate-object="text" data-key="7999"><span data-slate-leaf="true" data-offset-key="7999:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">on</span></span></span></span><span data-slate-object="text" data-key="8000"><span data-slate-leaf="true" data-offset-key="8000:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8001"><span data-slate-leaf="true" data-offset-key="8001:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">each</span></span></span></span><span data-slate-object="text" data-key="8002"><span data-slate-leaf="true" data-offset-key="8002:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8003"><span data-slate-leaf="true" data-offset-key="8003:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">as</span></span></span></span><span data-slate-object="text" data-key="8004"><span data-slate-leaf="true" data-offset-key="8004:0" data-first-offset="true"><span data-slate-string="true"> root:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8005"></div><div data-slate-type="code-line" data-slate-object="block" data-key="8006"><span data-slate-object="text" data-key="8007"><span data-slate-leaf="true" data-offset-key="8007:0" data-first-offset="true"><span data-slate-string="true">kubeadm </span></span></span><span data-slate-object="text" data-key="8008"><span data-slate-leaf="true" data-offset-key="8008:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">join</span></span></span></span><span data-slate-object="text" data-key="8009"><span data-slate-leaf="true" data-offset-key="8009:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8010"><span data-slate-leaf="true" data-offset-key="8010:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">192.168</span></span></span></span><span data-slate-object="text" data-key="8011"><span data-slate-leaf="true" data-offset-key="8011:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.10</span></span></span></span><span data-slate-object="text" data-key="8012"><span data-slate-leaf="true" data-offset-key="8012:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.210</span></span></span></span><span data-slate-object="text" data-key="8013"><span data-slate-leaf="true" data-offset-key="8013:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="8014"><span data-slate-leaf="true" data-offset-key="8014:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">6443</span></span></span></span><span data-slate-object="text" data-key="8015"><span data-slate-leaf="true" data-offset-key="8015:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8016"><span data-slate-leaf="true" data-offset-key="8016:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--token tv9mkx.tw7it9vphe158e74 \</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8017"><span data-slate-object="text" data-key="8018"><span data-slate-leaf="true" data-offset-key="8018:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="8019"><span data-slate-leaf="true" data-offset-key="8019:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8020"><span data-slate-object="text" data-key="8021"><span data-slate-leaf="true" data-offset-key="8021:0" data-first-offset="true"><span data-slate-string="true">安装完成后，你就可以使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8022"><span data-slate-object="text" data-key="8023"><span data-slate-leaf="true" data-offset-key="8023:0" data-first-offset="true"><span data-slate-string="true">kubectl version</span></span></span></span><span data-slate-object="text" data-key="8024"><span data-slate-leaf="true" data-offset-key="8024:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8025"><span data-slate-object="text" data-key="8026"><span data-slate-leaf="true" data-offset-key="8026:0" data-first-offset="true"><span data-slate-string="true">kubectl get node</span></span></span></span><span data-slate-object="text" data-key="8027"><span data-slate-leaf="true" data-offset-key="8027:0" data-first-offset="true"><span data-slate-string="true"> 来检查 Kubernetes 的版本和集群的节点状态了：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="8028"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8029"><span data-slate-object="text" data-key="8030"><span data-slate-leaf="true" data-offset-key="8030:0" data-first-offset="true"><span data-slate-string="true">kubectl version</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8031"><span data-slate-object="text" data-key="8032"><span data-slate-leaf="true" data-offset-key="8032:0" data-first-offset="true"><span data-slate-string="true">kubectl </span></span></span><span data-slate-object="text" data-key="8033"><span data-slate-leaf="true" data-offset-key="8033:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">get</span></span></span></span><span data-slate-object="text" data-key="8034"><span data-slate-leaf="true" data-offset-key="8034:0" data-first-offset="true"><span data-slate-string="true"> node</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="image" data-slate-object="block" data-key="8035"><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/resource/image/c6/09/c63ce96bfyy0e1bc2927d575a66ee209.png?wh=1482x366"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8036"><span data-slate-object="text" data-key="8037"><span data-slate-leaf="true" data-offset-key="8037:0" data-first-offset="true"><span data-slate-string="true">你会注意到 Master 节点的状态是 “NotReady”，这是由于还缺少网络插件，集群的内部网络还没有正常运作。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="8038" id="sr-toc-7"><span data-slate-object="text" data-key="8039"><span data-slate-leaf="true" data-offset-key="8039:0" data-first-offset="true"><span data-slate-string="true">安装 Flannel 网络插件</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="8040"><span data-slate-object="text" data-key="8041"><span data-slate-leaf="true" data-offset-key="8041:0" data-first-offset="true"><span data-slate-string="true">Kubernetes 定义了 CNI 标准，有很多网络插件，这里我选择最常用的 </span></span></span><span data-slate-object="text" data-key="8042"><span data-slate-leaf="true" data-offset-key="8042:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Flannel</span></span></span></span><span data-slate-object="text" data-key="8043"><span data-slate-leaf="true" data-offset-key="8043:0" data-first-offset="true"><span data-slate-string="true">，可以在它的 GitHub 仓库里（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="8044"><span data-slate-object="text" data-key="8045"><span data-slate-leaf="true" data-offset-key="8045:0" data-first-offset="true"><span data-slate-string="true">https://github.com/flannel-io/flannel/</span></span></span></a><span data-slate-object="text" data-key="8046"><span data-slate-leaf="true" data-offset-key="8046:0" data-first-offset="true"><span data-slate-string="true">）找到相关文档。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8047"><span data-slate-object="text" data-key="8048"><span data-slate-leaf="true" data-offset-key="8048:0" data-first-offset="true"><span data-slate-string="true">它安装也很简单，只需要使用项目的 “</span></span></span><span data-slate-object="text" data-key="8049"><span data-slate-leaf="true" data-offset-key="8049:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">kube-flannel.yml</span></span></span></span><span data-slate-object="text" data-key="8050"><span data-slate-leaf="true" data-offset-key="8050:0" data-first-offset="true"><span data-slate-string="true">” 在 Kubernetes 里部署一下就好了。不过因为它应用了 Kubernetes 的网段地址，你需要修改文件里的 “</span></span></span><span data-slate-object="text" data-key="8051"><span data-slate-leaf="true" data-offset-key="8051:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">net-conf.json</span></span></span></span><span data-slate-object="text" data-key="8052"><span data-slate-leaf="true" data-offset-key="8052:0" data-first-offset="true"><span data-slate-string="true">” 字段，把 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8053"><span data-slate-object="text" data-key="8054"><span data-slate-leaf="true" data-offset-key="8054:0" data-first-offset="true"><span data-slate-string="true">Network</span></span></span></span><span data-slate-object="text" data-key="8055"><span data-slate-leaf="true" data-offset-key="8055:0" data-first-offset="true"><span data-slate-string="true"> 改成刚才 kubeadm 的参数 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8056"><span data-slate-object="text" data-key="8057"><span data-slate-leaf="true" data-offset-key="8057:0" data-first-offset="true"><span data-slate-string="true">--pod-network-cidr</span></span></span></span><span data-slate-object="text" data-key="8058"><span data-slate-leaf="true" data-offset-key="8058:0" data-first-offset="true"><span data-slate-string="true"> 设置的地址段。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8059"><span data-slate-object="text" data-key="8060"><span data-slate-leaf="true" data-offset-key="8060:0" data-first-offset="true"><span data-slate-string="true">比如在这里，就要修改成 “10.10.0.0/16”：</span></span></span></div><div data-code-language="css" data-slate-type="pre" data-slate-object="block" data-key="8061"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8062"><span data-slate-object="text" data-key="8063"><span data-slate-leaf="true" data-offset-key="8063:0" data-first-offset="true"><span data-slate-string="true">  net-conf</span></span></span><span data-slate-object="text" data-key="8064"><span data-slate-leaf="true" data-offset-key="8064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.json</span></span></span></span><span data-slate-object="text" data-key="8065"><span data-slate-leaf="true" data-offset-key="8065:0" data-first-offset="true"><span data-slate-string="true">: |</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8066"><span data-slate-object="text" data-key="8067"><span data-slate-leaf="true" data-offset-key="8067:0" data-first-offset="true"><span data-slate-string="true">    {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8068"><span data-slate-object="text" data-key="8069"><span data-slate-leaf="true" data-offset-key="8069:0" data-first-offset="true"><span data-slate-string="true">      "Network": </span></span></span><span data-slate-object="text" data-key="8070"><span data-slate-leaf="true" data-offset-key="8070:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"10.10.0.0/16"</span></span></span></span><span data-slate-object="text" data-key="8071"><span data-slate-leaf="true" data-offset-key="8071:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8072"><span data-slate-object="text" data-key="8073"><span data-slate-leaf="true" data-offset-key="8073:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="8074"><span data-slate-leaf="true" data-offset-key="8074:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Backend"</span></span></span></span><span data-slate-object="text" data-key="8075"><span data-slate-leaf="true" data-offset-key="8075:0" data-first-offset="true"><span data-slate-string="true">: {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8076"><span data-slate-object="text" data-key="8077"><span data-slate-leaf="true" data-offset-key="8077:0" data-first-offset="true"><span data-slate-string="true">        "Type": </span></span></span><span data-slate-object="text" data-key="8078"><span data-slate-leaf="true" data-offset-key="8078:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"vxlan"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8079"><span data-slate-object="text" data-key="8080"><span data-slate-leaf="true" data-offset-key="8080:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8081"><span data-slate-object="text" data-key="8082"><span data-slate-leaf="true" data-offset-key="8082:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8083"><span data-slate-object="text" data-key="8084"><span data-slate-leaf="true" data-offset-key="8084:0" data-first-offset="true"><span data-slate-string="true">改好后，你就可以用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8085"><span data-slate-object="text" data-key="8086"><span data-slate-leaf="true" data-offset-key="8086:0" data-first-offset="true"><span data-slate-string="true">kubectl apply</span></span></span></span><span data-slate-object="text" data-key="8087"><span data-slate-leaf="true" data-offset-key="8087:0" data-first-offset="true"><span data-slate-string="true"> 来安装 Flannel 网络了：</span></span></span></div><div data-slate-type="pre" data-slate-object="block" data-key="8088"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8089"><span data-slate-object="text" data-key="8090"><span data-slate-leaf="true" data-offset-key="8090:0" data-first-offset="true"><span data-slate-string="true">kubectl apply -f kube-flannel.yml</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8091"><span data-slate-object="text" data-key="8092"><span data-slate-leaf="true" data-offset-key="8092:0" data-first-offset="true"><span data-slate-string="true">稍等一小会，等镜像拉取下来并运行之后，你就可以执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8093"><span data-slate-object="text" data-key="8094"><span data-slate-leaf="true" data-offset-key="8094:0" data-first-offset="true"><span data-slate-string="true">kubectl get node</span></span></span></span><span data-slate-object="text" data-key="8095"><span data-slate-leaf="true" data-offset-key="8095:0" data-first-offset="true"><span data-slate-string="true"> 来看节点状态：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="8096"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8097"><span data-slate-object="text" data-key="8098"><span data-slate-leaf="true" data-offset-key="8098:0" data-first-offset="true"><span data-slate-string="true">kubectl </span></span></span><span data-slate-object="text" data-key="8099"><span data-slate-leaf="true" data-offset-key="8099:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">get</span></span></span></span><span data-slate-object="text" data-key="8100"><span data-slate-leaf="true" data-offset-key="8100:0" data-first-offset="true"><span data-slate-string="true"> node</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="image" data-slate-object="block" data-key="8101"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/6a/7a/6a3c852abe5b193a6997b154163ed67a.png?wh=1434x184"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8102"><span data-slate-object="text" data-key="8103"><span data-slate-leaf="true" data-offset-key="8103:0" data-first-offset="true"><span data-slate-string="true">这时你应该能够看到 Master 节点的状态是 “Ready”，表明节点网络也工作正常了。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="8104" id="sr-toc-8"><span data-slate-object="text" data-key="8105"><span data-slate-leaf="true" data-offset-key="8105:0" data-first-offset="true"><span data-slate-string="true">安装 Worker 节点</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="8106"><span data-slate-object="text" data-key="8107"><span data-slate-leaf="true" data-offset-key="8107:0" data-first-offset="true"><span data-slate-string="true">如果你成功安装了 Master 节点，那么 Worker 节点的安装就简单多了，只需要用之前拷贝的那条 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8108"><span data-slate-object="text" data-key="8109"><span data-slate-leaf="true" data-offset-key="8109:0" data-first-offset="true"><span data-slate-string="true">kubeadm join</span></span></span></span><span data-slate-object="text" data-key="8110"><span data-slate-leaf="true" data-offset-key="8110:0" data-first-offset="true"><span data-slate-string="true"> 命令就可以了，记得要用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8111"><span data-slate-object="text" data-key="8112"><span data-slate-leaf="true" data-offset-key="8112:0" data-first-offset="true"><span data-slate-string="true">sudo</span></span></span></span><span data-slate-object="text" data-key="8113"><span data-slate-leaf="true" data-offset-key="8113:0" data-first-offset="true"><span data-slate-string="true"> 来执行：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="8114"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8115"><span data-slate-object="text" data-key="8116"><span data-slate-leaf="true" data-offset-key="8116:0" data-first-offset="true"><span data-slate-string="true">sudo \</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8117"><span data-slate-object="text" data-key="8118"><span data-slate-leaf="true" data-offset-key="8118:0" data-first-offset="true"><span data-slate-string="true">kubeadm </span></span></span><span data-slate-object="text" data-key="8119"><span data-slate-leaf="true" data-offset-key="8119:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">join</span></span></span></span><span data-slate-object="text" data-key="8120"><span data-slate-leaf="true" data-offset-key="8120:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8121"><span data-slate-leaf="true" data-offset-key="8121:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">192.168</span></span></span></span><span data-slate-object="text" data-key="8122"><span data-slate-leaf="true" data-offset-key="8122:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.10</span></span></span></span><span data-slate-object="text" data-key="8123"><span data-slate-leaf="true" data-offset-key="8123:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.210</span></span></span></span><span data-slate-object="text" data-key="8124"><span data-slate-leaf="true" data-offset-key="8124:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="8125"><span data-slate-leaf="true" data-offset-key="8125:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">6443</span></span></span></span><span data-slate-object="text" data-key="8126"><span data-slate-leaf="true" data-offset-key="8126:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="8127"><span data-slate-leaf="true" data-offset-key="8127:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--token tv9mkx.tw7it9vphe158e74 \</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8128"><span data-slate-object="text" data-key="8129"><span data-slate-leaf="true" data-offset-key="8129:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="8130"><span data-slate-leaf="true" data-offset-key="8130:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8131"><span data-slate-object="text" data-key="8132"><span data-slate-leaf="true" data-offset-key="8132:0" data-first-offset="true"><span data-slate-string="true">它会连接 Master 节点，然后拉取镜像，安装网络插件，最后把节点加入集群。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8133"><span data-slate-object="text" data-key="8134"><span data-slate-leaf="true" data-offset-key="8134:0" data-first-offset="true"><span data-slate-string="true">当然，这个过程中同样也会遇到拉取镜像的问题，你可以如法炮制，提前把镜像下载到 Worker 节点本地，这样安装过程中就不会再有障碍了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8135"><span data-slate-object="text" data-key="8136"><span data-slate-leaf="true" data-offset-key="8136:0" data-first-offset="true"><span data-slate-string="true">Worker 节点安装完毕后，执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8137"><span data-slate-object="text" data-key="8138"><span data-slate-leaf="true" data-offset-key="8138:0" data-first-offset="true"><span data-slate-string="true">kubectl get node</span></span></span></span><span data-slate-object="text" data-key="8139"><span data-slate-leaf="true" data-offset-key="8139:0" data-first-offset="true"><span data-slate-string="true"> ，就会看到两个节点都是 “Ready” 状态：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="8140"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/f7/26/f756ece9e81af80a7204243f15777026.png?wh=1430x246"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8141"><span data-slate-object="text" data-key="8142"><span data-slate-leaf="true" data-offset-key="8142:0" data-first-offset="true"><span data-slate-string="true">现在让我们用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8143"><span data-slate-object="text" data-key="8144"><span data-slate-leaf="true" data-offset-key="8144:0" data-first-offset="true"><span data-slate-string="true">kubectl run</span></span></span></span><span data-slate-object="text" data-key="8145"><span data-slate-leaf="true" data-offset-key="8145:0" data-first-offset="true"><span data-slate-string="true"> ，运行 Nginx 来测试一下：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="8146"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8147"><span data-slate-object="text" data-key="8148"><span data-slate-leaf="true" data-offset-key="8148:0" data-first-offset="true"><span data-slate-string="true">kubectl run ngx </span></span></span><span data-slate-object="text" data-key="8149"><span data-slate-leaf="true" data-offset-key="8149:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--image=nginx:alpine</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8150"><span data-slate-object="text" data-key="8151"><span data-slate-leaf="true" data-offset-key="8151:0" data-first-offset="true"><span data-slate-string="true">kubectl </span></span></span><span data-slate-object="text" data-key="8152"><span data-slate-leaf="true" data-offset-key="8152:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">get</span></span></span></span><span data-slate-object="text" data-key="8153"><span data-slate-leaf="true" data-offset-key="8153:0" data-first-offset="true"><span data-slate-string="true"> pod </span></span></span><span data-slate-object="text" data-key="8154"><span data-slate-leaf="true" data-offset-key="8154:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-</span></span></span></span><span data-slate-object="text" data-key="8155"><span data-slate-leaf="true" data-offset-key="8155:0" data-first-offset="true"><span data-slate-string="true">o wide</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="image" data-slate-object="block" data-key="8156"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/73/e9/73651e5f178e2daf6eaf7ac262e230e9.png?wh=1584x188"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8157"><span data-slate-object="text" data-key="8158"><span data-slate-leaf="true" data-offset-key="8158:0" data-first-offset="true"><span data-slate-string="true">会看到 Pod 运行在 Worker 节点上，IP 地址是 “10.10.1.2”，表明我们的 Kubernetes 集群部署成功。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="8159" id="sr-toc-9"><span data-slate-object="text" data-key="8160"><span data-slate-leaf="true" data-offset-key="8160:0" data-first-offset="true"><span data-slate-string="true">小结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="8161"><span data-slate-object="text" data-key="8162"><span data-slate-leaf="true" data-offset-key="8162:0" data-first-offset="true"><span data-slate-string="true">好了，把 Master 节点和 Worker 节点都安装好，我们今天的任务就算是基本完成了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8163"><span data-slate-object="text" data-key="8164"><span data-slate-leaf="true" data-offset-key="8164:0" data-first-offset="true"><span data-slate-string="true">后面 Console 节点的部署工作更加简单，它只需要安装一个 kubectl，然后复制 “config” 文件就行，你可以直接在 Master 节点上用 “scp” 远程拷贝，例如：</span></span></span></div><div data-code-language="javascript" data-slate-type="pre" data-slate-object="block" data-key="8165"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="8166"><span data-slate-object="text" data-key="8167"><span data-slate-leaf="true" data-offset-key="8167:0" data-first-offset="true"><span data-slate-string="true">scp </span></span></span><span data-slate-object="text" data-key="8168"><span data-slate-leaf="true" data-offset-key="8168:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`which kubectl`</span></span></span></span><span data-slate-object="text" data-key="8169"><span data-slate-leaf="true" data-offset-key="8169:0" data-first-offset="true"><span data-slate-string="true"> chrono@</span></span></span><span data-slate-object="text" data-key="8170"><span data-slate-leaf="true" data-offset-key="8170:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">192.168</span></span></span></span><span data-slate-object="text" data-key="8171"><span data-slate-leaf="true" data-offset-key="8171:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.10</span></span></span></span><span data-slate-object="text" data-key="8172"><span data-slate-leaf="true" data-offset-key="8172:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.208</span></span></span></span><span data-slate-object="text" data-key="8173"><span data-slate-leaf="true" data-offset-key="8173:0" data-first-offset="true"><span data-slate-string="true">:~/</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="8174"><span data-slate-object="text" data-key="8175"><span data-slate-leaf="true" data-offset-key="8175:0" data-first-offset="true"><span data-slate-string="true">scp ~</span></span></span><span data-slate-object="text" data-key="8176"><span data-slate-leaf="true" data-offset-key="8176:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">/.kube/</span></span></span></span><span data-slate-object="text" data-key="8177"><span data-slate-leaf="true" data-offset-key="8177:0" data-first-offset="true"><span data-slate-string="true">config chrono@</span></span></span><span data-slate-object="text" data-key="8178"><span data-slate-leaf="true" data-offset-key="8178:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">192.168</span></span></span></span><span data-slate-object="text" data-key="8179"><span data-slate-leaf="true" data-offset-key="8179:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.10</span></span></span></span><span data-slate-object="text" data-key="8180"><span data-slate-leaf="true" data-offset-key="8180:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.208</span></span></span></span><span data-slate-object="text" data-key="8181"><span data-slate-leaf="true" data-offset-key="8181:0" data-first-offset="true"><span data-slate-string="true">:~/.</span></span></span><span data-slate-object="text" data-key="8182"><span data-slate-leaf="true" data-offset-key="8182:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">kube</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8183"><span data-slate-object="text" data-key="8184"><span data-slate-leaf="true" data-offset-key="8184:0" data-first-offset="true"><span data-slate-string="true">今天的过程多一些，要点我列在了下面：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="8185"><div data-slate-type="list-line" data-slate-object="block" data-key="8186"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="8187"><span data-slate-leaf="true" data-offset-key="8187:0" data-first-offset="true"><span data-slate-string="true">kubeadm 是一个方便易用的 Kubernetes 工具，能够部署生产级别的 Kubernetes 集群。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="8188"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="8189"><span data-slate-leaf="true" data-offset-key="8189:0" data-first-offset="true"><span data-slate-string="true">安装 Kubernetes 之前需要修改主机的配置，包括主机名、Docker 配置、网络设置、交换分区等。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="8190"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="8191"><span data-slate-leaf="true" data-offset-key="8191:0" data-first-offset="true"><span data-slate-string="true">Kubernetes 的组件镜像存放在 gcr.io，国内下载比较麻烦，可以考虑从 minikube 或者国内镜像网站获取。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="8192"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="8193"><span data-slate-leaf="true" data-offset-key="8193:0" data-first-offset="true"><span data-slate-string="true">安装 Master 节点需要使用命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8194"><span data-slate-object="text" data-key="8195"><span data-slate-leaf="true" data-offset-key="8195:0" data-first-offset="true"><span data-slate-string="true">kubeadm init</span></span></span></span><span data-slate-object="text" data-key="8196"><span data-slate-leaf="true" data-offset-key="8196:0" data-first-offset="true"><span data-slate-string="true">，安装 Worker 节点需要使用命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="8197"><span data-slate-object="text" data-key="8198"><span data-slate-leaf="true" data-offset-key="8198:0" data-first-offset="true"><span data-slate-string="true">kubeadm join</span></span></span></span><span data-slate-object="text" data-key="8199"><span data-slate-leaf="true" data-offset-key="8199:0" data-first-offset="true"><span data-slate-string="true">，还要部署 Flannel 等网络插件才能让集群正常工作。</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8200"><span data-slate-object="text" data-key="8201"><span data-slate-leaf="true" data-offset-key="8201:0" data-first-offset="true"><span data-slate-string="true">因为这些操作都是各种 Linux 命令，全手动敲下来确实很繁琐，所以我把这些步骤都做成了 Shell 脚本放在了 GitHub 上（</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="8202"><span data-slate-object="text" data-key="8203"><span data-slate-leaf="true" data-offset-key="8203:0" data-first-offset="true"><span data-slate-string="true">https://github.com/chronolaw/k8s_study/tree/master/admin</span></span></span></a><span data-slate-object="text" data-key="8204"><span data-slate-leaf="true" data-offset-key="8204:0" data-first-offset="true"><span data-slate-string="true">），你可以下载后直接运行。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="8205" id="sr-toc-10"><span data-slate-object="text" data-key="8206"><span data-slate-leaf="true" data-offset-key="8206:0" data-first-offset="true"><span data-slate-string="true">课下作业</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="8207"><span data-slate-object="text" data-key="8208"><span data-slate-leaf="true" data-offset-key="8208:0" data-first-offset="true"><span data-slate-string="true">最后的课下作业是实际动手操作，请你多花费一些时间，用虚拟机创建出集群节点，再用 kubeadm 部署出这个多节点的 Kubernetes 环境，在接下来的 “中级篇” 和 “高级篇” 里我们就会在这个 Kubernetes 集群里做实验。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="8209"><span data-slate-object="text" data-key="8210"><span data-slate-leaf="true" data-offset-key="8210:0" data-first-offset="true"><span data-slate-string="true">安装部署过程中有任何疑问，欢迎在留言区留言，我会第一时间回复你。如果觉得有帮助，也欢迎分享给自己身边的朋友一起学习，下节课见。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="8211"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/d3/41/d3d76937e5f4eb6545a07b96bc731e41.jpg?wh=1920x2513"></div></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/94/c1/9415076c60e63fc6303d9a3bc900b5c1.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-11">精选留言 (48)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>怀朔</span></div></div><div>本章质量略显不足。主要如下几点
1、已经在考虑多节点不如把多集群考虑进去 这样才是真正的线上环境？
2、因为网络问题 考虑仓库不足 如何直接引用国内云厂商镜像仓库？ 讲解如何把海外镜像复制国内镜像岂不是更好？
3、生产中明显最关键是网络插件问题 和 cidr 块 网络冲突问题 通篇没有讲 令人略显单薄</div><div><p>作者回复: 
1. 一步步来，不要着急。

2. 国内的我很少用，大家也都懂。

3. 什么都讲就会显得内容太多太杂，毕竟专栏的目标是入门，不是上生产系统。

4. 感谢建议，会和编辑考虑再改进。</p></div><div><div>2022-07-29</div><div><div><i></i><span>2</span></div><div><i></i><span>8</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 朱雯</span></div></div><div>终于跑起来了，提醒大家一件事，那就是新节点如何加入到 k8s 集群中，第一遍执行有提示，后续的话，可以执行 kubeadm token create --print-join-command 这条命令显示加入方式</div><div><p>作者回复: great</p></div><div><div>2022-08-02</div><div><div><i></i></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/2c/82/ec/99b480e8.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>hiDaLao</span></div></div><div>1. 装环境时可先装一台然后克隆；
2. kubeadm init 时指定的 apiserver 的 ip 需要是自己环境上 master 节点的 ip 地址，如果指定错误，可通过 sudo kubeadm reset 重置；
3. kube-flannel.yml 文件在仓库的 Documentation 目录下，只用 copy 到环境上修改下 net-config.json 里面的 Network 的地址即可；
4. 执行 scp ~/.kube/config 到 console 节点时，需要先在 console 节点上通过 mkdir ~/.kube 创建下目录</div><div><p>作者回复: great </p></div><div><div>2022-07-31</div><div><div><i></i></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 努力学习不准懈怠</span></div></div><div>一定要关闭 swap，不然 kubelet 无法启动！！！</div><div><p>作者回复: good</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/7a/27/77ca2bc2.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 小林子</span></div></div><div>老师为啥不用 Calico 网络插件了</div><div><p>作者回复：后面高级篇会用，flannel 简单，而且现在不是我们学习的重点。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/13/99/f0/d9343049.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 星亦辰</span></div></div><div>cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes] 
name=Kubernetes 
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64 
enabled=1 
gpgcheck=0 
repo_gpgcheck=0 
EOF

补充一个 Yum 的源 
</div><div><p>作者回复: great</p></div><div><div>2022-08-01</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/b3/d9/cf061262.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 新时代农民工</span></div></div><div>老师请问下，成功按文中操作搭建集群，在测试运行 Nginx 的时候，通过 expose 端口在 NodePort， 为何只能在 worker 的 node 上访问， 而在 master 节点上，通过本地 ip 访问不了呢</div><div><p>作者回复：应该是 master 节点不参与业务吧，可以试着把污点去掉。</p></div><div><div>2022-08-01</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>peter</span></div></div><div>请教老师几个问题：
Q1：脚本为什么对 src_name 两次赋值？
       脚本的 for 循环里面有如下两行：
       src_name=${name#k8s.gcr.io/}    
       src_name=${src_name#coredns/}
       为什么对同一个 src_name 两次赋值？

Q2：同一个虚拟机上是否可以同时按照 minikube 和 kubeadm？
Q3：apiserver 的 IP 应该是自己的虚拟机的 IP，Pod 地址段和虚拟机 IP 无关，采用私有地址段即可，
        是这样吗？
        文中提到：“apiserver 的服务地址是 “192.168.10.210””，这个地址是作者自己虚拟机的 IP，
        读者应该换成自己虚拟机的 IP，是这样吗？
        文中提到：“我指定了 Pod 的地址段是 “10.10.0.0/16””，Pod 的 IP 段和虚拟机无关，读者的环境
        也可以采用，对吗？</div><div><p>作者回复: 
1. 这个属于 shell 编程了，因为 coredns 镜像的名字比较特别，做了特殊处理。

2. 当然可以，但 kubectl 的 config 文件就得做个切换了。

3. 是的，第一个 IP 地址是节点的地址，必须是你自己的，第二个是集群里的 IP 地址，可以用这个 10.10.0.0。</p></div><div><div>2022-07-31</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/f8/25/06c86919.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>rexzhao</span></div></div><div>kube-flannel.yml 文件是在哪个位置？是从哪来的？ 修改的内容对吗好像不是 yml 文件格式。</div><div><p>作者回复：可以在专栏的 GitHub 仓库里找到，或者直接去 flannel 项目上获取。

注意看 YAML，它用的是 “:|” ，表示的是一个长字符串，内容是 json 格式。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Frank</span></div></div><div>为什么到目前为止，各大云计算公司大厂都没有做一个 gcr.io  k8s 的同步镜像站呢</div><div><p>作者回复：应该有的，不过我了解的不多。</p></div><div><div>2022-07-29</div><div><div><i></i><span>4</span></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1a/d0/51/f1c9ae2d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Christopher</span></div></div><div>还是挺翔实的搭建教程！</div><div><p>作者回复：全程实录，笑。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 威</span></div></div><div>按照教程安装完后，节点能正常链接起来，但内部 dns 解析不了，基本检查了一下，k8s 的 dns pod 是正常 running</div><div><p>作者回复: running 不代表就正常，看看 log，可以重启 pod 试试。</p></div><div><div>2022-08-08</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Geek_8497e1</span></div></div><div>你好，有 kubeadm，高可用 k8s 的搭建文档嘛</div><div><p>作者回复：这个可以上 Kubernetes 官网上找。</p></div><div><div>2022-08-02</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132"></div></div><div><div><div><span>pyhhou</span></div></div><div>老师，在配置 Master 节点的时候有问题，报错如下

ppeng@master:~$ sudo kubeadm init \
    --pod-network-cidr=10.10.0.0/16 \
    --apiserver-advertise-address=192.168.10.210 \
    --kubernetes-version=v1.23.3
[sudo] password for ppeng:
[init] Using Kubernetes version: v1.23.3
[preflight] Running pre-flight checks
error execution phase preflight: [preflight] Some fatal errors occurred:
	[ERROR Port-10259]: Port 10259 is in use
	[ERROR Port-10257]: Port 10257 is in use
	[ERROR FileAvailable--etc-kubernetes-manifests-kube-apiserver.yaml]: /etc/kubernetes/manifests/kube-apiserver.yaml already exists
	[ERROR FileAvailable--etc-kubernetes-manifests-kube-controller-manager.yaml]: /etc/kubernetes/manifests/kube-controller-manager.yaml already exists
	[ERROR FileAvailable--etc-kubernetes-manifests-kube-scheduler.yaml]: /etc/kubernetes/manifests/kube-scheduler.yaml already exists
	[ERROR FileAvailable--etc-kubernetes-manifests-etcd.yaml]: /etc/kubernetes/manifests/etcd.yaml already exists
	[ERROR Port-10250]: Port 10250 is in use
[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`
To see the stack trace of this error execute with --v=5 or higher

前面的步骤都已成功，docker 也成功拉取了镜像，不清楚这里报错的原因是什么</div><div><p>作者回复：建议用 kubeadm reset，弄个干净的环境再试试。</p></div><div><div>2022-08-02</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqF6ViaDyAibEKbcKfWoGXe8lCbb8wqes5g3JezHWNLf4DIl92QwXX43HWv408BxzkOKmKb2HpKJuIw/132"></div></div><div><div><div><span>Geek_b537b2</span></div></div><div>入门好教程</div><div><p>作者回复: thanks</p></div><div><div>2022-07-30</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/17/e9/26/afc08398.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Amos ヾ</span></div></div><div>后面会有 k8s 多 master 安装教程吗？官方文档貌似需要一个外部 lb 吧？是否可以本地模拟呢？</div><div><p>作者回复：这个我觉得意义可能不是太大，掌握了 kubeadm 的用法，再看一下官方文档就可以会多节点了，再写出来感觉有点多余。</p></div><div><div>2022-07-30</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 西门吹牛</span></div></div><div>云原生，开发人员只关心业务代码，所有部署，微服务治理相关的，运维相关都依托云基础设施，把原先微服务架构中，除业务代码之外的服务治理比如服务发现，负载均衡，熔断限流等从软件应用层面转移到云基础设施比如 k8s 上，虽然 k8s 底层容器技术依赖硬件基础设施，但容器之间的服务治理基础设施不能完全处理，k8s 中各种编排对象也属于软件，只是让对开发人员透明化了，让程序员回归到以业务为主，只关心业务的本质上</div><div><p>作者回复: good，云原生的意思还可以再参考一下 09 讲我的个人理解。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/17/36/1d/874dc1e3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 你的笑忘书</span></div></div><div>希望老师补充下生产中，使用 kubeadm 部署集群的话，有哪些务必需要注意的点。</div><div><p>作者回复：我是开发背景，对系统管理不是太了解，但显然生产中使用 kubeadm 要比我们课程里要考虑更多的东西，比如证书安全、高可用等等，建议去咨询更专业的同事。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1d/b9/8b/d0763d9a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 进击的土豆</span></div></div><div>老师，kubeadm 和 rke 的区别是什么</div><div><p>作者回复: kubeadm 是 Kubernetes 的安装部署工具，RKE 是 rancher 公司的 Kubernetes 发行版，类似 GKE，可以搜一下。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Geek_8497e1</span></div></div><div>请问，生产环境，老师建议用二进制还是 kubeadmin</div><div><p>作者回复：我没有太多发言权，可能还是得具体运维部门拍板才行。</p></div><div><div>2022-07-29</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1m"><outline class="toc-level-h1" data-reactid=".1m.0" style="width: 175px;"><active data-reactid=".1m.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1m.0.1"><span data-reactid=".1m.0.1.0"> 17｜更真实的云原生：实际搭建多节点的 Kubernetes 集群</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.1" style="width: 165px;"><active data-reactid=".1m.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1m.1.1"><span data-reactid=".1m.1.1.0">什么是 kubeadm</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.2" style="width: 165px;"><active data-reactid=".1m.2.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1m.2.1"><span data-reactid=".1m.2.1.0">实验环境的架构是什么样的</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.3" style="width: 165px;"><active data-reactid=".1m.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1m.3.1"><span data-reactid=".1m.3.1.0">安装前的准备工作</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.4" style="width: 165px;"><active data-reactid=".1m.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".1m.4.1"><span data-reactid=".1m.4.1.0">安装 kubeadm</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.5" style="width: 165px;"><active data-reactid=".1m.5.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1m.5.1"><span data-reactid=".1m.5.1.0">下载 Kubernetes 组件镜像</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.6" style="width: 165px;"><active data-reactid=".1m.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1m.6.1"><span data-reactid=".1m.6.1.0">安装 Master 节点</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.7" style="width: 165px;"><active data-reactid=".1m.7.0"></active><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1m.7.1"><span data-reactid=".1m.7.1.0">安装 Flannel 网络插件</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.8" style="width: 165px;"><active data-reactid=".1m.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1m.8.1"><span data-reactid=".1m.8.1.0">安装 Worker 节点</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.9" style="width: 165px;"><active data-reactid=".1m.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1m.9.1"><span data-reactid=".1m.9.1.0">小结</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.a" style="width: 165px;"><active data-reactid=".1m.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".1m.a.1"><span data-reactid=".1m.a.1.0">课下作业</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.b" style="width: 165px;"><active data-reactid=".1m.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".1m.b.1"><span data-reactid=".1m.b.1.0">精选留言 (48)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/534762" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>