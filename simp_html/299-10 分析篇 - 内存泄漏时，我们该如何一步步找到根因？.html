
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 10 分析篇 | 内存泄漏时，我们该如何一步步找到根因？</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>10 分析篇 | 内存泄漏时，我们该如何一步步找到根因？</sr-rd-title>
                    
                    <sr-rd-content><h1 id="sr-toc-0">10 分析篇 | 内存泄漏时，我们该如何一步步找到根因？</h1><div><span>邵亚方</span> <span> 2020-09-10</span></div><div><div><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/7f/05/7f9ced53913f62b898b0dca180608705.jpg" style="width: auto;"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：邵亚方</span><span>大小：8.03M</span><span> 时长：08:47</span></div></div><audio title="10 分析篇 | 内存泄漏时，我们该如何一步步找到根因？" src="https://res001.geekbang.org/media/audio/41/68/412a07e3793675c2134dde65d03f6968/ld/ld.m3u8" __idm_id__="1359883"></audio></div><div><div><div><div data-slate-editor="true" data-key="3559" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="3560"><span data-slate-object="text" data-key="3561"><span data-slate-leaf="true" data-offset-key="3561:0" data-first-offset="true"><span data-slate-string="true">你好，我是邵亚方。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3562"><span data-slate-object="text" data-key="3563"><span data-slate-leaf="true" data-offset-key="3563:0" data-first-offset="true"><span data-slate-string="true">通过我们前面的基础篇以及案例篇的学习，你对内存泄漏应该有了自己的一些理解。这节课我来跟你聊一聊系统性地分析内存泄漏问题的方法：也就是说，在面对内存泄漏时，我们该如何一步步去找到根因？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3564"><span data-slate-object="text" data-key="3565"><span data-slate-leaf="true" data-offset-key="3565:0" data-first-offset="true"><span data-slate-string="true">不过，我不会深入到具体语言的实现细节，以及具体业务的代码逻辑中，而是会从 Linux 系统上通用的一些分析方法来入手。这样，不论你使用什么开发语言，不论你在开发什么，它总能给你提供一些帮助。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="3566" id="sr-toc-1"><span data-slate-object="text" data-key="3567"><span data-slate-leaf="true" data-offset-key="3567:0" data-first-offset="true"><span data-slate-string="true">如何定位出是谁在消耗内存 ？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="3568"><span data-slate-object="text" data-key="3569"><span data-slate-leaf="true" data-offset-key="3569:0" data-first-offset="true"><span data-slate-string="true">内存泄漏的外在表现通常是系统内存不够，严重的话可能会引起 OOM (Out of Memory)，甚至系统宕机。那在发生这些现象时，惯用的分析套路是什么呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3570"><span data-slate-object="text" data-key="3571"><span data-slate-leaf="true" data-offset-key="3571:0" data-first-offset="true"><span data-slate-string="true">首先，我们需要去找出到底是谁在消耗内存，/proc/meminfo 可以帮助我们来快速定位出问题所在。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3572"><span data-slate-object="text" data-key="3573"><span data-slate-leaf="true" data-offset-key="3573:0" data-first-offset="true"><span data-slate-string="true">/proc/meminfo 中的项目很多，我们没必要全部都背下来，不过有些项是相对容易出问题的，也是你在遇到内存相关的问题时，需要重点去排查的。我将这些项列了一张表格，也给出了每一项有异常时的排查思路。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="3574"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/a4/30/a48d1c573d19e30ecee8dc6f6fdd3930.jpg?wh=4215*3139"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3575"><span data-slate-object="text" data-key="3576"><span data-slate-leaf="true" data-offset-key="3576:0" data-first-offset="true"><span data-slate-string="true">总之，如果进程的内存有问题，那使用 top 就可以观察出来；如果进程的内存没有问题，那你可以从 /proc/meminfo 入手来一步步地去深入分析。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3577"><span data-slate-object="text" data-key="3578"><span data-slate-leaf="true" data-offset-key="3578:0" data-first-offset="true"><span data-slate-string="true">接下来，我们分析一个实际的案例，来看看如何分析进程内存泄漏是什么原因导致的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="3579" id="sr-toc-2"><span data-slate-object="text" data-key="3580"><span data-slate-leaf="true" data-offset-key="3580:0" data-first-offset="true"><span data-slate-string="true">如何去分析进程的内存泄漏原因？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="3581"><span data-slate-object="text" data-key="3582"><span data-slate-leaf="true" data-offset-key="3582:0" data-first-offset="true"><span data-slate-string="true">这是我多年以前帮助一个小伙伴分析的内存泄漏问题。这个小伙伴已经使用 top 排查出了业务进程的内存异常，但是不清楚该如何去进一步分析。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3583"><span data-slate-object="text" data-key="3584"><span data-slate-leaf="true" data-offset-key="3584:0" data-first-offset="true"><span data-slate-string="true">他遇到的这个异常是，业务进程的虚拟地址空间（VIRT）被消耗很大，但是物理内存（RES）使用得却很少，所以他怀疑是进程的虚拟地址空间有内存泄漏。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3585"><span data-slate-object="text" data-key="3586"><span data-slate-leaf="true" data-offset-key="3586:0" data-first-offset="true"><span data-slate-string="true">我们在 “</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="3587"><span data-slate-object="text" data-key="3588"><span data-slate-leaf="true" data-offset-key="3588:0" data-first-offset="true"><span data-slate-string="true">06 讲</span></span></span></a><span data-slate-object="text" data-key="3589"><span data-slate-leaf="true" data-offset-key="3589:0" data-first-offset="true"><span data-slate-string="true">” 中也讲过，出现该现象时，可以用 top 命令观察（这是当时保存的生产环境信息，部分信息做了脱敏处理）：</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="3590"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3591"><span data-slate-object="text" data-key="3592"><span data-slate-leaf="true" data-offset-key="3592:0" data-first-offset="true"><span data-slate-string="true">  PID </span></span></span><span data-slate-object="text" data-key="3593"><span data-slate-leaf="true" data-offset-key="3593:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">USER</span></span></span></span><span data-slate-object="text" data-key="3594"><span data-slate-leaf="true" data-offset-key="3594:0" data-first-offset="true"><span data-slate-string="true">      PR  NI  VIRT  RES  SHR S </span></span></span><span data-slate-object="text" data-key="3595"><span data-slate-leaf="true" data-offset-key="3595:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">%</span></span></span></span><span data-slate-object="text" data-key="3596"><span data-slate-leaf="true" data-offset-key="3596:0" data-first-offset="true"><span data-slate-string="true">CPU </span></span></span><span data-slate-object="text" data-key="3597"><span data-slate-leaf="true" data-offset-key="3597:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">%</span></span></span></span><span data-slate-object="text" data-key="3598"><span data-slate-leaf="true" data-offset-key="3598:0" data-first-offset="true"><span data-slate-string="true">MEM    </span></span></span><span data-slate-object="text" data-key="3599"><span data-slate-leaf="true" data-offset-key="3599:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">TIME</span></span></span></span><span data-slate-object="text" data-key="3600"><span data-slate-leaf="true" data-offset-key="3600:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">+</span></span></span></span><span data-slate-object="text" data-key="3601"><span data-slate-leaf="true" data-offset-key="3601:0" data-first-offset="true"><span data-slate-string="true">  COMMAND                                                                     </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3602"><span data-slate-object="text" data-key="3603"><span data-slate-leaf="true" data-offset-key="3603:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31108</span></span></span></span><span data-slate-object="text" data-key="3604"><span data-slate-leaf="true" data-offset-key="3604:0" data-first-offset="true"><span data-slate-string="true"> app      </span></span></span><span data-slate-object="text" data-key="3605"><span data-slate-leaf="true" data-offset-key="3605:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">20</span></span></span></span><span data-slate-object="text" data-key="3606"><span data-slate-leaf="true" data-offset-key="3606:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="3607"><span data-slate-leaf="true" data-offset-key="3607:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="3608"><span data-slate-leaf="true" data-offset-key="3608:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="3609"><span data-slate-leaf="true" data-offset-key="3609:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">285</span></span></span></span><span data-slate-object="text" data-key="3610"><span data-slate-leaf="true" data-offset-key="3610:0" data-first-offset="true"><span data-slate-string="true">g </span></span></span><span data-slate-object="text" data-key="3611"><span data-slate-leaf="true" data-offset-key="3611:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">4.0</span></span></span></span><span data-slate-object="text" data-key="3612"><span data-slate-leaf="true" data-offset-key="3612:0" data-first-offset="true"><span data-slate-string="true">g  </span></span></span><span data-slate-object="text" data-key="3613"><span data-slate-leaf="true" data-offset-key="3613:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">19</span></span></span></span><span data-slate-object="text" data-key="3614"><span data-slate-leaf="true" data-offset-key="3614:0" data-first-offset="true"><span data-slate-string="true">m S </span></span></span><span data-slate-object="text" data-key="3615"><span data-slate-leaf="true" data-offset-key="3615:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">60.6</span></span></span></span><span data-slate-object="text" data-key="3616"><span data-slate-leaf="true" data-offset-key="3616:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="3617"><span data-slate-leaf="true" data-offset-key="3617:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">12.7</span></span></span></span><span data-slate-object="text" data-key="3618"><span data-slate-leaf="true" data-offset-key="3618:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="3619"><span data-slate-leaf="true" data-offset-key="3619:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">10986</span></span></span></span><span data-slate-object="text" data-key="3620"><span data-slate-leaf="true" data-offset-key="3620:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3621"><span data-slate-leaf="true" data-offset-key="3621:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">15</span></span></span></span><span data-slate-object="text" data-key="3622"><span data-slate-leaf="true" data-offset-key="3622:0" data-first-offset="true"><span data-slate-string="true"> app_server  </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3623"><span data-slate-object="text" data-key="3624"><span data-slate-leaf="true" data-offset-key="3624:0" data-first-offset="true"><span data-slate-string="true">可以看到 app_server 这个程序的虚拟地址空间（VIRT 这一项）很大，有 285GB。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3625"><span data-slate-object="text" data-key="3626"><span data-slate-leaf="true" data-offset-key="3626:0" data-first-offset="true"><span data-slate-string="true">那该如何追踪 app_server 究竟是哪里存在问题呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3627"><span data-slate-object="text" data-key="3628"><span data-slate-leaf="true" data-offset-key="3628:0" data-first-offset="true"><span data-slate-string="true">我们可以用 pidstat 命令（关于该命令，你可以 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="3629"><span data-slate-object="text" data-key="3630"><span data-slate-leaf="true" data-offset-key="3630:0" data-first-offset="true"><span data-slate-string="true">man pidstat</span></span></span></a><span data-slate-object="text" data-key="3631"><span data-slate-leaf="true" data-offset-key="3631:0" data-first-offset="true"><span data-slate-string="true">）来追踪下该进程的内存行为，看看能够发现什么现象。</span></span></span></div><div data-code-language="shell" data-slate-type="pre" data-slate-object="block" data-key="3632"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3633"><span data-slate-object="text" data-key="3634"><span data-slate-leaf="true" data-offset-key="3634:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$ </span></span></span></span><span data-slate-object="text" data-key="3635"><span data-slate-leaf="true" data-offset-key="3635:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">pidstat -r -p 31108  1</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3636"></div><div data-slate-type="code-line" data-slate-object="block" data-key="3637"></div><div data-slate-type="code-line" data-slate-object="block" data-key="3638"><span data-slate-object="text" data-key="3639"><span data-slate-leaf="true" data-offset-key="3639:0" data-first-offset="true"><span data-slate-string="true">04:47:00 PM     31108    353.00      0.00 299029776 4182152  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3640"><span data-slate-object="text" data-key="3641"><span data-slate-leaf="true" data-offset-key="3641:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3642"><span data-slate-object="text" data-key="3643"><span data-slate-leaf="true" data-offset-key="3643:0" data-first-offset="true"><span data-slate-string="true">04:47:59 PM     31108    149.00      0.00 299029776 4181052  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3644"><span data-slate-object="text" data-key="3645"><span data-slate-leaf="true" data-offset-key="3645:0" data-first-offset="true"><span data-slate-string="true">04:48:00 PM     31108    191.00      0.00 299040020 4181188  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3646"><span data-slate-object="text" data-key="3647"><span data-slate-leaf="true" data-offset-key="3647:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3648"><span data-slate-object="text" data-key="3649"><span data-slate-leaf="true" data-offset-key="3649:0" data-first-offset="true"><span data-slate-string="true">04:48:59 PM     31108    179.00      0.00 299040020 4181400  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3650"><span data-slate-object="text" data-key="3651"><span data-slate-leaf="true" data-offset-key="3651:0" data-first-offset="true"><span data-slate-string="true">04:49:00 PM     31108    183.00      0.00 299050264 4181524  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3652"><span data-slate-object="text" data-key="3653"><span data-slate-leaf="true" data-offset-key="3653:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3654"><span data-slate-object="text" data-key="3655"><span data-slate-leaf="true" data-offset-key="3655:0" data-first-offset="true"><span data-slate-string="true">04:49:59 PM     31108    157.00      0.00 299050264 4181456  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3656"><span data-slate-object="text" data-key="3657"><span data-slate-leaf="true" data-offset-key="3657:0" data-first-offset="true"><span data-slate-string="true">04:50:00 PM     31108    207.00      0.00 299060508 4181560  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3658"><span data-slate-object="text" data-key="3659"><span data-slate-leaf="true" data-offset-key="3659:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3660"><span data-slate-object="text" data-key="3661"><span data-slate-leaf="true" data-offset-key="3661:0" data-first-offset="true"><span data-slate-string="true">04:50:59 PM     31108    127.00      0.00 299060508 4180816  12.73  app_server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3662"><span data-slate-object="text" data-key="3663"><span data-slate-leaf="true" data-offset-key="3663:0" data-first-offset="true"><span data-slate-string="true">04:51:00 PM     31108    172.00      0.00 299070752 4180956  12.73  app_server</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3664"><span data-slate-object="text" data-key="3665"><span data-slate-leaf="true" data-offset-key="3665:0" data-first-offset="true"><span data-slate-string="true">如上所示，在每个整分钟的时候，VSZ 会增大 10244KB，这看起来是一个很有规律的现象。然后，我们再来看下增大的这个内存区域到底是什么，你可以通过 /proc/PID/smaps 来看（关于 /proc 提供的信息，你可以回顾我们课程的 “</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="3666"><span data-slate-object="text" data-key="3667"><span data-slate-leaf="true" data-offset-key="3667:0" data-first-offset="true"><span data-slate-string="true">05 讲</span></span></span></a><span data-slate-object="text" data-key="3668"><span data-slate-leaf="true" data-offset-key="3668:0" data-first-offset="true"><span data-slate-string="true">”）：</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3669"><span data-slate-object="text" data-key="3670"><span data-slate-leaf="true" data-offset-key="3670:0" data-first-offset="true"><span data-slate-string="true">增大的内存区域，具体如下：</span></span></span></div><div data-code-language="shell" data-slate-type="pre" data-slate-object="block" data-key="3671"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3672"><span data-slate-object="text" data-key="3673"><span data-slate-leaf="true" data-offset-key="3673:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$ </span></span></span></span><span data-slate-object="text" data-key="3674"><span data-slate-leaf="true" data-offset-key="3674:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cat</span></span></span></span></span><span data-slate-object="text" data-key="3675"><span data-slate-leaf="true" data-offset-key="3675:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> /proc/31108/smaps</span></span></span></span><span data-slate-object="text" data-key="3676"><span data-slate-leaf="true" data-offset-key="3676:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3677"><span data-slate-object="text" data-key="3678"><span data-slate-leaf="true" data-offset-key="3678:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3679"><span data-slate-object="text" data-key="3680"><span data-slate-leaf="true" data-offset-key="3680:0" data-first-offset="true"><span data-slate-string="true">7faae0e49000-7faae1849000 rw-p 00000000 00:00 0 </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3681"><span data-slate-object="text" data-key="3682"><span data-slate-leaf="true" data-offset-key="3682:0" data-first-offset="true"><span data-slate-string="true">Size:              10240 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3683"><span data-slate-object="text" data-key="3684"><span data-slate-leaf="true" data-offset-key="3684:0" data-first-offset="true"><span data-slate-string="true">Rss:                  80 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3685"><span data-slate-object="text" data-key="3686"><span data-slate-leaf="true" data-offset-key="3686:0" data-first-offset="true"><span data-slate-string="true">Pss:                  80 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3687"><span data-slate-object="text" data-key="3688"><span data-slate-leaf="true" data-offset-key="3688:0" data-first-offset="true"><span data-slate-string="true">Shared_Clean:          0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3689"><span data-slate-object="text" data-key="3690"><span data-slate-leaf="true" data-offset-key="3690:0" data-first-offset="true"><span data-slate-string="true">Shared_Dirty:          0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3691"><span data-slate-object="text" data-key="3692"><span data-slate-leaf="true" data-offset-key="3692:0" data-first-offset="true"><span data-slate-string="true">Private_Clean:         0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3693"><span data-slate-object="text" data-key="3694"><span data-slate-leaf="true" data-offset-key="3694:0" data-first-offset="true"><span data-slate-string="true">Private_Dirty:        80 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3695"><span data-slate-object="text" data-key="3696"><span data-slate-leaf="true" data-offset-key="3696:0" data-first-offset="true"><span data-slate-string="true">Referenced:           60 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3697"><span data-slate-object="text" data-key="3698"><span data-slate-leaf="true" data-offset-key="3698:0" data-first-offset="true"><span data-slate-string="true">Anonymous:            80 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3699"><span data-slate-object="text" data-key="3700"><span data-slate-leaf="true" data-offset-key="3700:0" data-first-offset="true"><span data-slate-string="true">AnonHugePages:         0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3701"><span data-slate-object="text" data-key="3702"><span data-slate-leaf="true" data-offset-key="3702:0" data-first-offset="true"><span data-slate-string="true">Swap:                  0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3703"><span data-slate-object="text" data-key="3704"><span data-slate-leaf="true" data-offset-key="3704:0" data-first-offset="true"><span data-slate-string="true">KernelPageSize:        4 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3705"><span data-slate-object="text" data-key="3706"><span data-slate-leaf="true" data-offset-key="3706:0" data-first-offset="true"><span data-slate-string="true">MMUPageSize:           4 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3707"><span data-slate-object="text" data-key="3708"><span data-slate-leaf="true" data-offset-key="3708:0" data-first-offset="true"><span data-slate-string="true">7faae1849000-7faae184a000 ---p 00000000 00:00 0 </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3709"><span data-slate-object="text" data-key="3710"><span data-slate-leaf="true" data-offset-key="3710:0" data-first-offset="true"><span data-slate-string="true">Size:                  4 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3711"><span data-slate-object="text" data-key="3712"><span data-slate-leaf="true" data-offset-key="3712:0" data-first-offset="true"><span data-slate-string="true">Rss:                   0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3713"><span data-slate-object="text" data-key="3714"><span data-slate-leaf="true" data-offset-key="3714:0" data-first-offset="true"><span data-slate-string="true">Pss:                   0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3715"><span data-slate-object="text" data-key="3716"><span data-slate-leaf="true" data-offset-key="3716:0" data-first-offset="true"><span data-slate-string="true">Shared_Clean:          0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3717"><span data-slate-object="text" data-key="3718"><span data-slate-leaf="true" data-offset-key="3718:0" data-first-offset="true"><span data-slate-string="true">Shared_Dirty:          0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3719"><span data-slate-object="text" data-key="3720"><span data-slate-leaf="true" data-offset-key="3720:0" data-first-offset="true"><span data-slate-string="true">Private_Clean:         0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3721"><span data-slate-object="text" data-key="3722"><span data-slate-leaf="true" data-offset-key="3722:0" data-first-offset="true"><span data-slate-string="true">Private_Dirty:         0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3723"><span data-slate-object="text" data-key="3724"><span data-slate-leaf="true" data-offset-key="3724:0" data-first-offset="true"><span data-slate-string="true">Referenced:            0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3725"><span data-slate-object="text" data-key="3726"><span data-slate-leaf="true" data-offset-key="3726:0" data-first-offset="true"><span data-slate-string="true">Anonymous:             0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3727"><span data-slate-object="text" data-key="3728"><span data-slate-leaf="true" data-offset-key="3728:0" data-first-offset="true"><span data-slate-string="true">AnonHugePages:         0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3729"><span data-slate-object="text" data-key="3730"><span data-slate-leaf="true" data-offset-key="3730:0" data-first-offset="true"><span data-slate-string="true">Swap:                  0 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3731"><span data-slate-object="text" data-key="3732"><span data-slate-leaf="true" data-offset-key="3732:0" data-first-offset="true"><span data-slate-string="true">KernelPageSize:        4 kB</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3733"><span data-slate-object="text" data-key="3734"><span data-slate-leaf="true" data-offset-key="3734:0" data-first-offset="true"><span data-slate-string="true">MMUPageSize:           4 kB</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3735"><span data-slate-object="text" data-key="3736"><span data-slate-leaf="true" data-offset-key="3736:0" data-first-offset="true"><span data-slate-string="true">可以看到，它包括：一个私有地址空间，这从 rw-p 这个属性中的 private 可以看出来；以及一个保护页 ，这从 —p 这个属性可以看出来，即进程无法访问。对于有经验的开发者而言，从这个 4K 的保护页就可以猜测出应该跟线程栈有关了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3737"><span data-slate-object="text" data-key="3738"><span data-slate-leaf="true" data-offset-key="3738:0" data-first-offset="true"><span data-slate-string="true">然后我们跟踪下进程申请这部分地址空间的目的是什么，通过 strace 命令来跟踪系统调用就可以了。因为 VIRT 的增加，它的系统调用函数无非是 mmap 或者 brk，那么我们只需要 strace 的结果来看下 mmap 或 brk 就可以了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3739"><span data-slate-object="text" data-key="3740"><span data-slate-leaf="true" data-offset-key="3740:0" data-first-offset="true"><span data-slate-string="true">用 strace 跟踪如下：</span></span></span></div><div data-code-language="shell" data-slate-type="pre" data-slate-object="block" data-key="3741"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3742"><span data-slate-object="text" data-key="3743"><span data-slate-leaf="true" data-offset-key="3743:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$ </span></span></span></span><span data-slate-object="text" data-key="3744"><span data-slate-leaf="true" data-offset-key="3744:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">strace -t -f -p 31108 -o 31108.strace</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3745"><span data-slate-object="text" data-key="3746"><span data-slate-leaf="true" data-offset-key="3746:0" data-first-offset="true"><span data-slate-string="true">线程数较多，如果使用 -f 来跟踪线程，跟踪的信息量也很大，逐个搜索日志里面的 mmap 或者 brk 真是眼花缭乱， 所以我们来 grep 一下这个大小 (10489856 即 10244KB)，然后过滤下就好了：</span></span></span></div><div data-code-language="xml" data-slate-type="pre" data-slate-object="block" data-key="3747"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3748"><span data-slate-object="text" data-key="3749"><span data-slate-leaf="true" data-offset-key="3749:0" data-first-offset="true"><span data-slate-string="true">$ cat 31108.strace | grep 10489856    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3750"><span data-slate-object="text" data-key="3751"><span data-slate-leaf="true" data-offset-key="3751:0" data-first-offset="true"><span data-slate-string="true">31152 23:00:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3752"><span data-slate-leaf="true" data-offset-key="3752:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3753"><span data-slate-leaf="true" data-offset-key="3753:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3754"><span data-slate-leaf="true" data-offset-key="3754:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3755"><span data-slate-leaf="true" data-offset-key="3755:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3756"><span data-slate-leaf="true" data-offset-key="3756:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3757"><span data-slate-object="text" data-key="3758"><span data-slate-leaf="true" data-offset-key="3758:0" data-first-offset="true"><span data-slate-string="true">31151 23:01:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3759"><span data-slate-leaf="true" data-offset-key="3759:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3760"><span data-slate-leaf="true" data-offset-key="3760:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3761"><span data-slate-leaf="true" data-offset-key="3761:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3762"><span data-slate-leaf="true" data-offset-key="3762:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3763"><span data-slate-leaf="true" data-offset-key="3763:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3764"><span data-slate-object="text" data-key="3765"><span data-slate-leaf="true" data-offset-key="3765:0" data-first-offset="true"><span data-slate-string="true">31157 23:02:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3766"><span data-slate-leaf="true" data-offset-key="3766:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3767"><span data-slate-leaf="true" data-offset-key="3767:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3768"><span data-slate-leaf="true" data-offset-key="3768:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3769"><span data-slate-leaf="true" data-offset-key="3769:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3770"><span data-slate-leaf="true" data-offset-key="3770:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3771"><span data-slate-object="text" data-key="3772"><span data-slate-leaf="true" data-offset-key="3772:0" data-first-offset="true"><span data-slate-string="true">31158 23:03:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3773"><span data-slate-leaf="true" data-offset-key="3773:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3774"><span data-slate-leaf="true" data-offset-key="3774:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3775"><span data-slate-leaf="true" data-offset-key="3775:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3776"><span data-slate-leaf="true" data-offset-key="3776:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3777"><span data-slate-leaf="true" data-offset-key="3777:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3778"><span data-slate-object="text" data-key="3779"><span data-slate-leaf="true" data-offset-key="3779:0" data-first-offset="true"><span data-slate-string="true">31165 23:04:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3780"><span data-slate-leaf="true" data-offset-key="3780:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3781"><span data-slate-leaf="true" data-offset-key="3781:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3782"><span data-slate-leaf="true" data-offset-key="3782:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3783"><span data-slate-leaf="true" data-offset-key="3783:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3784"><span data-slate-leaf="true" data-offset-key="3784:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3785"><span data-slate-object="text" data-key="3786"><span data-slate-leaf="true" data-offset-key="3786:0" data-first-offset="true"><span data-slate-string="true">31163 23:05:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3787"><span data-slate-leaf="true" data-offset-key="3787:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3788"><span data-slate-leaf="true" data-offset-key="3788:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3789"><span data-slate-leaf="true" data-offset-key="3789:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3790"><span data-slate-leaf="true" data-offset-key="3790:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3791"><span data-slate-leaf="true" data-offset-key="3791:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3792"><span data-slate-object="text" data-key="3793"><span data-slate-leaf="true" data-offset-key="3793:0" data-first-offset="true"><span data-slate-string="true">31153 23:06:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3794"><span data-slate-leaf="true" data-offset-key="3794:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3795"><span data-slate-leaf="true" data-offset-key="3795:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3796"><span data-slate-leaf="true" data-offset-key="3796:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3797"><span data-slate-leaf="true" data-offset-key="3797:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3798"><span data-slate-leaf="true" data-offset-key="3798:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3799"><span data-slate-object="text" data-key="3800"><span data-slate-leaf="true" data-offset-key="3800:0" data-first-offset="true"><span data-slate-string="true">31155 23:07:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3801"><span data-slate-leaf="true" data-offset-key="3801:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3802"><span data-slate-leaf="true" data-offset-key="3802:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3803"><span data-slate-leaf="true" data-offset-key="3803:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3804"><span data-slate-leaf="true" data-offset-key="3804:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3805"><span data-slate-leaf="true" data-offset-key="3805:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3806"><span data-slate-object="text" data-key="3807"><span data-slate-leaf="true" data-offset-key="3807:0" data-first-offset="true"><span data-slate-string="true">31149 23:08:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3808"><span data-slate-leaf="true" data-offset-key="3808:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3809"><span data-slate-leaf="true" data-offset-key="3809:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3810"><span data-slate-leaf="true" data-offset-key="3810:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3811"><span data-slate-leaf="true" data-offset-key="3811:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3812"><span data-slate-leaf="true" data-offset-key="3812:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3813"><span data-slate-object="text" data-key="3814"><span data-slate-leaf="true" data-offset-key="3814:0" data-first-offset="true"><span data-slate-string="true">31147 23:09:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3815"><span data-slate-leaf="true" data-offset-key="3815:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3816"><span data-slate-leaf="true" data-offset-key="3816:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3817"><span data-slate-leaf="true" data-offset-key="3817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3818"><span data-slate-leaf="true" data-offset-key="3818:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3819"><span data-slate-leaf="true" data-offset-key="3819:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3820"><span data-slate-object="text" data-key="3821"><span data-slate-leaf="true" data-offset-key="3821:0" data-first-offset="true"><span data-slate-string="true">31159 23:10:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3822"><span data-slate-leaf="true" data-offset-key="3822:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3823"><span data-slate-leaf="true" data-offset-key="3823:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3824"><span data-slate-leaf="true" data-offset-key="3824:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3825"><span data-slate-leaf="true" data-offset-key="3825:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3826"><span data-slate-leaf="true" data-offset-key="3826:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3827"><span data-slate-object="text" data-key="3828"><span data-slate-leaf="true" data-offset-key="3828:0" data-first-offset="true"><span data-slate-string="true">31157 23:11:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3829"><span data-slate-leaf="true" data-offset-key="3829:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3830"><span data-slate-leaf="true" data-offset-key="3830:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3831"><span data-slate-leaf="true" data-offset-key="3831:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3832"><span data-slate-leaf="true" data-offset-key="3832:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3833"><span data-slate-leaf="true" data-offset-key="3833:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3834"><span data-slate-object="text" data-key="3835"><span data-slate-leaf="true" data-offset-key="3835:0" data-first-offset="true"><span data-slate-string="true">31148 23:12:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3836"><span data-slate-leaf="true" data-offset-key="3836:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3837"><span data-slate-leaf="true" data-offset-key="3837:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3838"><span data-slate-leaf="true" data-offset-key="3838:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3839"><span data-slate-leaf="true" data-offset-key="3839:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3840"><span data-slate-leaf="true" data-offset-key="3840:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3841"><span data-slate-object="text" data-key="3842"><span data-slate-leaf="true" data-offset-key="3842:0" data-first-offset="true"><span data-slate-string="true">31150 23:13:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3843"><span data-slate-leaf="true" data-offset-key="3843:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3844"><span data-slate-leaf="true" data-offset-key="3844:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3845"><span data-slate-leaf="true" data-offset-key="3845:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3846"><span data-slate-leaf="true" data-offset-key="3846:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3847"><span data-slate-leaf="true" data-offset-key="3847:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3848"><span data-slate-object="text" data-key="3849"><span data-slate-leaf="true" data-offset-key="3849:0" data-first-offset="true"><span data-slate-string="true">31173 23:14:00 mmap(NULL, 10489856, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, -1, 0 </span></span></span><span data-slate-object="text" data-key="3850"><span data-slate-leaf="true" data-offset-key="3850:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;</span></span></span></span><span data-slate-object="text" data-key="3851"><span data-slate-leaf="true" data-offset-key="3851:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">unfinished</span></span></span></span></span><span data-slate-object="text" data-key="3852"><span data-slate-leaf="true" data-offset-key="3852:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3853"><span data-slate-leaf="true" data-offset-key="3853:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">...</span></span></span></span></span><span data-slate-object="text" data-key="3854"><span data-slate-leaf="true" data-offset-key="3854:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&gt;</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3855"><span data-slate-object="text" data-key="3856"><span data-slate-leaf="true" data-offset-key="3856:0" data-first-offset="true"><span data-slate-string="true">从这个日志我们可以看到，出错的是 mmap () 这个系统调用，那我们再来看下 mmap 这个内存的目的：</span></span></span></div><div data-code-language="objectivec" data-slate-type="pre" data-slate-object="block" data-key="3857"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3858"><span data-slate-object="text" data-key="3859"><span data-slate-leaf="true" data-offset-key="3859:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31151</span></span></span></span><span data-slate-object="text" data-key="3860"><span data-slate-leaf="true" data-offset-key="3860:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="3861"><span data-slate-leaf="true" data-offset-key="3861:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">23</span></span></span></span><span data-slate-object="text" data-key="3862"><span data-slate-leaf="true" data-offset-key="3862:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3863"><span data-slate-leaf="true" data-offset-key="3863:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">01</span></span></span></span><span data-slate-object="text" data-key="3864"><span data-slate-leaf="true" data-offset-key="3864:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3865"><span data-slate-leaf="true" data-offset-key="3865:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">00</span></span></span></span><span data-slate-object="text" data-key="3866"><span data-slate-leaf="true" data-offset-key="3866:0" data-first-offset="true"><span data-slate-string="true"> mmap(</span></span></span><span data-slate-object="text" data-key="3867"><span data-slate-leaf="true" data-offset-key="3867:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NULL</span></span></span></span><span data-slate-object="text" data-key="3868"><span data-slate-leaf="true" data-offset-key="3868:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="3869"><span data-slate-leaf="true" data-offset-key="3869:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">10489856</span></span></span></span><span data-slate-object="text" data-key="3870"><span data-slate-leaf="true" data-offset-key="3870:0" data-first-offset="true"><span data-slate-string="true">, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, </span></span></span><span data-slate-object="text" data-key="3871"><span data-slate-leaf="true" data-offset-key="3871:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-1</span></span></span></span><span data-slate-object="text" data-key="3872"><span data-slate-leaf="true" data-offset-key="3872:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="3873"><span data-slate-leaf="true" data-offset-key="3873:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="3874"><span data-slate-leaf="true" data-offset-key="3874:0" data-first-offset="true"><span data-slate-string="true"> &lt;unfinished ...&gt;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3875"><span data-slate-object="text" data-key="3876"><span data-slate-leaf="true" data-offset-key="3876:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31151</span></span></span></span><span data-slate-object="text" data-key="3877"><span data-slate-leaf="true" data-offset-key="3877:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="3878"><span data-slate-leaf="true" data-offset-key="3878:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">23</span></span></span></span><span data-slate-object="text" data-key="3879"><span data-slate-leaf="true" data-offset-key="3879:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3880"><span data-slate-leaf="true" data-offset-key="3880:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">01</span></span></span></span><span data-slate-object="text" data-key="3881"><span data-slate-leaf="true" data-offset-key="3881:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3882"><span data-slate-leaf="true" data-offset-key="3882:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">00</span></span></span></span><span data-slate-object="text" data-key="3883"><span data-slate-leaf="true" data-offset-key="3883:0" data-first-offset="true"><span data-slate-string="true"> mprotect(</span></span></span><span data-slate-object="text" data-key="3884"><span data-slate-leaf="true" data-offset-key="3884:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0x7fa94bbc0000</span></span></span></span><span data-slate-object="text" data-key="3885"><span data-slate-leaf="true" data-offset-key="3885:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="3886"><span data-slate-leaf="true" data-offset-key="3886:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">4096</span></span></span></span><span data-slate-object="text" data-key="3887"><span data-slate-leaf="true" data-offset-key="3887:0" data-first-offset="true"><span data-slate-string="true">, PROT_NONE &lt;unfinished ...&gt;   &lt;&lt;&lt; 创建一个保护页  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3888"><span data-slate-object="text" data-key="3889"><span data-slate-leaf="true" data-offset-key="3889:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31151</span></span></span></span><span data-slate-object="text" data-key="3890"><span data-slate-leaf="true" data-offset-key="3890:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="3891"><span data-slate-leaf="true" data-offset-key="3891:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">23</span></span></span></span><span data-slate-object="text" data-key="3892"><span data-slate-leaf="true" data-offset-key="3892:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3893"><span data-slate-leaf="true" data-offset-key="3893:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">01</span></span></span></span><span data-slate-object="text" data-key="3894"><span data-slate-leaf="true" data-offset-key="3894:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3895"><span data-slate-leaf="true" data-offset-key="3895:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">00</span></span></span></span><span data-slate-object="text" data-key="3896"><span data-slate-leaf="true" data-offset-key="3896:0" data-first-offset="true"><span data-slate-string="true"> clone (&lt;unfinished ...&gt;   &lt;&lt;&lt; 创建线程</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3897"><span data-slate-object="text" data-key="3898"><span data-slate-leaf="true" data-offset-key="3898:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">31151</span></span></span></span><span data-slate-object="text" data-key="3899"><span data-slate-leaf="true" data-offset-key="3899:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="3900"><span data-slate-leaf="true" data-offset-key="3900:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">23</span></span></span></span><span data-slate-object="text" data-key="3901"><span data-slate-leaf="true" data-offset-key="3901:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3902"><span data-slate-leaf="true" data-offset-key="3902:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">01</span></span></span></span><span data-slate-object="text" data-key="3903"><span data-slate-leaf="true" data-offset-key="3903:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="3904"><span data-slate-leaf="true" data-offset-key="3904:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">00</span></span></span></span><span data-slate-object="text" data-key="3905"><span data-slate-leaf="true" data-offset-key="3905:0" data-first-offset="true"><span data-slate-string="true"> &lt;... clone resumed&gt; child_stack=</span></span></span><span data-slate-object="text" data-key="3906"><span data-slate-leaf="true" data-offset-key="3906:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0x7fa94c5afe50</span></span></span></span><span data-slate-object="text" data-key="3907"><span data-slate-leaf="true" data-offset-key="3907:0" data-first-offset="true"><span data-slate-string="true">, flags=</span></span></span><span data-slate-object="text" data-key="3908"><span data-slate-leaf="true" data-offset-key="3908:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_VM</span></span></span></span><span data-slate-object="text" data-key="3909"><span data-slate-leaf="true" data-offset-key="3909:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3910"><span data-slate-leaf="true" data-offset-key="3910:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_FS</span></span></span></span><span data-slate-object="text" data-key="3911"><span data-slate-leaf="true" data-offset-key="3911:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3912"><span data-slate-leaf="true" data-offset-key="3912:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_FILES</span></span></span></span><span data-slate-object="text" data-key="3913"><span data-slate-leaf="true" data-offset-key="3913:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3914"><span data-slate-leaf="true" data-offset-key="3914:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_SIGHAND</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3915"><span data-slate-object="text" data-key="3916"><span data-slate-leaf="true" data-offset-key="3916:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3917"><span data-slate-leaf="true" data-offset-key="3917:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_THREAD</span></span></span></span><span data-slate-object="text" data-key="3918"><span data-slate-leaf="true" data-offset-key="3918:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3919"><span data-slate-leaf="true" data-offset-key="3919:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_SYSVSEM</span></span></span></span><span data-slate-object="text" data-key="3920"><span data-slate-leaf="true" data-offset-key="3920:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3921"><span data-slate-leaf="true" data-offset-key="3921:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_SETTLS</span></span></span></span><span data-slate-object="text" data-key="3922"><span data-slate-leaf="true" data-offset-key="3922:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3923"><span data-slate-leaf="true" data-offset-key="3923:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_PARENT_SETTID</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3924"><span data-slate-object="text" data-key="3925"><span data-slate-leaf="true" data-offset-key="3925:0" data-first-offset="true"><span data-slate-string="true">|</span></span></span><span data-slate-object="text" data-key="3926"><span data-slate-leaf="true" data-offset-key="3926:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">CLONE_CHILD_CLEARTID</span></span></span></span><span data-slate-object="text" data-key="3927"><span data-slate-leaf="true" data-offset-key="3927:0" data-first-offset="true"><span data-slate-string="true">, parent_tidptr=</span></span></span><span data-slate-object="text" data-key="3928"><span data-slate-leaf="true" data-offset-key="3928:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0x7fa94c5c09d0</span></span></span></span><span data-slate-object="text" data-key="3929"><span data-slate-leaf="true" data-offset-key="3929:0" data-first-offset="true"><span data-slate-string="true">, tls=</span></span></span><span data-slate-object="text" data-key="3930"><span data-slate-leaf="true" data-offset-key="3930:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0x7fa94c5c0700</span></span></span></span><span data-slate-object="text" data-key="3931"><span data-slate-leaf="true" data-offset-key="3931:0" data-first-offset="true"><span data-slate-string="true">, child_tidptr=</span></span></span><span data-slate-object="text" data-key="3932"><span data-slate-leaf="true" data-offset-key="3932:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0x7fa94c5c09d0</span></span></span></span><span data-slate-object="text" data-key="3933"><span data-slate-leaf="true" data-offset-key="3933:0" data-first-offset="true"><span data-slate-string="true">) = </span></span></span><span data-slate-object="text" data-key="3934"><span data-slate-leaf="true" data-offset-key="3934:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">20610</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3935"><span data-slate-object="text" data-key="3936"><span data-slate-leaf="true" data-offset-key="3936:0" data-first-offset="true"><span data-slate-string="true">可以看出，这是在 clone 时申请的线程栈。到这里你可能会有一个疑问：既然线程栈消耗了这么多的内存，那理应有很多才对啊？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3937"><span data-slate-object="text" data-key="3938"><span data-slate-leaf="true" data-offset-key="3938:0" data-first-offset="true"><span data-slate-string="true">但是实际上，系统中并没有很多 app_server 的线程，那这是为什么呢？答案其实比较简单：线程短暂执行完毕后就退出了，可是 mmap 的线程栈却没有被释放。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3939"><span data-slate-object="text" data-key="3940"><span data-slate-leaf="true" data-offset-key="3940:0" data-first-offset="true"><span data-slate-string="true">我们来写一个简单的程序复现这个现象，问题的复现是很重要的，如果很复杂的问题可以用简单的程序来复现，那就是最好的结果了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="3941"><span data-slate-object="text" data-key="3942"><span data-slate-leaf="true" data-offset-key="3942:0" data-first-offset="true"><span data-slate-string="true">如下是一个简单的复现程序：mmap 一个 40K 的线程栈，然后线程简单执行一下就退出。</span></span></span></div><div data-code-language="cpp" data-slate-type="pre" data-slate-object="block" data-key="3943"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="3944"><span data-slate-object="text" data-key="3945"><span data-slate-leaf="true" data-offset-key="3945:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3946"><span data-slate-leaf="true" data-offset-key="3946:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3947"><span data-slate-leaf="true" data-offset-key="3947:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3948"><span data-slate-leaf="true" data-offset-key="3948:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;stdio.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3949"><span data-slate-object="text" data-key="3950"><span data-slate-leaf="true" data-offset-key="3950:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3951"><span data-slate-leaf="true" data-offset-key="3951:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3952"><span data-slate-leaf="true" data-offset-key="3952:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3953"><span data-slate-leaf="true" data-offset-key="3953:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;unistd.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3954"><span data-slate-object="text" data-key="3955"><span data-slate-leaf="true" data-offset-key="3955:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3956"><span data-slate-leaf="true" data-offset-key="3956:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3957"><span data-slate-leaf="true" data-offset-key="3957:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3958"><span data-slate-leaf="true" data-offset-key="3958:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;sys/mman.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3959"><span data-slate-object="text" data-key="3960"><span data-slate-leaf="true" data-offset-key="3960:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3961"><span data-slate-leaf="true" data-offset-key="3961:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3962"><span data-slate-leaf="true" data-offset-key="3962:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3963"><span data-slate-leaf="true" data-offset-key="3963:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;sys/types.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3964"><span data-slate-object="text" data-key="3965"><span data-slate-leaf="true" data-offset-key="3965:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3966"><span data-slate-leaf="true" data-offset-key="3966:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3967"><span data-slate-leaf="true" data-offset-key="3967:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3968"><span data-slate-leaf="true" data-offset-key="3968:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;sys/wait.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3969"><span data-slate-object="text" data-key="3970"><span data-slate-leaf="true" data-offset-key="3970:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3971"><span data-slate-leaf="true" data-offset-key="3971:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">define</span></span></span></span></span><span data-slate-object="text" data-key="3972"><span data-slate-leaf="true" data-offset-key="3972:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> _SCHED_H </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3973"><span data-slate-object="text" data-key="3974"><span data-slate-leaf="true" data-offset-key="3974:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3975"><span data-slate-leaf="true" data-offset-key="3975:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">define</span></span></span></span></span><span data-slate-object="text" data-key="3976"><span data-slate-leaf="true" data-offset-key="3976:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> __USE_GNU </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3977"><span data-slate-object="text" data-key="3978"><span data-slate-leaf="true" data-offset-key="3978:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3979"><span data-slate-leaf="true" data-offset-key="3979:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="3980"><span data-slate-leaf="true" data-offset-key="3980:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3981"><span data-slate-leaf="true" data-offset-key="3981:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">&lt;bits/sched.h&gt;</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3982"><span data-slate-object="text" data-key="3983"><span data-slate-leaf="true" data-offset-key="3983:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3984"><span data-slate-object="text" data-key="3985"><span data-slate-leaf="true" data-offset-key="3985:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="3986"><span data-slate-leaf="true" data-offset-key="3986:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">define</span></span></span></span></span><span data-slate-object="text" data-key="3987"><span data-slate-leaf="true" data-offset-key="3987:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> STACK_SIZE 40960</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3988"><span data-slate-object="text" data-key="3989"><span data-slate-leaf="true" data-offset-key="3989:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3990"><span data-slate-object="text" data-key="3991"><span data-slate-leaf="true" data-offset-key="3991:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">int</span></span></span></span></span><span data-slate-object="text" data-key="3992"><span data-slate-leaf="true" data-offset-key="3992:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="3993"><span data-slate-leaf="true" data-offset-key="3993:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="3994"><span data-slate-leaf="true" data-offset-key="3994:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(</span></span></span></span></span><span data-slate-object="text" data-key="3995"><span data-slate-leaf="true" data-offset-key="3995:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">void</span></span></span></span></span></span><span data-slate-object="text" data-key="3996"><span data-slate-leaf="true" data-offset-key="3996:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> *arg)</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3997"><span data-slate-object="text" data-key="3998"><span data-slate-leaf="true" data-offset-key="3998:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="3999"><span data-slate-object="text" data-key="4000"><span data-slate-leaf="true" data-offset-key="4000:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4001"><span data-slate-leaf="true" data-offset-key="4001:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="4002"><span data-slate-leaf="true" data-offset-key="4002:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4003"><span data-slate-leaf="true" data-offset-key="4003:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"thread enter.\n"</span></span></span></span><span data-slate-object="text" data-key="4004"><span data-slate-leaf="true" data-offset-key="4004:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4005"><span data-slate-object="text" data-key="4006"><span data-slate-leaf="true" data-offset-key="4006:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4007"><span data-slate-leaf="true" data-offset-key="4007:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sleep</span></span></span></span><span data-slate-object="text" data-key="4008"><span data-slate-leaf="true" data-offset-key="4008:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4009"><span data-slate-leaf="true" data-offset-key="4009:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1</span></span></span></span><span data-slate-object="text" data-key="4010"><span data-slate-leaf="true" data-offset-key="4010:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4011"><span data-slate-object="text" data-key="4012"><span data-slate-leaf="true" data-offset-key="4012:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4013"><span data-slate-leaf="true" data-offset-key="4013:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="4014"><span data-slate-leaf="true" data-offset-key="4014:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4015"><span data-slate-leaf="true" data-offset-key="4015:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"thread exit.\n"</span></span></span></span><span data-slate-object="text" data-key="4016"><span data-slate-leaf="true" data-offset-key="4016:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4017"><span data-slate-object="text" data-key="4018"><span data-slate-leaf="true" data-offset-key="4018:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4019"><span data-slate-object="text" data-key="4020"><span data-slate-leaf="true" data-offset-key="4020:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4021"><span data-slate-leaf="true" data-offset-key="4021:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="4022"><span data-slate-leaf="true" data-offset-key="4022:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="4023"><span data-slate-leaf="true" data-offset-key="4023:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="4024"><span data-slate-leaf="true" data-offset-key="4024:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4025"><span data-slate-object="text" data-key="4026"><span data-slate-leaf="true" data-offset-key="4026:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4027"></div><div data-slate-type="code-line" data-slate-object="block" data-key="4028"></div><div data-slate-type="code-line" data-slate-object="block" data-key="4029"><span data-slate-object="text" data-key="4030"><span data-slate-leaf="true" data-offset-key="4030:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">int</span></span></span></span></span><span data-slate-object="text" data-key="4031"><span data-slate-leaf="true" data-offset-key="4031:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="4032"><span data-slate-leaf="true" data-offset-key="4032:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="4033"><span data-slate-leaf="true" data-offset-key="4033:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4034"><span data-slate-object="text" data-key="4035"><span data-slate-leaf="true" data-offset-key="4035:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4036"><span data-slate-object="text" data-key="4037"><span data-slate-leaf="true" data-offset-key="4037:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4038"><span data-slate-leaf="true" data-offset-key="4038:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">int</span></span></span></span><span data-slate-object="text" data-key="4039"><span data-slate-leaf="true" data-offset-key="4039:0" data-first-offset="true"><span data-slate-string="true"> thread_pid;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4040"><span data-slate-object="text" data-key="4041"><span data-slate-leaf="true" data-offset-key="4041:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4042"><span data-slate-leaf="true" data-offset-key="4042:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">int</span></span></span></span><span data-slate-object="text" data-key="4043"><span data-slate-leaf="true" data-offset-key="4043:0" data-first-offset="true"><span data-slate-string="true"> status;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4044"><span data-slate-object="text" data-key="4045"><span data-slate-leaf="true" data-offset-key="4045:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4046"><span data-slate-leaf="true" data-offset-key="4046:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">int</span></span></span></span><span data-slate-object="text" data-key="4047"><span data-slate-leaf="true" data-offset-key="4047:0" data-first-offset="true"><span data-slate-string="true"> w;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4048"><span data-slate-object="text" data-key="4049"><span data-slate-leaf="true" data-offset-key="4049:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4050"><span data-slate-object="text" data-key="4051"><span data-slate-leaf="true" data-offset-key="4051:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4052"><span data-slate-leaf="true" data-offset-key="4052:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">while</span></span></span></span><span data-slate-object="text" data-key="4053"><span data-slate-leaf="true" data-offset-key="4053:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span><span data-slate-object="text" data-key="4054"><span data-slate-leaf="true" data-offset-key="4054:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1</span></span></span></span><span data-slate-object="text" data-key="4055"><span data-slate-leaf="true" data-offset-key="4055:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4056"><span data-slate-object="text" data-key="4057"><span data-slate-leaf="true" data-offset-key="4057:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4058"><span data-slate-leaf="true" data-offset-key="4058:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">void</span></span></span></span><span data-slate-object="text" data-key="4059"><span data-slate-leaf="true" data-offset-key="4059:0" data-first-offset="true"><span data-slate-string="true"> *addr = </span></span></span><span data-slate-object="text" data-key="4060"><span data-slate-leaf="true" data-offset-key="4060:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">mmap</span></span></span></span><span data-slate-object="text" data-key="4061"><span data-slate-leaf="true" data-offset-key="4061:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4062"><span data-slate-leaf="true" data-offset-key="4062:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NULL</span></span></span></span><span data-slate-object="text" data-key="4063"><span data-slate-leaf="true" data-offset-key="4063:0" data-first-offset="true"><span data-slate-string="true">, STACK_SIZE, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|MAP_STACK, </span></span></span><span data-slate-object="text" data-key="4064"><span data-slate-leaf="true" data-offset-key="4064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-1</span></span></span></span><span data-slate-object="text" data-key="4065"><span data-slate-leaf="true" data-offset-key="4065:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="4066"><span data-slate-leaf="true" data-offset-key="4066:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="4067"><span data-slate-leaf="true" data-offset-key="4067:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4068"><span data-slate-object="text" data-key="4069"><span data-slate-leaf="true" data-offset-key="4069:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4070"><span data-slate-leaf="true" data-offset-key="4070:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="4071"><span data-slate-leaf="true" data-offset-key="4071:0" data-first-offset="true"><span data-slate-string="true"> (addr == </span></span></span><span data-slate-object="text" data-key="4072"><span data-slate-leaf="true" data-offset-key="4072:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NULL</span></span></span></span><span data-slate-object="text" data-key="4073"><span data-slate-leaf="true" data-offset-key="4073:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4074"><span data-slate-object="text" data-key="4075"><span data-slate-leaf="true" data-offset-key="4075:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="4076"><span data-slate-leaf="true" data-offset-key="4076:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perror</span></span></span></span><span data-slate-object="text" data-key="4077"><span data-slate-leaf="true" data-offset-key="4077:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4078"><span data-slate-leaf="true" data-offset-key="4078:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"mmap"</span></span></span></span><span data-slate-object="text" data-key="4079"><span data-slate-leaf="true" data-offset-key="4079:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4080"><span data-slate-object="text" data-key="4081"><span data-slate-leaf="true" data-offset-key="4081:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="4082"><span data-slate-leaf="true" data-offset-key="4082:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">goto</span></span></span></span><span data-slate-object="text" data-key="4083"><span data-slate-leaf="true" data-offset-key="4083:0" data-first-offset="true"><span data-slate-string="true"> error;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4084"><span data-slate-object="text" data-key="4085"><span data-slate-leaf="true" data-offset-key="4085:0" data-first-offset="true"><span data-slate-string="true">        }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4086"><span data-slate-object="text" data-key="4087"><span data-slate-leaf="true" data-offset-key="4087:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4088"><span data-slate-leaf="true" data-offset-key="4088:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="4089"><span data-slate-leaf="true" data-offset-key="4089:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4090"><span data-slate-leaf="true" data-offset-key="4090:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"creat new thread...\n"</span></span></span></span><span data-slate-object="text" data-key="4091"><span data-slate-leaf="true" data-offset-key="4091:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4092"><span data-slate-object="text" data-key="4093"><span data-slate-leaf="true" data-offset-key="4093:0" data-first-offset="true"><span data-slate-string="true">        thread_pid = </span></span></span><span data-slate-object="text" data-key="4094"><span data-slate-leaf="true" data-offset-key="4094:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">clone</span></span></span></span><span data-slate-object="text" data-key="4095"><span data-slate-leaf="true" data-offset-key="4095:0" data-first-offset="true"><span data-slate-string="true">(&amp;func, addr + STACK_SIZE, CLONE_SIGHAND|CLONE_FS|CLONE_VM|CLONE_FILES, </span></span></span><span data-slate-object="text" data-key="4096"><span data-slate-leaf="true" data-offset-key="4096:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NULL</span></span></span></span><span data-slate-object="text" data-key="4097"><span data-slate-leaf="true" data-offset-key="4097:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4098"><span data-slate-object="text" data-key="4099"><span data-slate-leaf="true" data-offset-key="4099:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4100"><span data-slate-leaf="true" data-offset-key="4100:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="4101"><span data-slate-leaf="true" data-offset-key="4101:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4102"><span data-slate-leaf="true" data-offset-key="4102:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Done! Thread pid: %d\n"</span></span></span></span><span data-slate-object="text" data-key="4103"><span data-slate-leaf="true" data-offset-key="4103:0" data-first-offset="true"><span data-slate-string="true">, thread_pid);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4104"><span data-slate-object="text" data-key="4105"><span data-slate-leaf="true" data-offset-key="4105:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4106"><span data-slate-leaf="true" data-offset-key="4106:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="4107"><span data-slate-leaf="true" data-offset-key="4107:0" data-first-offset="true"><span data-slate-string="true"> (thread_pid != </span></span></span><span data-slate-object="text" data-key="4108"><span data-slate-leaf="true" data-offset-key="4108:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-1</span></span></span></span><span data-slate-object="text" data-key="4109"><span data-slate-leaf="true" data-offset-key="4109:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4110"><span data-slate-object="text" data-key="4111"><span data-slate-leaf="true" data-offset-key="4111:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="4112"><span data-slate-leaf="true" data-offset-key="4112:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">do</span></span></span></span><span data-slate-object="text" data-key="4113"><span data-slate-leaf="true" data-offset-key="4113:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4114"><span data-slate-object="text" data-key="4115"><span data-slate-leaf="true" data-offset-key="4115:0" data-first-offset="true"><span data-slate-string="true">                w = </span></span></span><span data-slate-object="text" data-key="4116"><span data-slate-leaf="true" data-offset-key="4116:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">waitpid</span></span></span></span><span data-slate-object="text" data-key="4117"><span data-slate-leaf="true" data-offset-key="4117:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4118"><span data-slate-leaf="true" data-offset-key="4118:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-1</span></span></span></span><span data-slate-object="text" data-key="4119"><span data-slate-leaf="true" data-offset-key="4119:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="4120"><span data-slate-leaf="true" data-offset-key="4120:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NULL</span></span></span></span><span data-slate-object="text" data-key="4121"><span data-slate-leaf="true" data-offset-key="4121:0" data-first-offset="true"><span data-slate-string="true">, __WCLONE | __WALL);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4122"><span data-slate-object="text" data-key="4123"><span data-slate-leaf="true" data-offset-key="4123:0" data-first-offset="true"><span data-slate-string="true">                </span></span></span><span data-slate-object="text" data-key="4124"><span data-slate-leaf="true" data-offset-key="4124:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="4125"><span data-slate-leaf="true" data-offset-key="4125:0" data-first-offset="true"><span data-slate-string="true"> (w == </span></span></span><span data-slate-object="text" data-key="4126"><span data-slate-leaf="true" data-offset-key="4126:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-1</span></span></span></span><span data-slate-object="text" data-key="4127"><span data-slate-leaf="true" data-offset-key="4127:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4128"><span data-slate-object="text" data-key="4129"><span data-slate-leaf="true" data-offset-key="4129:0" data-first-offset="true"><span data-slate-string="true">                    </span></span></span><span data-slate-object="text" data-key="4130"><span data-slate-leaf="true" data-offset-key="4130:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">perror</span></span></span></span><span data-slate-object="text" data-key="4131"><span data-slate-leaf="true" data-offset-key="4131:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4132"><span data-slate-leaf="true" data-offset-key="4132:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"waitpid"</span></span></span></span><span data-slate-object="text" data-key="4133"><span data-slate-leaf="true" data-offset-key="4133:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4134"><span data-slate-object="text" data-key="4135"><span data-slate-leaf="true" data-offset-key="4135:0" data-first-offset="true"><span data-slate-string="true">                    </span></span></span><span data-slate-object="text" data-key="4136"><span data-slate-leaf="true" data-offset-key="4136:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">goto</span></span></span></span><span data-slate-object="text" data-key="4137"><span data-slate-leaf="true" data-offset-key="4137:0" data-first-offset="true"><span data-slate-string="true"> error;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4138"><span data-slate-object="text" data-key="4139"><span data-slate-leaf="true" data-offset-key="4139:0" data-first-offset="true"><span data-slate-string="true">                }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4140"><span data-slate-object="text" data-key="4141"><span data-slate-leaf="true" data-offset-key="4141:0" data-first-offset="true"><span data-slate-string="true">            } </span></span></span><span data-slate-object="text" data-key="4142"><span data-slate-leaf="true" data-offset-key="4142:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">while</span></span></span></span><span data-slate-object="text" data-key="4143"><span data-slate-leaf="true" data-offset-key="4143:0" data-first-offset="true"><span data-slate-string="true"> (!</span></span></span><span data-slate-object="text" data-key="4144"><span data-slate-leaf="true" data-offset-key="4144:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">WIFEXITED</span></span></span></span><span data-slate-object="text" data-key="4145"><span data-slate-leaf="true" data-offset-key="4145:0" data-first-offset="true"><span data-slate-string="true">(status) &amp;&amp; !</span></span></span><span data-slate-object="text" data-key="4146"><span data-slate-leaf="true" data-offset-key="4146:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">WIFSIGNALED</span></span></span></span><span data-slate-object="text" data-key="4147"><span data-slate-leaf="true" data-offset-key="4147:0" data-first-offset="true"><span data-slate-string="true">(status));</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4148"><span data-slate-object="text" data-key="4149"><span data-slate-leaf="true" data-offset-key="4149:0" data-first-offset="true"><span data-slate-string="true">        }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4150"><span data-slate-object="text" data-key="4151"><span data-slate-leaf="true" data-offset-key="4151:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="4152"><span data-slate-leaf="true" data-offset-key="4152:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sleep</span></span></span></span><span data-slate-object="text" data-key="4153"><span data-slate-leaf="true" data-offset-key="4153:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="4154"><span data-slate-leaf="true" data-offset-key="4154:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">10</span></span></span></span><span data-slate-object="text" data-key="4155"><span data-slate-leaf="true" data-offset-key="4155:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4156"><span data-slate-object="text" data-key="4157"><span data-slate-leaf="true" data-offset-key="4157:0" data-first-offset="true"><span data-slate-string="true">   }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4158"></div><div data-slate-type="code-line" data-slate-object="block" data-key="4159"><span data-slate-object="text" data-key="4160"><span data-slate-leaf="true" data-offset-key="4160:0" data-first-offset="true"><span data-slate-string="true"> error:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4161"><span data-slate-object="text" data-key="4162"><span data-slate-leaf="true" data-offset-key="4162:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="4163"><span data-slate-leaf="true" data-offset-key="4163:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="4164"><span data-slate-leaf="true" data-offset-key="4164:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="4165"><span data-slate-leaf="true" data-offset-key="4165:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="4166"><span data-slate-leaf="true" data-offset-key="4166:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4167"><span data-slate-object="text" data-key="4168"><span data-slate-leaf="true" data-offset-key="4168:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="4169"><span data-slate-object="text" data-key="4170"><span data-slate-leaf="true" data-offset-key="4170:0" data-first-offset="true"><span data-slate-string="true">然后我们用 pidstat 观察该进程的执行，可以发现它的现象跟生产环境中的问题是一致的：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="4171"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="4172"><span data-slate-object="text" data-key="4173"><span data-slate-leaf="true" data-offset-key="4173:0" data-first-offset="true"><span data-slate-string="true">$ pidstat -r -p 535 5</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4174"><span data-slate-object="text" data-key="4175"><span data-slate-leaf="true" data-offset-key="4175:0" data-first-offset="true"><span data-slate-string="true">11:56:51 PM   UID       PID  minflt/s  majflt/s     VSZ    RSS   %MEM  Command</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4176"><span data-slate-object="text" data-key="4177"><span data-slate-leaf="true" data-offset-key="4177:0" data-first-offset="true"><span data-slate-string="true">11:56:56 PM     0       535      0.20      0.00    4364    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4178"><span data-slate-object="text" data-key="4179"><span data-slate-leaf="true" data-offset-key="4179:0" data-first-offset="true"><span data-slate-string="true">11:57:01 PM     0       535      0.00      0.00    4364    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4180"><span data-slate-object="text" data-key="4181"><span data-slate-leaf="true" data-offset-key="4181:0" data-first-offset="true"><span data-slate-string="true">11:57:06 PM     0       535      0.20      0.00    4404    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4182"><span data-slate-object="text" data-key="4183"><span data-slate-leaf="true" data-offset-key="4183:0" data-first-offset="true"><span data-slate-string="true">11:57:11 PM     0       535      0.00      0.00    4404    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4184"><span data-slate-object="text" data-key="4185"><span data-slate-leaf="true" data-offset-key="4185:0" data-first-offset="true"><span data-slate-string="true">11:57:16 PM     0       535      0.20      0.00    4444    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4186"><span data-slate-object="text" data-key="4187"><span data-slate-leaf="true" data-offset-key="4187:0" data-first-offset="true"><span data-slate-string="true">11:57:21 PM     0       535      0.00      0.00    4444    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4188"><span data-slate-object="text" data-key="4189"><span data-slate-leaf="true" data-offset-key="4189:0" data-first-offset="true"><span data-slate-string="true">11:57:26 PM     0       535      0.20      0.00    4484    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4190"><span data-slate-object="text" data-key="4191"><span data-slate-leaf="true" data-offset-key="4191:0" data-first-offset="true"><span data-slate-string="true">11:57:31 PM     0       535      0.00      0.00    4484    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4192"><span data-slate-object="text" data-key="4193"><span data-slate-leaf="true" data-offset-key="4193:0" data-first-offset="true"><span data-slate-string="true">11:57:36 PM     0       535      0.20      0.00    4524    360   0.00  a.out</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4194"><span data-slate-object="text" data-key="4195"><span data-slate-leaf="true" data-offset-key="4195:0" data-first-offset="true"><span data-slate-string="true">^C</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="4196"><span data-slate-object="text" data-key="4197"><span data-slate-leaf="true" data-offset-key="4197:0" data-first-offset="true"><span data-slate-string="true">Average:        0       535      0.11      0.00    4435    360   0.00  a.out</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="4198"><span data-slate-object="text" data-key="4199"><span data-slate-leaf="true" data-offset-key="4199:0" data-first-offset="true"><span data-slate-string="true">你可以看到，VSZ 每 10s 增大 40K，但是增加的那个线程只存在了 1s 就消失了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="4200"><span data-slate-object="text" data-key="4201"><span data-slate-leaf="true" data-offset-key="4201:0" data-first-offset="true"><span data-slate-string="true">至此我们就可以推断出 app_server 的代码哪里有问题了，然后小伙伴去修复该代码 Bug，很快就把该问题给解决了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="4202"><span data-slate-object="text" data-key="4203"><span data-slate-leaf="true" data-offset-key="4203:0" data-first-offset="true"><span data-slate-string="true">当然了，应用程序的内存泄漏问题其实是千奇百怪的，分析方法也不尽相同，我们讲述这个案例的目的是为了告诉你一些通用的分析技巧。我们掌握了这些通用分析技巧，很多时候就可以以不变来应万变了。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="4204" id="sr-toc-3"><span data-slate-object="text" data-key="4205"><span data-slate-leaf="true" data-offset-key="4205:0" data-first-offset="true"><span data-slate-string="true">课堂总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="4206"><span data-slate-object="text" data-key="4207"><span data-slate-leaf="true" data-offset-key="4207:0" data-first-offset="true"><span data-slate-string="true">这节课我们讲述了系统性分析 Linux 上内存泄漏问题的分析方法，要点如下：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="4208"><div data-slate-type="list-line" data-slate-object="block" data-key="4209"><span data-slate-object="text" data-key="4210"><span data-slate-leaf="true" data-offset-key="4210:0" data-first-offset="true"><span data-slate-string="true">top 工具和 /proc/meminfo 文件是分析 Linux 上内存泄漏问题，甚至是所有内存问题的第一步，我们先找出来哪个进程或者哪一项有异常，然后再针对性地分析；</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="4211"><span data-slate-object="text" data-key="4212"><span data-slate-leaf="true" data-offset-key="4212:0" data-first-offset="true"><span data-slate-string="true">应用程序的内存泄漏千奇百怪，所以你需要掌握一些通用的分析技巧，掌握了这些技巧很多时候就可以以不变应万变。但是，这些技巧的掌握，是建立在你的基础知识足够扎实的基础上。你需要熟练掌握我们这个系列课程讲述的这些基础知识，熟才能生巧。</span></span></span></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="4213" id="sr-toc-4"><span data-slate-object="text" data-key="4214"><span data-slate-leaf="true" data-offset-key="4214:0" data-first-offset="true"><span data-slate-string="true">课后作业</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="4215"><span data-slate-object="text" data-key="4216"><span data-slate-leaf="true" data-offset-key="4216:0" data-first-offset="true"><span data-slate-string="true">请写一个内存泄漏的程序，然后观察 /proc/[pid]/maps 以及 smaps 的变化（pid 即内存泄漏的程序的 pid）。欢迎你在留言区与我讨论。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="4217"><span data-slate-object="text" data-key="4218"><span data-slate-leaf="true" data-offset-key="4218:0" data-first-offset="true"><span data-slate-string="true">感谢你的阅读，如果你认为这节课的内容有收获，也欢迎把它分享给你的朋友，我们下一讲见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/2f/9a/2fc09f38e9fa11dc530cb3580fdfcc9a.png" style="width: auto;"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-5">精选留言 (11)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1b/30/85/14c2f16c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>石小</span></div></div><div>“对于有经验的开发者而言，从这个 4K 的保护页就可以猜测出应该跟线程栈有关了。” 请问老师怎么理解这局话？</div><div><p>作者回复：这是为了防止栈溢出问题，当线程栈溢出后，就会写这个保护页，进而出发 segfault。</p></div><div><div>2021-04-08</div><div><div><i></i></div><div><i></i><span>10</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/account/avatar/00/16/12/5e/77b67a85.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 飘云</span></div></div><div>写应用层代码的时候会用到 clone 么，不都用 pthread 么？ 用 pthread 不会出现例子中的问题吧。 
另外，内存泄露很多时候是 malloc 了内存但是没有 free，有什么好的方法快速定位是哪儿分配的内存忘了 free 呢？</div><div><p>作者回复: pthread_create 的时候可能会调用 clone，clone 是一个系统调用，pthread 是 lib 库，库函数其实是对系统调用的封装。
物理内存泄露并没有什么高效的分析方式，只能通过追踪 malloc/free 来看在哪里申请的没有去释放。</p></div><div><div>2020-10-30</div><div><div><i></i><span>2</span></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Richard</span></div></div><div>老师好，这个案例讲的是虚拟内存泄露，我想问一下：虚拟内存分配后在使用前不会真正的分配物理内存，那这个案例是不是仅仅是进程的虚拟内存存在问题？整个 Linux 系统的内存应该没有异常对不对？</div><div><p>作者回复：对的 只是虚拟地址空间产生了问题 实际的物理内存并没有问题 整个系统的内存并没有异常</p></div><div><div>2020-10-29</div><div><div><i></i></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epUBQibdMCca340MFZOe5I1GwZ0PosPIzA0TPCNzibgH00w45Zmv4jmL0mFRHMUM9FuKiclKOCBjSmsw/132"></div></div><div><div><div><span>Geek_circle</span></div></div><div>老师好，当系统内存不足，发现 kswapd0 进程持续运行，使用率超过 90% 多，load 过百，但是系统日志中并没有记录到 oom killer 。想知道系统内存不足时，启动 kswapd 和 oom killer 条件和优先级是什么样的呢？</div><div><p>作者回复：内存水位不足后就会唤醒 kswapd 来回收内存，如果 kswapd 可以回收内存并且内存水位持续高，kswapd 就会一直忙，它的使用率就会高。只有在回收不到内存的情况下，才会触发 oom killer 来杀进程。
你说的这种情况就是可以回收到内存，但是回收比较困难 所以才产生这种情况。</p></div><div><div>2020-09-13</div><div><div><i></i></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>jssfy</span></div></div><div>问题分析过程很赞，开头的总结性图表也很赞！</div><div><div>2020-09-13</div><div><div><i></i><span></span></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTINb3EmV5q6ytNWclxke1OicbEAw4ZSmibSCrNGZPDCnAjsGDwG3jJQcuEwAcFRffBQouXFEaERQbfw/132"></div></div><div><div><div><span>dpzain</span></div></div><div>现在生产环境 是 jvm 程序 跑在 docker 容器， jvm 堆内内存 监控一切正常，但是每隔半个月 mem 从 50% 到 90% ，按照上面的方法发现确实有对外内存在缓慢的泄漏   非常慢（没 5s - 20s 增加几 kb 甚至  几十个 byte ）找不出任何规律 怎么破；</div><div><p>作者回复: jvm 堆外内存泄漏，在明确哪些任务在泄漏内存后，最好能否结合代码来进行打点追踪，看看哪里有问题。</p></div><div><div>2020-11-24</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/16/cd/db/7467ad23.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Bachue Zhou</span></div></div><div>不太懂，smaps 的内容这么多，如何找到出问题的部分？是多次 cat smaps 然后做 diff 吗？</div><div><div>2022-06-05</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAWUhO0xSjD6wbGScY5WOujAE94vNYWlWmsVdibb0IWbXzSSNXJHp0lqfWVq8ZicKBsEY1EuAWArew/132"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Felix</span></div></div><div>真是读书万卷，其意自现</div><div><div>2022-05-17</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/ed/91/1d332031.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>我能走多远</span></div></div><div>对底层的基础理论不牢靠，原来定位问题有这么多的方法。学习了</div><div><div>2020-11-07</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/5e/96/a03175bc.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>莫名</span></div></div><div>赞，之前有过比较类似的排查思路。</div><div><div>2020-10-22</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/1PyKtnO7QRIP8mlcGNu4wpYVjOo6ZZ7pNIxbmRSYK0KvbcXPVcsiba4ibo1GTjQrRYibiaPxrrTPtlGnzoDEP7tDBQ/132"></div></div><div><div><div><span>ermaot</span></div></div><div>曲径通幽，豁然开朗。基础要扎实，但工具也要熟啊</div><div><div>2020-09-10</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".v"><outline class="toc-level-h1" data-reactid=".v.0" style="width: 175px;"><active data-reactid=".v.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".v.0.1"><span data-reactid=".v.0.1.0">10 分析篇 | 内存泄漏时，我们该如何一步步找到根因？</span></a></outline><outline class="toc-level-h2" data-reactid=".v.1" style="width: 165px;"><active data-reactid=".v.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".v.1.1"><span data-reactid=".v.1.1.0">如何定位出是谁在消耗内存 ？</span></a></outline><outline class="toc-level-h2" data-reactid=".v.2" style="width: 165px;"><active data-reactid=".v.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".v.2.1"><span data-reactid=".v.2.1.0">如何去分析进程的内存泄漏原因？</span></a></outline><outline class="toc-level-h2" data-reactid=".v.3" style="width: 165px;"><active data-reactid=".v.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".v.3.1"><span data-reactid=".v.3.1.0">课堂总结</span></a></outline><outline class="toc-level-h2" data-reactid=".v.4" style="width: 165px;"><active data-reactid=".v.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".v.4.1"><span data-reactid=".v.4.1.0">课后作业</span></a></outline><outline class="toc-level-h2" data-reactid=".v.5" style="width: 165px;"><active data-reactid=".v.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".v.5.1"><span data-reactid=".v.5.1.0">精选留言 (11)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/283787" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>