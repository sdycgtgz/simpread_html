
                <html lang="en" class="simpread-font simpread-theme-root" style='undefined'>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 20 | Hive + Spark 强强联合：分布式数仓的不二之选</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>20 | Hive + Spark 强强联合：分布式数仓的不二之选</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">今天咱们说一说与 Spark SQL 有关的那些重要配置项。</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0">20 | Hive + Spark 强强联合：分布式数仓的不二之选</h1><div><span>吴磊</span> <span> 2021-10-25</span></div><div><div><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/b5/db/b5a0a6b149cb1f873d5579c4b1391fdb.jpg" style="width: auto;"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：吴磊</span><span>大小：22.04M</span><span> 时长：24:08</span></div></div><audio title="20 | Hive + Spark强强联合：分布式数仓的不二之选" src="https://res001.geekbang.org/media/audio/e4/42/e463c83e689ebb162784285cbe57ed42/ld/ld.m3u8" __idm_id__="1622018"></audio></div><div><div><div><div data-slate-editor="true" data-key="284" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="285"><span data-slate-object="text" data-key="286"><span data-slate-leaf="true" data-offset-key="286:0" data-first-offset="true"><span data-slate-string="true">你好，我是吴磊。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="287"><span data-slate-object="text" data-key="288"><span data-slate-leaf="true" data-offset-key="288:0" data-first-offset="true"><span data-slate-string="true">在数据源与数据格式，以及数据转换那两讲（第 15、16 讲），我们介绍了在 Spark SQL 之上做数据分析应用开发的一般步骤。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="289"><span data-slate-object="text" data-key="290"><span data-slate-leaf="true" data-offset-key="290:0" data-first-offset="true"><span data-slate-string="true">这里我们简单回顾一下：首先，我们通过 SparkSession read API 从分布式文件系统创建 DataFrame。然后，通过创建临时表并使用 SQL 语句，或是直接使用 DataFrame API，来进行各式各样的数据转换、过滤、聚合等操作。最后，我们再用 SparkSession 的 write API 把计算结果写回分布式文件系统。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="291"><span data-slate-object="text" data-key="292"><span data-slate-leaf="true" data-offset-key="292:0" data-first-offset="true"><span data-slate-string="true">实际上，直接与文件系统交互，仅仅是 Spark SQL 数据应用的常见场景之一。Spark SQL 另一类非常典型的场景是与 Hive 做集成、构建分布式数据仓库。我们知道，数据仓库指的是一类带有主题、聚合层次较高的数据集合，它的承载形式，往往是一系列 Schema 经过精心设计的数据表。在数据分析这类场景中，数据仓库的应用非常普遍。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="293"><span data-slate-object="text" data-key="294"><span data-slate-leaf="true" data-offset-key="294:0" data-first-offset="true"><span data-slate-string="true">在 Hive 与 Spark 这对 “万金油” 组合中，Hive 擅长元数据管理，而 Spark 的专长是高效的分布式计算，二者的结合可谓是 “强强联合”。今天这一讲，我们就来聊一聊 Spark 与 Hive 集成的两类方式，一类是从 Spark 的视角出发，我们称之为 Spark with Hive；而另一类，则是从 Hive 的视角出发，业界的通俗说法是：Hive on Spark。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="295" id="sr-toc-1"><span data-slate-object="text" data-key="296"><span data-slate-leaf="true" data-offset-key="296:0" data-first-offset="true"><span data-slate-string="true">Hive 架构与基本原理</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="297"><span data-slate-object="text" data-key="298"><span data-slate-leaf="true" data-offset-key="298:0" data-first-offset="true"><span data-slate-string="true">磨刀不误砍柴工，在讲解这两类集成方式之前，我们不妨先花点时间，来了解一下 Hive 的架构和工作原理，避免不熟悉 Hive 的同学听得云里雾里。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="299"><span data-slate-object="text" data-key="300"><span data-slate-leaf="true" data-offset-key="300:0" data-first-offset="true"><span data-slate-string="true">Hive 是 Apache Hadoop 社区用于构建数据仓库的核心组件，它负责提供种类丰富的用户接口，接收用户提交的 SQL 查询语句。这些查询语句经过 Hive 的解析与优化之后，往往会被转化为分布式任务，并交付 Hadoop MapReduce 付诸执行。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="301"><span data-slate-object="text" data-key="302"><span data-slate-leaf="true" data-offset-key="302:0" data-first-offset="true"><span data-slate-string="true">Hive 是名副其实的 “集大成者”，它的核心部件，其实主要是 User Interface（1）和 Driver（3）。而不论是元数据库（4）、存储系统（5），还是计算引擎（6），Hive 都以 “外包”、“可插拔” 的方式交给第三方独立组件，所谓 “把专业的事交给专业的人去做”，如下图所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="303"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/ef/2e/ef0925c39f5b0534d2143yye8b7b8e2e.jpg?wh=1920x1239"></div><div>Hive 架构</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="304"><span data-slate-object="text" data-key="305"><span data-slate-leaf="true" data-offset-key="305:0" data-first-offset="true"><span data-slate-string="true">Hive 的 User Interface 为开发者提供 SQL 接入服务，具体的接入途径有 Hive Server 2（2）、CLI 和 Web Interface（Web 界面入口）。其中，CLI 与 Web Interface 直接在本地接收 SQL 查询语句，而 Hive Server 2 则通过提供 JDBC/ODBC 客户端连接，允许开发者从远程提交 SQL 查询请求。显然，Hive Server 2 的接入方式更为灵活，应用也更为广泛。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="306"><span data-slate-object="text" data-key="307"><span data-slate-leaf="true" data-offset-key="307:0" data-first-offset="true"><span data-slate-string="true">我们以响应一个 SQL 查询为例，看一看 Hive 是怎样工作的。接收到 SQL 查询之后，Hive 的 Driver 首先使用其 Parser 组件，将查询语句转化为 AST（Abstract Syntax Tree，查询语法树）。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="308"><span data-slate-object="text" data-key="309"><span data-slate-leaf="true" data-offset-key="309:0" data-first-offset="true"><span data-slate-string="true">紧接着，Planner 组件根据 AST 生成执行计划，而 Optimizer 则进一步优化执行计划。要完成这一系列的动作，Hive 必须要能拿到相关数据表的元信息才行，比如表名、列名、字段类型、数据文件存储路径、文件格式，等等。而这些重要的元信息，通通存储在一个叫作 “Hive Metastore”（4）的数据库中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="310"><span data-slate-object="text" data-key="311"><span data-slate-leaf="true" data-offset-key="311:0" data-first-offset="true"><span data-slate-string="true">本质上，Hive Metastore 其实就是一个普通的关系型数据库（RDBMS），它可以是免费的 MySQL、Derby，也可以是商业性质的 Oracle、IBM DB2。实际上，除了用于辅助 SQL 语法解析、执行计划的生成与优化，</span></span></span><span data-slate-object="text" data-key="312"><span data-slate-leaf="true" data-offset-key="312:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Metastore 的重要作用之一，是帮助底层计算引擎高效地定位并访问分布式文件系统中的数据源</span></span></span></span><span data-slate-object="text" data-key="313"><span data-slate-leaf="true" data-offset-key="313:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="314"><span data-slate-object="text" data-key="315"><span data-slate-leaf="true" data-offset-key="315:0" data-first-offset="true"><span data-slate-string="true">这里的分布式文件系统，可以是 Hadoop 生态的 HDFS，也可以是云原生的 Amazon S3。而在执行方面，Hive 目前支持 3 类计算引擎，分别是 Hadoop MapReduce、Tez 和 Spark。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="316"><span data-slate-object="text" data-key="317"><span data-slate-leaf="true" data-offset-key="317:0" data-first-offset="true"><span data-slate-string="true">当 Hive 采用 Spark 作为底层的计算引擎时，我们就把这种集成方式称作 “Hive on Spark”。相反，当 Spark 仅仅是把 Hive 当成是一种元信息的管理工具时，我们把 Spark 与 Hive 的这种集成方式，叫作 “Spark with Hive”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="318"><span data-slate-object="text" data-key="319"><span data-slate-leaf="true" data-offset-key="319:0" data-first-offset="true"><span data-slate-string="true">你可能会觉得很困惑：“这两种说法听上去差不多嘛，两种集成方式，到底有什么本质的不同呢？” 接下来，我们就按照 “先易后难” 的顺序，先来说说 “Spark with Hive” 这种集成方式，然后再去介绍 “Hive on Spark”。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="320" id="sr-toc-2"><span data-slate-object="text" data-key="321"><span data-slate-leaf="true" data-offset-key="321:0" data-first-offset="true"><span data-slate-string="true">Spark with Hive</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="322"><span data-slate-object="text" data-key="323"><span data-slate-leaf="true" data-offset-key="323:0" data-first-offset="true"><span data-slate-string="true">在开始正式学习 Spark with Hive 之前，我们先来说说这类集成方式的核心思想。前面我们刚刚说过，Hive Metastore 利用 RDBMS 来存储数据表的元信息，如表名、表类型、表数据的 Schema、表（分区）数据的存储路径、以及存储格式，等等。形象点说，Metastore 就像是 “户口簿”，它记录着分布式文件系统中每一份数据集的 “底细”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="324"><span data-slate-object="text" data-key="325"><span data-slate-leaf="true" data-offset-key="325:0" data-first-offset="true"><span data-slate-string="true">Spark SQL 通过访问 Hive Metastore 这本 “户口簿”，即可扩充数据访问来源。而这，就是 Spark with Hive 集成方式的核心思想。直白点说，在这种集成模式下，Spark 是主体，Hive Metastore 不过是 Spark 用来扩充数据来源的辅助工具。厘清 Spark 与 Hive 的关系，有助于我们后面区分 Hive on Spark 与 Spark with Hive 之间的差异。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="326"><span data-slate-object="text" data-key="327"><span data-slate-leaf="true" data-offset-key="327:0" data-first-offset="true"><span data-slate-string="true">作为开发者，我们可以通过 </span></span></span><span data-slate-object="text" data-key="328"><span data-slate-leaf="true" data-offset-key="328:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">3 种途径</span></span></span></span><span data-slate-object="text" data-key="329"><span data-slate-leaf="true" data-offset-key="329:0" data-first-offset="true"><span data-slate-string="true">来实现 Spark with Hive 的集成方式，它们分别是：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="330"><div data-slate-type="list-line" data-slate-object="block" data-key="331"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="332"><span data-slate-leaf="true" data-offset-key="332:0" data-first-offset="true"><span data-slate-string="true">创建 SparkSession，访问本地或远程的 Hive Metastore；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="333"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="334"><span data-slate-leaf="true" data-offset-key="334:0" data-first-offset="true"><span data-slate-string="true">通过 Spark 内置的 spark-sql CLI，访问本地 Hive Metastore；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="335"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="336"><span data-slate-leaf="true" data-offset-key="336:0" data-first-offset="true"><span data-slate-string="true">通过 Beeline 客户端，访问 Spark Thrift Server。</span></span></span></div></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="337" id="sr-toc-3"><span data-slate-object="text" data-key="338"><span data-slate-leaf="true" data-offset-key="338:0" data-first-offset="true"><span data-slate-string="true">SparkSession + Hive Metastore</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="339"><span data-slate-object="text" data-key="340"><span data-slate-leaf="true" data-offset-key="340:0" data-first-offset="true"><span data-slate-string="true">为了更好地理解 Hive 与 Spark 的关系，我们先从第一种途径，也就是通过 SparkSession 访问 Hive Metastore 说起。首先，我们使用如下命令来启动 Hive Metastore。</span></span></span></div><div data-code-language="sql" data-slate-type="pre" data-slate-object="block" data-key="341"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="342"><span data-slate-object="text" data-key="343"><span data-slate-leaf="true" data-offset-key="343:0" data-first-offset="true"><span data-slate-string="true">hive </span></span></span><span data-slate-object="text" data-key="344"><span data-slate-leaf="true" data-offset-key="344:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">--service metastore</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="345"><span data-slate-object="text" data-key="346"><span data-slate-leaf="true" data-offset-key="346:0" data-first-offset="true"><span data-slate-string="true">Hive Metastore 启动之后，我们需要让 Spark 知道 Metastore 的访问地址，也就是告诉他数据源的 “户口簿” 藏在什么地方。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="347"><span data-slate-object="text" data-key="348"><span data-slate-leaf="true" data-offset-key="348:0" data-first-offset="true"><span data-slate-string="true">要传递这个消息，我们有两种办法。一种是在创建 SparkSession 的时候，通过 config 函数来明确指定 hive.metastore.uris 参数。另一种方法是让 Spark 读取 Hive 的配置文件 hive-site.xml，该文件记录着与 Hive 相关的各种配置项，其中就包括 hive.metastore.uris 这一项。把 hive-site.xml 拷贝到 Spark 安装目录下的 conf 子目录，Spark 即可自行读取其中的配置内容。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="349"><span data-slate-object="text" data-key="350"><span data-slate-leaf="true" data-offset-key="350:0" data-first-offset="true"><span data-slate-string="true">接下来，我们通过一个小例子，来演示第一种用法。假设 Hive 中有一张名为 “salaries” 的薪资表，每条数据都包含 id 和 salary 两个字段，表数据存储在 HDFS，那么，在 spark-shell 中敲入下面的代码，我们即可轻松访问 Hive 中的数据表。</span></span></span></div><div data-code-language="javascript" data-slate-type="pre" data-slate-object="block" data-key="351"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="352"><span data-slate-object="text" data-key="353"><span data-slate-leaf="true" data-offset-key="353:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="354"><span data-slate-leaf="true" data-offset-key="354:0" data-first-offset="true"><span data-slate-string="true"> org.</span></span></span><span data-slate-object="text" data-key="355"><span data-slate-leaf="true" data-offset-key="355:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">apache</span></span></span></span><span data-slate-object="text" data-key="356"><span data-slate-leaf="true" data-offset-key="356:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="357"><span data-slate-leaf="true" data-offset-key="357:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">spark</span></span></span></span><span data-slate-object="text" data-key="358"><span data-slate-leaf="true" data-offset-key="358:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="359"><span data-slate-leaf="true" data-offset-key="359:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sql</span></span></span></span><span data-slate-object="text" data-key="360"><span data-slate-leaf="true" data-offset-key="360:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="361"><span data-slate-leaf="true" data-offset-key="361:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">SparkSession</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="362"><span data-slate-object="text" data-key="363"><span data-slate-leaf="true" data-offset-key="363:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="364"><span data-slate-leaf="true" data-offset-key="364:0" data-first-offset="true"><span data-slate-string="true">  org.</span></span></span><span data-slate-object="text" data-key="365"><span data-slate-leaf="true" data-offset-key="365:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">apache</span></span></span></span><span data-slate-object="text" data-key="366"><span data-slate-leaf="true" data-offset-key="366:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="367"><span data-slate-leaf="true" data-offset-key="367:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">spark</span></span></span></span><span data-slate-object="text" data-key="368"><span data-slate-leaf="true" data-offset-key="368:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="369"><span data-slate-leaf="true" data-offset-key="369:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sql</span></span></span></span><span data-slate-object="text" data-key="370"><span data-slate-leaf="true" data-offset-key="370:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="371"><span data-slate-leaf="true" data-offset-key="371:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">DataFrame</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="372"><span data-slate-object="text" data-key="373"><span data-slate-leaf="true" data-offset-key="373:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="374"><span data-slate-object="text" data-key="375"><span data-slate-leaf="true" data-offset-key="375:0" data-first-offset="true"><span data-slate-string="true">val </span></span></span><span data-slate-object="text" data-key="376"><span data-slate-leaf="true" data-offset-key="376:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">hiveHost</span></span></span></span><span data-slate-object="text" data-key="377"><span data-slate-leaf="true" data-offset-key="377:0" data-first-offset="true"><span data-slate-string="true">: </span></span></span><span data-slate-object="text" data-key="378"><span data-slate-leaf="true" data-offset-key="378:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">String</span></span></span></span><span data-slate-object="text" data-key="379"><span data-slate-leaf="true" data-offset-key="379:0" data-first-offset="true"><span data-slate-string="true"> = _</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="380"><span data-slate-object="text" data-key="381"><span data-slate-leaf="true" data-offset-key="381:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 创建 SparkSession 实例</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="382"><span data-slate-object="text" data-key="383"><span data-slate-leaf="true" data-offset-key="383:0" data-first-offset="true"><span data-slate-string="true">val spark = </span></span></span><span data-slate-object="text" data-key="384"><span data-slate-leaf="true" data-offset-key="384:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">SparkSession</span></span></span></span><span data-slate-object="text" data-key="385"><span data-slate-leaf="true" data-offset-key="385:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="386"><span data-slate-leaf="true" data-offset-key="386:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">builder</span></span></span></span><span data-slate-object="text" data-key="387"><span data-slate-leaf="true" data-offset-key="387:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="388"><span data-slate-object="text" data-key="389"><span data-slate-leaf="true" data-offset-key="389:0" data-first-offset="true"><span data-slate-string="true">                   .</span></span></span><span data-slate-object="text" data-key="390"><span data-slate-leaf="true" data-offset-key="390:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">config</span></span></span></span><span data-slate-object="text" data-key="391"><span data-slate-leaf="true" data-offset-key="391:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="392"><span data-slate-leaf="true" data-offset-key="392:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"hive.metastore.uris"</span></span></span></span><span data-slate-object="text" data-key="393"><span data-slate-leaf="true" data-offset-key="393:0" data-first-offset="true"><span data-slate-string="true">, s</span></span></span><span data-slate-object="text" data-key="394"><span data-slate-leaf="true" data-offset-key="394:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"thrift://hiveHost:9083"</span></span></span></span><span data-slate-object="text" data-key="395"><span data-slate-leaf="true" data-offset-key="395:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="396"><span data-slate-object="text" data-key="397"><span data-slate-leaf="true" data-offset-key="397:0" data-first-offset="true"><span data-slate-string="true">                   .</span></span></span><span data-slate-object="text" data-key="398"><span data-slate-leaf="true" data-offset-key="398:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">enableHiveSupport</span></span></span></span><span data-slate-object="text" data-key="399"><span data-slate-leaf="true" data-offset-key="399:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="400"><span data-slate-object="text" data-key="401"><span data-slate-leaf="true" data-offset-key="401:0" data-first-offset="true"><span data-slate-string="true">                   .</span></span></span><span data-slate-object="text" data-key="402"><span data-slate-leaf="true" data-offset-key="402:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">getOrCreate</span></span></span></span><span data-slate-object="text" data-key="403"><span data-slate-leaf="true" data-offset-key="403:0" data-first-offset="true"><span data-slate-string="true">()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="404"><span data-slate-object="text" data-key="405"><span data-slate-leaf="true" data-offset-key="405:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="406"><span data-slate-object="text" data-key="407"><span data-slate-leaf="true" data-offset-key="407:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 读取 Hive 表，创建 DataFrame</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="408"><span data-slate-object="text" data-key="409"><span data-slate-leaf="true" data-offset-key="409:0" data-first-offset="true"><span data-slate-string="true">val </span></span></span><span data-slate-object="text" data-key="410"><span data-slate-leaf="true" data-offset-key="410:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">df</span></span></span></span><span data-slate-object="text" data-key="411"><span data-slate-leaf="true" data-offset-key="411:0" data-first-offset="true"><span data-slate-string="true">: </span></span></span><span data-slate-object="text" data-key="412"><span data-slate-leaf="true" data-offset-key="412:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">DataFrame</span></span></span></span><span data-slate-object="text" data-key="413"><span data-slate-leaf="true" data-offset-key="413:0" data-first-offset="true"><span data-slate-string="true"> = spark.</span></span></span><span data-slate-object="text" data-key="414"><span data-slate-leaf="true" data-offset-key="414:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">sql</span></span></span></span><span data-slate-object="text" data-key="415"><span data-slate-leaf="true" data-offset-key="415:0" data-first-offset="true"><span data-slate-string="true">(“select * </span></span></span><span data-slate-object="text" data-key="416"><span data-slate-leaf="true" data-offset-key="416:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">from</span></span></span></span><span data-slate-object="text" data-key="417"><span data-slate-leaf="true" data-offset-key="417:0" data-first-offset="true"><span data-slate-string="true"> salaries”)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="418"><span data-slate-object="text" data-key="419"><span data-slate-leaf="true" data-offset-key="419:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="420"><span data-slate-object="text" data-key="421"><span data-slate-leaf="true" data-offset-key="421:0" data-first-offset="true"><span data-slate-string="true">df.</span></span></span><span data-slate-object="text" data-key="422"><span data-slate-leaf="true" data-offset-key="422:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">show</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="423"><span data-slate-object="text" data-key="424"><span data-slate-leaf="true" data-offset-key="424:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="425"><span data-slate-object="text" data-key="426"><span data-slate-leaf="true" data-offset-key="426:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">/** 结果打印</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="427"><span data-slate-object="text" data-key="428"><span data-slate-leaf="true" data-offset-key="428:0" data-first-offset="true"><span data-slate-string="true">+---+------+</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="429"><span data-slate-object="text" data-key="430"><span data-slate-leaf="true" data-offset-key="430:0" data-first-offset="true"><span data-slate-string="true">| id|salary|</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="431"><span data-slate-object="text" data-key="432"><span data-slate-leaf="true" data-offset-key="432:0" data-first-offset="true"><span data-slate-string="true">+---+------+</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="433"><span data-slate-object="text" data-key="434"><span data-slate-leaf="true" data-offset-key="434:0" data-first-offset="true"><span data-slate-string="true">|  1| 26000|</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="435"><span data-slate-object="text" data-key="436"><span data-slate-leaf="true" data-offset-key="436:0" data-first-offset="true"><span data-slate-string="true">|  2| 30000|</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="437"><span data-slate-object="text" data-key="438"><span data-slate-leaf="true" data-offset-key="438:0" data-first-offset="true"><span data-slate-string="true">|  4| 25000|</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="439"><span data-slate-object="text" data-key="440"><span data-slate-leaf="true" data-offset-key="440:0" data-first-offset="true"><span data-slate-string="true">|  3| 20000|</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="441"><span data-slate-object="text" data-key="442"><span data-slate-leaf="true" data-offset-key="442:0" data-first-offset="true"><span data-slate-string="true">+---+------+</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="443"><span data-slate-object="text" data-key="444"><span data-slate-leaf="true" data-offset-key="444:0" data-first-offset="true"><span data-slate-string="true">*/</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="445"><span data-slate-object="text" data-key="446"><span data-slate-leaf="true" data-offset-key="446:0" data-first-offset="true"><span data-slate-string="true">在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="447"><span data-slate-object="text" data-key="448"><span data-slate-leaf="true" data-offset-key="448:0" data-first-offset="true"><span data-slate-string="true">第 16 讲</span></span></span></a><span data-slate-object="text" data-key="449"><span data-slate-leaf="true" data-offset-key="449:0" data-first-offset="true"><span data-slate-string="true">，我们讲过利用 createTempView 函数从数据文件创建临时表的方法，临时表创建好之后，我们就可以使用 SparkSession 的 sql API 来提交 SQL 查询语句。连接到 Hive Metastore 之后，咱们就可以绕过第一步，直接使用 sql API 去访问 Hive 中现有的表，是不是很方便？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="450"><span data-slate-object="text" data-key="451"><span data-slate-leaf="true" data-offset-key="451:0" data-first-offset="true"><span data-slate-string="true">更重要的是，createTempView 函数创建的临时表，它的生命周期仅限于 Spark 作业内部，这意味着一旦作业执行完毕，临时表也就不复存在，没有办法被其他应用复用。Hive 表则不同，它们的元信息已经持久化到 Hive Metastore 中，不同的作业、应用、甚至是计算引擎，如 Spark、Presto、Impala，等等，都可以通过 Hive Metastore 来访问 Hive 表。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="452"><span data-slate-object="text" data-key="453"><span data-slate-leaf="true" data-offset-key="453:0" data-first-offset="true"><span data-slate-string="true">总结下来，在 SparkSession + Hive Metastore 这种集成方式中，Spark 对于 Hive 的访问，仅仅涉及到 Metastore 这一环节，对于 Hive 架构中的其他组件，Spark 并未触及。换句话说，在这种集成方式中，Spark 仅仅是 “白嫖” 了 Hive 的 Metastore，拿到数据集的元信息之后，Spark SQL 自行加载数据、自行处理，如下图所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="454"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/46/26/46932522eafc289c1093eb8543f81726.jpg?wh=1920x1192"></div><div>SparkSession + Hive Metastore 的集成方式</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="455"><span data-slate-object="text" data-key="456"><span data-slate-leaf="true" data-offset-key="456:0" data-first-offset="true"><span data-slate-string="true">在第一种集成方式下，通过 sql API，你可以直接提交复杂的 SQL 语句，也可以在创建 DataFrame 之后，再使用第 16 讲提到的各种算子去实现业务逻辑。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="457" id="sr-toc-4"><span data-slate-object="text" data-key="458"><span data-slate-leaf="true" data-offset-key="458:0" data-first-offset="true"><span data-slate-string="true">spark-sql CLI + Hive Metastore</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="459"><span data-slate-object="text" data-key="460"><span data-slate-leaf="true" data-offset-key="460:0" data-first-offset="true"><span data-slate-string="true">不过，你可能会说：“既然是搭建数仓，那么能不能像使用普通数据库那样，直接输入 SQL 查询，绕过 SparkSession 的 sql API 呢？”</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="461"><span data-slate-object="text" data-key="462"><span data-slate-leaf="true" data-offset-key="462:0" data-first-offset="true"><span data-slate-string="true">答案自然是肯定的，接下来，我们就来说说 Spark with Hive 的第二种集成方式：spark-sql CLI + Hive Metastore。与 spark-shell、spark-submit 类似，spark-sql 也是 Spark 内置的系统命令。将配置好 hive.metastore.uris 参数的 hive-site.xml 文件放到 Spark 安装目录的 conf 下，我们即可在 spark-sql 中直接使用 SQL 语句来查询或是处理 Hive 表。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="463"><span data-slate-object="text" data-key="464"><span data-slate-leaf="true" data-offset-key="464:0" data-first-offset="true"><span data-slate-string="true">显然，在这种集成模式下，Spark 和 Hive 的关系，与刚刚讲的 SparkSession + Hive Metastore 一样，本质上都是 Spark 通过 Hive Metastore 来扩充数据源。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="465"><span data-slate-object="text" data-key="466"><span data-slate-leaf="true" data-offset-key="466:0" data-first-offset="true"><span data-slate-string="true">不过，相比前者，spark-sql CLI 的集成方式多了一层限制，那就是在部署上，spark-sql CLI 与 Hive Metastore 必须安装在同一个计算节点。换句话说，</span></span><span data-slate-leaf="true" data-offset-key="466:1"><span data-slate-object="annotation" data-annotation-key="gkann_c314703c" data-attr-id="38268" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">spark-sql CLI 只能在本地访问 Hive Metastore，而没有办法通过远程的方式来做到这一点。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="467"><span data-slate-object="text" data-key="468"><span data-slate-leaf="true" data-offset-key="468:0" data-first-offset="true"><span data-slate-string="true">在绝大多数的工业级生产系统中，不同的大数据组件往往是单独部署的，Hive 与 Spark 也不例外。由于 Hive Metastore 可用于服务不同的计算引擎，如前面提到的 Presto、Impala，因此为了减轻节点的工作负载，Hive Metastore 往往会部署到一台相对独立的计算节点。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="469"><span data-slate-object="text" data-key="470"><span data-slate-leaf="true" data-offset-key="470:0" data-first-offset="true"><span data-slate-string="true">在这样的背景下，不得不说，spark-sql CLI 本地访问的限制，极大地削弱了它的适用场景，这也是 spark-sql CLI + Hive Metastore 这种集成方式几乎无人问津的根本原因。不过，这并不妨碍我们学习并了解它，这有助于我们对 Spark 与 Hive 之间的关系加深理解。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="471" id="sr-toc-5"><span data-slate-object="text" data-key="472"><span data-slate-leaf="true" data-offset-key="472:0" data-first-offset="true"><span data-slate-string="true">Beeline + Spark Thrift Server</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="473"><span data-slate-object="text" data-key="474"><span data-slate-leaf="true" data-offset-key="474:0" data-first-offset="true"><span data-slate-string="true">说到这里，你可能会追问：“既然 spark-sql CLI 有这样那样的限制，那么，还有没有其他集成方式，既能够部署到生产系统，又能让开发者写 SQL 查询呢？” 答案自然是 “有”，Spark with Hive 集成的第三种途径，就是使用 Beeline 客户端，去连接 Spark Thrift Server，从而完成 Hive 表的访问与处理。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="475"><span data-slate-object="text" data-key="476"><span data-slate-leaf="true" data-offset-key="476:0" data-first-offset="true"><span data-slate-string="true">Beeline 原本是 Hive 客户端，通过 JDBC 接入 Hive Server 2。Hive Server 2 可以同时服务多个客户端，从而提供多租户的 Hive 查询服务。由于 Hive Server 2 的实现采用了 Thrift RPC 协议框架，因此很多时候我们又把 Hive Server 2 称为 “Hive Thrift Server 2”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="477"><span data-slate-object="text" data-key="478"><span data-slate-leaf="true" data-offset-key="478:0" data-first-offset="true"><span data-slate-string="true">通过 Hive Server 2 接入的查询请求，经由 Hive Driver 的解析、规划与优化，交给 Hive 搭载的计算引擎付诸执行。相应地，查询结果再由 Hiver Server 2 返还给 Beeline 客户端，如下图右侧的虚线框所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="479"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/27/bb/272024a56b15938617c668b260453dbb.jpg?wh=1920x1126"></div><div>Beeline + Spark Thrift Server 的集成方式</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="480"><span data-slate-object="text" data-key="481"><span data-slate-leaf="true" data-offset-key="481:0" data-first-offset="true"><span data-slate-string="true">Spark Thrift Server 脱胎于 Hive Server 2，在接收查询、多租户服务、权限管理等方面，这两个服务端的实现逻辑几乎一模一样。它们最大的不同，在于 SQL 查询接入之后的解析、规划、优化与执行。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="482"><span data-slate-object="text" data-key="483"><span data-slate-leaf="true" data-offset-key="483:0" data-first-offset="true"><span data-slate-string="true">我们刚刚说过，Hive Server 2 的 “后台” 是 Hive 的那套基础架构。而 SQL 查询在接入到 Spark Thrift Server 之后，它首先会交由 Spark SQL 优化引擎进行一系列的优化。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="484"><span data-slate-object="text" data-key="485"><span data-slate-leaf="true" data-offset-key="485:0" data-first-offset="true"><span data-slate-string="true">在第 14 讲我们提过，借助于 Catalyst 与 Tungsten 这对 “左膀右臂”，Spark SQL 对 SQL 查询语句先后进行语法解析、语法树构建、逻辑优化、物理优化、数据结构优化、以及执行代码优化，等等。然后，Spark SQL 将优化过后的执行计划，交付给 Spark Core 执行引擎付诸运行。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="486"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/cb/fa/cbfdebe214a4d0f89ff1f4704e5913fa.jpg?wh=1920x849"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="487"><span data-slate-object="text" data-key="488"><span data-slate-leaf="true" data-offset-key="488:0" data-first-offset="true"><span data-slate-string="true">不难发现，SQL 查询在接入 Spark Thrift Server 之后的执行路径，与 DataFrame 在 Spark 中的执行路径是完全一致的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="489"><span data-slate-object="text" data-key="490"><span data-slate-leaf="true" data-offset-key="490:0" data-first-offset="true"><span data-slate-string="true">理清了 Spark Thrift Server 与 Hive Server 2 之间的区别与联系之后，接下来，我们来说说 Spark Thrift Server 的启动与 Beeline 的具体用法。要启动 Spark Thrift Server，我们只需调用 Spark 提供的 start-thriftserver.sh 脚本即可。</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="491"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="492"><span data-slate-object="text" data-key="493"><span data-slate-leaf="true" data-offset-key="493:0" data-first-offset="true"><span data-slate-string="true">// SPARK_HOME 环境变量，指向 Spark 安装目录</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="494"><span data-slate-object="text" data-key="495"><span data-slate-leaf="true" data-offset-key="495:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="496"><span data-slate-leaf="true" data-offset-key="496:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="497"><span data-slate-leaf="true" data-offset-key="497:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$SPARK_HOME</span></span></span></span><span data-slate-object="text" data-key="498"><span data-slate-leaf="true" data-offset-key="498:0" data-first-offset="true"><span data-slate-string="true">/sbin</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="499"><span data-slate-object="text" data-key="500"><span data-slate-leaf="true" data-offset-key="500:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="501"><span data-slate-object="text" data-key="502"><span data-slate-leaf="true" data-offset-key="502:0" data-first-offset="true"><span data-slate-string="true">// 启动 Spark Thrift Server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="503"><span data-slate-object="text" data-key="504"><span data-slate-leaf="true" data-offset-key="504:0" data-first-offset="true"><span data-slate-string="true">./start-thriftserver.sh</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="505"><span data-slate-object="text" data-key="506"><span data-slate-leaf="true" data-offset-key="506:0" data-first-offset="true"><span data-slate-string="true">脚本执行成功之后，Spark Thrift Server 默认在 10000 端口监听 JDBC/ODBC 的连接请求。有意思的是，关于监听端口的设置，Spark 复用了 Hive 的 hive.server2.thrift.port 参数。与其他的 Hive 参数一样，hive.server2.thrift.port 同样要在 hive-site.xml 配置文件中设置。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="507"><span data-slate-object="text" data-key="508"><span data-slate-leaf="true" data-offset-key="508:0" data-first-offset="true"><span data-slate-string="true">一旦 Spark Thrift Server 启动成功，我们就可以在任意节点上通过 Beeline 客户端来访问该服务。在客户端与服务端之间成功建立连接（Connections）之后，咱们就能在 Beeline 客户端使用 SQL 语句处理 Hive 表了。需要注意的是，在这种集成模式下，SQL 语句背后的优化与计算引擎是 Spark。</span></span></span></div><div data-code-language="shell" data-slate-type="pre" data-slate-object="block" data-key="509"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="510"><span data-slate-object="text" data-key="511"><span data-slate-leaf="true" data-offset-key="511:0" data-first-offset="true"><span data-slate-string="true">/**</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="512"><span data-slate-object="text" data-key="513"><span data-slate-leaf="true" data-offset-key="513:0" data-first-offset="true"><span data-slate-string="true">用 Beeline 客户端连接 Spark Thrift Server，</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="514"><span data-slate-object="text" data-key="515"><span data-slate-leaf="true" data-offset-key="515:0" data-first-offset="true"><span data-slate-string="true">其中，hostname 是 Spark Thrift Server 服务所在节点</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="516"><span data-slate-object="text" data-key="517"><span data-slate-leaf="true" data-offset-key="517:0" data-first-offset="true"><span data-slate-string="true">*/</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="518"><span data-slate-object="text" data-key="519"><span data-slate-leaf="true" data-offset-key="519:0" data-first-offset="true"><span data-slate-string="true">beeline -u “jdbc:hive2://hostname:10000”</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="520"><span data-slate-object="text" data-key="521"><span data-slate-leaf="true" data-offset-key="521:0" data-first-offset="true"><span data-slate-string="true">好啦，到此为止，Spark with Hive 这类集成方式我们就讲完了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="522"><span data-slate-object="text" data-key="523"><span data-slate-leaf="true" data-offset-key="523:0" data-first-offset="true"><span data-slate-string="true">为了巩固刚刚学过的内容，咱们趁热打铁，一起来做个简单的小结。</span></span></span><span data-slate-object="text" data-key="524"><span data-slate-leaf="true" data-offset-key="524:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">不论是 SparkSession + Hive Metastore、spark-sql CLI + Hive Metastore，还是 Beeline + Spark Thrift Server，Spark 扮演的角色都是执行引擎，而 Hive 的作用主要在于通过 Metastore 提供底层数据集的元数据。不难发现，在这类集成方式中，Spark 唱 “主角”，而 Hive 唱 “配角”</span></span></span></span><span data-slate-object="text" data-key="525"><span data-slate-leaf="true" data-offset-key="525:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="526" id="sr-toc-6"><span data-slate-object="text" data-key="527"><span data-slate-leaf="true" data-offset-key="527:0" data-first-offset="true"><span data-slate-string="true">Hive on Spark</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="528"><span data-slate-object="text" data-key="529"><span data-slate-leaf="true" data-offset-key="529:0" data-first-offset="true"><span data-slate-string="true">说到这里，你可能会好奇：“对于 Hive 社区与 Spark 社区来说，大家都是平等的，那么有没有 Hive 唱主角，而 Spark 唱配角的时候呢？” 还真有，这就是 Spark 与 Hive 集成的另一种形式：Hive on Spark。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="530" id="sr-toc-7"><span data-slate-object="text" data-key="531"><span data-slate-leaf="true" data-offset-key="531:0" data-first-offset="true"><span data-slate-string="true">基本原理</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="532"><span data-slate-object="text" data-key="533"><span data-slate-leaf="true" data-offset-key="533:0" data-first-offset="true"><span data-slate-string="true">在这一讲的开头，我们简单介绍了 Hive 的基础架构。Hive 的松耦合设计，使得它的 Metastore、底层文件系统、以及执行引擎都是可插拔、可替换的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="534"><span data-slate-object="text" data-key="535"><span data-slate-leaf="true" data-offset-key="535:0" data-first-offset="true"><span data-slate-string="true">在执行引擎方面，Hive 默认搭载的是 Hadoop MapReduce，但它同时也支持 Tez 和 Spark。所谓的 “Hive on Spark”，实际上指的就是 Hive 采用 Spark 作为其后端的分布式执行引擎，如下图所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="536"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/9e/2f/9e2cd8c611f8eb2238a0f759c782ae2f.jpg?wh=1920x1584"></div><div>Hive on Spark 系统架构</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="537"><span data-slate-object="text" data-key="538"><span data-slate-leaf="true" data-offset-key="538:0" data-first-offset="true"><span data-slate-string="true">从用户的视角来看，使用 Hive on MapReduce 或是 Hive on Tez 与使用 Hive on Spark 没有任何区别，执行引擎的切换对用户来说是完全透明的。不论 Hive 选择哪一种执行引擎，引擎仅仅负责任务的分布式计算，SQL 语句的解析、规划与优化，通通由 Hive 的 Driver 来完成。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="539"><span data-slate-object="text" data-key="540"><span data-slate-leaf="true" data-offset-key="540:0" data-first-offset="true"><span data-slate-string="true">为了搭载不同的执行引擎，Hive 还需要做一些简单的适配，从而把优化过的执行计划 “翻译” 成底层计算引擎的语义。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="541"><span data-slate-object="text" data-key="542"><span data-slate-leaf="true" data-offset-key="542:0" data-first-offset="true"><span data-slate-string="true">举例来说，在 Hive on Spark 的集成方式中，Hive 在将 SQL 语句转换为执行计划之后，还需要把执行计划 “翻译” 成 RDD 语义下的 DAG，然后再把 DAG 交付给 Spark Core 付诸执行。从第 14 讲到现在，我们一直在强调，Spark SQL 除了扮演数据分析子框架的角色之外，还是 Spark 新一代的优化引擎。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="543"><span data-slate-object="text" data-key="544"><span data-slate-leaf="true" data-offset-key="544:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在 Hive on Spark 这种集成模式下，Hive 与 Spark 衔接的部分是 Spark Core，而不是 Spark SQL，这一点需要我们特别注意</span></span></span></span><span data-slate-object="text" data-key="545"><span data-slate-leaf="true" data-offset-key="545:0" data-first-offset="true"><span data-slate-string="true">。这也是为什么，相比 Hive on Spark，Spark with Hive 的集成在执行性能上会更胜一筹。毕竟，Spark SQL + Spark Core 这种原装组合，相比 Hive Driver + Spark Core 这种适配组合，在契合度上要更高一些。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="546" id="sr-toc-8"><span data-slate-object="text" data-key="547"><span data-slate-leaf="true" data-offset-key="547:0" data-first-offset="true"><span data-slate-string="true">集成实现</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="548"><span data-slate-object="text" data-key="549"><span data-slate-leaf="true" data-offset-key="549:0" data-first-offset="true"><span data-slate-string="true">分析完原理之后，接下来，我们再来说说，Hive on Spark 的集成到底该怎么实现。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="550"><span data-slate-object="text" data-key="551"><span data-slate-leaf="true" data-offset-key="551:0" data-first-offset="true"><span data-slate-string="true">首先，既然我们想让 Hive 搭载 Spark，那么我们事先得准备好一套完备的 Spark 部署。对于 Spark 的部署模式，Hive 不做任何限定，Spark on Standalone、Spark on Yarn 或是 Spark on Kubernetes 都是可以的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="552"><span data-slate-object="text" data-key="553"><span data-slate-leaf="true" data-offset-key="553:0" data-first-offset="true"><span data-slate-string="true">Spark 集群准备好之后，我们就可以通过修改 hive-site.xml 中相关的配置项，来轻松地完成 Hive on Spark 的集成，如下表所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="554"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/c3/c7/c36ca5536aa4638696838343973a79c7.jpg?wh=1920x534"></div><div>Hive on Spark 主要配置项</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="555"><span data-slate-object="text" data-key="556"><span data-slate-leaf="true" data-offset-key="556:0" data-first-offset="true"><span data-slate-string="true">其中，hive.execution.engine 用于指定 Hive 后端执行引擎，可选值有 “mapreduce”、“tez” 和 “spark”，显然，将该参数设置为 “spark”，即表示采用 Hive on Spark 的集成方式。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="557"><span data-slate-object="text" data-key="558"><span data-slate-leaf="true" data-offset-key="558:0" data-first-offset="true"><span data-slate-string="true">确定了执行引擎之后，接下来我们自然要告诉 Hive：“Spark 集群部署在哪里”，spark.master 正是为了实现这个目的。另外，为了方便 Hive 调用 Spark 的相关脚本与 Jar 包，我们还需要通过 spark.home 参数来指定 Spark 的安装目录。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="559"><span data-slate-object="text" data-key="560"><span data-slate-leaf="true" data-offset-key="560:0" data-first-offset="true"><span data-slate-string="true">配置好这 3 个参数之后，我们就可以用 Hive SQL 向 Hive 提交查询请求，而 Hive 则是先通过访问 Metastore 在 Driver 端完成执行计划的制定与优化，然后再将其 “翻译” 为 RDD 语义下的 DAG，最后把 DAG 交给后端的 Spark 去执行分布式计算。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="561"><span data-slate-object="text" data-key="562"><span data-slate-leaf="true" data-offset-key="562:0" data-first-offset="true"><span data-slate-string="true">当你在终端看到 “Hive on Spark” 的字样时，就证明 Hive 后台的执行引擎确实是 Spark，如下图所示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="563"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/3c/c5/3c0c988d1c4049fe82b270015a67e3c5.jpeg?wh=1558x832"></div><div>Hive on Spark 示例截图</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="564"><span data-slate-object="text" data-key="565"><span data-slate-leaf="true" data-offset-key="565:0" data-first-offset="true"><span data-slate-string="true">当然，除了上述 3 个配置项以外，Hive 还提供了更多的参数，用于微调它与 Spark 之间的交互。对于这些参数，你可以通过访问 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="566"><span data-slate-object="text" data-key="567"><span data-slate-leaf="true" data-offset-key="567:0" data-first-offset="true"><span data-slate-string="true">Hive on Spark 配置项列表</span></span></span></a><span data-slate-object="text" data-key="568"><span data-slate-leaf="true" data-offset-key="568:0" data-first-offset="true"><span data-slate-string="true">来查看。不仅如此，在第 12 讲，我们详细介绍了 Spark 自身的基础配置项，这些配置项都可以配置到 hive-site.xml 中，方便你更细粒度地控制 Hive 与 Spark 之间的集成。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="569" id="sr-toc-9"><span data-slate-object="text" data-key="570"><span data-slate-leaf="true" data-offset-key="570:0" data-first-offset="true"><span data-slate-string="true">重点回顾</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="571"><span data-slate-object="text" data-key="572"><span data-slate-leaf="true" data-offset-key="572:0" data-first-offset="true"><span data-slate-string="true">好啦，到此为止，今天的内容就全部讲完啦！内容有点多，我们一起来做个总结。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="573"><span data-slate-object="text" data-key="574"><span data-slate-leaf="true" data-offset-key="574:0" data-first-offset="true"><span data-slate-string="true">今天这一讲，你需要了解 Spark 与 Hive 常见的两类集成方式，Spark with Hive 和 Hive on Spark。前者由 Spark 社区主导，以 Spark 为主、Hive 为辅；后者则由 Hive 社区主导，以 Hive 为主、Spark 为辅。两类集成方式各有千秋，适用场景各有不同。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="575"><span data-slate-object="text" data-key="576"><span data-slate-leaf="true" data-offset-key="576:0" data-first-offset="true"><span data-slate-string="true">在 Spark with Hive 这类集成方式中，Spark 主要是利用 Hive Metastore 来扩充数据源，从而降低分布式文件的管理与维护成本，如路径管理、分区管理、Schema 维护，等等。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="577"><span data-slate-object="text" data-key="578"><span data-slate-leaf="true" data-offset-key="578:0" data-first-offset="true"><span data-slate-string="true">对于 Spark with Hive，我们至少有 3 种途径来实现 Spark 与 Hive 的集成，分别是 SparkSession + Hive Metastore，spark-sql CLI + Hive Metastore 和 Beeline + Spark Thrift Server。对于这 3 种集成方式，我把整理了表格，供你随时查看。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="579"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/06/14/0699d1a41365d56e900747e109d3be14.jpg?wh=1920x772"></div><div>Spark with Hive 实现途径</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="580"><span data-slate-object="text" data-key="581"><span data-slate-leaf="true" data-offset-key="581:0" data-first-offset="true"><span data-slate-string="true">与 Spark with Hive 相对，另一类集成方式是 Hive on Spark。这种集成方式，本质上是 Hive 社区为 Hive 用户提供了一种新的选项，这个选项就是，在执行引擎方面，除了原有的 MapReduce 与 Tez，开发者还可以选择执行性能更佳的 Spark。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="582"><span data-slate-object="text" data-key="583"><span data-slate-leaf="true" data-offset-key="583:0" data-first-offset="true"><span data-slate-string="true">因此，在 Spark 大行其道的当下，习惯使用 Hive 的团队与开发者，更愿意去尝试和采用 Spark 作为后端的执行引擎。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="584"><span data-slate-object="text" data-key="585"><span data-slate-leaf="true" data-offset-key="585:0" data-first-offset="true"><span data-slate-string="true">熟悉了不同集成方式的区别与适用场景之后，在日后的工作中，当你需要将 Spark 与 Hive 做集成的时候，就可以做到有的放矢、有章可循，加油。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="586" id="sr-toc-10"><span data-slate-object="text" data-key="587"><span data-slate-leaf="true" data-offset-key="587:0" data-first-offset="true"><span data-slate-string="true">每课一练</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="588"><span data-slate-object="text" data-key="589"><span data-slate-leaf="true" data-offset-key="589:0" data-first-offset="true"><span data-slate-string="true">1. 在 Hive on Spark 的部署模式下，用另外一套 Spark 部署去访问 Hive Metastore，比如，通过创建 SparkSession 并访问 Hive Metastore 来扩充数据源。那么，在这种情况下，你能大概说一说用户代码的执行路径吗？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="590"><span data-slate-object="text" data-key="591"><span data-slate-leaf="true" data-offset-key="591:0" data-first-offset="true"><span data-slate-string="true">2. 尽管咱们专栏的主题是 Spark，但我强烈建议你学习并牢记 Hive 的架构设计。松耦合的设计理念让 Hive 本身非常轻量的同时，还给予了 Hive 极大的扩展能力。也正因如此，Hive 才能一直牢牢占据开源数仓霸主的地位。Hive 的设计思想是非常值得我们好好学习的，这样的设计思想可以推而广之，应用到任何需要考虑架构设计的地方，不论是前端、后端，还是大数据与机器学习。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="592"><span data-slate-object="text" data-key="593"><span data-slate-leaf="true" data-offset-key="593:0" data-first-offset="true"><span data-slate-string="true">欢迎你在留言区跟我交流互动，也欢迎把这一讲的内容分享给更多同事、朋友。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-11">精选留言 (9)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/29/57/61/369a609c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>A</span></div></div><div>不过，相比前者，spark-sql CLI 的集成方式多了一层限制，那就是在部署上，spark-sql CLI 与 Hive Metastore 必须安装在同一个计算节点。换句话说，spark-sql CLI 只能在本地访问 Hive Metastore，而没有办法通过远程的方式来做到这一点。   --------- 我试了试是可以的老师，是我对这句话理解有误嘛？三台机器 01、02、03；01、02 启动 hive metastore，然后在 03 上启动 spark-sql spark://bdp-dc-003:7077  同样是可以使用 hive 的 metastore</div><div><p>作者回复：理解的没有问题～

这块限制，随着 Spark 社区和 Hive 社区的发展，确实已经消除了，我后面会抽时间，改一下这里的原文描述，给兄弟们带来的困惑，表示抱歉哈～</p></div><div><div>2021-11-09</div><div><div><i></i></div><div><i></i><span>6</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM5dE76DFqQlkTdseGfAKdcb7XSpS8eOlJ5W0g5jJxWe8EoBb5Yz4JGZU6zPFosonSibudko7yDgfiaw/132"></div></div><div><div><div><span>Geek_e2be2a</span></div></div><div>官方的 Spark Thriftserver 功能比较弱，可以试一下 Apache Kyuubi</div><div><div>2022-07-17</div><div><div><i></i><span></span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/zWLzhGrHubcMJnNFz0s0akeMpefNBVy2jic3rxetxHIjy1icPjJBXFQc78AW10icVN47BLrWicHcSm9MOfG38J2kKw/132"></div></div><div><div><div><span>Geek_278a2c</span></div></div><div>1，请问可以通过 hive sql create table 并插入数据，然后通过 spark sql 访问吗？（配置同一个 hive metastore）
2，类似的，请问可以通过 hive sql create udf，然后通过 spark sql 使用 udf 吗？
</div><div><div>2022-03-15</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Unknown element</span></div></div><div>老师问下 Beeline + Spark Thrift Server 这种部署方式应该怎么配置 spark 参数呢？我看我们公司的文件是在 hivesql 里带上类似 set hive.exec.parallel=true; 这种参数，这和用 dataframe api 设置参数不太一样啊。。如果在 hive sql 里配置的话它的参数和 spark 的参数的对应关系是怎样的呢？谢谢老师～</div><div><p>作者回复: Beeline + Spark Thrift Server 这种方式，走的是 Spark 的计算引擎，所以 set hive.exec.parallel=true 这类 Hive specific 的参数，在这里其实是不起作用的。

不过在 Hive on Spark 的模式下，Hive 相关的设置项都会起作用。其实本质上，还是要区分优化引擎和计算引擎。在 Hive on Spark 里面，Hive 和 Spark 配置项都会起作用，Hive 负责优化，Spark 负责执行。而在 Spark with Hive Metastore 的集成模式下，Spark 做优化，Spark 做执行，这个时候，Hive 的配置项就没什么用了哈～</p></div><div><div>2021-12-20</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Unknown element</span></div></div><div>问题一的执行路径是不是还是先建立 dataframe，然后根据 sql 逻辑完成计算，最后存到 hive？虽然是 hive on spark 但是我理解这种情况下应该没有用到 hive 的优化引擎吧</div><div><p>作者回复：是的，用户代码走的还是 Spark with Hive metastore 的路径，也就是仅仅把 Hive 当做元数据管理器，从 Hive 扩充数据源，或是把数据写到 Hive 中去～

对于 Hive on Spark 来说，Spark 只是后端的计算引擎，提交给 Hive 的 SQL，会通过 Hive 本身的解析、优化，再交给 Spark 去执行而已</p></div><div><div>2021-11-25</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/27/9a/e1/0867c16b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>HHB</span></div></div><div>老师请问，Hive with Spark 的方式比直接使用 spark sql 的性能高吗？</div><div><p>作者回复：你说的是 Hive on Spark 吗？一般来说，Hive on Spark 的性能，比 Spark with Hive metastore 或是 Spark SQL 本身，性能都要差一些，原因的话，老弟可以根据架构图来琢磨琢磨哈～</p></div><div><div>2021-11-19</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/w74m73icotZZEiasC6VzRUytfkFkgyYCGAcz16oBWuMXueWOxxVuAnH6IHaZFXkj5OqwlVO1fnocvn9gGYh8gGcw/132"></div></div><div><div><div><span>Geek_995b78</span></div></div><div>老师，我把 hive 引擎换成 spark 后，一直出现这个错误，我看了 资源充足呀，您看一下，是什么原因呢

hive (test)&gt; select count (*) from spark_hive group by id;
Query ID = root_20211031144450_fc398bef-8f94-4a07-a678-cdeef464b128
Total jobs = 1
Launching Job 1 out of 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&lt;number&gt;
In order to set a constant number of reducers:
  set mapreduce.job.reduces=&lt;number&gt;
Starting Spark Job = 75d07aa7-a98f-43b5-8fe5-de4158f454a7
Job hasn't been submitted after 61s. Aborting it.
Possible reasons include network issues, errors in remote driver or the cluster has no available resources, etc.
Please check YARN or Spark driver's logs for further information.
Status: SENT
Failed to execute spark task, with exception 'java.lang.IllegalStateException (RPC channel is closed.)'
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.spark.SparkTask. RPC channel is closed.
</div><div><p>作者回复: Hive on Spark 对于版本一致性要求比较高，这个是比较麻烦和比较坑的一点。上面的报错，是因为 Hive 和 Spark 版本不一致导致的，老弟可以参考这里，去根据两个组件版本的要求来配置 Hive on Spark：

https://cwiki.apache.org/confluence/display/Hive/Hive+on+Spark%3A+Getting+Started
</p></div><div><div>2021-10-31</div><div><div><i></i><span>3</span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>qinsi</span></div></div><div>理论上应该可以把 HQL 转换成 Spark SQL 吧，那样 Hive on Spark 是不是性能就会提升了？</div><div><p>作者回复：对，理论上是这样的。不过，Hive 社区不会这么做，为啥呢？因为 Hive 社区是从自身的设计出发，它还要顾及 MapReduce 和 Tez，所以不会轻易动自身的优化引擎。不过讲道理，如果 Hive 实现了一套与 Spark SQL 一样的优化机制，那么 Hive on Spark 性能，就会像你说的，有所提升～</p></div><div><div>2021-10-26</div><div><div><i></i><span>2</span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/6a/a8/6853ca39.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>gouge</span></div></div><div>老师，请问为什么会有这个限制？“spark-sql CLI 的集成方式多了一层限制，那就是在部署上，spark-sql CLI 与 Hive Metastore 必须安装在同一个计算节点”。

我实验好像没有发现存在这个 “限制”。如下：

我在本地配置 % SPARK_HOME%/conf/hive-site.xml，内容如下：
&lt;configuration&gt;
&lt;property&gt;
  &lt;name&gt;hive.metastore.uris&lt;/name&gt;
  &lt;value&gt;thrift://xxx:9083&lt;/value&gt;  
&lt;/property&gt;
&lt;/configuration&gt;

其中 xxx:9083 为远程服务器上部署的 hive metastore。通过这样的配置，再执行 % SPARK_HOME%/bin/spark-sql，是可以查询到 hive 的元数据信息的。

谢谢！

</div><div><p>作者回复：好问题～

是这样的，spark-sql 会在进程内启动自己的 Metastore service，然后尝试去连接 MySQL database（Metastore database），我可能原文没有交代清楚。老弟帮忙看下，看看 hive-site.xml 中，是否有 Metastore database 相关的配置项，推测是 spark-sql 自己的 Metastore service 通过 hive-site.xml 里面的 database 信息，直连的 MySQL database。

老弟帮忙确认下哈～</p></div><div><div>2021-10-26</div><div><div><i></i><span>4</span></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1"><outline class="toc-level-h1" data-reactid=".1.0" style="width: 175px;"><active data-reactid=".1.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1.0.1"><span data-reactid=".1.0.1.0">20 | Hive + Spark 强强联合：分布式数仓的不二之选</span></a></outline><outline class="toc-level-h2" data-reactid=".1.1" style="width: 165px;"><active data-reactid=".1.1.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1.1.1"><span data-reactid=".1.1.1.0">Hive 架构与基本原理</span></a></outline><outline class="toc-level-h2" data-reactid=".1.2" style="width: 165px;"><active data-reactid=".1.2.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1.2.1"><span data-reactid=".1.2.1.0">Spark with Hive</span></a></outline><outline class="toc-level-h3" data-reactid=".1.3" style="width: 155px;"><active data-reactid=".1.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1.3.1"><span data-reactid=".1.3.1.0">SparkSession + Hive Metastore</span></a></outline><outline class="toc-level-h3" data-reactid=".1.4" style="width: 155px;"><active data-reactid=".1.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".1.4.1"><span data-reactid=".1.4.1.0">spark-sql CLI + Hive Metastore</span></a></outline><outline class="toc-level-h3" data-reactid=".1.5" style="width: 155px;"><active data-reactid=".1.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1.5.1"><span data-reactid=".1.5.1.0">Beeline + Spark Thrift Server</span></a></outline><outline class="toc-level-h2" data-reactid=".1.6" style="width: 165px;"><active data-reactid=".1.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1.6.1"><span data-reactid=".1.6.1.0">Hive on Spark</span></a></outline><outline class="toc-level-h3" data-reactid=".1.7" style="width: 155px;"><active data-reactid=".1.7.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1.7.1"><span data-reactid=".1.7.1.0">基本原理</span></a></outline><outline class="toc-level-h3" data-reactid=".1.8" style="width: 155px;"><active data-reactid=".1.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1.8.1"><span data-reactid=".1.8.1.0">集成实现</span></a></outline><outline class="toc-level-h2" data-reactid=".1.9" style="width: 165px;"><active data-reactid=".1.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1.9.1"><span data-reactid=".1.9.1.0">重点回顾</span></a></outline><outline class="toc-level-h2" data-reactid=".1.a" style="width: 165px;"><active data-reactid=".1.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".1.a.1"><span data-reactid=".1.a.1.0">每课一练</span></a></outline><outline class="toc-level-h2" data-reactid=".1.b" style="width: 165px;"><active data-reactid=".1.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".1.b.1"><span data-reactid=".1.b.1.0">精选留言 (9)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/429858" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>