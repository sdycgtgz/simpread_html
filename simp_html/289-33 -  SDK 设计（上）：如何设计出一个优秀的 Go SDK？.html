
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">这一讲我们来了解目前业界有哪些优秀的开源日志包，以及手把手教你从 0 编写一个日志包</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0"> 33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？</h1><div><span>孔令飞</span> <span> 2021-08-10</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/d7/33/d735222d4a0f2db9a346212696529e33.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：孔令飞</span><span>大小：13.38M</span><span> 时长：14:38</span></div></div><audio title="33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？" src="https://res001.geekbang.org/media/audio/97/f4/979d085783a9cc210156717875b933f4/ld/ld.m3u8" __idm_id__="319501"></audio></div><div><div><div><div data-slate-editor="true" data-key="18638" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="18639"><span data-slate-object="text" data-key="18640"><span data-slate-leaf="true" data-offset-key="18640:0" data-first-offset="true"><span data-slate-string="true">你好，我是孔令飞。接下来的两讲，我们来看下如何设计和实现一个优秀的 Go SDK。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18641"><span data-slate-object="text" data-key="18642"><span data-slate-leaf="true" data-offset-key="18642:0" data-first-offset="true"><span data-slate-string="true">后端服务通过 API 接口对外提供应用的功能，但是用户直接调用 API 接口，需要编写 API 接口调用的逻辑，并且需要构造入参和解析返回的数据包，使用起来效率低，而且有一定的开发工作量。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18643"><span data-slate-object="text" data-key="18644"><span data-slate-leaf="true" data-offset-key="18644:0" data-first-offset="true"><span data-slate-string="true">在实际的项目开发中，通常会提供对开发者更友好的 SDK 包，供客户端调用。很多大型服务在发布时都会伴随着 SDK 的发布，例如腾讯云很多产品都提供了 SDK：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18645"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/e1/fa/e1bb8eb03c2f26f546710e95751c17fa.png?wh=1920x747"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18646"><span data-slate-object="text" data-key="18647"><span data-slate-leaf="true" data-offset-key="18647:0" data-first-offset="true"><span data-slate-string="true">既然 SDK 如此重要，那么如何设计一个优秀的 Go SDK 呢？这一讲我就来详细介绍一下。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18648" id="sr-toc-1"><span data-slate-object="text" data-key="18649"><span data-slate-leaf="true" data-offset-key="18649:0" data-first-offset="true"><span data-slate-string="true">什么是 SDK？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18650"><span data-slate-object="text" data-key="18651"><span data-slate-leaf="true" data-offset-key="18651:0" data-first-offset="true"><span data-slate-string="true">首先，我们来看下什么是 SDK。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18652"><span data-slate-object="text" data-key="18653"><span data-slate-leaf="true" data-offset-key="18653:0" data-first-offset="true"><span data-slate-string="true">对于 SDK（Software Development Kit，软件开发工具包），不同场景下有不同的解释。但是对于一个 Go 后端服务来说，SDK 通常是指</span></span></span><span data-slate-object="text" data-key="18654"><span data-slate-leaf="true" data-offset-key="18654:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">封装了 Go 后端服务 API 接口的软件包</span></span></span></span><span data-slate-object="text" data-key="18655"><span data-slate-leaf="true" data-offset-key="18655:0" data-first-offset="true"><span data-slate-string="true">，里面通常包含了跟软件相关的库、文档、使用示例、封装好的 API 接口和工具。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18656"><span data-slate-object="text" data-key="18657"><span data-slate-leaf="true" data-offset-key="18657:0" data-first-offset="true"><span data-slate-string="true">调用 SDK 跟调用本地函数没有太大的区别，所以可以极大地提升开发者的开发效率和体验。SDK 可以由服务提供者提供，也可以由其他组织或个人提供。为了鼓励开发者使用其系统或语言，SDK 通常都是免费提供的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18658"><span data-slate-object="text" data-key="18659"><span data-slate-leaf="true" data-offset-key="18659:0" data-first-offset="true"><span data-slate-string="true">通常，服务提供者会提供不同语言的 SDK，比如针对 Python 开发者会提供 Python 版的 SDK，针对 Go 开发者会提供 Go 版的 SDK。一些比较专业的团队还会有 SDK 自动生成工具，可以根据 API 接口定义，自动生成不同语言的 SDK。例如，Protocol Buffers 的编译工具 protoc，就可以基于 Protobuf 文件生成 C++、Python、Java、JavaScript、PHP 等语言版本的 SDK。阿里云、腾讯云这些一线大厂，也可以基于 API 定义，生成不同编程语言的 SDK。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18660" id="sr-toc-2"><span data-slate-object="text" data-key="18661"><span data-slate-leaf="true" data-offset-key="18661:0" data-first-offset="true"><span data-slate-string="true">SDK 设计方法</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18662"><span data-slate-object="text" data-key="18663"><span data-slate-leaf="true" data-offset-key="18663:0" data-first-offset="true"><span data-slate-string="true">那么，我们如何才能设计一个好的 SDK 呢？对于 SDK，不同团队会有不同的设计方式，我调研了一些优秀 SDK 的实现，发现这些 SDK 有一些共同点。根据我的调研结果，结合我在实际开发中的经验，我总结出了一套 SDK 设计方法，接下来就分享给你。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18664" id="sr-toc-3"><span data-slate-object="text" data-key="18665"><span data-slate-leaf="true" data-offset-key="18665:0" data-first-offset="true"><span data-slate-string="true">如何给 SDK 命名？</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18666"><span data-slate-object="text" data-key="18667"><span data-slate-leaf="true" data-offset-key="18667:0" data-first-offset="true"><span data-slate-string="true">在讲设计方法之前，我先来介绍两个重要的知识点：SDK 的命名方式和 SDK 的目录结构。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18668"><span data-slate-object="text" data-key="18669"><span data-slate-leaf="true" data-offset-key="18669:0" data-first-offset="true"><span data-slate-string="true">SDK 的名字目前没有统一的规范，但比较常见的命名方式是 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18670"><span data-slate-object="text" data-key="18671"><span data-slate-leaf="true" data-offset-key="18671:0" data-first-offset="true"><span data-slate-string="true">xxx-sdk-go</span></span></span></span><span data-slate-object="text" data-key="18672"><span data-slate-leaf="true" data-offset-key="18672:0" data-first-offset="true"><span data-slate-string="true"> / </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18673"><span data-slate-object="text" data-key="18674"><span data-slate-leaf="true" data-offset-key="18674:0" data-first-offset="true"><span data-slate-string="true">xxx-sdk-python</span></span></span></span><span data-slate-object="text" data-key="18675"><span data-slate-leaf="true" data-offset-key="18675:0" data-first-offset="true"><span data-slate-string="true"> / </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18676"><span data-slate-object="text" data-key="18677"><span data-slate-leaf="true" data-offset-key="18677:0" data-first-offset="true"><span data-slate-string="true">xxx-sdk-java</span></span></span></span><span data-slate-object="text" data-key="18678"><span data-slate-leaf="true" data-offset-key="18678:0" data-first-offset="true"><span data-slate-string="true"> 。其中， </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18679"><span data-slate-object="text" data-key="18680"><span data-slate-leaf="true" data-offset-key="18680:0" data-first-offset="true"><span data-slate-string="true">xxx</span></span></span></span><span data-slate-object="text" data-key="18681"><span data-slate-leaf="true" data-offset-key="18681:0" data-first-offset="true"><span data-slate-string="true"> 可以是项目名或者组织名，例如腾讯云在 GitHub 上的组织名为 tencentcloud，那它的 SDK 命名如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18682"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/e2/1e/e269d5d0e19a73d45ccdf5f5561c611e.png?wh=1210x863"></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18683" id="sr-toc-4"><span data-slate-object="text" data-key="18684"><span data-slate-leaf="true" data-offset-key="18684:0" data-first-offset="true"><span data-slate-string="true">SDK 的目录结构</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18685"><span data-slate-object="text" data-key="18686"><span data-slate-leaf="true" data-offset-key="18686:0" data-first-offset="true"><span data-slate-string="true">不同项目 SDK 的目录结构也不相同，但一般需要包含下面这些文件或目录。目录名可能会有所不同，但目录功能是类似的。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18687"><div data-slate-type="list-line" data-slate-object="block" data-key="18688"><span data-slate-object="text" data-key="18689"><span data-slate-leaf="true" data-offset-key="18689:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">README.md</span></span></span></span><span data-slate-object="text" data-key="18690"><span data-slate-leaf="true" data-offset-key="18690:0" data-first-offset="true"><span data-slate-string="true">：SDK 的帮助文档，里面包含了安装、配置和使用 SDK 的方法。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18691"><span data-slate-object="text" data-key="18692"><span data-slate-leaf="true" data-offset-key="18692:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">examples/sample/</span></span></span></span><span data-slate-object="text" data-key="18693"><span data-slate-leaf="true" data-offset-key="18693:0" data-first-offset="true"><span data-slate-string="true">：SDK 的使用示例。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18694"><span data-slate-object="text" data-key="18695"><span data-slate-leaf="true" data-offset-key="18695:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">sdk/</span></span></span></span><span data-slate-object="text" data-key="18696"><span data-slate-leaf="true" data-offset-key="18696:0" data-first-offset="true"><span data-slate-string="true">：SDK 共享的包，里面封装了最基础的通信功能。如果是 HTTP 服务，基本都是基于 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18697"><span data-slate-object="text" data-key="18698"><span data-slate-leaf="true" data-offset-key="18698:0" data-first-offset="true"><span data-slate-string="true">net/http</span></span></span></span><span data-slate-object="text" data-key="18699"><span data-slate-leaf="true" data-offset-key="18699:0" data-first-offset="true"><span data-slate-string="true"> 包进行封装。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18700"><span data-slate-object="text" data-key="18701"><span data-slate-leaf="true" data-offset-key="18701:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">api</span></span></span></span><span data-slate-object="text" data-key="18702"><span data-slate-leaf="true" data-offset-key="18702:0" data-first-offset="true"><span data-slate-string="true">：如果 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18703"><span data-slate-object="text" data-key="18704"><span data-slate-leaf="true" data-offset-key="18704:0" data-first-offset="true"><span data-slate-string="true">xxx-sdk-go</span></span></span></span><span data-slate-object="text" data-key="18705"><span data-slate-leaf="true" data-offset-key="18705:0" data-first-offset="true"><span data-slate-string="true"> 只是为某一个服务提供 SDK，就可以把该服务的所有 API 接口封装代码存放在 api 目录下。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18706"><span data-slate-object="text" data-key="18707"><span data-slate-leaf="true" data-offset-key="18707:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">services/{iam, tms}</span></span></span></span><span data-slate-object="text" data-key="18708"><span data-slate-leaf="true" data-offset-key="18708:0" data-first-offset="true"><span data-slate-string="true"> ：如果 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18709"><span data-slate-object="text" data-key="18710"><span data-slate-leaf="true" data-offset-key="18710:0" data-first-offset="true"><span data-slate-string="true">xxx-sdk-go</span></span></span></span><span data-slate-object="text" data-key="18711"><span data-slate-leaf="true" data-offset-key="18711:0" data-first-offset="true"><span data-slate-string="true"> 中， </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18712"><span data-slate-object="text" data-key="18713"><span data-slate-leaf="true" data-offset-key="18713:0" data-first-offset="true"><span data-slate-string="true">xxx</span></span></span></span><span data-slate-object="text" data-key="18714"><span data-slate-leaf="true" data-offset-key="18714:0" data-first-offset="true"><span data-slate-string="true"> 是一个组织，那么这个 SDK 很可能会集成该组织中很多服务的 API，就可以把某类服务的 API 接口封装代码存放在 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18715"><span data-slate-object="text" data-key="18716"><span data-slate-leaf="true" data-offset-key="18716:0" data-first-offset="true"><span data-slate-string="true">services/&lt;服务名&gt;</span></span></span></span><span data-slate-object="text" data-key="18717"><span data-slate-leaf="true" data-offset-key="18717:0" data-first-offset="true"><span data-slate-string="true"> 下，例如 AWS 的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="18718"><span data-slate-object="text" data-key="18719"><span data-slate-leaf="true" data-offset-key="18719:0" data-first-offset="true"><span data-slate-string="true">Go SDK</span></span></span></a><span data-slate-object="text" data-key="18720"><span data-slate-leaf="true" data-offset-key="18720:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18721"><span data-slate-object="text" data-key="18722"><span data-slate-leaf="true" data-offset-key="18722:0" data-first-offset="true"><span data-slate-string="true">一个典型的目录结构如下：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="18723"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18724"><span data-slate-object="text" data-key="18725"><span data-slate-leaf="true" data-offset-key="18725:0" data-first-offset="true"><span data-slate-string="true">├── examples            </span></span></span><span data-slate-object="text" data-key="18726"><span data-slate-leaf="true" data-offset-key="18726:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 示例代码存放目录</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18727"><span data-slate-object="text" data-key="18728"><span data-slate-leaf="true" data-offset-key="18728:0" data-first-offset="true"><span data-slate-string="true">│   └── authz.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18729"><span data-slate-object="text" data-key="18730"><span data-slate-leaf="true" data-offset-key="18730:0" data-first-offset="true"><span data-slate-string="true">├── README.md           </span></span></span><span data-slate-object="text" data-key="18731"><span data-slate-leaf="true" data-offset-key="18731:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># SDK 使用文档</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18732"><span data-slate-object="text" data-key="18733"><span data-slate-leaf="true" data-offset-key="18733:0" data-first-offset="true"><span data-slate-string="true">├── sdk                 </span></span></span><span data-slate-object="text" data-key="18734"><span data-slate-leaf="true" data-offset-key="18734:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 公共包，封装了 SDK 配置、API 请求、认证等代码</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18735"><span data-slate-object="text" data-key="18736"><span data-slate-leaf="true" data-offset-key="18736:0" data-first-offset="true"><span data-slate-string="true">│   ├── client.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18737"><span data-slate-object="text" data-key="18738"><span data-slate-leaf="true" data-offset-key="18738:0" data-first-offset="true"><span data-slate-string="true">│   ├── config.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18739"><span data-slate-object="text" data-key="18740"><span data-slate-leaf="true" data-offset-key="18740:0" data-first-offset="true"><span data-slate-string="true">│   ├── credential.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18741"><span data-slate-object="text" data-key="18742"><span data-slate-leaf="true" data-offset-key="18742:0" data-first-offset="true"><span data-slate-string="true">│   └── ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18743"><span data-slate-object="text" data-key="18744"><span data-slate-leaf="true" data-offset-key="18744:0" data-first-offset="true"><span data-slate-string="true">└── services            </span></span></span><span data-slate-object="text" data-key="18745"><span data-slate-leaf="true" data-offset-key="18745:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># API 封装</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18746"><span data-slate-object="text" data-key="18747"><span data-slate-leaf="true" data-offset-key="18747:0" data-first-offset="true"><span data-slate-string="true">    ├── common</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18748"><span data-slate-object="text" data-key="18749"><span data-slate-leaf="true" data-offset-key="18749:0" data-first-offset="true"><span data-slate-string="true">    │   └── model</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18750"><span data-slate-object="text" data-key="18751"><span data-slate-leaf="true" data-offset-key="18751:0" data-first-offset="true"><span data-slate-string="true">    ├── iam             </span></span></span><span data-slate-object="text" data-key="18752"><span data-slate-leaf="true" data-offset-key="18752:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 服务的 API 接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18753"><span data-slate-object="text" data-key="18754"><span data-slate-leaf="true" data-offset-key="18754:0" data-first-offset="true"><span data-slate-string="true">    │   ├── authz.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18755"><span data-slate-object="text" data-key="18756"><span data-slate-leaf="true" data-offset-key="18756:0" data-first-offset="true"><span data-slate-string="true">    │   ├── client.go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18757"><span data-slate-object="text" data-key="18758"><span data-slate-leaf="true" data-offset-key="18758:0" data-first-offset="true"><span data-slate-string="true">    │   └── ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18759"><span data-slate-object="text" data-key="18760"><span data-slate-leaf="true" data-offset-key="18760:0" data-first-offset="true"><span data-slate-string="true">    └── tms             </span></span></span><span data-slate-object="text" data-key="18761"><span data-slate-leaf="true" data-offset-key="18761:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># tms 服务的 API 接口</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18762" id="sr-toc-5"><span data-slate-object="text" data-key="18763"><span data-slate-leaf="true" data-offset-key="18763:0" data-first-offset="true"><span data-slate-string="true">SDK 设计方法</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18764"><span data-slate-object="text" data-key="18765"><span data-slate-leaf="true" data-offset-key="18765:0" data-first-offset="true"><span data-slate-string="true">SDK 的设计方法如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18766"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/9f/ca/9fb7aa8d3da4210223e9b0c87943e8ca.jpg?wh=1920x841"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18767"><span data-slate-object="text" data-key="18768"><span data-slate-leaf="true" data-offset-key="18768:0" data-first-offset="true"><span data-slate-string="true">我们可以通过 Config 配置创建客户端 Client，例如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18769"><span data-slate-object="text" data-key="18770"><span data-slate-leaf="true" data-offset-key="18770:0" data-first-offset="true"><span data-slate-string="true">func NewClient(config sdk.Config) (Client, error)</span></span></span></span><span data-slate-object="text" data-key="18771"><span data-slate-leaf="true" data-offset-key="18771:0" data-first-offset="true"><span data-slate-string="true">，配置中可以指定下面的信息。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18772"><div data-slate-type="list-line" data-slate-object="block" data-key="18773"><span data-slate-object="text" data-key="18774"><span data-slate-leaf="true" data-offset-key="18774:0" data-first-offset="true"><span data-slate-string="true">服务的后端地址：服务的后端地址可以通过配置文件来配置，也可以直接固化在 SDK 中，推荐后端服务地址可通过配置文件配置。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18775"><span data-slate-object="text" data-key="18776"><span data-slate-leaf="true" data-offset-key="18776:0" data-first-offset="true"><span data-slate-string="true">认证信息：最常用的认证方式是通过密钥认证，也有一些是通过用户名和密码认证。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18777"><span data-slate-object="text" data-key="18778"><span data-slate-leaf="true" data-offset-key="18778:0" data-first-offset="true"><span data-slate-string="true">其他配置：例如超时时间、重试次数、缓存时间等。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18779"><span data-slate-object="text" data-key="18780"><span data-slate-leaf="true" data-offset-key="18780:0" data-first-offset="true"><span data-slate-string="true">创建的 Client 是一个结构体或者 Go interface。这里我建议你使用 interface 类型，这样可以将定义和具体实现解耦。Client 具有一些方法，例如 CreateUser、DeleteUser 等，每一个方法对应一个 API 接口，下面是一个 Client 定义：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18781"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18782"><span data-slate-object="text" data-key="18783"><span data-slate-leaf="true" data-offset-key="18783:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="18784"><span data-slate-leaf="true" data-offset-key="18784:0" data-first-offset="true"><span data-slate-string="true"> Client </span></span></span><span data-slate-object="text" data-key="18785"><span data-slate-leaf="true" data-offset-key="18785:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="18786"><span data-slate-leaf="true" data-offset-key="18786:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18787"><span data-slate-object="text" data-key="18788"><span data-slate-leaf="true" data-offset-key="18788:0" data-first-offset="true"><span data-slate-string="true">    client *sdk.Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18789"><span data-slate-object="text" data-key="18790"><span data-slate-leaf="true" data-offset-key="18790:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18791"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18792"><span data-slate-object="text" data-key="18793"><span data-slate-leaf="true" data-offset-key="18793:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18794"><span data-slate-leaf="true" data-offset-key="18794:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18795"><span data-slate-leaf="true" data-offset-key="18795:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *Client)</span></span></span></span></span><span data-slate-object="text" data-key="18796"><span data-slate-leaf="true" data-offset-key="18796:0" data-first-offset="true"><span data-slate-string="true"> CreateUser(req *CreateUserRequest) (*CreateUserResponse, </span></span></span><span data-slate-object="text" data-key="18797"><span data-slate-leaf="true" data-offset-key="18797:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18798"><span data-slate-leaf="true" data-offset-key="18798:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18799"><span data-slate-object="text" data-key="18800"><span data-slate-leaf="true" data-offset-key="18800:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18801"><span data-slate-leaf="true" data-offset-key="18801:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// normal code</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18802"><span data-slate-object="text" data-key="18803"><span data-slate-leaf="true" data-offset-key="18803:0" data-first-offset="true"><span data-slate-string="true">    resp := &amp;CreateUserResponse{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18804"><span data-slate-object="text" data-key="18805"><span data-slate-leaf="true" data-offset-key="18805:0" data-first-offset="true"><span data-slate-string="true">    err := c.client.Send(req, resp)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18806"><span data-slate-object="text" data-key="18807"><span data-slate-leaf="true" data-offset-key="18807:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18808"><span data-slate-leaf="true" data-offset-key="18808:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="18809"><span data-slate-leaf="true" data-offset-key="18809:0" data-first-offset="true"><span data-slate-string="true"> resp, err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18810"><span data-slate-object="text" data-key="18811"><span data-slate-leaf="true" data-offset-key="18811:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18812"><span data-slate-object="text" data-key="18813"><span data-slate-leaf="true" data-offset-key="18813:0" data-first-offset="true"><span data-slate-string="true">调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18814"><span data-slate-object="text" data-key="18815"><span data-slate-leaf="true" data-offset-key="18815:0" data-first-offset="true"><span data-slate-string="true">client.CreateUser(req)</span></span></span></span><span data-slate-object="text" data-key="18816"><span data-slate-leaf="true" data-offset-key="18816:0" data-first-offset="true"><span data-slate-string="true"> 会执行 HTTP 请求，在 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18817"><span data-slate-object="text" data-key="18818"><span data-slate-leaf="true" data-offset-key="18818:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="18819"><span data-slate-leaf="true" data-offset-key="18819:0" data-first-offset="true"><span data-slate-string="true"> 中可以指定 HTTP 请求的方法 Method、路径 Path 和请求 Body。 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18820"><span data-slate-object="text" data-key="18821"><span data-slate-leaf="true" data-offset-key="18821:0" data-first-offset="true"><span data-slate-string="true">CreateUser</span></span></span></span><span data-slate-object="text" data-key="18822"><span data-slate-leaf="true" data-offset-key="18822:0" data-first-offset="true"><span data-slate-string="true"> 函数中，会调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18823"><span data-slate-object="text" data-key="18824"><span data-slate-leaf="true" data-offset-key="18824:0" data-first-offset="true"><span data-slate-string="true">c.client.Send(req)</span></span></span></span><span data-slate-object="text" data-key="18825"><span data-slate-leaf="true" data-offset-key="18825:0" data-first-offset="true"><span data-slate-string="true"> 执行具体的 HTTP 请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18826"><span data-slate-type="code" data-slate-object="inline" data-key="18827"><span data-slate-object="text" data-key="18828"><span data-slate-leaf="true" data-offset-key="18828:0" data-first-offset="true"><span data-slate-string="true">c.client</span></span></span></span><span data-slate-object="text" data-key="18829"><span data-slate-leaf="true" data-offset-key="18829:0" data-first-offset="true"><span data-slate-string="true"> 是 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18830"><span data-slate-object="text" data-key="18831"><span data-slate-leaf="true" data-offset-key="18831:0" data-first-offset="true"><span data-slate-string="true">*Request</span></span></span></span><span data-slate-object="text" data-key="18832"><span data-slate-leaf="true" data-offset-key="18832:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量，  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18833"><span data-slate-object="text" data-key="18834"><span data-slate-leaf="true" data-offset-key="18834:0" data-first-offset="true"><span data-slate-string="true">*Request</span></span></span></span><span data-slate-object="text" data-key="18835"><span data-slate-leaf="true" data-offset-key="18835:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量具有一些方法，可以根据传入的请求参数 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18836"><span data-slate-object="text" data-key="18837"><span data-slate-leaf="true" data-offset-key="18837:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="18838"><span data-slate-leaf="true" data-offset-key="18838:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18839"><span data-slate-object="text" data-key="18840"><span data-slate-leaf="true" data-offset-key="18840:0" data-first-offset="true"><span data-slate-string="true">config</span></span></span></span><span data-slate-object="text" data-key="18841"><span data-slate-leaf="true" data-offset-key="18841:0" data-first-offset="true"><span data-slate-string="true"> 配置构造出请求路径、认证头和请求 Body，并调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18842"><span data-slate-object="text" data-key="18843"><span data-slate-leaf="true" data-offset-key="18843:0" data-first-offset="true"><span data-slate-string="true">net/http</span></span></span></span><span data-slate-object="text" data-key="18844"><span data-slate-leaf="true" data-offset-key="18844:0" data-first-offset="true"><span data-slate-string="true"> 包完成最终的 HTTP 请求，最后将返回结果 Unmarshal 到传入的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18845"><span data-slate-object="text" data-key="18846"><span data-slate-leaf="true" data-offset-key="18846:0" data-first-offset="true"><span data-slate-string="true">resp</span></span></span></span><span data-slate-object="text" data-key="18847"><span data-slate-leaf="true" data-offset-key="18847:0" data-first-offset="true"><span data-slate-string="true"> 结构体中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18848"><span data-slate-object="text" data-key="18849"><span data-slate-leaf="true" data-offset-key="18849:0" data-first-offset="true"><span data-slate-string="true">根据我的调研，目前有两种 SDK 设计方式可供参考，一种是各大公有云厂商采用的 SDK 设计方式，一种是 Kubernetes client-go 的设计方式。IAM 项目分别实现了这两种 SDK 设计方式，但我还是更倾向于对外提供 client-go 方式的 SDK，我会在下一讲详细介绍它。这两种设计方式的设计思路跟上面介绍的是一致的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18850" id="sr-toc-6"><span data-slate-object="text" data-key="18851"><span data-slate-leaf="true" data-offset-key="18851:0" data-first-offset="true"><span data-slate-string="true">公有云厂商采用的 SDK 设计方式</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18852"><span data-slate-object="text" data-key="18853"><span data-slate-leaf="true" data-offset-key="18853:0" data-first-offset="true"><span data-slate-string="true">这里，我先来简单介绍下公有云厂商采用的 SDK 设计模式。SDK 架构如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18854"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/82/ce/82ebe90b0490b9a2a76e2f302dd896ce.jpg?wh=1920x866"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18855"><span data-slate-object="text" data-key="18856"><span data-slate-leaf="true" data-offset-key="18856:0" data-first-offset="true"><span data-slate-string="true">SDK 框架分为两层，分别是 API 层和基础层。API 层主要用来构建客户端实例，并调用客户端实例提供的方法来完成 API 请求，每一个方法对应一个 API 接口。API 层最终会调用基础层提供的能力，来完成 REST API 请求。基础层通过依次执行构建请求参数（Builder）、签发并添加认证头（Signer）、执行 HTTP 请求（Request）三大步骤，来完成具体的 REST API 请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18857"><span data-slate-object="text" data-key="18858"><span data-slate-leaf="true" data-offset-key="18858:0" data-first-offset="true"><span data-slate-string="true">为了让你更好地理解公有云 SDK 的设计方式，接下来我会结合一些真实的代码，给你讲解 API 层和基础层的具体设计，SDK 代码见 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="18859"><span data-slate-object="text" data-key="18860"><span data-slate-leaf="true" data-offset-key="18860:0" data-first-offset="true"><span data-slate-string="true">medu-sdk-go</span></span></span></a><span data-slate-object="text" data-key="18861"><span data-slate-leaf="true" data-offset-key="18861:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18862" id="sr-toc-7"><span data-slate-object="text" data-key="18863"><span data-slate-leaf="true" data-offset-key="18863:0" data-first-offset="true"><span data-slate-string="true">API 层：创建客户端实例</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18864"><span data-slate-object="text" data-key="18865"><span data-slate-leaf="true" data-offset-key="18865:0" data-first-offset="true"><span data-slate-string="true">客户端在使用服务 A 的 SDK 时，首先需要根据 Config 配置创建一个服务 A 的客户端 Client，Client 实际上是一个 struct，定义如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18866"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18867"><span data-slate-object="text" data-key="18868"><span data-slate-leaf="true" data-offset-key="18868:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="18869"><span data-slate-leaf="true" data-offset-key="18869:0" data-first-offset="true"><span data-slate-string="true"> Client </span></span></span><span data-slate-object="text" data-key="18870"><span data-slate-leaf="true" data-offset-key="18870:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="18871"><span data-slate-leaf="true" data-offset-key="18871:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18872"><span data-slate-object="text" data-key="18873"><span data-slate-leaf="true" data-offset-key="18873:0" data-first-offset="true"><span data-slate-string="true">    sdk.Client</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18874"><span data-slate-object="text" data-key="18875"><span data-slate-leaf="true" data-offset-key="18875:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18876"><span data-slate-object="text" data-key="18877"><span data-slate-leaf="true" data-offset-key="18877:0" data-first-offset="true"><span data-slate-string="true">在创建客户端时，需要传入认证（例如密钥、用户名 / 密码）、后端服务地址等配置信息。例如，可以通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="18878"><span data-slate-object="text" data-key="18879"><span data-slate-leaf="true" data-offset-key="18879:0" data-first-offset="true"><span data-slate-string="true">NewClientWithSecret</span></span></span></a><span data-slate-object="text" data-key="18880"><span data-slate-leaf="true" data-offset-key="18880:0" data-first-offset="true"><span data-slate-string="true"> 方法来构建一个带密钥对的客户端：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18881"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18882"><span data-slate-object="text" data-key="18883"><span data-slate-leaf="true" data-offset-key="18883:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18884"><span data-slate-leaf="true" data-offset-key="18884:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18885"><span data-slate-leaf="true" data-offset-key="18885:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NewClientWithSecret</span></span></span></span></span><span data-slate-object="text" data-key="18886"><span data-slate-leaf="true" data-offset-key="18886:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(secretID, secretKey </span></span></span></span></span><span data-slate-object="text" data-key="18887"><span data-slate-leaf="true" data-offset-key="18887:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="18888"><span data-slate-leaf="true" data-offset-key="18888:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="18889"><span data-slate-leaf="true" data-offset-key="18889:0" data-first-offset="true"><span data-slate-string="true"> (client *Client, err </span></span></span><span data-slate-object="text" data-key="18890"><span data-slate-leaf="true" data-offset-key="18890:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18891"><span data-slate-leaf="true" data-offset-key="18891:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18892"><span data-slate-object="text" data-key="18893"><span data-slate-leaf="true" data-offset-key="18893:0" data-first-offset="true"><span data-slate-string="true">    client = &amp;Client{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18894"><span data-slate-object="text" data-key="18895"><span data-slate-leaf="true" data-offset-key="18895:0" data-first-offset="true"><span data-slate-string="true">    config := sdk.NewConfig().WithEndpoint(defaultEndpoint)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18896"><span data-slate-object="text" data-key="18897"><span data-slate-leaf="true" data-offset-key="18897:0" data-first-offset="true"><span data-slate-string="true">    client.Init(serviceName).WithSecret(secretID, secretKey).WithConfig(config)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18898"><span data-slate-object="text" data-key="18899"><span data-slate-leaf="true" data-offset-key="18899:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18900"><span data-slate-leaf="true" data-offset-key="18900:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18901"><span data-slate-object="text" data-key="18902"><span data-slate-leaf="true" data-offset-key="18902:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18903"><span data-slate-object="text" data-key="18904"><span data-slate-leaf="true" data-offset-key="18904:0" data-first-offset="true"><span data-slate-string="true">这里要注意，上面创建客户端时，传入的密钥对最终会在基础层中被使用，用来签发 JWT Token。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18905"><span data-slate-object="text" data-key="18906"><span data-slate-leaf="true" data-offset-key="18906:0" data-first-offset="true"><span data-slate-string="true">Client 有多个方法（Sender），例如 Authz 等，每个方法代表一个 API 接口。Sender 方法会接收 AuthzRequest 等结构体类型的指针作为输入参数。我们可以调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18907"><span data-slate-object="text" data-key="18908"><span data-slate-leaf="true" data-offset-key="18908:0" data-first-offset="true"><span data-slate-string="true">client.Authz(req)</span></span></span></span><span data-slate-object="text" data-key="18909"><span data-slate-leaf="true" data-offset-key="18909:0" data-first-offset="true"><span data-slate-string="true"> 来执行 REST API 调用。可以在 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18910"><span data-slate-object="text" data-key="18911"><span data-slate-leaf="true" data-offset-key="18911:0" data-first-offset="true"><span data-slate-string="true">client.Authz</span></span></span></span><span data-slate-object="text" data-key="18912"><span data-slate-leaf="true" data-offset-key="18912:0" data-first-offset="true"><span data-slate-string="true"> 方法中添加一些业务逻辑处理。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18913"><span data-slate-object="text" data-key="18914"><span data-slate-leaf="true" data-offset-key="18914:0" data-first-offset="true"><span data-slate-string="true">client.Authz</span></span></span></span><span data-slate-object="text" data-key="18915"><span data-slate-leaf="true" data-offset-key="18915:0" data-first-offset="true"><span data-slate-string="true"> 代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18916"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18917"><span data-slate-object="text" data-key="18918"><span data-slate-leaf="true" data-offset-key="18918:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="18919"><span data-slate-leaf="true" data-offset-key="18919:0" data-first-offset="true"><span data-slate-string="true"> AuthzRequest </span></span></span><span data-slate-object="text" data-key="18920"><span data-slate-leaf="true" data-offset-key="18920:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="18921"><span data-slate-leaf="true" data-offset-key="18921:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18922"><span data-slate-object="text" data-key="18923"><span data-slate-leaf="true" data-offset-key="18923:0" data-first-offset="true"><span data-slate-string="true">    *request.BaseRequest</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18924"><span data-slate-object="text" data-key="18925"><span data-slate-leaf="true" data-offset-key="18925:0" data-first-offset="true"><span data-slate-string="true">    Resource *</span></span></span><span data-slate-object="text" data-key="18926"><span data-slate-leaf="true" data-offset-key="18926:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="18927"><span data-slate-leaf="true" data-offset-key="18927:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18928"><span data-slate-leaf="true" data-offset-key="18928:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"resource"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18929"><span data-slate-object="text" data-key="18930"><span data-slate-leaf="true" data-offset-key="18930:0" data-first-offset="true"><span data-slate-string="true">    Action *</span></span></span><span data-slate-object="text" data-key="18931"><span data-slate-leaf="true" data-offset-key="18931:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="18932"><span data-slate-leaf="true" data-offset-key="18932:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18933"><span data-slate-leaf="true" data-offset-key="18933:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"action"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18934"><span data-slate-object="text" data-key="18935"><span data-slate-leaf="true" data-offset-key="18935:0" data-first-offset="true"><span data-slate-string="true">    Subject *</span></span></span><span data-slate-object="text" data-key="18936"><span data-slate-leaf="true" data-offset-key="18936:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="18937"><span data-slate-leaf="true" data-offset-key="18937:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18938"><span data-slate-leaf="true" data-offset-key="18938:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"subject"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18939"><span data-slate-object="text" data-key="18940"><span data-slate-leaf="true" data-offset-key="18940:0" data-first-offset="true"><span data-slate-string="true">    Context *ladon.Context</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18941"><span data-slate-object="text" data-key="18942"><span data-slate-leaf="true" data-offset-key="18942:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18943"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18944"><span data-slate-object="text" data-key="18945"><span data-slate-leaf="true" data-offset-key="18945:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18946"><span data-slate-leaf="true" data-offset-key="18946:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18947"><span data-slate-leaf="true" data-offset-key="18947:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *Client)</span></span></span></span></span><span data-slate-object="text" data-key="18948"><span data-slate-leaf="true" data-offset-key="18948:0" data-first-offset="true"><span data-slate-string="true"> Authz(req *AuthzRequest) (resp *AuthzResponse, err </span></span></span><span data-slate-object="text" data-key="18949"><span data-slate-leaf="true" data-offset-key="18949:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18950"><span data-slate-leaf="true" data-offset-key="18950:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18951"><span data-slate-object="text" data-key="18952"><span data-slate-leaf="true" data-offset-key="18952:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18953"><span data-slate-leaf="true" data-offset-key="18953:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="18954"><span data-slate-leaf="true" data-offset-key="18954:0" data-first-offset="true"><span data-slate-string="true"> req == </span></span></span><span data-slate-object="text" data-key="18955"><span data-slate-leaf="true" data-offset-key="18955:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="18956"><span data-slate-leaf="true" data-offset-key="18956:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18957"><span data-slate-object="text" data-key="18958"><span data-slate-leaf="true" data-offset-key="18958:0" data-first-offset="true"><span data-slate-string="true">        req = NewAuthzRequest()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18959"><span data-slate-object="text" data-key="18960"><span data-slate-leaf="true" data-offset-key="18960:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18961"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18962"><span data-slate-object="text" data-key="18963"><span data-slate-leaf="true" data-offset-key="18963:0" data-first-offset="true"><span data-slate-string="true">    resp = NewAuthzResponse()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18964"><span data-slate-object="text" data-key="18965"><span data-slate-leaf="true" data-offset-key="18965:0" data-first-offset="true"><span data-slate-string="true">    err = c.Send(req, resp)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18966"><span data-slate-object="text" data-key="18967"><span data-slate-leaf="true" data-offset-key="18967:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18968"><span data-slate-leaf="true" data-offset-key="18968:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18969"><span data-slate-object="text" data-key="18970"><span data-slate-leaf="true" data-offset-key="18970:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18971"><span data-slate-object="text" data-key="18972"><span data-slate-leaf="true" data-offset-key="18972:0" data-first-offset="true"><span data-slate-string="true">请求结构体中的字段都是指针类型的，使用指针的好处是可以判断入参是否有被指定，如果</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18973"><span data-slate-object="text" data-key="18974"><span data-slate-leaf="true" data-offset-key="18974:0" data-first-offset="true"><span data-slate-string="true"> req.Subject == nil</span></span></span></span><span data-slate-object="text" data-key="18975"><span data-slate-leaf="true" data-offset-key="18975:0" data-first-offset="true"><span data-slate-string="true"> 就说明传参中没有 Subject 参数，如果</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18976"><span data-slate-object="text" data-key="18977"><span data-slate-leaf="true" data-offset-key="18977:0" data-first-offset="true"><span data-slate-string="true"> req.Subject != nil</span></span></span></span><span data-slate-object="text" data-key="18978"><span data-slate-leaf="true" data-offset-key="18978:0" data-first-offset="true"><span data-slate-string="true"> 就说明参数中有传 Subject 参数。根据某个参数是否被传入，执行不同的业务逻辑，这在 Go API 接口开发中非常常见。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18979"><span data-slate-object="text" data-key="18980"><span data-slate-leaf="true" data-offset-key="18980:0" data-first-offset="true"><span data-slate-string="true">另外，因为 Client 通过匿名的方式继承了基础层中的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="18981"><span data-slate-object="text" data-key="18982"><span data-slate-leaf="true" data-offset-key="18982:0" data-first-offset="true"><span data-slate-string="true">Client</span></span></span></a><span data-slate-object="text" data-key="18983"><span data-slate-leaf="true" data-offset-key="18983:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18984"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18985"><span data-slate-object="text" data-key="18986"><span data-slate-leaf="true" data-offset-key="18986:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="18987"><span data-slate-leaf="true" data-offset-key="18987:0" data-first-offset="true"><span data-slate-string="true"> Client </span></span></span><span data-slate-object="text" data-key="18988"><span data-slate-leaf="true" data-offset-key="18988:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="18989"><span data-slate-leaf="true" data-offset-key="18989:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18990"><span data-slate-object="text" data-key="18991"><span data-slate-leaf="true" data-offset-key="18991:0" data-first-offset="true"><span data-slate-string="true">  sdk.Client</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18992"><span data-slate-object="text" data-key="18993"><span data-slate-leaf="true" data-offset-key="18993:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18994"><span data-slate-object="text" data-key="18995"><span data-slate-leaf="true" data-offset-key="18995:0" data-first-offset="true"><span data-slate-string="true">所以，API 层创建的 Client 最终可以直接调用基础层中的 Client 提供的</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18996"><span data-slate-object="text" data-key="18997"><span data-slate-leaf="true" data-offset-key="18997:0" data-first-offset="true"><span data-slate-string="true"> Send(req, resp)</span></span></span></span><span data-slate-object="text" data-key="18998"><span data-slate-leaf="true" data-offset-key="18998:0" data-first-offset="true"><span data-slate-string="true"> 方法，来执行 RESTful API 调用，并将结果保存在 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18999"><span data-slate-object="text" data-key="19000"><span data-slate-leaf="true" data-offset-key="19000:0" data-first-offset="true"><span data-slate-string="true">resp</span></span></span></span><span data-slate-object="text" data-key="19001"><span data-slate-leaf="true" data-offset-key="19001:0" data-first-offset="true"><span data-slate-string="true"> 中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19002"><span data-slate-object="text" data-key="19003"><span data-slate-leaf="true" data-offset-key="19003:0" data-first-offset="true"><span data-slate-string="true">为了方便和 API 层的 Client 进行区分，我下面统一将基础层中的 Client 称为 </span></span></span><span data-slate-object="text" data-key="19004"><span data-slate-leaf="true" data-offset-key="19004:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">sdk.Client</span></span></span></span><span data-slate-object="text" data-key="19005"><span data-slate-leaf="true" data-offset-key="19005:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19006"><span data-slate-object="text" data-key="19007"><span data-slate-leaf="true" data-offset-key="19007:0" data-first-offset="true"><span data-slate-string="true">最后，一个完整的客户端调用示例代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19008"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19009"><span data-slate-object="text" data-key="19010"><span data-slate-leaf="true" data-offset-key="19010:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="19011"><span data-slate-leaf="true" data-offset-key="19011:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19012"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19013"><span data-slate-object="text" data-key="19014"><span data-slate-leaf="true" data-offset-key="19014:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="19015"><span data-slate-leaf="true" data-offset-key="19015:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19016"><span data-slate-object="text" data-key="19017"><span data-slate-leaf="true" data-offset-key="19017:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19018"><span data-slate-leaf="true" data-offset-key="19018:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"fmt"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19019"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19020"><span data-slate-object="text" data-key="19021"><span data-slate-leaf="true" data-offset-key="19021:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19022"><span data-slate-leaf="true" data-offset-key="19022:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/ory/ladon"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19023"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19024"><span data-slate-object="text" data-key="19025"><span data-slate-leaf="true" data-offset-key="19025:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19026"><span data-slate-leaf="true" data-offset-key="19026:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/medu-sdk-go/sdk"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19027"><span data-slate-object="text" data-key="19028"><span data-slate-leaf="true" data-offset-key="19028:0" data-first-offset="true"><span data-slate-string="true">  iam </span></span></span><span data-slate-object="text" data-key="19029"><span data-slate-leaf="true" data-offset-key="19029:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/medu-sdk-go/services/iam/authz"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19030"><span data-slate-object="text" data-key="19031"><span data-slate-leaf="true" data-offset-key="19031:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19032"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19033"><span data-slate-object="text" data-key="19034"><span data-slate-leaf="true" data-offset-key="19034:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19035"><span data-slate-leaf="true" data-offset-key="19035:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19036"><span data-slate-leaf="true" data-offset-key="19036:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="19037"><span data-slate-leaf="true" data-offset-key="19037:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="19038"><span data-slate-leaf="true" data-offset-key="19038:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19039"><span data-slate-object="text" data-key="19040"><span data-slate-leaf="true" data-offset-key="19040:0" data-first-offset="true"><span data-slate-string="true">  client, _ := iam.NewClientWithSecret(</span></span></span><span data-slate-object="text" data-key="19041"><span data-slate-leaf="true" data-offset-key="19041:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"XhbY3aCrfjdYcP1OFJRu9xcno8JzSbUIvGE2"</span></span></span></span><span data-slate-object="text" data-key="19042"><span data-slate-leaf="true" data-offset-key="19042:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="19043"><span data-slate-leaf="true" data-offset-key="19043:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"bfJRvlFwsoW9L30DlG87BBW0arJamSeK"</span></span></span></span><span data-slate-object="text" data-key="19044"><span data-slate-leaf="true" data-offset-key="19044:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19045"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19046"><span data-slate-object="text" data-key="19047"><span data-slate-leaf="true" data-offset-key="19047:0" data-first-offset="true"><span data-slate-string="true">  req := iam.NewAuthzRequest()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19048"><span data-slate-object="text" data-key="19049"><span data-slate-leaf="true" data-offset-key="19049:0" data-first-offset="true"><span data-slate-string="true">  req.Resource = sdk.String(</span></span></span><span data-slate-object="text" data-key="19050"><span data-slate-leaf="true" data-offset-key="19050:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"resources:articles:ladon-introduction"</span></span></span></span><span data-slate-object="text" data-key="19051"><span data-slate-leaf="true" data-offset-key="19051:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19052"><span data-slate-object="text" data-key="19053"><span data-slate-leaf="true" data-offset-key="19053:0" data-first-offset="true"><span data-slate-string="true">  req.Action = sdk.String(</span></span></span><span data-slate-object="text" data-key="19054"><span data-slate-leaf="true" data-offset-key="19054:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"delete"</span></span></span></span><span data-slate-object="text" data-key="19055"><span data-slate-leaf="true" data-offset-key="19055:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19056"><span data-slate-object="text" data-key="19057"><span data-slate-leaf="true" data-offset-key="19057:0" data-first-offset="true"><span data-slate-string="true">  req.Subject = sdk.String(</span></span></span><span data-slate-object="text" data-key="19058"><span data-slate-leaf="true" data-offset-key="19058:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"users:peter"</span></span></span></span><span data-slate-object="text" data-key="19059"><span data-slate-leaf="true" data-offset-key="19059:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19060"><span data-slate-object="text" data-key="19061"><span data-slate-leaf="true" data-offset-key="19061:0" data-first-offset="true"><span data-slate-string="true">  ctx := ladon.Context(</span></span></span><span data-slate-object="text" data-key="19062"><span data-slate-leaf="true" data-offset-key="19062:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">map</span></span></span></span><span data-slate-object="text" data-key="19063"><span data-slate-leaf="true" data-offset-key="19063:0" data-first-offset="true"><span data-slate-string="true">[</span></span></span><span data-slate-object="text" data-key="19064"><span data-slate-leaf="true" data-offset-key="19064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19065"><span data-slate-leaf="true" data-offset-key="19065:0" data-first-offset="true"><span data-slate-string="true">]</span></span></span><span data-slate-object="text" data-key="19066"><span data-slate-leaf="true" data-offset-key="19066:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19067"><span data-slate-leaf="true" data-offset-key="19067:0" data-first-offset="true"><span data-slate-string="true">{}{</span></span></span><span data-slate-object="text" data-key="19068"><span data-slate-leaf="true" data-offset-key="19068:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"remoteIPAddress"</span></span></span></span><span data-slate-object="text" data-key="19069"><span data-slate-leaf="true" data-offset-key="19069:0" data-first-offset="true"><span data-slate-string="true">: </span></span></span><span data-slate-object="text" data-key="19070"><span data-slate-leaf="true" data-offset-key="19070:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"192.168.0.5"</span></span></span></span><span data-slate-object="text" data-key="19071"><span data-slate-leaf="true" data-offset-key="19071:0" data-first-offset="true"><span data-slate-string="true">})</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19072"><span data-slate-object="text" data-key="19073"><span data-slate-leaf="true" data-offset-key="19073:0" data-first-offset="true"><span data-slate-string="true">  req.Context = &amp;ctx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19074"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19075"><span data-slate-object="text" data-key="19076"><span data-slate-leaf="true" data-offset-key="19076:0" data-first-offset="true"><span data-slate-string="true">  resp, err := client.Authz(req)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19077"><span data-slate-object="text" data-key="19078"><span data-slate-leaf="true" data-offset-key="19078:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19079"><span data-slate-leaf="true" data-offset-key="19079:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19080"><span data-slate-leaf="true" data-offset-key="19080:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19081"><span data-slate-leaf="true" data-offset-key="19081:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19082"><span data-slate-leaf="true" data-offset-key="19082:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19083"><span data-slate-object="text" data-key="19084"><span data-slate-leaf="true" data-offset-key="19084:0" data-first-offset="true"><span data-slate-string="true">    fmt.Println(</span></span></span><span data-slate-object="text" data-key="19085"><span data-slate-leaf="true" data-offset-key="19085:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"err1"</span></span></span></span><span data-slate-object="text" data-key="19086"><span data-slate-leaf="true" data-offset-key="19086:0" data-first-offset="true"><span data-slate-string="true">, err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19087"><span data-slate-object="text" data-key="19088"><span data-slate-leaf="true" data-offset-key="19088:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19089"><span data-slate-leaf="true" data-offset-key="19089:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19090"><span data-slate-object="text" data-key="19091"><span data-slate-leaf="true" data-offset-key="19091:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19092"><span data-slate-object="text" data-key="19093"><span data-slate-leaf="true" data-offset-key="19093:0" data-first-offset="true"><span data-slate-string="true">  fmt.Printf(</span></span></span><span data-slate-object="text" data-key="19094"><span data-slate-leaf="true" data-offset-key="19094:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"get response body: `%s`\n"</span></span></span></span><span data-slate-object="text" data-key="19095"><span data-slate-leaf="true" data-offset-key="19095:0" data-first-offset="true"><span data-slate-string="true">, resp.String())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19096"><span data-slate-object="text" data-key="19097"><span data-slate-leaf="true" data-offset-key="19097:0" data-first-offset="true"><span data-slate-string="true">  fmt.Printf(</span></span></span><span data-slate-object="text" data-key="19098"><span data-slate-leaf="true" data-offset-key="19098:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"allowed: %v\n"</span></span></span></span><span data-slate-object="text" data-key="19099"><span data-slate-leaf="true" data-offset-key="19099:0" data-first-offset="true"><span data-slate-string="true">, resp.Allowed)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19100"><span data-slate-object="text" data-key="19101"><span data-slate-leaf="true" data-offset-key="19101:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="19102" id="sr-toc-8"><span data-slate-object="text" data-key="19103"><span data-slate-leaf="true" data-offset-key="19103:0" data-first-offset="true"><span data-slate-string="true">基础层：构建并执行 HTTP 请求</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="19104"><span data-slate-object="text" data-key="19105"><span data-slate-leaf="true" data-offset-key="19105:0" data-first-offset="true"><span data-slate-string="true">上面我们创建了客户端实例，并调用了它的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19106"><span data-slate-object="text" data-key="19107"><span data-slate-leaf="true" data-offset-key="19107:0" data-first-offset="true"><span data-slate-string="true">Send</span></span></span></a><span data-slate-object="text" data-key="19108"><span data-slate-leaf="true" data-offset-key="19108:0" data-first-offset="true"><span data-slate-string="true"> 方法来完成最终的 HTTP 请求。这里，我们来看下 Send 方法具体是如何构建 HTTP 请求的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19109"><span data-slate-object="text" data-key="19110"><span data-slate-leaf="true" data-offset-key="19110:0" data-first-offset="true"><span data-slate-string="true">sdk.Client 通过 Send 方法，完成最终的 API 调用，代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19111"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19112"><span data-slate-object="text" data-key="19113"><span data-slate-leaf="true" data-offset-key="19113:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19114"><span data-slate-leaf="true" data-offset-key="19114:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19115"><span data-slate-leaf="true" data-offset-key="19115:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *Client)</span></span></span></span></span><span data-slate-object="text" data-key="19116"><span data-slate-leaf="true" data-offset-key="19116:0" data-first-offset="true"><span data-slate-string="true"> Send(req request.Request, resp response.Response) </span></span></span><span data-slate-object="text" data-key="19117"><span data-slate-leaf="true" data-offset-key="19117:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19118"><span data-slate-leaf="true" data-offset-key="19118:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19119"><span data-slate-object="text" data-key="19120"><span data-slate-leaf="true" data-offset-key="19120:0" data-first-offset="true"><span data-slate-string="true">  method := req.GetMethod()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19121"><span data-slate-object="text" data-key="19122"><span data-slate-leaf="true" data-offset-key="19122:0" data-first-offset="true"><span data-slate-string="true">  builder := GetParameterBuilder(method, c.Logger)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19123"><span data-slate-object="text" data-key="19124"><span data-slate-leaf="true" data-offset-key="19124:0" data-first-offset="true"><span data-slate-string="true">  jsonReq, _ := json.Marshal(req)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19125"><span data-slate-object="text" data-key="19126"><span data-slate-leaf="true" data-offset-key="19126:0" data-first-offset="true"><span data-slate-string="true">  encodedUrl, err := builder.BuildURL(req.GetURL(), jsonReq)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19127"><span data-slate-object="text" data-key="19128"><span data-slate-leaf="true" data-offset-key="19128:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19129"><span data-slate-leaf="true" data-offset-key="19129:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19130"><span data-slate-leaf="true" data-offset-key="19130:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19131"><span data-slate-leaf="true" data-offset-key="19131:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19132"><span data-slate-leaf="true" data-offset-key="19132:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19133"><span data-slate-object="text" data-key="19134"><span data-slate-leaf="true" data-offset-key="19134:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19135"><span data-slate-leaf="true" data-offset-key="19135:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19136"><span data-slate-leaf="true" data-offset-key="19136:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19137"><span data-slate-object="text" data-key="19138"><span data-slate-leaf="true" data-offset-key="19138:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19139"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19140"><span data-slate-object="text" data-key="19141"><span data-slate-leaf="true" data-offset-key="19141:0" data-first-offset="true"><span data-slate-string="true">  endPoint := c.Config.Endpoint</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19142"><span data-slate-object="text" data-key="19143"><span data-slate-leaf="true" data-offset-key="19143:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19144"><span data-slate-leaf="true" data-offset-key="19144:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19145"><span data-slate-leaf="true" data-offset-key="19145:0" data-first-offset="true"><span data-slate-string="true"> endPoint == </span></span></span><span data-slate-object="text" data-key="19146"><span data-slate-leaf="true" data-offset-key="19146:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="19147"><span data-slate-leaf="true" data-offset-key="19147:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19148"><span data-slate-object="text" data-key="19149"><span data-slate-leaf="true" data-offset-key="19149:0" data-first-offset="true"><span data-slate-string="true">    endPoint = fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="19150"><span data-slate-leaf="true" data-offset-key="19150:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"%s/%s"</span></span></span></span><span data-slate-object="text" data-key="19151"><span data-slate-leaf="true" data-offset-key="19151:0" data-first-offset="true"><span data-slate-string="true">, defaultEndpoint, c.ServiceName)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19152"><span data-slate-object="text" data-key="19153"><span data-slate-leaf="true" data-offset-key="19153:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19154"><span data-slate-object="text" data-key="19155"><span data-slate-leaf="true" data-offset-key="19155:0" data-first-offset="true"><span data-slate-string="true">  reqUrl := fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="19156"><span data-slate-leaf="true" data-offset-key="19156:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"%s://%s/%s%s"</span></span></span></span><span data-slate-object="text" data-key="19157"><span data-slate-leaf="true" data-offset-key="19157:0" data-first-offset="true"><span data-slate-string="true">, c.Config.Scheme, endPoint, req.GetVersion(), encodedUrl)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19158"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19159"><span data-slate-object="text" data-key="19160"><span data-slate-leaf="true" data-offset-key="19160:0" data-first-offset="true"><span data-slate-string="true">  body, err := builder.BuildBody(jsonReq)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19161"><span data-slate-object="text" data-key="19162"><span data-slate-leaf="true" data-offset-key="19162:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19163"><span data-slate-leaf="true" data-offset-key="19163:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19164"><span data-slate-leaf="true" data-offset-key="19164:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19165"><span data-slate-leaf="true" data-offset-key="19165:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19166"><span data-slate-leaf="true" data-offset-key="19166:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19167"><span data-slate-object="text" data-key="19168"><span data-slate-leaf="true" data-offset-key="19168:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19169"><span data-slate-leaf="true" data-offset-key="19169:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19170"><span data-slate-leaf="true" data-offset-key="19170:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19171"><span data-slate-object="text" data-key="19172"><span data-slate-leaf="true" data-offset-key="19172:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19173"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19174"><span data-slate-object="text" data-key="19175"><span data-slate-leaf="true" data-offset-key="19175:0" data-first-offset="true"><span data-slate-string="true">  sign := </span></span></span><span data-slate-object="text" data-key="19176"><span data-slate-leaf="true" data-offset-key="19176:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19177"><span data-slate-leaf="true" data-offset-key="19177:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *http.Request)</span></span></span></span></span><span data-slate-object="text" data-key="19178"><span data-slate-leaf="true" data-offset-key="19178:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19179"><span data-slate-leaf="true" data-offset-key="19179:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19180"><span data-slate-leaf="true" data-offset-key="19180:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19181"><span data-slate-object="text" data-key="19182"><span data-slate-leaf="true" data-offset-key="19182:0" data-first-offset="true"><span data-slate-string="true">    signer := NewSigner(c.signMethod, c.Credential, c.Logger)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19183"><span data-slate-object="text" data-key="19184"><span data-slate-leaf="true" data-offset-key="19184:0" data-first-offset="true"><span data-slate-string="true">    _ = signer.Sign(c.ServiceName, r, strings.NewReader(body))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19185"><span data-slate-object="text" data-key="19186"><span data-slate-leaf="true" data-offset-key="19186:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19187"><span data-slate-leaf="true" data-offset-key="19187:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19188"><span data-slate-leaf="true" data-offset-key="19188:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19189"><span data-slate-object="text" data-key="19190"><span data-slate-leaf="true" data-offset-key="19190:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19191"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19192"><span data-slate-object="text" data-key="19193"><span data-slate-leaf="true" data-offset-key="19193:0" data-first-offset="true"><span data-slate-string="true">  rawResponse, err := c.doSend(method, reqUrl, body, req.GetHeaders(), sign)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19194"><span data-slate-object="text" data-key="19195"><span data-slate-leaf="true" data-offset-key="19195:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19196"><span data-slate-leaf="true" data-offset-key="19196:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19197"><span data-slate-leaf="true" data-offset-key="19197:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19198"><span data-slate-leaf="true" data-offset-key="19198:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19199"><span data-slate-leaf="true" data-offset-key="19199:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19200"><span data-slate-object="text" data-key="19201"><span data-slate-leaf="true" data-offset-key="19201:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19202"><span data-slate-leaf="true" data-offset-key="19202:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19203"><span data-slate-leaf="true" data-offset-key="19203:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19204"><span data-slate-object="text" data-key="19205"><span data-slate-leaf="true" data-offset-key="19205:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19206"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19207"><span data-slate-object="text" data-key="19208"><span data-slate-leaf="true" data-offset-key="19208:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19209"><span data-slate-leaf="true" data-offset-key="19209:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19210"><span data-slate-leaf="true" data-offset-key="19210:0" data-first-offset="true"><span data-slate-string="true"> response.ParseFromHttpResponse(rawResponse, resp)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19211"><span data-slate-object="text" data-key="19212"><span data-slate-leaf="true" data-offset-key="19212:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19213"><span data-slate-object="text" data-key="19214"><span data-slate-leaf="true" data-offset-key="19214:0" data-first-offset="true"><span data-slate-string="true">上面的代码大体上可以分为四个步骤。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19215"><span data-slate-object="text" data-key="19216"><span data-slate-leaf="true" data-offset-key="19216:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步，Builder：构建请求参数。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19217"><span data-slate-object="text" data-key="19218"><span data-slate-leaf="true" data-offset-key="19218:0" data-first-offset="true"><span data-slate-string="true">根据传入的 AuthzRequest 和客户端配置 Config，构造 HTTP 请求参数，包括请求路径和请求 Body。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19219"><span data-slate-object="text" data-key="19220"><span data-slate-leaf="true" data-offset-key="19220:0" data-first-offset="true"><span data-slate-string="true">接下来，我们来看下如何构造 HTTP 请求参数。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19221"><div data-slate-type="list-line" data-slate-object="block" data-key="19222"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="19223"><span data-slate-leaf="true" data-offset-key="19223:0" data-first-offset="true"><span data-slate-string="true">HTTP 请求路径构建</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19224"><span data-slate-object="text" data-key="19225"><span data-slate-leaf="true" data-offset-key="19225:0" data-first-offset="true"><span data-slate-string="true">在创建客户端时，我们通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19226"><span data-slate-object="text" data-key="19227"><span data-slate-leaf="true" data-offset-key="19227:0" data-first-offset="true"><span data-slate-string="true">NewAuthzRequest</span></span></span></a><span data-slate-object="text" data-key="19228"><span data-slate-leaf="true" data-offset-key="19228:0" data-first-offset="true"><span data-slate-string="true"> 函数创建了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19229"><span data-slate-object="text" data-key="19230"><span data-slate-leaf="true" data-offset-key="19230:0" data-first-offset="true"><span data-slate-string="true">/v1/authz</span></span></span></span><span data-slate-object="text" data-key="19231"><span data-slate-leaf="true" data-offset-key="19231:0" data-first-offset="true"><span data-slate-string="true"> REST API 接口请求结构体 AuthzRequest，代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19232"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19233"><span data-slate-object="text" data-key="19234"><span data-slate-leaf="true" data-offset-key="19234:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19235"><span data-slate-leaf="true" data-offset-key="19235:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19236"><span data-slate-leaf="true" data-offset-key="19236:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">NewAuthzRequest</span></span></span></span></span><span data-slate-object="text" data-key="19237"><span data-slate-leaf="true" data-offset-key="19237:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="19238"><span data-slate-leaf="true" data-offset-key="19238:0" data-first-offset="true"><span data-slate-string="true"> (req *AuthzRequest) {    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19239"><span data-slate-object="text" data-key="19240"><span data-slate-leaf="true" data-offset-key="19240:0" data-first-offset="true"><span data-slate-string="true">    req = &amp;AuthzRequest{    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19241"><span data-slate-object="text" data-key="19242"><span data-slate-leaf="true" data-offset-key="19242:0" data-first-offset="true"><span data-slate-string="true">        BaseRequest: &amp;request.BaseRequest{    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19243"><span data-slate-object="text" data-key="19244"><span data-slate-leaf="true" data-offset-key="19244:0" data-first-offset="true"><span data-slate-string="true">            URL:     </span></span></span><span data-slate-object="text" data-key="19245"><span data-slate-leaf="true" data-offset-key="19245:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/authz"</span></span></span></span><span data-slate-object="text" data-key="19246"><span data-slate-leaf="true" data-offset-key="19246:0" data-first-offset="true"><span data-slate-string="true">,    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19247"><span data-slate-object="text" data-key="19248"><span data-slate-leaf="true" data-offset-key="19248:0" data-first-offset="true"><span data-slate-string="true">            Method:  </span></span></span><span data-slate-object="text" data-key="19249"><span data-slate-leaf="true" data-offset-key="19249:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"POST"</span></span></span></span><span data-slate-object="text" data-key="19250"><span data-slate-leaf="true" data-offset-key="19250:0" data-first-offset="true"><span data-slate-string="true">,    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19251"><span data-slate-object="text" data-key="19252"><span data-slate-leaf="true" data-offset-key="19252:0" data-first-offset="true"><span data-slate-string="true">            Header:  </span></span></span><span data-slate-object="text" data-key="19253"><span data-slate-leaf="true" data-offset-key="19253:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19254"><span data-slate-leaf="true" data-offset-key="19254:0" data-first-offset="true"><span data-slate-string="true">,    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19255"><span data-slate-object="text" data-key="19256"><span data-slate-leaf="true" data-offset-key="19256:0" data-first-offset="true"><span data-slate-string="true">            Version: </span></span></span><span data-slate-object="text" data-key="19257"><span data-slate-leaf="true" data-offset-key="19257:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"v1"</span></span></span></span><span data-slate-object="text" data-key="19258"><span data-slate-leaf="true" data-offset-key="19258:0" data-first-offset="true"><span data-slate-string="true">,    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19259"><span data-slate-object="text" data-key="19260"><span data-slate-leaf="true" data-offset-key="19260:0" data-first-offset="true"><span data-slate-string="true">        },    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19261"><span data-slate-object="text" data-key="19262"><span data-slate-leaf="true" data-offset-key="19262:0" data-first-offset="true"><span data-slate-string="true">    }    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19263"><span data-slate-object="text" data-key="19264"><span data-slate-leaf="true" data-offset-key="19264:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19265"><span data-slate-leaf="true" data-offset-key="19265:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19266"><span data-slate-leaf="true" data-offset-key="19266:0" data-first-offset="true"><span data-slate-string="true">                                </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19267"><span data-slate-object="text" data-key="19268"><span data-slate-leaf="true" data-offset-key="19268:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19269"><span data-slate-object="text" data-key="19270"><span data-slate-leaf="true" data-offset-key="19270:0" data-first-offset="true"><span data-slate-string="true">可以看到，我们创建的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19271"><span data-slate-object="text" data-key="19272"><span data-slate-leaf="true" data-offset-key="19272:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19273"><span data-slate-leaf="true" data-offset-key="19273:0" data-first-offset="true"><span data-slate-string="true"> 中包含了 API 版本（Version）、API 路径（URL）和请求方法（Method）。这样，我们就可以在 Send 方法中，构建出请求路径：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19274"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19275"><span data-slate-object="text" data-key="19276"><span data-slate-leaf="true" data-offset-key="19276:0" data-first-offset="true"><span data-slate-string="true">endPoint := c.Config.Endpoint                                                 </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19277"><span data-slate-object="text" data-key="19278"><span data-slate-leaf="true" data-offset-key="19278:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19279"><span data-slate-leaf="true" data-offset-key="19279:0" data-first-offset="true"><span data-slate-string="true"> endPoint == </span></span></span><span data-slate-object="text" data-key="19280"><span data-slate-leaf="true" data-offset-key="19280:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="19281"><span data-slate-leaf="true" data-offset-key="19281:0" data-first-offset="true"><span data-slate-string="true"> {                                                          </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19282"><span data-slate-object="text" data-key="19283"><span data-slate-leaf="true" data-offset-key="19283:0" data-first-offset="true"><span data-slate-string="true">    endPoint = fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="19284"><span data-slate-leaf="true" data-offset-key="19284:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"%s/%s"</span></span></span></span><span data-slate-object="text" data-key="19285"><span data-slate-leaf="true" data-offset-key="19285:0" data-first-offset="true"><span data-slate-string="true">, defaultEndpoint, c.ServiceName)           </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19286"><span data-slate-object="text" data-key="19287"><span data-slate-leaf="true" data-offset-key="19287:0" data-first-offset="true"><span data-slate-string="true">}                                                                  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19288"><span data-slate-object="text" data-key="19289"><span data-slate-leaf="true" data-offset-key="19289:0" data-first-offset="true"><span data-slate-string="true">reqUrl := fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="19290"><span data-slate-leaf="true" data-offset-key="19290:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"%s://%s/%s%s"</span></span></span></span><span data-slate-object="text" data-key="19291"><span data-slate-leaf="true" data-offset-key="19291:0" data-first-offset="true"><span data-slate-string="true">, c.Config.Scheme, endPoint, req.GetVersion(), encodedUrl) </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19292"><span data-slate-object="text" data-key="19293"><span data-slate-leaf="true" data-offset-key="19293:0" data-first-offset="true"><span data-slate-string="true">上述代码中，c.Config.Scheme=http/https、endPoint=iam.api.marmotedu.com:8080、req.GetVersion ()=v1 和 encodedUrl，我们可以认为它们等于 /authz。所以，最终构建出的请求路径为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19294"><span data-slate-object="text" data-key="19295"><span data-slate-leaf="true" data-offset-key="19295:0" data-first-offset="true"><span data-slate-string="true"> http://iam.api.marmotedu.com:8080/v1/authz</span></span></span></span><span data-slate-object="text" data-key="19296"><span data-slate-leaf="true" data-offset-key="19296:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19297"><div data-slate-type="list-line" data-slate-object="block" data-key="19298"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="19299"><span data-slate-leaf="true" data-offset-key="19299:0" data-first-offset="true"><span data-slate-string="true">HTTP 请求 Body 构建</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19300"><span data-slate-object="text" data-key="19301"><span data-slate-leaf="true" data-offset-key="19301:0" data-first-offset="true"><span data-slate-string="true">在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19302"><span data-slate-object="text" data-key="19303"><span data-slate-leaf="true" data-offset-key="19303:0" data-first-offset="true"><span data-slate-string="true">BuildBody</span></span></span></a><span data-slate-object="text" data-key="19304"><span data-slate-leaf="true" data-offset-key="19304:0" data-first-offset="true"><span data-slate-string="true"> 方法中构建请求 Body。BuildBody 会将 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19305"><span data-slate-object="text" data-key="19306"><span data-slate-leaf="true" data-offset-key="19306:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19307"><span data-slate-leaf="true" data-offset-key="19307:0" data-first-offset="true"><span data-slate-string="true"> Marshal 成 JSON 格式的 string。HTTP 请求会以该字符串作为 Body 参数。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19308"><span data-slate-object="text" data-key="19309"><span data-slate-leaf="true" data-offset-key="19309:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二步，Signer：签发并添加认证头。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19310"><span data-slate-object="text" data-key="19311"><span data-slate-leaf="true" data-offset-key="19311:0" data-first-offset="true"><span data-slate-string="true">访问 IAM 的 API 接口需要进行认证，所以在发送 HTTP 请求之前，还需要给 HTTP 请求添加认证 Header。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19312"><span data-slate-object="text" data-key="19313"><span data-slate-leaf="true" data-offset-key="19313:0" data-first-offset="true"><span data-slate-string="true">medu-sdk-go 代码提供了 JWT 和 HMAC 两种认证方式，最终采用了 JWT 认证方式。JWT 认证签发方法为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19314"><span data-slate-object="text" data-key="19315"><span data-slate-leaf="true" data-offset-key="19315:0" data-first-offset="true"><span data-slate-string="true">Sign</span></span></span></a><span data-slate-object="text" data-key="19316"><span data-slate-leaf="true" data-offset-key="19316:0" data-first-offset="true"><span data-slate-string="true">，代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19317"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19318"><span data-slate-object="text" data-key="19319"><span data-slate-leaf="true" data-offset-key="19319:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19320"><span data-slate-leaf="true" data-offset-key="19320:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19321"><span data-slate-leaf="true" data-offset-key="19321:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(v1 SignatureV1)</span></span></span></span></span><span data-slate-object="text" data-key="19322"><span data-slate-leaf="true" data-offset-key="19322:0" data-first-offset="true"><span data-slate-string="true"> Sign(serviceName </span></span></span><span data-slate-object="text" data-key="19323"><span data-slate-leaf="true" data-offset-key="19323:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19324"><span data-slate-leaf="true" data-offset-key="19324:0" data-first-offset="true"><span data-slate-string="true">, r *http.Request, body io.ReadSeeker) http.Header {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19325"><span data-slate-object="text" data-key="19326"><span data-slate-leaf="true" data-offset-key="19326:0" data-first-offset="true"><span data-slate-string="true">  tokenString := auth.Sign(v1.Credentials.SecretID, v1.Credentials.SecretKey, </span></span></span><span data-slate-object="text" data-key="19327"><span data-slate-leaf="true" data-offset-key="19327:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"medu-sdk-go"</span></span></span></span><span data-slate-object="text" data-key="19328"><span data-slate-leaf="true" data-offset-key="19328:0" data-first-offset="true"><span data-slate-string="true">, serviceName+</span></span></span><span data-slate-object="text" data-key="19329"><span data-slate-leaf="true" data-offset-key="19329:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".marmotedu.com"</span></span></span></span><span data-slate-object="text" data-key="19330"><span data-slate-leaf="true" data-offset-key="19330:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19331"><span data-slate-object="text" data-key="19332"><span data-slate-leaf="true" data-offset-key="19332:0" data-first-offset="true"><span data-slate-string="true">  r.Header.Set(</span></span></span><span data-slate-object="text" data-key="19333"><span data-slate-leaf="true" data-offset-key="19333:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization"</span></span></span></span><span data-slate-object="text" data-key="19334"><span data-slate-leaf="true" data-offset-key="19334:0" data-first-offset="true"><span data-slate-string="true">, fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="19335"><span data-slate-leaf="true" data-offset-key="19335:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Bearer %s"</span></span></span></span><span data-slate-object="text" data-key="19336"><span data-slate-leaf="true" data-offset-key="19336:0" data-first-offset="true"><span data-slate-string="true">, tokenString))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19337"><span data-slate-object="text" data-key="19338"><span data-slate-leaf="true" data-offset-key="19338:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19339"><span data-slate-leaf="true" data-offset-key="19339:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19340"><span data-slate-leaf="true" data-offset-key="19340:0" data-first-offset="true"><span data-slate-string="true"> r.Header</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19341"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19342"><span data-slate-object="text" data-key="19343"><span data-slate-leaf="true" data-offset-key="19343:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19344"><span data-slate-type="code" data-slate-object="inline" data-key="19345"><span data-slate-object="text" data-key="19346"><span data-slate-leaf="true" data-offset-key="19346:0" data-first-offset="true"><span data-slate-string="true">auth.Sign</span></span></span></span><span data-slate-object="text" data-key="19347"><span data-slate-leaf="true" data-offset-key="19347:0" data-first-offset="true"><span data-slate-string="true"> 方法根据 SecretID 和 SecretKey 签发 JWT Token。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19348"><span data-slate-object="text" data-key="19349"><span data-slate-leaf="true" data-offset-key="19349:0" data-first-offset="true"><span data-slate-string="true">接下来，我们就可以调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19350"><span data-slate-object="text" data-key="19351"><span data-slate-leaf="true" data-offset-key="19351:0" data-first-offset="true"><span data-slate-string="true">doSend</span></span></span></a><span data-slate-object="text" data-key="19352"><span data-slate-leaf="true" data-offset-key="19352:0" data-first-offset="true"><span data-slate-string="true"> 方法来执行 HTTP 请求了。调用代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19353"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19354"><span data-slate-object="text" data-key="19355"><span data-slate-leaf="true" data-offset-key="19355:0" data-first-offset="true"><span data-slate-string="true">rawResponse, err := c.doSend(method, reqUrl, body, req.GetHeaders(), sign)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19356"><span data-slate-object="text" data-key="19357"><span data-slate-leaf="true" data-offset-key="19357:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19358"><span data-slate-leaf="true" data-offset-key="19358:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19359"><span data-slate-leaf="true" data-offset-key="19359:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19360"><span data-slate-leaf="true" data-offset-key="19360:0" data-first-offset="true"><span data-slate-string="true"> {                                                               </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19361"><span data-slate-object="text" data-key="19362"><span data-slate-leaf="true" data-offset-key="19362:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19363"><span data-slate-leaf="true" data-offset-key="19363:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19364"><span data-slate-leaf="true" data-offset-key="19364:0" data-first-offset="true"><span data-slate-string="true"> err     </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19365"><span data-slate-object="text" data-key="19366"><span data-slate-leaf="true" data-offset-key="19366:0" data-first-offset="true"><span data-slate-string="true">} </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19367"><span data-slate-object="text" data-key="19368"><span data-slate-leaf="true" data-offset-key="19368:0" data-first-offset="true"><span data-slate-string="true">可以看到，我们传入了 HTTP 请求方法 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19369"><span data-slate-object="text" data-key="19370"><span data-slate-leaf="true" data-offset-key="19370:0" data-first-offset="true"><span data-slate-string="true">method</span></span></span></span><span data-slate-object="text" data-key="19371"><span data-slate-leaf="true" data-offset-key="19371:0" data-first-offset="true"><span data-slate-string="true"> 、HTTP 请求 URL  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19372"><span data-slate-object="text" data-key="19373"><span data-slate-leaf="true" data-offset-key="19373:0" data-first-offset="true"><span data-slate-string="true">reqUrl</span></span></span></span><span data-slate-object="text" data-key="19374"><span data-slate-leaf="true" data-offset-key="19374:0" data-first-offset="true"><span data-slate-string="true"> 、HTTP 请求 Body  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19375"><span data-slate-object="text" data-key="19376"><span data-slate-leaf="true" data-offset-key="19376:0" data-first-offset="true"><span data-slate-string="true">body</span></span></span></span><span data-slate-object="text" data-key="19377"><span data-slate-leaf="true" data-offset-key="19377:0" data-first-offset="true"><span data-slate-string="true">，以及用来签发 JWT Token 的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19378"><span data-slate-object="text" data-key="19379"><span data-slate-leaf="true" data-offset-key="19379:0" data-first-offset="true"><span data-slate-string="true">sign</span></span></span></span><span data-slate-object="text" data-key="19380"><span data-slate-leaf="true" data-offset-key="19380:0" data-first-offset="true"><span data-slate-string="true"> 方法。我们在调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19381"><span data-slate-object="text" data-key="19382"><span data-slate-leaf="true" data-offset-key="19382:0" data-first-offset="true"><span data-slate-string="true">NewAuthzRequest</span></span></span></span><span data-slate-object="text" data-key="19383"><span data-slate-leaf="true" data-offset-key="19383:0" data-first-offset="true"><span data-slate-string="true"> 创建 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19384"><span data-slate-object="text" data-key="19385"><span data-slate-leaf="true" data-offset-key="19385:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19386"><span data-slate-leaf="true" data-offset-key="19386:0" data-first-offset="true"><span data-slate-string="true"> 时，指定了 HTTP Method，所以这里的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19387"><span data-slate-object="text" data-key="19388"><span data-slate-leaf="true" data-offset-key="19388:0" data-first-offset="true"><span data-slate-string="true">method := req.GetMethod()</span></span></span></span><span data-slate-object="text" data-key="19389"><span data-slate-leaf="true" data-offset-key="19389:0" data-first-offset="true"><span data-slate-string="true"> 、reqUrl 和请求 Body 都是通过 Builder 来构建的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19390"><span data-slate-object="text" data-key="19391"><span data-slate-leaf="true" data-offset-key="19391:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第三步，Request：执行 H</span></span></span></span><span data-slate-object="text" data-key="19392"><span data-slate-leaf="true" data-offset-key="19392:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">T</span></span></span></span><span data-slate-object="text" data-key="19393"><span data-slate-leaf="true" data-offset-key="19393:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">T</span></span></span></span><span data-slate-object="text" data-key="19394"><span data-slate-leaf="true" data-offset-key="19394:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">P</span></span></span></span><span data-slate-object="text" data-key="19395"><span data-slate-leaf="true" data-offset-key="19395:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true"> 请求。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19396"><span data-slate-object="text" data-key="19397"><span data-slate-leaf="true" data-offset-key="19397:0" data-first-offset="true"><span data-slate-string="true">调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19398"><span data-slate-object="text" data-key="19399"><span data-slate-leaf="true" data-offset-key="19399:0" data-first-offset="true"><span data-slate-string="true">doSend</span></span></span></a><span data-slate-object="text" data-key="19400"><span data-slate-leaf="true" data-offset-key="19400:0" data-first-offset="true"><span data-slate-string="true"> 方法执行 HTTP 请求，doSend 通过调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19401"><span data-slate-object="text" data-key="19402"><span data-slate-leaf="true" data-offset-key="19402:0" data-first-offset="true"><span data-slate-string="true">net/http</span></span></span></span><span data-slate-object="text" data-key="19403"><span data-slate-leaf="true" data-offset-key="19403:0" data-first-offset="true"><span data-slate-string="true"> 包提供的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19404"><span data-slate-object="text" data-key="19405"><span data-slate-leaf="true" data-offset-key="19405:0" data-first-offset="true"><span data-slate-string="true">http.NewRequest</span></span></span></span><span data-slate-object="text" data-key="19406"><span data-slate-leaf="true" data-offset-key="19406:0" data-first-offset="true"><span data-slate-string="true"> 方法来发送 HTTP 请求，执行完 HTTP 请求后，会返回 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19407"><span data-slate-object="text" data-key="19408"><span data-slate-leaf="true" data-offset-key="19408:0" data-first-offset="true"><span data-slate-string="true">*http.Response</span></span></span></span><span data-slate-object="text" data-key="19409"><span data-slate-leaf="true" data-offset-key="19409:0" data-first-offset="true"><span data-slate-string="true"> 类型的 Response。代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19410"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19411"><span data-slate-object="text" data-key="19412"><span data-slate-leaf="true" data-offset-key="19412:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19413"><span data-slate-leaf="true" data-offset-key="19413:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19414"><span data-slate-leaf="true" data-offset-key="19414:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *Client)</span></span></span></span></span><span data-slate-object="text" data-key="19415"><span data-slate-leaf="true" data-offset-key="19415:0" data-first-offset="true"><span data-slate-string="true"> doSend(method, url, data </span></span></span><span data-slate-object="text" data-key="19416"><span data-slate-leaf="true" data-offset-key="19416:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19417"><span data-slate-leaf="true" data-offset-key="19417:0" data-first-offset="true"><span data-slate-string="true">, header </span></span></span><span data-slate-object="text" data-key="19418"><span data-slate-leaf="true" data-offset-key="19418:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">map</span></span></span></span><span data-slate-object="text" data-key="19419"><span data-slate-leaf="true" data-offset-key="19419:0" data-first-offset="true"><span data-slate-string="true">[</span></span></span><span data-slate-object="text" data-key="19420"><span data-slate-leaf="true" data-offset-key="19420:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19421"><span data-slate-leaf="true" data-offset-key="19421:0" data-first-offset="true"><span data-slate-string="true">]</span></span></span><span data-slate-object="text" data-key="19422"><span data-slate-leaf="true" data-offset-key="19422:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19423"><span data-slate-leaf="true" data-offset-key="19423:0" data-first-offset="true"><span data-slate-string="true">, sign SignFunc) (*http.Response, </span></span></span><span data-slate-object="text" data-key="19424"><span data-slate-leaf="true" data-offset-key="19424:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19425"><span data-slate-leaf="true" data-offset-key="19425:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19426"><span data-slate-object="text" data-key="19427"><span data-slate-leaf="true" data-offset-key="19427:0" data-first-offset="true"><span data-slate-string="true">    client := &amp;http.Client{Timeout: c.Config.Timeout}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19428"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19429"><span data-slate-object="text" data-key="19430"><span data-slate-leaf="true" data-offset-key="19430:0" data-first-offset="true"><span data-slate-string="true">    req, err := http.NewRequest(method, url, strings.NewReader(data))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19431"><span data-slate-object="text" data-key="19432"><span data-slate-leaf="true" data-offset-key="19432:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19433"><span data-slate-leaf="true" data-offset-key="19433:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19434"><span data-slate-leaf="true" data-offset-key="19434:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19435"><span data-slate-leaf="true" data-offset-key="19435:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19436"><span data-slate-leaf="true" data-offset-key="19436:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19437"><span data-slate-object="text" data-key="19438"><span data-slate-leaf="true" data-offset-key="19438:0" data-first-offset="true"><span data-slate-string="true">        c.Logger.Errorf(</span></span></span><span data-slate-object="text" data-key="19439"><span data-slate-leaf="true" data-offset-key="19439:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"%s"</span></span></span></span><span data-slate-object="text" data-key="19440"><span data-slate-leaf="true" data-offset-key="19440:0" data-first-offset="true"><span data-slate-string="true">, err.Error())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19441"><span data-slate-object="text" data-key="19442"><span data-slate-leaf="true" data-offset-key="19442:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="19443"><span data-slate-leaf="true" data-offset-key="19443:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19444"><span data-slate-leaf="true" data-offset-key="19444:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19445"><span data-slate-leaf="true" data-offset-key="19445:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19446"><span data-slate-leaf="true" data-offset-key="19446:0" data-first-offset="true"><span data-slate-string="true">, err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19447"><span data-slate-object="text" data-key="19448"><span data-slate-leaf="true" data-offset-key="19448:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19449"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19450"><span data-slate-object="text" data-key="19451"><span data-slate-leaf="true" data-offset-key="19451:0" data-first-offset="true"><span data-slate-string="true">    c.setHeader(req, header)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19452"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19453"><span data-slate-object="text" data-key="19454"><span data-slate-leaf="true" data-offset-key="19454:0" data-first-offset="true"><span data-slate-string="true">    err = sign(req)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19455"><span data-slate-object="text" data-key="19456"><span data-slate-leaf="true" data-offset-key="19456:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19457"><span data-slate-leaf="true" data-offset-key="19457:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19458"><span data-slate-leaf="true" data-offset-key="19458:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19459"><span data-slate-leaf="true" data-offset-key="19459:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19460"><span data-slate-leaf="true" data-offset-key="19460:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19461"><span data-slate-object="text" data-key="19462"><span data-slate-leaf="true" data-offset-key="19462:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="19463"><span data-slate-leaf="true" data-offset-key="19463:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19464"><span data-slate-leaf="true" data-offset-key="19464:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19465"><span data-slate-leaf="true" data-offset-key="19465:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19466"><span data-slate-leaf="true" data-offset-key="19466:0" data-first-offset="true"><span data-slate-string="true">, err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19467"><span data-slate-object="text" data-key="19468"><span data-slate-leaf="true" data-offset-key="19468:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19469"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19470"><span data-slate-object="text" data-key="19471"><span data-slate-leaf="true" data-offset-key="19471:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19472"><span data-slate-leaf="true" data-offset-key="19472:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19473"><span data-slate-leaf="true" data-offset-key="19473:0" data-first-offset="true"><span data-slate-string="true"> client.Do(req)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19474"><span data-slate-object="text" data-key="19475"><span data-slate-leaf="true" data-offset-key="19475:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19476"><span data-slate-object="text" data-key="19477"><span data-slate-leaf="true" data-offset-key="19477:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第四步，处理 H</span></span></span></span><span data-slate-object="text" data-key="19478"><span data-slate-leaf="true" data-offset-key="19478:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">TT</span></span></span></span><span data-slate-object="text" data-key="19479"><span data-slate-leaf="true" data-offset-key="19479:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">P</span></span></span></span><span data-slate-object="text" data-key="19480"><span data-slate-leaf="true" data-offset-key="19480:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true"> 请求</span></span></span></span><span data-slate-object="text" data-key="19481"><span data-slate-leaf="true" data-offset-key="19481:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">返回结果。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19482"><span data-slate-object="text" data-key="19483"><span data-slate-leaf="true" data-offset-key="19483:0" data-first-offset="true"><span data-slate-string="true">调用 doSend 方法返回 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19484"><span data-slate-object="text" data-key="19485"><span data-slate-leaf="true" data-offset-key="19485:0" data-first-offset="true"><span data-slate-string="true">*http.Response</span></span></span></span><span data-slate-object="text" data-key="19486"><span data-slate-leaf="true" data-offset-key="19486:0" data-first-offset="true"><span data-slate-string="true"> 类型的 Response 后，Send 方法会调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19487"><span data-slate-object="text" data-key="19488"><span data-slate-leaf="true" data-offset-key="19488:0" data-first-offset="true"><span data-slate-string="true">ParseFromHttpResponse</span></span></span></a><span data-slate-object="text" data-key="19489"><span data-slate-leaf="true" data-offset-key="19489:0" data-first-offset="true"><span data-slate-string="true"> 函数来处理 HTTP Response，ParseFromHttpResponse 函数代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19490"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19491"><span data-slate-object="text" data-key="19492"><span data-slate-leaf="true" data-offset-key="19492:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19493"><span data-slate-leaf="true" data-offset-key="19493:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19494"><span data-slate-leaf="true" data-offset-key="19494:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">ParseFromHttpResponse</span></span></span></span></span><span data-slate-object="text" data-key="19495"><span data-slate-leaf="true" data-offset-key="19495:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(rawResponse *http.Response, response Response)</span></span></span></span></span><span data-slate-object="text" data-key="19496"><span data-slate-leaf="true" data-offset-key="19496:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19497"><span data-slate-leaf="true" data-offset-key="19497:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19498"><span data-slate-leaf="true" data-offset-key="19498:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19499"><span data-slate-object="text" data-key="19500"><span data-slate-leaf="true" data-offset-key="19500:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19501"><span data-slate-leaf="true" data-offset-key="19501:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">defer</span></span></span></span><span data-slate-object="text" data-key="19502"><span data-slate-leaf="true" data-offset-key="19502:0" data-first-offset="true"><span data-slate-string="true"> rawResponse.Body.Close()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19503"><span data-slate-object="text" data-key="19504"><span data-slate-leaf="true" data-offset-key="19504:0" data-first-offset="true"><span data-slate-string="true">  body, err := ioutil.ReadAll(rawResponse.Body)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19505"><span data-slate-object="text" data-key="19506"><span data-slate-leaf="true" data-offset-key="19506:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19507"><span data-slate-leaf="true" data-offset-key="19507:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19508"><span data-slate-leaf="true" data-offset-key="19508:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19509"><span data-slate-leaf="true" data-offset-key="19509:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19510"><span data-slate-leaf="true" data-offset-key="19510:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19511"><span data-slate-object="text" data-key="19512"><span data-slate-leaf="true" data-offset-key="19512:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19513"><span data-slate-leaf="true" data-offset-key="19513:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19514"><span data-slate-leaf="true" data-offset-key="19514:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19515"><span data-slate-object="text" data-key="19516"><span data-slate-leaf="true" data-offset-key="19516:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19517"><span data-slate-object="text" data-key="19518"><span data-slate-leaf="true" data-offset-key="19518:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19519"><span data-slate-leaf="true" data-offset-key="19519:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19520"><span data-slate-leaf="true" data-offset-key="19520:0" data-first-offset="true"><span data-slate-string="true"> rawResponse.StatusCode != </span></span></span><span data-slate-object="text" data-key="19521"><span data-slate-leaf="true" data-offset-key="19521:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">200</span></span></span></span><span data-slate-object="text" data-key="19522"><span data-slate-leaf="true" data-offset-key="19522:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19523"><span data-slate-object="text" data-key="19524"><span data-slate-leaf="true" data-offset-key="19524:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19525"><span data-slate-leaf="true" data-offset-key="19525:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19526"><span data-slate-leaf="true" data-offset-key="19526:0" data-first-offset="true"><span data-slate-string="true"> fmt.Errorf(</span></span></span><span data-slate-object="text" data-key="19527"><span data-slate-leaf="true" data-offset-key="19527:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"request fail with status: %s, with body: %s"</span></span></span></span><span data-slate-object="text" data-key="19528"><span data-slate-leaf="true" data-offset-key="19528:0" data-first-offset="true"><span data-slate-string="true">, rawResponse.Status, body)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19529"><span data-slate-object="text" data-key="19530"><span data-slate-leaf="true" data-offset-key="19530:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19531"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19532"><span data-slate-object="text" data-key="19533"><span data-slate-leaf="true" data-offset-key="19533:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19534"><span data-slate-leaf="true" data-offset-key="19534:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19535"><span data-slate-leaf="true" data-offset-key="19535:0" data-first-offset="true"><span data-slate-string="true"> err := response.ParseErrorFromHTTPResponse(body); err != </span></span></span><span data-slate-object="text" data-key="19536"><span data-slate-leaf="true" data-offset-key="19536:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19537"><span data-slate-leaf="true" data-offset-key="19537:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19538"><span data-slate-object="text" data-key="19539"><span data-slate-leaf="true" data-offset-key="19539:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19540"><span data-slate-leaf="true" data-offset-key="19540:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19541"><span data-slate-leaf="true" data-offset-key="19541:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19542"><span data-slate-object="text" data-key="19543"><span data-slate-leaf="true" data-offset-key="19543:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19544"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19545"><span data-slate-object="text" data-key="19546"><span data-slate-leaf="true" data-offset-key="19546:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19547"><span data-slate-leaf="true" data-offset-key="19547:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="19548"><span data-slate-leaf="true" data-offset-key="19548:0" data-first-offset="true"><span data-slate-string="true"> json.Unmarshal(body, &amp;response)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19549"><span data-slate-object="text" data-key="19550"><span data-slate-leaf="true" data-offset-key="19550:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19551"><span data-slate-object="text" data-key="19552"><span data-slate-leaf="true" data-offset-key="19552:0" data-first-offset="true"><span data-slate-string="true">可以看到，在 ParseFromHttpResponse 函数中，会先判断 HTTP Response 中的 StatusCode 是否为 200，如果不是 200，则会报错。如果是 200，会调用传入的 resp 变量提供的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19553"><span data-slate-object="text" data-key="19554"><span data-slate-leaf="true" data-offset-key="19554:0" data-first-offset="true"><span data-slate-string="true">ParseErrorFromHTTPResponse</span></span></span></a><span data-slate-object="text" data-key="19555"><span data-slate-leaf="true" data-offset-key="19555:0" data-first-offset="true"><span data-slate-string="true"> 方法，来将 HTTP Response 的 Body Unmarshal 到 resp 变量中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19556"><span data-slate-object="text" data-key="19557"><span data-slate-leaf="true" data-offset-key="19557:0" data-first-offset="true"><span data-slate-string="true">通过以上四步，SDK 调用方调用了 API，并获得了 API 的返回结果 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19558"><span data-slate-object="text" data-key="19559"><span data-slate-leaf="true" data-offset-key="19559:0" data-first-offset="true"><span data-slate-string="true">resp</span></span></span></span><span data-slate-object="text" data-key="19560"><span data-slate-leaf="true" data-offset-key="19560:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19561"><span data-slate-object="text" data-key="19562"><span data-slate-leaf="true" data-offset-key="19562:0" data-first-offset="true"><span data-slate-string="true">下面这些公有云厂商的 SDK 采用了此设计模式：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19563"><div data-slate-type="list-line" data-slate-object="block" data-key="19564"><span data-slate-object="text" data-key="19565"><span data-slate-leaf="true" data-offset-key="19565:0" data-first-offset="true"><span data-slate-string="true">腾讯云 SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19566"><span data-slate-object="text" data-key="19567"><span data-slate-leaf="true" data-offset-key="19567:0" data-first-offset="true"><span data-slate-string="true">tencentcloud-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19568"><span data-slate-leaf="true" data-offset-key="19568:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19569"><span data-slate-object="text" data-key="19570"><span data-slate-leaf="true" data-offset-key="19570:0" data-first-offset="true"><span data-slate-string="true">AWS SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19571"><span data-slate-object="text" data-key="19572"><span data-slate-leaf="true" data-offset-key="19572:0" data-first-offset="true"><span data-slate-string="true">aws-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19573"><span data-slate-leaf="true" data-offset-key="19573:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19574"><span data-slate-object="text" data-key="19575"><span data-slate-leaf="true" data-offset-key="19575:0" data-first-offset="true"><span data-slate-string="true">阿里云 SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19576"><span data-slate-object="text" data-key="19577"><span data-slate-leaf="true" data-offset-key="19577:0" data-first-offset="true"><span data-slate-string="true">alibaba-cloud-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19578"><span data-slate-leaf="true" data-offset-key="19578:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19579"><span data-slate-object="text" data-key="19580"><span data-slate-leaf="true" data-offset-key="19580:0" data-first-offset="true"><span data-slate-string="true">京东云 SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19581"><span data-slate-object="text" data-key="19582"><span data-slate-leaf="true" data-offset-key="19582:0" data-first-offset="true"><span data-slate-string="true">jdcloud-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19583"><span data-slate-leaf="true" data-offset-key="19583:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19584"><span data-slate-object="text" data-key="19585"><span data-slate-leaf="true" data-offset-key="19585:0" data-first-offset="true"><span data-slate-string="true">Ucloud SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19586"><span data-slate-object="text" data-key="19587"><span data-slate-leaf="true" data-offset-key="19587:0" data-first-offset="true"><span data-slate-string="true">ucloud-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19588"><span data-slate-leaf="true" data-offset-key="19588:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19589"><span data-slate-object="text" data-key="19590"><span data-slate-leaf="true" data-offset-key="19590:0" data-first-offset="true"><span data-slate-string="true">IAM 公有云方式的 SDK 实现为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19591"><span data-slate-object="text" data-key="19592"><span data-slate-leaf="true" data-offset-key="19592:0" data-first-offset="true"><span data-slate-string="true">medu-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19593"><span data-slate-leaf="true" data-offset-key="19593:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19594"><span data-slate-object="text" data-key="19595"><span data-slate-leaf="true" data-offset-key="19595:0" data-first-offset="true"><span data-slate-string="true">此外，IAM 还设计并实现了 Kubernetes client-go 方式的 Go SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19596"><span data-slate-object="text" data-key="19597"><span data-slate-leaf="true" data-offset-key="19597:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19598"><span data-slate-leaf="true" data-offset-key="19598:0" data-first-offset="true"><span data-slate-string="true">，marmotedu-sdk-go 也是 IAM Go SDK 所采用的 SDK。下一讲中，我会具体介绍 marmotedu-sdk-go 的设计和实现。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="19599" id="sr-toc-9"><span data-slate-object="text" data-key="19600"><span data-slate-leaf="true" data-offset-key="19600:0" data-first-offset="true"><span data-slate-string="true">总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="19601"><span data-slate-object="text" data-key="19602"><span data-slate-leaf="true" data-offset-key="19602:0" data-first-offset="true"><span data-slate-string="true">这一讲，我主要介绍了如何设计一个优秀的 Go SDK。通过提供 SDK，可以提高 API 调用效率，减少 API 调用难度，所以大型应用通常都会提供 SDK。不同团队有不同的 SDK 设计方法，但目前比较好的实现是公有云厂商采用的 SDK 设计方式。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19603"><span data-slate-object="text" data-key="19604"><span data-slate-leaf="true" data-offset-key="19604:0" data-first-offset="true"><span data-slate-string="true">公有云厂商的 SDK 设计方式中，SDK 按调用顺序从上到下可以分为 3 个模块，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="19605"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/b9/a9/b9bd3020ae56f6bb49bc3a38bcaf64a9.jpg?wh=1920x878"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19606"><span data-slate-object="text" data-key="19607"><span data-slate-leaf="true" data-offset-key="19607:0" data-first-offset="true"><span data-slate-string="true">Client 构造 SDK 客户端，在构造客户端时，会创建请求参数 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19608"><span data-slate-object="text" data-key="19609"><span data-slate-leaf="true" data-offset-key="19609:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19610"><span data-slate-leaf="true" data-offset-key="19610:0" data-first-offset="true"><span data-slate-string="true"> ， </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19611"><span data-slate-object="text" data-key="19612"><span data-slate-leaf="true" data-offset-key="19612:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19613"><span data-slate-leaf="true" data-offset-key="19613:0" data-first-offset="true"><span data-slate-string="true"> 中会指定 API 版本、HTTP 请求方法、API 请求路径等信息。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19614"><span data-slate-object="text" data-key="19615"><span data-slate-leaf="true" data-offset-key="19615:0" data-first-offset="true"><span data-slate-string="true">Client 会请求 Builder 和 Signer 来构建 HTTP 请求的各项参数：HTTP 请求方法、HTTP 请求路径、HTTP 认证头、HTTP 请求 Body。Builder 和 Signer 是根据 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19616"><span data-slate-object="text" data-key="19617"><span data-slate-leaf="true" data-offset-key="19617:0" data-first-offset="true"><span data-slate-string="true">req</span></span></span></span><span data-slate-object="text" data-key="19618"><span data-slate-leaf="true" data-offset-key="19618:0" data-first-offset="true"><span data-slate-string="true"> 配置来构造这些 HTTP 请求参数的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19619"><span data-slate-object="text" data-key="19620"><span data-slate-leaf="true" data-offset-key="19620:0" data-first-offset="true"><span data-slate-string="true">构造完成之后，会请求 Request 模块，Request 模块通过调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19621"><span data-slate-object="text" data-key="19622"><span data-slate-leaf="true" data-offset-key="19622:0" data-first-offset="true"><span data-slate-string="true">net/http</span></span></span></span><span data-slate-object="text" data-key="19623"><span data-slate-leaf="true" data-offset-key="19623:0" data-first-offset="true"><span data-slate-string="true"> 包，来执行 HTTP 请求，并返回请求结果。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="19624" id="sr-toc-10"><span data-slate-object="text" data-key="19625"><span data-slate-leaf="true" data-offset-key="19625:0" data-first-offset="true"><span data-slate-string="true">课后练习</span></span></span></h2><div data-slate-type="list" data-slate-object="block" data-key="19626"><div data-slate-type="list-line" data-slate-object="block" data-key="19627"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="19628"><span data-slate-leaf="true" data-offset-key="19628:0" data-first-offset="true"><span data-slate-string="true">思考下，如何实现可以支持多个 API 版本的 SDK 包，代码如何实现？</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="19629"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="19630"><span data-slate-leaf="true" data-offset-key="19630:0" data-first-offset="true"><span data-slate-string="true">这一讲介绍了一种 SDK 实现方式，在你的 Go 开发生涯中，还有没有一些更好的 SDK 实现方法？欢迎在留言区分享。</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19631"><span data-slate-object="text" data-key="19632"><span data-slate-leaf="true" data-offset-key="19632:0" data-first-offset="true"><span data-slate-string="true">期待你在留言区与我交流讨论，我们下一讲见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/1f/81/1f6c18433af717a740f1e49389f2f981.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-11">精选留言 (8)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/25/06/13/e4f9f79b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>你赖东东不错嘛</span></div></div><div>Q1: 构建 Request 时将 API 版本作为可选参数传入</div><div><p>作者回复：优秀！</p></div><div><div>2021-08-11</div><div><div><i></i></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>return</span></div></div><div>老师讲的太好了，
请教老师一个问题：
sdk 中 日志应该如何设计比较好，
我看 阿里云是 默认了一个实现，用的标准 log。
这样好吗， 如果用户使用的是  zap，那是不是得分文件，用同一个文件会不会冲突。
感觉都不优雅</div><div><p>作者回复：我感觉有 2 个思路：
1. 直接返回错误，不打印日志。
2. 如果 SDK 中需要打印日志，在创建 SDK Client 时，添加一个可选的 Logger 接口，将程序中的 logger 传进入。

建议 1，感觉 SDK 没必要打印日志，因为 SDK 功能其实比较简单，就是组合参数、发送 HTTP 请求、返回数据。不会封装复杂的逻辑。</p></div><div><div>2021-12-06</div><div><div><i></i><span>2</span></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Sch0ng</span></div></div><div>sdk 为服务使用方提供了方便的同时，也为服务提供方省去很多不必要的沟通培训成本。
文中介绍了 go sdk 的目录结构，架构和云厂商常用的设计实现方案。</div><div><div>2021-08-17</div><div><div><i></i><span></span></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>yandongxiao</span></div></div><div>总结：
SDK 的命名规范、目录结构、以及各个云厂商的逻辑架构。
云厂商的 SDK 的实现分为两层：API 层和基础层。
API 层实现一个 Client 对象，每个方法对应了一个 API 接口
基础层：主要负责，请求的 Marshall、Unmarshal、签名等功能。
API 层的 Client 通过匿名的方式继承了基础层的 Client。</div><div><p>作者回复：总结的到位！</p></div><div><div>2021-12-04</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132"></div></div><div><div><div><span>ppd0705</span></div></div><div>云厂商 python 版本 sdk 感觉代码质量 ucloud 最好</div><div><p>作者回复：感谢分享！</p></div><div><div>2021-10-31</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="http://thirdwx.qlogo.cn/mmopen/vi_32/iaxgvyIjNFomptQ9qBk4iaakYOS1XojYHDp48TXt1kX9DxTkKuR2UXGTyhG1liahib6E4BLF12ia6mic2pF0t4ECeZIQ/132"></div></div><div><div><div><span>Joeforfun</span></div></div><div>很赞，准备给没有 go-sdk 的某云厂商写个简单的 demo</div><div><div>2021-08-31</div><div><div><i></i><span>7</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/18/3e/89/ccc2ebd9.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 陈晓涛</span></div></div><div>openapi-generator 是个非常不错的项目：https://github.com/openapitools/openapi-generator，支持生成几十种客户端语言，安装简单，使用简单，生成的代码质量高，还有特别详细的 markdown 使用文档，超级推荐</div><div><p>作者回复：感谢分享，后面看下能否切换到这种方式</p></div><div><div>2022-01-19</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1d/9b/e5/bd0be5c3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>⁶₆⁶₆⁶₆</span></div></div><div>你讲义里面提供的客户端调用示例执行失败了，也就是你 https://github.com/marmotedu/medu-sdk-go 里面提供的那个示例代码，错误提示如下，提示找不到对应的包，但是明明已经拉下来了呀，没看出原因，希望大佬能解答下。

[root@dev sdk]# go mod init sdk
go: creating new go.mod: module sdk
go: to add module requirements and sums:
        go mod tidy
[root@dev sdk]# go mod tidy
go: finding module for package github.com/marmotedu/medu-sdk-go/services/iam
go: finding module for package github.com/marmotedu/medu-sdk-go/sdk
go: finding module for package github.com/ory/ladon
go: found github.com/marmotedu/medu-sdk-go/sdk in github.com/marmotedu/medu-sdk-go v1.0.0
go: found github.com/ory/ladon in github.com/ory/ladon v1.2.0
go: finding module for package github.com/marmotedu/medu-sdk-go/services/iam
sdk imports
        github.com/marmotedu/medu-sdk-go/services/iam: module github.com/marmotedu/medu-sdk-go@latest found (v1.0.0), but does not contain package github.com/marmotedu/medu-sdk-go/services/iam
[root@dev sdk]#
[root@dev sdk]# ll /root/workspace/golang/pkg/mod/github.com/marmotedu/
total 8
dr-xr-xr-x  6 root root  185 Sep 16 01:16 api@v1.0.1
dr-xr-xr-x  3 root root  138 Sep 25 17:48 component-base@v0.0.2
dr-xr-xr-x  3 root root  138 Sep 22 22:43 component-base@v1.0.0
dr-xr-xr-x  3 root root  138 Sep 16 01:16 component-base@v1.0.1
dr-xr-xr-x  2 root root 4096 Sep 22 22:43 errors@v0.0.1
dr-xr-xr-x  2 root root 4096 Sep 16 01:16 errors@v1.0.2
dr-xr-xr-x 18 root root  257 Sep 15 22:57 gopractise-demo@v0.0.1
dr-xr-xr-x  5 root root  261 Sep 16 01:16 log@v0.0.1
dr-xr-xr-x  8 root root  233 Sep 16 01:18 marmotedu-sdk-go@v1.0.2-0.20210528170801-2c91b80cb4cf
dr-xr-xr-x  5 root root  112 Sep 25 17:48 medu-sdk-go@v1.0.0
[root@dev sdk]#
</div><div><p>作者回复: go mod init sdk

上面的命令换成：go mod init github.com/marmotedu/medu-sdk-go

因为你 init 的报名是 sdk，所以找不到当前包下的 iam 目录</p></div><div><div>2021-09-25</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".11"><outline class="toc-level-h1" data-reactid=".11.0" style="width: 175px;"><active data-reactid=".11.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".11.0.1"><span data-reactid=".11.0.1.0"> 33 |  SDK 设计（上）：如何设计出一个优秀的 Go SDK？</span></a></outline><outline class="toc-level-h2" data-reactid=".11.1" style="width: 165px;"><active data-reactid=".11.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".11.1.1"><span data-reactid=".11.1.1.0">什么是 SDK？</span></a></outline><outline class="toc-level-h2" data-reactid=".11.2" style="width: 165px;"><active data-reactid=".11.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".11.2.1"><span data-reactid=".11.2.1.0">SDK 设计方法</span></a></outline><outline class="toc-level-h3" data-reactid=".11.3" style="width: 155px;"><active data-reactid=".11.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".11.3.1"><span data-reactid=".11.3.1.0">如何给 SDK 命名？</span></a></outline><outline class="toc-level-h3" data-reactid=".11.4" style="width: 155px;"><active data-reactid=".11.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".11.4.1"><span data-reactid=".11.4.1.0">SDK 的目录结构</span></a></outline><outline class="toc-level-h3" data-reactid=".11.5" style="width: 155px;"><active data-reactid=".11.5.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".11.5.1"><span data-reactid=".11.5.1.0">SDK 设计方法</span></a></outline><outline class="toc-level-h2" data-reactid=".11.6" style="width: 165px;"><active data-reactid=".11.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".11.6.1"><span data-reactid=".11.6.1.0">公有云厂商采用的 SDK 设计方式</span></a></outline><outline class="toc-level-h3" data-reactid=".11.7" style="width: 155px;"><active data-reactid=".11.7.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".11.7.1"><span data-reactid=".11.7.1.0">API 层：创建客户端实例</span></a></outline><outline class="toc-level-h3" data-reactid=".11.8" style="width: 155px;"><active data-reactid=".11.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".11.8.1"><span data-reactid=".11.8.1.0">基础层：构建并执行 HTTP 请求</span></a></outline><outline class="toc-level-h2" data-reactid=".11.9" style="width: 165px;"><active data-reactid=".11.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".11.9.1"><span data-reactid=".11.9.1.0">总结</span></a></outline><outline class="toc-level-h2" data-reactid=".11.a" style="width: 165px;"><active data-reactid=".11.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".11.a.1"><span data-reactid=".11.a.1.0">课后练习</span></a></outline><outline class="toc-level-h2" data-reactid=".11.b" style="width: 165px;"><active data-reactid=".11.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".11.b.1"><span data-reactid=".11.b.1.0">精选留言 (8)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/406389" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>