
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 02 | 几行汇编几行 C：实现一个最简单的内核</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>02 | 几行汇编几行 C：实现一个最简单的内核</sr-rd-title>
                    
                    <sr-rd-content><h1 id="sr-toc-0"> 02 | 几行汇编几行 C：实现一个最简单的内核</h1><div><span>LMOS</span> <span>2021-05-12</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/cc/c2/cc8b43db9ba6612c13dde51083894cc2.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：陈晨</span><span>大小：12.32M</span><span> 时长：13:29</span></div></div><audio title="02 | 几行汇编几行C：实现一个最简单的内核" src="https://res001.geekbang.org/media/audio/fa/c2/fa83e7db04c115964e83ece8648e53c2/ld/ld.m3u8"></audio></div><div><div><div><div data-slate-editor="true" data-key="791" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="792"><span data-slate-object="text" data-key="793"><span data-slate-leaf="true" data-offset-key="793:0" data-first-offset="true"><span data-slate-string="true">你好，我是 LMOS。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="794"><span data-slate-object="text" data-key="795"><span data-slate-leaf="true" data-offset-key="795:0" data-first-offset="true"><span data-slate-string="true">我们知道，在学习许多编程语言一开始的时候，都有一段用其语言编写的经典程序 ——Hello World。这不过是某一操作系统平台之上的应用程序，却心高气傲地问候世界。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="796"><span data-slate-object="text" data-key="797"><span data-slate-leaf="true" data-offset-key="797:0" data-first-offset="true"><span data-slate-string="true">而我们学习操作系统的时候，那么也不妨撇开其它现有的操作系统，基于硬件，写一个最小的操作系统 ——Hello OS，先练练手、热热身，直观感受一下。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="798"><span data-slate-object="text" data-key="799"><span data-slate-leaf="true" data-offset-key="799:0" data-first-offset="true"><span data-slate-string="true">本节课的</span></span></span><span data-slate-object="text" data-key="800"><span data-slate-leaf="true" data-offset-key="800:0" data-first-offset="true"><span data-slate-type="primary" data-slate-object="mark"><span data-slate-string="true">配套代码</span></span></span></span><span data-slate-object="text" data-key="801"><span data-slate-leaf="true" data-offset-key="801:0" data-first-offset="true"><span data-slate-string="true">，你可以从</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="802"><span data-slate-object="text" data-key="803"><span data-slate-leaf="true" data-offset-key="803:0" data-first-offset="true"><span data-slate-string="true">这里</span></span></span></a><span data-slate-object="text" data-key="804"><span data-slate-leaf="true" data-offset-key="804:0" data-first-offset="true"><span data-slate-string="true">下载。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="805"><span data-slate-object="text" data-key="806"><span data-slate-leaf="true" data-offset-key="806:0" data-first-offset="true"><span data-slate-string="true">请注意，这节课主要是演示思路，不要求你马上动手实现。详细的环境安装、配置我们到第十节课再详细展开。有兴趣上手的同学，可以参考留言区置顶的实验笔记探索。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="807" id="sr-toc-1"><span data-slate-object="text" data-key="808"><span data-slate-leaf="true" data-offset-key="808:0" data-first-offset="true"><span data-slate-string="true">PC 机的引导流程</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="809"><span data-slate-object="text" data-key="810"><span data-slate-leaf="true" data-offset-key="810:0" data-first-offset="true"><span data-slate-string="true">看标题就知道，写操作系统要用汇编和 C 语言，尽管这个 Hello OS 很小，但也要用到两种编程语言。其实，现有的商业操作系统都是用这两种语言开发出来的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="811"><span data-slate-object="text" data-key="812"><span data-slate-leaf="true" data-offset-key="812:0" data-first-offset="true"><span data-slate-string="true">先不用害怕，Hello OS 的代码量很少。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="813"><span data-slate-object="text" data-key="814"><span data-slate-leaf="true" data-offset-key="814:0" data-first-offset="true"><span data-slate-string="true">其实，我们也不打算从 PC 的引导程序开始写起，原因是目前我们的知识储备还不够，所以先借用一下 GRUB 引导程序，只要我们的 PC 机上安装了 Ubuntu Linux 操作系统，GRUB 就已经存在了。这会大大降低我们开始的难度，也不至于打消你的热情。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="815"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/1d/dc/1db2342da1abdc9f1f77e4c69a94d0dc.png?wh=620*421"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="816"><span data-slate-object="text" data-key="817"><span data-slate-leaf="true" data-offset-key="817:0" data-first-offset="true"><span data-slate-string="true">那在写 Hello OS 之前，我们先要搞清楚 Hello OS 的引导流程，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="818"><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/resource/image/f2/bd/f2d31ab7144bf309761711efa9d6d4bd.jpg?wh=4335*3170"></div><div>Hello OS 引导流程图</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="819"><span data-slate-object="text" data-key="820"><span data-slate-leaf="true" data-offset-key="820:0" data-first-offset="true"><span data-slate-string="true">简单解释一下，PC 机 BIOS 固件是固化在 PC 机主板上的 ROM 芯片中的，掉电也能保存，PC 机上电后的第一条指令就是 BIOS 固件中的，它负责</span></span></span><span data-slate-object="text" data-key="821"><span data-slate-leaf="true" data-offset-key="821:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">检测和初始化 CPU、内存及主板平台</span></span></span></span><span data-slate-object="text" data-key="822"><span data-slate-leaf="true" data-offset-key="822:0" data-first-offset="true"><span data-slate-string="true">，然后加载引导设备（大概率是硬盘）中的第一个扇区数据，到 0x7c00 地址开始的内存空间，再接着跳转到 0x7c00 处执行指令，在我们这里的情况下就是 GRUB 引导程序。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="823"><span data-slate-object="text" data-key="824"><span data-slate-leaf="true" data-offset-key="824:0" data-first-offset="true"><span data-slate-string="true">当然，更先进的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="825"><span data-slate-object="text" data-key="826"><span data-slate-leaf="true" data-offset-key="826:0" data-first-offset="true"><span data-slate-string="true">UEFI BIOS</span></span></span></a><span data-slate-object="text" data-key="827"><span data-slate-leaf="true" data-offset-key="827:0" data-first-offset="true"><span data-slate-string="true"> 则不同，这里就不深入其中了，你可以通过链接自行了解。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="828" id="sr-toc-2"><span data-slate-object="text" data-key="829"><span data-slate-leaf="true" data-offset-key="829:0" data-first-offset="true"><span data-slate-string="true">Hello OS 引导汇编代码</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="830"><span data-slate-object="text" data-key="831"><span data-slate-leaf="true" data-offset-key="831:0" data-first-offset="true"><span data-slate-string="true">明白了 PC 机的启动流程，下面只剩下我们的 Hello OS 了，我们马上就去写好它。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="832"><span data-slate-object="text" data-key="833"><span data-slate-leaf="true" data-offset-key="833:0" data-first-offset="true"><span data-slate-string="true">我们先来写一段汇编代码。这里我要特别说明一个问题：为什么不能直接用 C？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="834"><span data-slate-object="text" data-key="835"><span data-slate-leaf="true" data-offset-key="835:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_77bff97b" data-attr-id="38554" data-attr-name="public" data-annotation-type="public"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">C 作为通用的高级语言，不能直接操作特定的硬件，而且 C 语言的函数调用、函数传参，</span></span></span></span><span data-slate-leaf="true" data-offset-key="835:1"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">都需要用栈。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="836"><span data-slate-object="text" data-key="837"><span data-slate-leaf="true" data-offset-key="837:0" data-first-offset="true"><span data-slate-string="true">栈简单来说就是一块内存空间，其中数据满足</span></span></span><span data-slate-object="text" data-key="838"><span data-slate-leaf="true" data-offset-key="838:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">后进先出</span></span></span></span><span data-slate-object="text" data-key="839"><span data-slate-leaf="true" data-offset-key="839:0" data-first-offset="true"><span data-slate-string="true">的特性，它由 CPU 特定的栈寄存器指向，</span></span><span data-slate-leaf="true" data-offset-key="839:1"><span data-slate-object="annotation" data-annotation-key="gkann_29d4d2d5" data-attr-id="40438" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">所以我们要先用汇编代码处理好这些 C 语言的工作环境。</span></span></span></span></div><div data-code-language="css" data-slate-type="pre" data-slate-object="block" data-key="840"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div><div data-code-line-number="52"></div><div data-code-line-number="53"></div><div data-code-line-number="54"></div><div data-code-line-number="55"></div><div data-code-line-number="56"></div><div data-code-line-number="57"></div><div data-code-line-number="58"></div><div data-code-line-number="59"></div><div data-code-line-number="60"></div><div data-code-line-number="61"></div><div data-code-line-number="62"></div><div data-code-line-number="63"></div><div data-code-line-number="64"></div><div data-code-line-number="65"></div><div data-code-line-number="66"></div><div data-code-line-number="67"></div><div data-code-line-number="68"></div><div data-code-line-number="69"></div><div data-code-line-number="70"></div><div data-code-line-number="71"></div><div data-code-line-number="72"></div><div data-code-line-number="73"></div><div data-code-line-number="74"></div><div data-code-line-number="75"></div><div data-code-line-number="76"></div><div data-code-line-number="77"></div><div data-code-line-number="78"></div><div data-code-line-number="79"></div><div data-code-line-number="80"></div><div data-code-line-number="81"></div><div data-code-line-number="82"></div><div data-code-line-number="83"></div><div data-code-line-number="84"></div><div data-code-line-number="85"></div><div data-code-line-number="86"></div><div data-code-line-number="87"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="841"><span data-slate-object="text" data-key="842"><span data-slate-leaf="true" data-offset-key="842:0" data-first-offset="true"><span data-slate-string="true">; 彭东 @ </span></span></span><span data-slate-object="text" data-key="843"><span data-slate-leaf="true" data-offset-key="843:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">2021.01</span></span></span></span><span data-slate-object="text" data-key="844"><span data-slate-leaf="true" data-offset-key="844:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="845"><span data-slate-leaf="true" data-offset-key="845:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">09</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="846"><span data-slate-object="text" data-key="847"><span data-slate-leaf="true" data-offset-key="847:0" data-first-offset="true"><span data-slate-string="true">MBT_HDR_FLAGS EQU </span></span></span><span data-slate-object="text" data-key="848"><span data-slate-leaf="true" data-offset-key="848:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="849"><span data-slate-leaf="true" data-offset-key="849:0" data-first-offset="true"><span data-slate-string="true">x00010003</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="850"><span data-slate-object="text" data-key="851"><span data-slate-leaf="true" data-offset-key="851:0" data-first-offset="true"><span data-slate-string="true">MBT_HDR_MAGIC EQU </span></span></span><span data-slate-object="text" data-key="852"><span data-slate-leaf="true" data-offset-key="852:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="853"><span data-slate-leaf="true" data-offset-key="853:0" data-first-offset="true"><span data-slate-string="true">x1BADB002 ; 多引导协议头魔数</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="854"><span data-slate-object="text" data-key="855"><span data-slate-leaf="true" data-offset-key="855:0" data-first-offset="true"><span data-slate-string="true">MBT_HDR2_MAGIC EQU </span></span></span><span data-slate-object="text" data-key="856"><span data-slate-leaf="true" data-offset-key="856:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="857"><span data-slate-leaf="true" data-offset-key="857:0" data-first-offset="true"><span data-slate-string="true">xe85250d6 ; 第二版多引导协议头魔数</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="858"><span data-slate-object="text" data-key="859"><span data-slate-leaf="true" data-offset-key="859:0" data-first-offset="true"><span data-slate-string="true">global _start ; 导出_start 符号</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="860"><span data-slate-object="text" data-key="861"><span data-slate-leaf="true" data-offset-key="861:0" data-first-offset="true"><span data-slate-string="true">extern </span></span></span><span data-slate-object="text" data-key="862"><span data-slate-leaf="true" data-offset-key="862:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span><span data-slate-object="text" data-key="863"><span data-slate-leaf="true" data-offset-key="863:0" data-first-offset="true"><span data-slate-string="true"> ; 导入外部的</span></span></span><span data-slate-object="text" data-key="864"><span data-slate-leaf="true" data-offset-key="864:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> main</span></span></span></span><span data-slate-object="text" data-key="865"><span data-slate-leaf="true" data-offset-key="865:0" data-first-offset="true"><span data-slate-string="true"> 函数符号</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="866"><span data-slate-object="text" data-key="867"><span data-slate-leaf="true" data-offset-key="867:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">[section .start.text]</span></span></span></span><span data-slate-object="text" data-key="868"><span data-slate-leaf="true" data-offset-key="868:0" data-first-offset="true"><span data-slate-string="true"> ; 定义</span></span></span><span data-slate-object="text" data-key="869"><span data-slate-leaf="true" data-offset-key="869:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.start</span></span></span></span><span data-slate-object="text" data-key="870"><span data-slate-leaf="true" data-offset-key="870:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">.text</span></span></span></span><span data-slate-object="text" data-key="871"><span data-slate-leaf="true" data-offset-key="871:0" data-first-offset="true"><span data-slate-string="true"> 代码节</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="872"><span data-slate-object="text" data-key="873"><span data-slate-leaf="true" data-offset-key="873:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">[bits 32]</span></span></span></span><span data-slate-object="text" data-key="874"><span data-slate-leaf="true" data-offset-key="874:0" data-first-offset="true"><span data-slate-string="true"> ; 汇编成</span></span></span><span data-slate-object="text" data-key="875"><span data-slate-leaf="true" data-offset-key="875:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> 32</span></span></span></span><span data-slate-object="text" data-key="876"><span data-slate-leaf="true" data-offset-key="876:0" data-first-offset="true"><span data-slate-string="true"> 位代码</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="877"><span data-slate-object="text" data-key="878"><span data-slate-leaf="true" data-offset-key="878:0" data-first-offset="true"><span data-slate-string="true">_start:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="879"><span data-slate-object="text" data-key="880"><span data-slate-leaf="true" data-offset-key="880:0" data-first-offset="true"><span data-slate-string="true">jmp _entry</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="881"><span data-slate-object="text" data-key="882"><span data-slate-leaf="true" data-offset-key="882:0" data-first-offset="true"><span data-slate-string="true">ALIGN </span></span></span><span data-slate-object="text" data-key="883"><span data-slate-leaf="true" data-offset-key="883:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">8</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="884"><span data-slate-object="text" data-key="885"><span data-slate-leaf="true" data-offset-key="885:0" data-first-offset="true"><span data-slate-string="true">mbt_hdr:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="886"><span data-slate-object="text" data-key="887"><span data-slate-leaf="true" data-offset-key="887:0" data-first-offset="true"><span data-slate-string="true">dd MBT_HDR_MAGIC</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="888"><span data-slate-object="text" data-key="889"><span data-slate-leaf="true" data-offset-key="889:0" data-first-offset="true"><span data-slate-string="true">dd MBT_HDR_FLAGS</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="890"><span data-slate-object="text" data-key="891"><span data-slate-leaf="true" data-offset-key="891:0" data-first-offset="true"><span data-slate-string="true">dd </span></span></span><span data-slate-object="text" data-key="892"><span data-slate-leaf="true" data-offset-key="892:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-</span></span></span></span><span data-slate-object="text" data-key="893"><span data-slate-leaf="true" data-offset-key="893:0" data-first-offset="true"><span data-slate-string="true">(MBT_HDR_MAGIC+MBT_HDR_FLAGS)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="894"><span data-slate-object="text" data-key="895"><span data-slate-leaf="true" data-offset-key="895:0" data-first-offset="true"><span data-slate-string="true">dd mbt_hdr</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="896"><span data-slate-object="text" data-key="897"><span data-slate-leaf="true" data-offset-key="897:0" data-first-offset="true"><span data-slate-string="true">dd _start</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="898"><span data-slate-object="text" data-key="899"><span data-slate-leaf="true" data-offset-key="899:0" data-first-offset="true"><span data-slate-string="true">dd </span></span></span><span data-slate-object="text" data-key="900"><span data-slate-leaf="true" data-offset-key="900:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="901"><span data-slate-object="text" data-key="902"><span data-slate-leaf="true" data-offset-key="902:0" data-first-offset="true"><span data-slate-string="true">dd </span></span></span><span data-slate-object="text" data-key="903"><span data-slate-leaf="true" data-offset-key="903:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="904"><span data-slate-object="text" data-key="905"><span data-slate-leaf="true" data-offset-key="905:0" data-first-offset="true"><span data-slate-string="true">dd _entry</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="906"><span data-slate-object="text" data-key="907"><span data-slate-leaf="true" data-offset-key="907:0" data-first-offset="true"><span data-slate-string="true">; 以上是 GRUB 所需要的头</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="908"><span data-slate-object="text" data-key="909"><span data-slate-leaf="true" data-offset-key="909:0" data-first-offset="true"><span data-slate-string="true">ALIGN </span></span></span><span data-slate-object="text" data-key="910"><span data-slate-leaf="true" data-offset-key="910:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">8</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="911"><span data-slate-object="text" data-key="912"><span data-slate-leaf="true" data-offset-key="912:0" data-first-offset="true"><span data-slate-string="true">mbt2_hdr:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="913"><span data-slate-object="text" data-key="914"><span data-slate-leaf="true" data-offset-key="914:0" data-first-offset="true"><span data-slate-string="true">DD MBT_HDR2_MAGIC</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="915"><span data-slate-object="text" data-key="916"><span data-slate-leaf="true" data-offset-key="916:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="917"><span data-slate-leaf="true" data-offset-key="917:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="918"><span data-slate-object="text" data-key="919"><span data-slate-leaf="true" data-offset-key="919:0" data-first-offset="true"><span data-slate-string="true">DD mbt2_hdr_end - mbt2_hdr</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="920"><span data-slate-object="text" data-key="921"><span data-slate-leaf="true" data-offset-key="921:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="922"><span data-slate-leaf="true" data-offset-key="922:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">-</span></span></span></span><span data-slate-object="text" data-key="923"><span data-slate-leaf="true" data-offset-key="923:0" data-first-offset="true"><span data-slate-string="true">(MBT_HDR2_MAGIC + </span></span></span><span data-slate-object="text" data-key="924"><span data-slate-leaf="true" data-offset-key="924:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="925"><span data-slate-leaf="true" data-offset-key="925:0" data-first-offset="true"><span data-slate-string="true"> + (mbt2_hdr_end - mbt2_hdr))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="926"><span data-slate-object="text" data-key="927"><span data-slate-leaf="true" data-offset-key="927:0" data-first-offset="true"><span data-slate-string="true">DW </span></span></span><span data-slate-object="text" data-key="928"><span data-slate-leaf="true" data-offset-key="928:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">2</span></span></span></span><span data-slate-object="text" data-key="929"><span data-slate-leaf="true" data-offset-key="929:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="930"><span data-slate-leaf="true" data-offset-key="930:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="931"><span data-slate-object="text" data-key="932"><span data-slate-leaf="true" data-offset-key="932:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="933"><span data-slate-leaf="true" data-offset-key="933:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">24</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="934"><span data-slate-object="text" data-key="935"><span data-slate-leaf="true" data-offset-key="935:0" data-first-offset="true"><span data-slate-string="true">DD mbt2_hdr</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="936"><span data-slate-object="text" data-key="937"><span data-slate-leaf="true" data-offset-key="937:0" data-first-offset="true"><span data-slate-string="true">DD _start</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="938"><span data-slate-object="text" data-key="939"><span data-slate-leaf="true" data-offset-key="939:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="940"><span data-slate-leaf="true" data-offset-key="940:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="941"><span data-slate-object="text" data-key="942"><span data-slate-leaf="true" data-offset-key="942:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="943"><span data-slate-leaf="true" data-offset-key="943:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="944"><span data-slate-object="text" data-key="945"><span data-slate-leaf="true" data-offset-key="945:0" data-first-offset="true"><span data-slate-string="true">DW </span></span></span><span data-slate-object="text" data-key="946"><span data-slate-leaf="true" data-offset-key="946:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">3</span></span></span></span><span data-slate-object="text" data-key="947"><span data-slate-leaf="true" data-offset-key="947:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="948"><span data-slate-leaf="true" data-offset-key="948:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="949"><span data-slate-object="text" data-key="950"><span data-slate-leaf="true" data-offset-key="950:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="951"><span data-slate-leaf="true" data-offset-key="951:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">12</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="952"><span data-slate-object="text" data-key="953"><span data-slate-leaf="true" data-offset-key="953:0" data-first-offset="true"><span data-slate-string="true">DD _entry</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="954"><span data-slate-object="text" data-key="955"><span data-slate-leaf="true" data-offset-key="955:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="956"><span data-slate-leaf="true" data-offset-key="956:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="957"><span data-slate-object="text" data-key="958"><span data-slate-leaf="true" data-offset-key="958:0" data-first-offset="true"><span data-slate-string="true">DW </span></span></span><span data-slate-object="text" data-key="959"><span data-slate-leaf="true" data-offset-key="959:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="960"><span data-slate-leaf="true" data-offset-key="960:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="961"><span data-slate-leaf="true" data-offset-key="961:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="962"><span data-slate-object="text" data-key="963"><span data-slate-leaf="true" data-offset-key="963:0" data-first-offset="true"><span data-slate-string="true">DD </span></span></span><span data-slate-object="text" data-key="964"><span data-slate-leaf="true" data-offset-key="964:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">8</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="965"><span data-slate-object="text" data-key="966"><span data-slate-leaf="true" data-offset-key="966:0" data-first-offset="true"><span data-slate-string="true">mbt2_hdr_end:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="967"><span data-slate-object="text" data-key="968"><span data-slate-leaf="true" data-offset-key="968:0" data-first-offset="true"><span data-slate-string="true">; 以上是 GRUB2 所需要的头</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="969"><span data-slate-object="text" data-key="970"><span data-slate-leaf="true" data-offset-key="970:0" data-first-offset="true"><span data-slate-string="true">; 包含两个头是为了同时兼容 GRUB、GRUB2</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="971"><span data-slate-object="text" data-key="972"><span data-slate-leaf="true" data-offset-key="972:0" data-first-offset="true"><span data-slate-string="true">ALIGN </span></span></span><span data-slate-object="text" data-key="973"><span data-slate-leaf="true" data-offset-key="973:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">8</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="974"><span data-slate-object="text" data-key="975"><span data-slate-leaf="true" data-offset-key="975:0" data-first-offset="true"><span data-slate-string="true">_entry:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="976"><span data-slate-object="text" data-key="977"><span data-slate-leaf="true" data-offset-key="977:0" data-first-offset="true"><span data-slate-string="true">; 关中断</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="978"><span data-slate-object="text" data-key="979"><span data-slate-leaf="true" data-offset-key="979:0" data-first-offset="true"><span data-slate-string="true">cli</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="980"><span data-slate-object="text" data-key="981"><span data-slate-leaf="true" data-offset-key="981:0" data-first-offset="true"><span data-slate-string="true">; 关不可屏蔽中断</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="982"><span data-slate-object="text" data-key="983"><span data-slate-leaf="true" data-offset-key="983:0" data-first-offset="true"><span data-slate-string="true">in al, </span></span></span><span data-slate-object="text" data-key="984"><span data-slate-leaf="true" data-offset-key="984:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="985"><span data-slate-leaf="true" data-offset-key="985:0" data-first-offset="true"><span data-slate-string="true">x70</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="986"><span data-slate-object="text" data-key="987"><span data-slate-leaf="true" data-offset-key="987:0" data-first-offset="true"><span data-slate-string="true">or al, </span></span></span><span data-slate-object="text" data-key="988"><span data-slate-leaf="true" data-offset-key="988:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="989"><span data-slate-leaf="true" data-offset-key="989:0" data-first-offset="true"><span data-slate-string="true">x80</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="990"><span data-slate-object="text" data-key="991"><span data-slate-leaf="true" data-offset-key="991:0" data-first-offset="true"><span data-slate-string="true">out </span></span></span><span data-slate-object="text" data-key="992"><span data-slate-leaf="true" data-offset-key="992:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="993"><span data-slate-leaf="true" data-offset-key="993:0" data-first-offset="true"><span data-slate-string="true">x70,al</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="994"><span data-slate-object="text" data-key="995"><span data-slate-leaf="true" data-offset-key="995:0" data-first-offset="true"><span data-slate-string="true">; 重新加载 GDT</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="996"><span data-slate-object="text" data-key="997"><span data-slate-leaf="true" data-offset-key="997:0" data-first-offset="true"><span data-slate-string="true">lgdt </span></span></span><span data-slate-object="text" data-key="998"><span data-slate-leaf="true" data-offset-key="998:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">[GDT_PTR]</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="999"><span data-slate-object="text" data-key="1000"><span data-slate-leaf="true" data-offset-key="1000:0" data-first-offset="true"><span data-slate-string="true">jmp dword </span></span></span><span data-slate-object="text" data-key="1001"><span data-slate-leaf="true" data-offset-key="1001:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1002"><span data-slate-leaf="true" data-offset-key="1002:0" data-first-offset="true"><span data-slate-string="true">x8 :_32bits_mode</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1003"><span data-slate-object="text" data-key="1004"><span data-slate-leaf="true" data-offset-key="1004:0" data-first-offset="true"><span data-slate-string="true">_32bits_mode:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1005"><span data-slate-object="text" data-key="1006"><span data-slate-leaf="true" data-offset-key="1006:0" data-first-offset="true"><span data-slate-string="true">; 下面初始化 C 语言可能会用到的寄存器</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1007"><span data-slate-object="text" data-key="1008"><span data-slate-leaf="true" data-offset-key="1008:0" data-first-offset="true"><span data-slate-string="true">mov ax, </span></span></span><span data-slate-object="text" data-key="1009"><span data-slate-leaf="true" data-offset-key="1009:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1010"><span data-slate-leaf="true" data-offset-key="1010:0" data-first-offset="true"><span data-slate-string="true">x10</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1011"><span data-slate-object="text" data-key="1012"><span data-slate-leaf="true" data-offset-key="1012:0" data-first-offset="true"><span data-slate-string="true">mov ds, ax</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1013"><span data-slate-object="text" data-key="1014"><span data-slate-leaf="true" data-offset-key="1014:0" data-first-offset="true"><span data-slate-string="true">mov ss, ax</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1015"><span data-slate-object="text" data-key="1016"><span data-slate-leaf="true" data-offset-key="1016:0" data-first-offset="true"><span data-slate-string="true">mov es, ax</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1017"><span data-slate-object="text" data-key="1018"><span data-slate-leaf="true" data-offset-key="1018:0" data-first-offset="true"><span data-slate-string="true">mov fs, ax</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1019"><span data-slate-object="text" data-key="1020"><span data-slate-leaf="true" data-offset-key="1020:0" data-first-offset="true"><span data-slate-string="true">mov gs, ax</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1021"><span data-slate-object="text" data-key="1022"><span data-slate-leaf="true" data-offset-key="1022:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_db0e6225" data-attr-id="36505" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">xor eax,eax</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1023"><span data-slate-object="text" data-key="1024"><span data-slate-leaf="true" data-offset-key="1024:0" data-first-offset="true"><span data-slate-string="true">xor ebx,ebx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1025"><span data-slate-object="text" data-key="1026"><span data-slate-leaf="true" data-offset-key="1026:0" data-first-offset="true"><span data-slate-string="true">xor ecx,ecx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1027"><span data-slate-object="text" data-key="1028"><span data-slate-leaf="true" data-offset-key="1028:0" data-first-offset="true"><span data-slate-string="true">xor edx,edx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1029"><span data-slate-object="text" data-key="1030"><span data-slate-leaf="true" data-offset-key="1030:0" data-first-offset="true"><span data-slate-string="true">xor edi,edi</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1031"><span data-slate-object="text" data-key="1032"><span data-slate-leaf="true" data-offset-key="1032:0" data-first-offset="true"><span data-slate-string="true">xor esi,esi</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1033"><span data-slate-object="text" data-key="1034"><span data-slate-leaf="true" data-offset-key="1034:0" data-first-offset="true"><span data-slate-string="true">xor ebp,ebp</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1035"><span data-slate-object="text" data-key="1036"><span data-slate-leaf="true" data-offset-key="1036:0" data-first-offset="true"><span data-slate-string="true">xor esp,esp</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1037"><span data-slate-object="text" data-key="1038"><span data-slate-leaf="true" data-offset-key="1038:0" data-first-offset="true"><span data-slate-string="true">; 初始化栈，C 语言需要栈才能工作</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1039"><span data-slate-object="text" data-key="1040"><span data-slate-leaf="true" data-offset-key="1040:0" data-first-offset="true"><span data-slate-string="true">mov esp,</span></span></span><span data-slate-object="text" data-key="1041"><span data-slate-leaf="true" data-offset-key="1041:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1042"><span data-slate-leaf="true" data-offset-key="1042:0" data-first-offset="true"><span data-slate-string="true">x9000</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1043"><span data-slate-object="text" data-key="1044"><span data-slate-leaf="true" data-offset-key="1044:0" data-first-offset="true"><span data-slate-string="true">; 调用 C 语言函数</span></span></span><span data-slate-object="text" data-key="1045"><span data-slate-leaf="true" data-offset-key="1045:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> main</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1046"><span data-slate-object="text" data-key="1047"><span data-slate-leaf="true" data-offset-key="1047:0" data-first-offset="true"><span data-slate-string="true">call </span></span></span><span data-slate-object="text" data-key="1048"><span data-slate-leaf="true" data-offset-key="1048:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1049"><span data-slate-object="text" data-key="1050"><span data-slate-leaf="true" data-offset-key="1050:0" data-first-offset="true"><span data-slate-string="true">; 让 CPU 停止执行指令</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1051"><span data-slate-object="text" data-key="1052"><span data-slate-leaf="true" data-offset-key="1052:0" data-first-offset="true"><span data-slate-string="true">halt_step:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1053"><span data-slate-object="text" data-key="1054"><span data-slate-leaf="true" data-offset-key="1054:0" data-first-offset="true"><span data-slate-string="true">halt</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1055"><span data-slate-object="text" data-key="1056"><span data-slate-leaf="true" data-offset-key="1056:0" data-first-offset="true"><span data-slate-string="true">jmp halt_step</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1057"><span data-slate-object="text" data-key="1058"><span data-slate-leaf="true" data-offset-key="1058:0" data-first-offset="true"><span data-slate-string="true">GDT_START:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1059"><span data-slate-object="text" data-key="1060"><span data-slate-leaf="true" data-offset-key="1060:0" data-first-offset="true"><span data-slate-string="true">knull_dsc: dq </span></span></span><span data-slate-object="text" data-key="1061"><span data-slate-leaf="true" data-offset-key="1061:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1062"><span data-slate-object="text" data-key="1063"><span data-slate-leaf="true" data-offset-key="1063:0" data-first-offset="true"><span data-slate-string="true">kcode_dsc: dq </span></span></span><span data-slate-object="text" data-key="1064"><span data-slate-leaf="true" data-offset-key="1064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1065"><span data-slate-leaf="true" data-offset-key="1065:0" data-first-offset="true"><span data-slate-string="true">x00cf9e000000ffff</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1066"><span data-slate-object="text" data-key="1067"><span data-slate-leaf="true" data-offset-key="1067:0" data-first-offset="true"><span data-slate-string="true">kdata_dsc: dq </span></span></span><span data-slate-object="text" data-key="1068"><span data-slate-leaf="true" data-offset-key="1068:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1069"><span data-slate-leaf="true" data-offset-key="1069:0" data-first-offset="true"><span data-slate-string="true">x00cf92000000ffff</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1070"><span data-slate-object="text" data-key="1071"><span data-slate-leaf="true" data-offset-key="1071:0" data-first-offset="true"><span data-slate-string="true">k16cd_dsc: dq </span></span></span><span data-slate-object="text" data-key="1072"><span data-slate-leaf="true" data-offset-key="1072:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1073"><span data-slate-leaf="true" data-offset-key="1073:0" data-first-offset="true"><span data-slate-string="true">x00009e000000ffff</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1074"><span data-slate-object="text" data-key="1075"><span data-slate-leaf="true" data-offset-key="1075:0" data-first-offset="true"><span data-slate-string="true">k16da_dsc: dq </span></span></span><span data-slate-object="text" data-key="1076"><span data-slate-leaf="true" data-offset-key="1076:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="1077"><span data-slate-leaf="true" data-offset-key="1077:0" data-first-offset="true"><span data-slate-string="true">x000092000000ffff</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1078"><span data-slate-object="text" data-key="1079"><span data-slate-leaf="true" data-offset-key="1079:0" data-first-offset="true"><span data-slate-string="true">GDT_END:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1080"><span data-slate-object="text" data-key="1081"><span data-slate-leaf="true" data-offset-key="1081:0" data-first-offset="true"><span data-slate-string="true">GDT_PTR:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1082"><span data-slate-object="text" data-key="1083"><span data-slate-leaf="true" data-offset-key="1083:0" data-first-offset="true"><span data-slate-string="true">GDTLEN dw GDT_END-GDT_START-</span></span></span><span data-slate-object="text" data-key="1084"><span data-slate-leaf="true" data-offset-key="1084:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1085"><span data-slate-object="text" data-key="1086"><span data-slate-leaf="true" data-offset-key="1086:0" data-first-offset="true"><span data-slate-string="true">GDTBASE dd GDT_START</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1087"><span data-slate-object="text" data-key="1088"><span data-slate-leaf="true" data-offset-key="1088:0" data-first-offset="true"><span data-slate-string="true">以上的汇编代码（/lesson02/HelloOS/entry.asm）分为 4 个部分：</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1089"><span data-slate-object="text" data-key="1090"><span data-slate-leaf="true" data-offset-key="1090:0" data-first-offset="true"><span data-slate-string="true">1. 代码 1~40 行，用汇编定义的 GRUB 的多引导协议头，其实就是一定格式的数据，我们的 Hello OS 是用 GRUB 引导的，当然要遵循 </span></span></span><span data-slate-object="text" data-key="1091"><span data-slate-leaf="true" data-offset-key="1091:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">GRUB 的多引导协议标准</span></span></span></span><span data-slate-object="text" data-key="1092"><span data-slate-leaf="true" data-offset-key="1092:0" data-first-offset="true"><span data-slate-string="true">，让 GRUB 能识别我们的 Hello OS。之所以有两个引导头，是为了兼容 GRUB1 和 GRUB2。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1093"><span data-slate-object="text" data-key="1094"><span data-slate-leaf="true" data-offset-key="1094:0" data-first-offset="true"><span data-slate-string="true">2. 代码 44~52 行，关掉中断，设定 CPU 的工作模式。你现在可能不懂，没事儿，后面 CPU 相关的课程我们会专门再研究它。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1095"><span data-slate-object="text" data-key="1096"><span data-slate-leaf="true" data-offset-key="1096:0" data-first-offset="true"><span data-slate-string="true">3. 代码 54~73 行，初始化 CPU 的寄存器和 C 语言的运行环境。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1097"><span data-slate-object="text" data-key="1098"><span data-slate-leaf="true" data-offset-key="1098:0" data-first-offset="true"><span data-slate-string="true">4. 代码 78~87 行，GDT_START 开始的，是 CPU 工作模式所需要的数据，同样，后面讲 CPU 时会专门介绍。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1099" id="sr-toc-3"><span data-slate-object="text" data-key="1100"><span data-slate-leaf="true" data-offset-key="1100:0" data-first-offset="true"><span data-slate-string="true">Hello OS 的主函数</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1101"><span data-slate-object="text" data-key="1102"><span data-slate-leaf="true" data-offset-key="1102:0" data-first-offset="true"><span data-slate-string="true">到这，不知道你有没有发现一个问题？上面的汇编代码调用了 main 函数，而在其代码中并没有看到其函数体，而是从外部引入了一个符号。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1103"><span data-slate-object="text" data-key="1104"><span data-slate-leaf="true" data-offset-key="1104:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_3172f9c5" data-attr-id="38580" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">那是因为这个函数是用 C 语言写的在（/lesson02/HelloOS/main.c）中，最终它们分别由 nasm 和 GCC 编译成可链接模块，由 LD 链接器链接在一起，形成可执行的程序文件：</span></span></span></span></div><div data-code-language="cpp" data-slate-type="pre" data-slate-object="block" data-key="1105"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="1106"><span data-slate-object="text" data-key="1107"><span data-slate-leaf="true" data-offset-key="1107:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 彭东 @ 2021.01.09</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1108"><span data-slate-object="text" data-key="1109"><span data-slate-leaf="true" data-offset-key="1109:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#</span></span></span></span><span data-slate-object="text" data-key="1110"><span data-slate-leaf="true" data-offset-key="1110:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">include</span></span></span></span></span><span data-slate-object="text" data-key="1111"><span data-slate-leaf="true" data-offset-key="1111:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="1112"><span data-slate-leaf="true" data-offset-key="1112:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"vgastr.h"</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1113"><span data-slate-object="text" data-key="1114"><span data-slate-leaf="true" data-offset-key="1114:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">void</span></span></span></span></span><span data-slate-object="text" data-key="1115"><span data-slate-leaf="true" data-offset-key="1115:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="1116"><span data-slate-leaf="true" data-offset-key="1116:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="1117"><span data-slate-leaf="true" data-offset-key="1117:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1118"><span data-slate-object="text" data-key="1119"><span data-slate-leaf="true" data-offset-key="1119:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1120"><span data-slate-object="text" data-key="1121"><span data-slate-leaf="true" data-offset-key="1121:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1122"><span data-slate-leaf="true" data-offset-key="1122:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="1123"><span data-slate-leaf="true" data-offset-key="1123:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="1124"><span data-slate-leaf="true" data-offset-key="1124:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Hello OS!"</span></span></span></span><span data-slate-object="text" data-key="1125"><span data-slate-leaf="true" data-offset-key="1125:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1126"><span data-slate-object="text" data-key="1127"><span data-slate-leaf="true" data-offset-key="1127:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1128"><span data-slate-leaf="true" data-offset-key="1128:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="1129"><span data-slate-leaf="true" data-offset-key="1129:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1130"><span data-slate-object="text" data-key="1131"><span data-slate-leaf="true" data-offset-key="1131:0" data-first-offset="true"><span data-slate-string="true">} </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1132"><span data-slate-object="text" data-key="1133"><span data-slate-leaf="true" data-offset-key="1133:0" data-first-offset="true"><span data-slate-string="true">以上这段代码，你应该很熟悉了吧？不过这不是应用程序的 main 函数，而是 Hello OS 的 main 函数。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1134"><span data-slate-object="text" data-key="1135"><span data-slate-leaf="true" data-offset-key="1135:0" data-first-offset="true"><span data-slate-string="true">其中的 printf 也不是应用程序库中的那个 printf 了，而是需要我们自己实现了。你可以先停下歇歇，再去实现 printf 函数。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1136" id="sr-toc-4"><span data-slate-object="text" data-key="1137"><span data-slate-leaf="true" data-offset-key="1137:0" data-first-offset="true"><span data-slate-string="true">控制计算机屏幕</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1138"><span data-slate-object="text" data-key="1139"><span data-slate-leaf="true" data-offset-key="1139:0" data-first-offset="true"><span data-slate-string="true">接着我们再看下显卡，这和我们接下来要写的代码有直接关联。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1140"><span data-slate-object="text" data-key="1141"><span data-slate-leaf="true" data-offset-key="1141:0" data-first-offset="true"><span data-slate-string="true">计算机屏幕显示往往是显卡的输出，显卡有很多形式：集成在主板的叫集显，做在 CPU 芯片内的叫核显，独立存在通过 PCIE 接口连接的叫独显，性能依次上升，价格也是。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1142"><span data-slate-object="text" data-key="1143"><span data-slate-leaf="true" data-offset-key="1143:0" data-first-offset="true"><span data-slate-string="true">独显的高性能是游戏玩家们所钟爱的，3D 图形显示往往要涉及顶点处理、多边形的生成和变换、纹理、着色、打光、栅格化等。而这些任务的计算量超级大，所以独显往往有自己的 RAM、多达几百个运算核心的处理器。因此独显不仅仅是可以显示图像，而且可以执行大规模并行计算，比如 “挖矿”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1144"><span data-slate-object="text" data-key="1145"><span data-slate-leaf="true" data-offset-key="1145:0" data-first-offset="true"><span data-slate-string="true">我们要在屏幕上显示字符，就要编程操作显卡。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1146"><span data-slate-object="text" data-key="1147"><span data-slate-leaf="true" data-offset-key="1147:0" data-first-offset="true"><span data-slate-string="true">其实无论我们 PC 上是什么显卡，它们都支持一种叫 </span></span></span><span data-slate-object="text" data-key="1148"><span data-slate-leaf="true" data-offset-key="1148:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">VESA</span></span></span></span><span data-slate-object="text" data-key="1149"><span data-slate-leaf="true" data-offset-key="1149:0" data-first-offset="true"><span data-slate-string="true"> 的标准，这种标准下有两种工作模式：字符模式和图形模式。显卡们为了兼容这种标准，不得不自己提供一种叫 VGABIOS 的固件程序。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1150"><span data-slate-object="text" data-key="1151"><span data-slate-leaf="true" data-offset-key="1151:0" data-first-offset="true"><span data-slate-string="true">下面，我们来看看显卡的字符模式的工作细节。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1152"><span data-slate-object="text" data-key="1153"><span data-slate-leaf="true" data-offset-key="1153:0" data-first-offset="true"><span data-slate-string="true">它把屏幕分成 24 行，每行 80 个字符，把这（24*80）个位置映射到以 0xb8000 地址开始的内存中，每两个字节对应一个字符，其中一个字节是字符的 ASCII 码，另一个字节为字符的颜色值。如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="1154"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/78/f5/782ef574b96084fa44a33ea1f83146f5.jpg?wh=3530*1605"></div><div>计算机显卡文本模式</div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1155"><span data-slate-object="text" data-key="1156"><span data-slate-leaf="true" data-offset-key="1156:0" data-first-offset="true"><span data-slate-string="true">明白了显卡的字符模式的工作细节，下面我们开始写代码。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1157"><span data-slate-object="text" data-key="1158"><span data-slate-leaf="true" data-offset-key="1158:0" data-first-offset="true"><span data-slate-string="true">这里先提个醒：</span></span></span><span data-slate-object="text" data-key="1159"><span data-slate-leaf="true" data-offset-key="1159:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">C 语言字符串是以 0 结尾的，其字符编码通常是 utf8，而 utf8 编码对 ASCII 字符是兼容的，即英文字符的 ASCII 编码和 utf8 编码是相等的</span></span></span></span><span data-slate-object="text" data-key="1160"><span data-slate-leaf="true" data-offset-key="1160:0" data-first-offset="true"><span data-slate-string="true">（关于 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="1161"><span data-slate-object="text" data-key="1162"><span data-slate-leaf="true" data-offset-key="1162:0" data-first-offset="true"><span data-slate-string="true">utf8</span></span></span></a><span data-slate-object="text" data-key="1163"><span data-slate-leaf="true" data-offset-key="1163:0" data-first-offset="true"><span data-slate-string="true"> 编码你可以自行了解）。</span></span></span></div><div data-code-language="typescript" data-slate-type="pre" data-slate-object="block" data-key="1164"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="1165"><span data-slate-object="text" data-key="1166"><span data-slate-leaf="true" data-offset-key="1166:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 彭东 @ 2021.01.09</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1167"><span data-slate-object="text" data-key="1168"><span data-slate-leaf="true" data-offset-key="1168:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">void</span></span></span></span><span data-slate-object="text" data-key="1169"><span data-slate-leaf="true" data-offset-key="1169:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="1170"><span data-slate-leaf="true" data-offset-key="1170:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">_strwrite</span></span></span></span><span data-slate-object="text" data-key="1171"><span data-slate-leaf="true" data-offset-key="1171:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="1172"><span data-slate-leaf="true" data-offset-key="1172:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">char* </span></span></span></span><span data-slate-object="text" data-key="1173"><span data-slate-leaf="true" data-offset-key="1173:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span><span data-slate-object="text" data-key="1174"><span data-slate-leaf="true" data-offset-key="1174:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1175"><span data-slate-object="text" data-key="1176"><span data-slate-leaf="true" data-offset-key="1176:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1177"><span data-slate-object="text" data-key="1178"><span data-slate-leaf="true" data-offset-key="1178:0" data-first-offset="true"><span data-slate-string="true">  char* p_strdst = (char*)(</span></span></span><span data-slate-object="text" data-key="1179"><span data-slate-leaf="true" data-offset-key="1179:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0xb8000</span></span></span></span><span data-slate-object="text" data-key="1180"><span data-slate-leaf="true" data-offset-key="1180:0" data-first-offset="true"><span data-slate-string="true">);</span></span></span><span data-slate-object="text" data-key="1181"><span data-slate-leaf="true" data-offset-key="1181:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 指向显存的开始地址</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1182"><span data-slate-object="text" data-key="1183"><span data-slate-leaf="true" data-offset-key="1183:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1184"><span data-slate-leaf="true" data-offset-key="1184:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">while</span></span></span></span><span data-slate-object="text" data-key="1185"><span data-slate-leaf="true" data-offset-key="1185:0" data-first-offset="true"><span data-slate-string="true"> (*</span></span></span><span data-slate-object="text" data-key="1186"><span data-slate-leaf="true" data-offset-key="1186:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="1187"><span data-slate-leaf="true" data-offset-key="1187:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1188"><span data-slate-object="text" data-key="1189"><span data-slate-leaf="true" data-offset-key="1189:0" data-first-offset="true"><span data-slate-string="true">  {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1190"><span data-slate-object="text" data-key="1191"><span data-slate-leaf="true" data-offset-key="1191:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_77e0c975" data-attr-id="35841" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">    *p_strdst = *</span></span></span></span><span data-slate-object="text" data-key="1192"><span data-slate-leaf="true" data-offset-key="1192:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_77e0c975" data-attr-id="35841" data-attr-name="public" data-annotation-type="public"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span><span data-slate-object="text" data-key="1193"><span data-slate-leaf="true" data-offset-key="1193:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_77e0c975" data-attr-id="35841" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">++;</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1194"><span data-slate-object="text" data-key="1195"><span data-slate-leaf="true" data-offset-key="1195:0" data-first-offset="true"><span data-slate-string="true">    p_strdst += </span></span></span><span data-slate-object="text" data-key="1196"><span data-slate-leaf="true" data-offset-key="1196:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">2</span></span></span></span><span data-slate-object="text" data-key="1197"><span data-slate-leaf="true" data-offset-key="1197:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1198"><span data-slate-object="text" data-key="1199"><span data-slate-leaf="true" data-offset-key="1199:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1200"><span data-slate-object="text" data-key="1201"><span data-slate-leaf="true" data-offset-key="1201:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1202"><span data-slate-leaf="true" data-offset-key="1202:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="1203"><span data-slate-leaf="true" data-offset-key="1203:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1204"><span data-slate-object="text" data-key="1205"><span data-slate-leaf="true" data-offset-key="1205:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1206"></div><div data-slate-type="code-line" data-slate-object="block" data-key="1207"><span data-slate-object="text" data-key="1208"><span data-slate-leaf="true" data-offset-key="1208:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">void</span></span></span></span><span data-slate-object="text" data-key="1209"><span data-slate-leaf="true" data-offset-key="1209:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="1210"><span data-slate-leaf="true" data-offset-key="1210:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">printf</span></span></span></span><span data-slate-object="text" data-key="1211"><span data-slate-leaf="true" data-offset-key="1211:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="1212"><span data-slate-leaf="true" data-offset-key="1212:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">char* fmt, ...</span></span></span></span><span data-slate-object="text" data-key="1213"><span data-slate-leaf="true" data-offset-key="1213:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1214"><span data-slate-object="text" data-key="1215"><span data-slate-leaf="true" data-offset-key="1215:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1216"><span data-slate-object="text" data-key="1217"><span data-slate-leaf="true" data-offset-key="1217:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1218"><span data-slate-leaf="true" data-offset-key="1218:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">_strwrite</span></span></span></span><span data-slate-object="text" data-key="1219"><span data-slate-leaf="true" data-offset-key="1219:0" data-first-offset="true"><span data-slate-string="true">(fmt);</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1220"><span data-slate-object="text" data-key="1221"><span data-slate-leaf="true" data-offset-key="1221:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="1222"><span data-slate-leaf="true" data-offset-key="1222:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="1223"><span data-slate-leaf="true" data-offset-key="1223:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1224"><span data-slate-object="text" data-key="1225"><span data-slate-leaf="true" data-offset-key="1225:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1226"><span data-slate-object="text" data-key="1227"><span data-slate-leaf="true" data-offset-key="1227:0" data-first-offset="true"><span data-slate-string="true">代码很简单，printf 函数直接调用了 _strwrite 函数，而 _strwrite 函数正是将字符串里每个字符依次定入到 0xb8000 地址开始的显存中，而 p_strdst 每次加 2，这也是为了跳过字符的颜色信息的空间。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1228"><span data-slate-object="text" data-key="1229"><span data-slate-leaf="true" data-offset-key="1229:0" data-first-offset="true"><span data-slate-string="true">到这，Hello OS 相关的代码就写好了，下面就是编译和安装了。你可别以为这个事情就简单了，下面请跟着我去看一看。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1230" id="sr-toc-5"><span data-slate-object="text" data-key="1231"><span data-slate-leaf="true" data-offset-key="1231:0" data-first-offset="true"><span data-slate-string="true">编译和安装 Hello OS</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1232"><span data-slate-object="text" data-key="1233"><span data-slate-leaf="true" data-offset-key="1233:0" data-first-offset="true"><span data-slate-string="true">Hello OS 的代码都已经写好，这时就要进入安装测试环节了。在安装之前，我们要进行系统编译，即把每个代码模块编译最后链接成可执行的二进制文件。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1234"><span data-slate-object="text" data-key="1235"><span data-slate-leaf="true" data-offset-key="1235:0" data-first-offset="true"><span data-slate-string="true">你可能觉得我在小题大做，编译不就是输入几条命令吗，这么简单的工作也值得一说？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1236"><span data-slate-object="text" data-key="1237"><span data-slate-leaf="true" data-offset-key="1237:0" data-first-offset="true"><span data-slate-string="true">确实，对于我们 Hello OS 的编译工作来说特别简单，因为总共才三个代码文件，最多四条命令就可以完成。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1238"><span data-slate-object="text" data-key="1239"><span data-slate-leaf="true" data-offset-key="1239:0" data-first-offset="true"><span data-slate-string="true">但是以后我们 Hello OS 的文件数量会爆炸式增长，一个成熟的商业操作系统更是多达几万个代码模块文件，几千万行的代码量，是这世间最复杂的软件工程之一。所以需要一个牛逼的工具来控制这个巨大的编译过程。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1240" id="sr-toc-6"><span data-slate-object="text" data-key="1241"><span data-slate-leaf="true" data-offset-key="1241:0" data-first-offset="true"><span data-slate-string="true">make 工具</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1242"><span data-slate-object="text" data-key="1243"><span data-slate-leaf="true" data-offset-key="1243:0" data-first-offset="true"><span data-slate-string="true">make 历史悠久，小巧方便，也是很多成熟操作系统编译所使用的构建工具。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1244"><span data-slate-object="text" data-key="1245"><span data-slate-leaf="true" data-offset-key="1245:0" data-first-offset="true"><span data-slate-string="true">在软件开发中，make 是一个工具程序，</span></span><span data-slate-leaf="true" data-offset-key="1245:1"><span data-slate-object="annotation" data-annotation-key="gkann_05285dbd" data-attr-id="38895" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">它读取一个叫 “makefile” 的文件，也是一种文本文件，这个文件中写好了构建软件的规则，它能根据这些规则自动化构建软件。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1246"><span data-slate-object="text" data-key="1247"><span data-slate-leaf="true" data-offset-key="1247:0" data-first-offset="true"><span data-slate-string="true">makefile 文件中规则是这样的：首先有一个或者多个构建目标称为 “target”；目标后面紧跟着用于构建该目标所需要的文件，目标下面是构建该目标所需要的命令及参数。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1248"><span data-slate-object="text" data-key="1249"><span data-slate-leaf="true" data-offset-key="1249:0" data-first-offset="true"><span data-slate-string="true">与此同时，它也检查文件的依赖关系，如果需要的话，它会调用一些外部软件来完成任务。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1250"><span data-slate-object="text" data-key="1251"><span data-slate-leaf="true" data-offset-key="1251:0" data-first-offset="true"><span data-slate-string="true">第一次构建目标后，下一次执行 make 时，它会根据该目标所依赖的文件是否更新决定是否编译该目标，如果所依赖的文件没有更新且该目标又存在，那么它便不会构建该目标。这种特性非常有利于编译程序源代码。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1252"><span data-slate-object="text" data-key="1253"><span data-slate-leaf="true" data-offset-key="1253:0" data-first-offset="true"><span data-slate-string="true">任何一个 Linux 发行版中都默认自带这个 make 程序，所以不需要额外的安装工作，我们直接使用即可。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1254"><span data-slate-object="text" data-key="1255"><span data-slate-leaf="true" data-offset-key="1255:0" data-first-offset="true"><span data-slate-string="true">为了让你进一步了解 make 的使用，接下来我们一起看一个有关 makefile 的例子：</span></span></span></div><div data-code-language="python" data-slate-type="pre" data-slate-object="block" data-key="1256"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="1257"><span data-slate-object="text" data-key="1258"><span data-slate-leaf="true" data-offset-key="1258:0" data-first-offset="true"><span data-slate-string="true">CC = gcc </span></span></span><span data-slate-object="text" data-key="1259"><span data-slate-leaf="true" data-offset-key="1259:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#定义一个宏 CC 等于 gcc</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1260"><span data-slate-object="text" data-key="1261"><span data-slate-leaf="true" data-offset-key="1261:0" data-first-offset="true"><span data-slate-string="true">CFLAGS = -c </span></span></span><span data-slate-object="text" data-key="1262"><span data-slate-leaf="true" data-offset-key="1262:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#定义一个宏 CFLAGS 等于 - c</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1263"><span data-slate-object="text" data-key="1264"><span data-slate-leaf="true" data-offset-key="1264:0" data-first-offset="true"><span data-slate-string="true">OBJS_FILE = file.o file1.o file2.o file3.o file4.o </span></span></span><span data-slate-object="text" data-key="1265"><span data-slate-leaf="true" data-offset-key="1265:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#定义一个宏</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1266"><span data-slate-object="text" data-key="1267"><span data-slate-leaf="true" data-offset-key="1267:0" data-first-offset="true"><span data-slate-string="true">.PHONY : </span></span></span><span data-slate-object="text" data-key="1268"><span data-slate-leaf="true" data-offset-key="1268:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">all</span></span></span></span><span data-slate-object="text" data-key="1269"><span data-slate-leaf="true" data-offset-key="1269:0" data-first-offset="true"><span data-slate-string="true"> everything </span></span></span><span data-slate-object="text" data-key="1270"><span data-slate-leaf="true" data-offset-key="1270:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#定义两个伪目标 all、everything</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1271"><span data-slate-object="text" data-key="1272"><span data-slate-leaf="true" data-offset-key="1272:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">all</span></span></span></span><span data-slate-object="text" data-key="1273"><span data-slate-leaf="true" data-offset-key="1273:0" data-first-offset="true"><span data-slate-string="true">:everything </span></span></span><span data-slate-object="text" data-key="1274"><span data-slate-leaf="true" data-offset-key="1274:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#伪目标 all 依赖于伪目标 everything</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1275"><span data-slate-object="text" data-key="1276"><span data-slate-leaf="true" data-offset-key="1276:0" data-first-offset="true"><span data-slate-string="true">everything :$(OBJS_FILE) </span></span></span><span data-slate-object="text" data-key="1277"><span data-slate-leaf="true" data-offset-key="1277:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#伪目标 everything 依赖于 OBJS_FILE，而 OBJS_FILE 是宏会被</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1278"><span data-slate-object="text" data-key="1279"><span data-slate-leaf="true" data-offset-key="1279:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#替换成 file.o file1.o file2.o file3.o file4.o</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1280"><span data-slate-object="text" data-key="1281"><span data-slate-leaf="true" data-offset-key="1281:0" data-first-offset="true"><span data-slate-string="true">%.o : %.c</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1282"><span data-slate-object="text" data-key="1283"><span data-slate-leaf="true" data-offset-key="1283:0" data-first-offset="true"><span data-slate-string="true">   $(CC) $(CFLAGS) -o $@ $&lt;</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1284"><span data-slate-object="text" data-key="1285"><span data-slate-leaf="true" data-offset-key="1285:0" data-first-offset="true"><span data-slate-string="true">我来解释一下这个例子：</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1286"><span data-slate-object="text" data-key="1287"><span data-slate-leaf="true" data-offset-key="1287:0" data-first-offset="true"><span data-slate-string="true">make 规定 “#” 后面为注释，make 处理 makefile 时会自动丢弃。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1288"><span data-slate-object="text" data-key="1289"><span data-slate-leaf="true" data-offset-key="1289:0" data-first-offset="true"><span data-slate-string="true">makefile 中可以定义宏，方法是</span></span></span><span data-slate-object="text" data-key="1290"><span data-slate-leaf="true" data-offset-key="1290:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在一个字符串后跟一个 “=” 或者 “:=” 符号</span></span></span></span><span data-slate-object="text" data-key="1291"><span data-slate-leaf="true" data-offset-key="1291:0" data-first-offset="true"><span data-slate-string="true">，引用宏时要用 “</span></span></span><span data-slate-object="text" data-key="1292"><span data-slate-leaf="true" data-offset-key="1292:0" data-first-offset="true"><span data-slate-string="true">$</span></span></span><span data-slate-object="text" data-key="1293"><span data-slate-leaf="true" data-offset-key="1293:0" data-first-offset="true"><span data-slate-string="true">(宏名)”，宏最终会在宏出现的地方替换成相应的字符串，例如：</span></span></span><span data-slate-object="text" data-key="1294"><span data-slate-leaf="true" data-offset-key="1294:0" data-first-offset="true"><span data-slate-string="true">$</span></span></span><span data-slate-object="text" data-key="1295"><span data-slate-leaf="true" data-offset-key="1295:0" data-first-offset="true"><span data-slate-string="true">(CC) 会被替换成 gcc，</span></span></span><span data-slate-object="text" data-key="1296"><span data-slate-leaf="true" data-offset-key="1296:0" data-first-offset="true"><span data-slate-string="true">$</span></span></span><span data-slate-object="text" data-key="1297"><span data-slate-leaf="true" data-offset-key="1297:0" data-first-offset="true"><span data-slate-string="true">(OBJS_FILE) 会被替换成 file.o file1.o file2.o file3.o file4.o。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1298"><span data-slate-object="text" data-key="1299"><span data-slate-leaf="true" data-offset-key="1299:0" data-first-offset="true"><span data-slate-string="true">.PHONY 在 makefile 中表示定义伪目标。所谓伪目标，就是它不代表一个真正的文件名，在执行 make 时可以指定这个目标来执行其所在规则定义的命令。但是伪目标可以依赖于另一个伪目标或者文件，例如：all 依赖于 everything，everything 最终依赖于 file.c file1.c file2.c file3.c file4.c。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1300"><span data-slate-object="text" data-key="1301"><span data-slate-leaf="true" data-offset-key="1301:0" data-first-offset="true"><span data-slate-string="true">虽然我们会发现，everything 下面并没有相关的执行命令，但是下面有个通用规则：“%.o : %.c”。其中的 “%” 表示通配符，表示所有以 “.o” 结尾的文件依赖于所有以 “.c” 结尾的文件。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1302"><span data-slate-object="text" data-key="1303"><span data-slate-leaf="true" data-offset-key="1303:0" data-first-offset="true"><span data-slate-string="true">例如：file.c、file1.c、file2.c、file3.c、file4.c，通过这个通用规则会自动转换为依赖关系：file.o: file.c、file1.o: file1.c、file2.o: file2.c、file3.o: file3.c、file4.o: file4.c。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1304"><span data-slate-object="text" data-key="1305"><span data-slate-leaf="true" data-offset-key="1305:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">然后，针对这些依赖关系，</span></span></span><span data-slate-leaf="true" data-offset-key="1305:1"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">分别会执行：</span></span></span></span></span><span data-slate-object="text" data-key="1306"><span data-slate-leaf="true" data-offset-key="1306:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">$</span></span></span></span></span><span data-slate-object="text" data-key="1307"><span data-slate-leaf="true" data-offset-key="1307:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">(CC) </span></span></span></span></span><span data-slate-object="text" data-key="1308"><span data-slate-leaf="true" data-offset-key="1308:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">$</span></span></span></span></span><span data-slate-object="text" data-key="1309"><span data-slate-leaf="true" data-offset-key="1309:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">(CFLAGS) -o </span></span></span></span></span><span data-slate-object="text" data-key="1310"><span data-slate-leaf="true" data-offset-key="1310:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">$</span></span></span></span></span><span data-slate-object="text" data-key="1311"><span data-slate-leaf="true" data-offset-key="1311:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">@ </span></span></span></span></span><span data-slate-object="text" data-key="1312"><span data-slate-leaf="true" data-offset-key="1312:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">$</span></span></span></span></span><span data-slate-object="text" data-key="1313"><span data-slate-leaf="true" data-offset-key="1313:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_0ff6c995" data-attr-id="20217" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_4a38c0b1" data-attr-id="40285" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">&lt; 命令，</span></span></span></span><span data-slate-leaf="true" data-offset-key="1313:1"><span data-slate-string="true">当然最终会转换为：gcc –c –o xxxx.o xxxx.c，这里的 “xxxx” 表示一个具体的文件名。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1314" id="sr-toc-7"><span data-slate-object="text" data-key="1315"><span data-slate-leaf="true" data-offset-key="1315:0" data-first-offset="true"><span data-slate-string="true">编译</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1316"><span data-slate-object="text" data-key="1317"><span data-slate-leaf="true" data-offset-key="1317:0" data-first-offset="true"><span data-slate-string="true">下面我们用一张图来描述我们 Hello OS 的编译过程，如下所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="1318"><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/resource/image/cb/34/cbd634cd5256e372bcbebd4b95f21b34.jpg?wh=4378*4923"></div><div>Hello OS 编译过程</div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1319" id="sr-toc-8"><span data-slate-object="text" data-key="1320"><span data-slate-leaf="true" data-offset-key="1320:0" data-first-offset="true"><span data-slate-string="true">安装 Hello OS</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1321"><span data-slate-object="text" data-key="1322"><span data-slate-leaf="true" data-offset-key="1322:0" data-first-offset="true"><span data-slate-string="true">经过上述流程，我们就会得到 Hello OS.bin 文件，但是我们还要让 GRUB 能够找到它，才能在计算机启动时加载它。这个过程我们称为安装，不过这里没有写安装程序，得我们手动来做。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1323"><span data-slate-object="text" data-key="1324"><span data-slate-leaf="true" data-offset-key="1324:0" data-first-offset="true"><span data-slate-string="true">经研究发现，GRUB 在启动时会加载一个 grub.cfg 的文本文件，根据其中的内容执行相应的操作，其中一部分内容就是启动项。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1325"><span data-slate-object="text" data-key="1326"><span data-slate-leaf="true" data-offset-key="1326:0" data-first-offset="true"><span data-slate-string="true">GRUB 首先会显示启动项到屏幕，然后让我们选择启动项，最后 GRUB 根据启动项对应的信息，加载 OS 文件到内存。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1327"><span data-slate-object="text" data-key="1328"><span data-slate-leaf="true" data-offset-key="1328:0" data-first-offset="true"><span data-slate-string="true">下面来看看我们 Hello OS 的启动项：</span></span></span></div><div data-code-language="python" data-slate-type="pre" data-slate-object="block" data-key="1329"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="1330"><span data-slate-object="text" data-key="1331"><span data-slate-leaf="true" data-offset-key="1331:0" data-first-offset="true"><span data-slate-string="true">menuentry </span></span></span><span data-slate-object="text" data-key="1332"><span data-slate-leaf="true" data-offset-key="1332:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'HelloOS'</span></span></span></span><span data-slate-object="text" data-key="1333"><span data-slate-leaf="true" data-offset-key="1333:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1334"><span data-slate-object="text" data-key="1335"><span data-slate-leaf="true" data-offset-key="1335:0" data-first-offset="true"><span data-slate-string="true">     insmod part_msdos </span></span></span><span data-slate-object="text" data-key="1336"><span data-slate-leaf="true" data-offset-key="1336:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#GRUB 加载分区模块识别分区</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1337"><span data-slate-object="text" data-key="1338"><span data-slate-leaf="true" data-offset-key="1338:0" data-first-offset="true"><span data-slate-string="true">     insmod ext2 </span></span></span><span data-slate-object="text" data-key="1339"><span data-slate-leaf="true" data-offset-key="1339:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#GRUB 加载 ext 文件系统模块识别 ext 文件系统</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1340"><span data-slate-object="text" data-key="1341"><span data-slate-leaf="true" data-offset-key="1341:0" data-first-offset="true"><span data-slate-string="true">     </span></span></span><span data-slate-object="text" data-key="1342"><span data-slate-leaf="true" data-offset-key="1342:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">set</span></span></span></span><span data-slate-object="text" data-key="1343"><span data-slate-leaf="true" data-offset-key="1343:0" data-first-offset="true"><span data-slate-string="true"> root=</span></span></span><span data-slate-object="text" data-key="1344"><span data-slate-leaf="true" data-offset-key="1344:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'hd0,msdos4'</span></span></span></span><span data-slate-object="text" data-key="1345"><span data-slate-leaf="true" data-offset-key="1345:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="1346"><span data-slate-leaf="true" data-offset-key="1346:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#注意 boot 目录挂载的分区，这是我机器上的情况</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1347"><span data-slate-object="text" data-key="1348"><span data-slate-leaf="true" data-offset-key="1348:0" data-first-offset="true"><span data-slate-string="true">     multiboot2 /boot/HelloOS.</span></span></span><span data-slate-object="text" data-key="1349"><span data-slate-leaf="true" data-offset-key="1349:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">bin</span></span></span></span><span data-slate-object="text" data-key="1350"><span data-slate-leaf="true" data-offset-key="1350:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="1351"><span data-slate-leaf="true" data-offset-key="1351:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#GRUB 以 multiboot2 协议加载 HelloOS.bin</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1352"><span data-slate-object="text" data-key="1353"><span data-slate-leaf="true" data-offset-key="1353:0" data-first-offset="true"><span data-slate-string="true">     boot </span></span></span><span data-slate-object="text" data-key="1354"><span data-slate-leaf="true" data-offset-key="1354:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#GRUB 启动 HelloOS.bin</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1355"><span data-slate-object="text" data-key="1356"><span data-slate-leaf="true" data-offset-key="1356:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1357"><span data-slate-object="text" data-key="1358"><span data-slate-leaf="true" data-offset-key="1358:0" data-first-offset="true"><span data-slate-string="true">如果你不知道你的 boot 目录挂载的分区，可以在 Linux 系统的终端下输入命令：df /boot/，就会得到如下结果：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="1359"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="1360"><span data-slate-object="text" data-key="1361"><span data-slate-leaf="true" data-offset-key="1361:0" data-first-offset="true"><span data-slate-string="true">文件系统          1K - 块    已用     可用      已用 % 挂载点</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="1362"><span data-slate-object="text" data-key="1363"><span data-slate-leaf="true" data-offset-key="1363:0" data-first-offset="true"><span data-slate-string="true">/dev/sda4      48752308 8087584 38158536   18%    /</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1364"><span data-slate-object="text" data-key="1365"><span data-slate-leaf="true" data-offset-key="1365:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_d65d1fd8" data-attr-id="29522" data-attr-name="public" data-annotation-type="public"><span data-slate-object="annotation" data-annotation-key="gkann_91e1cb32" data-attr-id="26956" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">其中的 “sda4” 就是硬盘的第四个分区（硬件分区选择 MBR），但是 GRUB 的 menuentry 中不能写 sda4，</span></span></span></span><span data-slate-leaf="true" data-offset-key="1365:1"><span data-slate-string="true">而是要写 “hd0,msdos4”，这是 GRUB 的命名方式，hd0 表示第一块硬盘，结合起来就是第一块硬盘的第四个分区。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1366"><span data-slate-object="text" data-key="1367"><span data-slate-leaf="true" data-offset-key="1367:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_644c1971" data-attr-id="41479" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">把上面启动项的代码插入到你的 Linux 机器上的 /boot/grub/grub.cfg 文件末尾，</span></span></span><span data-slate-leaf="true" data-offset-key="1367:1"><span data-slate-string="true">然后把 Hello OS.bin 文件复制到 /boot/ 目录下，一定注意</span></span></span><span data-slate-object="text" data-key="1368"><span data-slate-leaf="true" data-offset-key="1368:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">这里是追加不是覆盖</span></span></span></span><span data-slate-object="text" data-key="1369"><span data-slate-leaf="true" data-offset-key="1369:0" data-first-offset="true"><span data-slate-string="true">。最后重启计算机，你就可以看到 Hello OS 的启动选项了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1370"><span data-slate-object="text" data-key="1371"><span data-slate-leaf="true" data-offset-key="1371:0" data-first-offset="true"><span data-slate-string="true">选择 Hello OS，按下 Enter 键（或者重启按 ESC 键），这样就可以成功启动我们自己的 Hello OS 了。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1372" id="sr-toc-9"><span data-slate-object="text" data-key="1373"><span data-slate-leaf="true" data-offset-key="1373:0" data-first-offset="true"><span data-slate-string="true">重点回顾</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1374"><span data-slate-object="text" data-key="1375"><span data-slate-leaf="true" data-offset-key="1375:0" data-first-offset="true"><span data-slate-string="true">有没有很开心？我们终于看到我们自己的 OS 运行了，就算它再简单也是我们自己的 OS。下面我们再次回顾下这节课的重点。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1376"><span data-slate-object="text" data-key="1377"><span data-slate-leaf="true" data-offset-key="1377:0" data-first-offset="true"><span data-slate-string="true">首先，我们了解了从按下 PC 机电源开关开始，PC 机的引导过程。它从 CPU 上电，到加载 BIOS 固件，再由 BIOS 固件对计算机进行自检和默认的初始化，并加载 GRUB 引导程序，最后由 GRUB 加载具体的操作系统。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1378"><span data-slate-object="text" data-key="1379"><span data-slate-leaf="true" data-offset-key="1379:0" data-first-offset="true"><span data-slate-string="true">其次，就到了我们这节课最难的部分，即用汇编语言和 C 语言实现我们的 Hello OS。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1380"><span data-slate-object="text" data-key="1381"><span data-slate-leaf="true" data-offset-key="1381:0" data-first-offset="true"><span data-slate-string="true">第一步，用汇编程序初始化 CPU 的寄存器、设置 CPU 的工作模式和栈，最重要的是</span></span></span><span data-slate-object="text" data-key="1382"><span data-slate-leaf="true" data-offset-key="1382:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">加入了 GRUB 引导协议头</span></span></span></span><span data-slate-object="text" data-key="1383"><span data-slate-leaf="true" data-offset-key="1383:0" data-first-offset="true"><span data-slate-string="true">；第二步，切换到 C 语言，用 C 语言写好了</span></span></span><span data-slate-object="text" data-key="1384"><span data-slate-leaf="true" data-offset-key="1384:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">主函数和控制显卡输出的函数</span></span></span></span><span data-slate-object="text" data-key="1385"><span data-slate-leaf="true" data-offset-key="1385:0" data-first-offset="true"><span data-slate-string="true">，其间还了解了显卡的一些工作细节。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1386"><span data-slate-object="text" data-key="1387"><span data-slate-leaf="true" data-offset-key="1387:0" data-first-offset="true"><span data-slate-string="true">最后，就是编译和安装 Hello OS 了。我们用了 make 工具编译整个代码，其实 make 会根据一些规则调用具体的 nasm、gcc、ld 等编译器，然后形成 Hello OS.bin 文件，你把这个文件写复制到 boot 分区，写好 GRUB 启动项，这样就好了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1388"><span data-slate-object="text" data-key="1389"><span data-slate-leaf="true" data-offset-key="1389:0" data-first-offset="true"><span data-slate-string="true">这里只是上上手，下面我们还会去准备一些别的东西，然后就真正开始了。但你此刻也许还有很多问题没有搞清楚，比如重新加载 GDT、关中断等，先不要担心，我们后面会一一解决的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="1390" id="sr-toc-10"><span data-slate-object="text" data-key="1391"><span data-slate-leaf="true" data-offset-key="1391:0" data-first-offset="true"><span data-slate-string="true">思考题</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="1392"><span data-slate-object="text" data-key="1393"><span data-slate-leaf="true" data-offset-key="1393:0" data-first-offset="true"><span data-slate-string="true">以上 printf 函数定义，其中有个形式参数很奇怪，请你思考下：为什么是 “…” 形式参数，这个形式参数有什么作用？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1394"><span data-slate-object="text" data-key="1395"><span data-slate-leaf="true" data-offset-key="1395:0" data-first-offset="true"><span data-slate-string="true">欢迎你在留言区分享你的思考或疑问。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="1396"><span data-slate-object="text" data-key="1397"><span data-slate-leaf="true" data-offset-key="1397:0" data-first-offset="true"><span data-slate-string="true">我是 LMOS，我们下节课见！</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><span>135</span> 人觉得很赞<a href="javascript:void(0);">给文章提建议</a></p></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgICAgICAgICAgIDAwMDAwMDAwMDAQEBAQEBAQIBAQICAgECAgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/wAARCADuAO4DAREAAhEBAxEB/8QAfAABAAICAwEBAAAAAAAAAAAAAAYHBAgBAwUCCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAgIECwQJBQAAAAAAAAECAwQRBSEGMWESF0FRgVITk+MUVJTUIkJiB5EyhBVFhbXFNnFygqJTEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD9vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGHmbhg7fD0mbl4+LF69l32wrctPBCMmpTfUk2BG7ue+Wqm4rNsua6XTi5DWvVKyutPyaoDmnnrlq19l506W9NPTYuSk2/xQqnGPlaQElxM7Dzq/S4WVj5VfhlRbC1Rfil2G3GXU9GBlAAAAAAAAAAAAAAAAAAAAAAAAAAAA4bUU5SajGKblJtJJJattvgkkBVHMnP8AJSswtilHSLcLdxcVLV9DWHCWsdF/6ST1+6uiQFW35F+VbK/Jutvum9Z23WSssk/xTm3JgdIADvx8nIxLY34t9uPdD9W2myVc1412otPR6cV0MC1uWufvTTrwd8cITlpCrcYpQhKT4KOXBaQrbf346R8aXFgWmnrxXFPimvCAAAAAAAAAAAAAAAAAAAAAAAAAAFUfmBzHKLexYVjjrGMtxsg+LU12oYia6E4tSn400vOQFTAAAAAAAuDkDmSWRFbHm2OVtUHLb7ZvWU6oLWeK2+LdMV2ofgTX3UBaAAAAAAAAAAAAAAAAAAAAAAAABi52XDAwsvNs4wxce6+S10cvRQlNQX4ptaLrYGr+RfblX3ZN8nO7Itsutk/vWWSc5Pq4sDpAAAAAABlYWXbgZeNmUPS3Guruhx0TcJJ9mWnTGa4NeFMDaDGvrysejJqeteRTVfW/HC2EbI/9ZAdwAAAAAAAAAAAAAAAAAAAAAACJc8WurlncOzwdrxateqeVT2v0wTXlA18AAAAAAAAAbFcnXSu5a2mcnq402U/8cfJuoivJGtASYAAAAAAAAAAAAAAAAAAAAAABFOdqXdyzuSjxlWse7yVZVMp/or1YGvQAAAAAAAADY3lGiWPy3tNclo5Yzv8AF9nJusyYvyxtQEjAAAAAAAAAAAAAAAAAAAAAAAdGVj15eNkYty1qyaLaLF4exbCVctOvSXADWDNxLsDLycLIj2bsa6dM/E3B6KUfHCa0afhTAxQAAAAAAZ224Nu55+LgUp+kyboV6pa9iDetljXm1VpyfUgNnqaoUU1UVLs101wqrj4oVxUILyRQHYAAAAAAAAAAAAAAAAAAAAAAAAVrz5yzPNh++cGtzyaK1HNpgtZX0QX2bopcZW0R4NdLhp5ujCmQAAAAAAXbyLyzPbaXumdW4ZuVX2aKprSWNjS0bck+Mbr9FqumMeHS2gLDAAAAAAAAAAAAAAAAAAAAAAAAAACuOZOQ6c+dmbtDrxcubc7cWX2cbIm+LlW0n7vbLw8OxJ+bxbCpM7bM/bLXVn4l+NPVpekg1CenhrsWtdseuLaAwQAHo7ftO47raqsDEuyZapSlCOlVevhtul2aql/uaAt3lrkWjbJ15u5yry86Gk6qYrXFxpripfaSd90X0NpRi+hNpSAsIAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4sqrug67a4W1y/WhZCM4P/AFjJNMDw7eVuXrm5T2jCTfT6Kr0C49VLrQHNPK/L1ElKvaMJtcU7alfo/Gle7FqB7cK4VQVdcIVwitIwhFQhFeJRikkgPsAAAAAAAAAAAAAAAAAAAAAAAAAY2XmYuBRPKzL68aiv9ay2XZjq+iKXTKcvBFJt+BARGf5g8uRk4q3LsSeinDFkoy60pyhPR9aQHz3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAMjG575cybY1PKtxnJpRnk0Trq1fglZHtxrXXLRLxgTCMozjGUZKUZJSjKLTjKLWqlFrVNNPgwOQAAAAAAAAAAAAAAAAAAAAUZ+YW43ZG9ywHOSx9vqpUa9fsu7IphkTta8MnCyMepLrYECAAAAAAAAAAAF0/lxuN2Tt+Zg2zlOO320uhyerhTlK1qpPzYWUSa8Xa06NALHAAAAAAAAAAAAAAAAAAAABr3zx/lO6fsX9OxAImAAAAAAAAAAALY/K/+Ofyz+4AWwAAAAAAAAAAAAAAAAAAAADXvnj/ACndP2L+nYgETAAAAAAAAAAAFsflf/HP5Z/cALYAAAAAAAAAAAAAAAAAAAABVvMfJG7bxvOZuONkbdCjI937Eb7cmNq9DiUUS7Ua8S2C1nU2tJPgB4fdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAJvyby1ncvfvH323Et989z9F7rZdPs+7+9dvt+loo019OtNNfD0ATcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//Z"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-11">精选留言 (240)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>pedro</span></div><span>置顶</span></div><div>不想在物理机上搞的同学们，可以参考一下我的 repo。如下：
```sh
git clone https://gitee.com/gaopedro/pos
cd pos 
make &amp;&amp; make umount_image
make qemu
```
注意，在 linux 操作系统下操作，记得下载 qemu，如：
```sh
sudo apt-get install qemu
```
这样就可以直接在 qemu 上跑出 hello  world 了～</div><div><p>作者回复：很牛啊</p></div><div><div>2021-05-12</div><div><div><i></i><span>25</span></div><div><i></i><span>80</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/6d/7f/e1c189c7.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 陈诚</span></div><span>置顶</span></div><div>写了一个关于这节课实验的笔记，VMware + Ubuntu 16.04 环境，供大家参考
https://blog.csdn.net/chenchengwudi/article/details/116707122</div><div><p>作者回复: 666666</p></div><div><div>2021-05-12</div><div><div><i></i><span>13</span></div><div><i></i><span>77</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/13/26/aa/b8435860.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Strangeen🚁</span></div><span>置顶</span></div><div>我是小白，只会 java，没学过 c，当时也只是抱着了解下操作系统的想法报了课程，学到第 2 课，发现完全听不懂... 
不过跟着课程和陈诚的博客走（https://blog.csdn.net/chenchengwudi/article/details/116707122），然后下载了老师的代码，最终居然还是跑出 Hello OS! 来了，虽然还不太明白汇编、Makefile、hello.lds 代码的含义...
看来又多了一份学下去的信心了！
我是在 mac pro (os 10.15.6) 上使用 parallel 安装的 ubuntu kylin 18.04，这里我要对像我这样的小白说 3 个点：
1、安装 nasm，才能执行 make
先安装 nasm：sudo apt-get install -y nasm
然后在 HelloOS 目录下执行：make -f Makefile
就可以得到 HelloOS.bin 文件了
2、一定要按照陈诚的博客的 2.1 中配置下启动项，不然无法选择 HelloOS 菜单
先修改文件：/etc/default/grub
然后执行：sudo update-grub
3、menuentry 直接添加到 grub.cfg 文件的末尾即可</div><div><p>作者回复：你太用功了</p></div><div><div>2021-05-15</div><div><div><i></i><span>15</span></div><div><i></i><span>64</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1c/f7/36/ccf3b5d1.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Vic</span></div><span>置顶</span></div><div>终于试成功了，超开心！
'Hello OS'

我是使用虚拟机
df /boot/
显示的是
Filesystem     1K-blocks    Used Available Use% Mounted on
/dev/vda1       50633164 1340568  49276212   3% /

一直遇到 error : file '/boot/HelloOS.bin' not found
后来看到网上有文章介绍 grub rescue 的模式，
在 grub boot menu 里运行 command line, 在 boot menu 按'c' 可进到 grub 的互动模式
grub&gt;
grub&gt; ls 
(hd0, gpt15) (hd0, gpt14) (hd0, gpt1)
可看到多个分区，一个个确认，直到能正确看到 /boot/ 下的档案表示这个分区是正确的分区
不正确的分区
grub&gt; ls (hd0,gpt15)/boot
unknown filesystem
一直到能正确显示档案系统
grub&gt; ls (hd0,gtp1)/boot

重新开机到原来 linux kernel 的选项
编辑
/boot/grub/grub.cfg
以我的虚拟机的设定
set root='hd0, gpt1'
存档，重开机
大功告成！





</div><div><p>编辑回复：太赞了，不但自己实战，还分享给大伙经验了，良性循环，666</p></div><div><div>2021-05-12</div><div><div><i></i><span>7</span></div><div><i></i><span>60</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div></div><div><div><div><span>Shinymimiq</span></div><span>置顶</span></div><div>我测试了一下 M1 的 Mac 也是能跑起了 HelloOS 的，虽然坑比较多。我大致总结了一下步骤：

首先需要安装 x86 版的 homebrew
用 Rosetta 打开 iTerm
然后安装 x86 的 homebrew
`arch -x86_64 /bin/bash -c"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"`

接下来是重点，Apple 自带的 C/C++ 工具链是 clang，外加用的 linker 和 GUN linker 不兼容，没办法使用课程中提供的 linker script，所以我们需要编译安装 x86 的 gcc 工具链，顺便可以把 nasm 和 qemu 给装了

```
/usr/local/bin/brew tap nativeos/i386-elf-toolchain
/usr/local/bin/brew install i386-elf-binutils i386-elf-gcc nasm qemu
```

安装完成之后确认一下我们的 gcc 和 ld
```
/usr/local/Cellar/i386-elf-gcc/9.2.0/bin/i386-elf-gcc
/usr/local/Cellar/i386-elf-binutils/2.31/bin/i386-elf-ld
```

接下来的步骤我参考了 Viz 的评论，代码是在
`https://github.com/vizv/learn\_os/tree/master/hello-os`

可以手动修改 Makefile 里面的宏
```
ASM := /usr/local/Cellar/nasm/2.15.05/bin/nasm
CC  := /usr/local/Cellar/i386-elf-gcc/9.2.0/bin/i386-elf-gcc
LD  := /usr/local/Cellar/i386-elf-binutils/2.31/bin/i386-elf-ld
```

顺带一提，我使用 iTerm 跑还需要在 qemu 命令上加上 - nographic，不然好像没法退出
```
qemu-system-x86_64 -nographic -curses -drive 'file=$&lt;,format=raw,index=0,media=disk'
```

然后直接 `make all` 就可以运行我们的 hello-os 了</div><div><p>作者回复：你好，感谢你的分享，m1 的同学有福了 </p></div><div><div>2021-05-22</div><div><div><i></i><span>4</span></div><div><i></i><span>48</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/dd/7b/c1efb1d9.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 胡永</span></div><span>置顶</span></div><div>补充两个我遇到的坑：
1. 如何确定 boot 挂载的分区，参考 Geek_993581 提供的方法，在 grub 命令行里确认。
 set root='hd0,msdos4' #注意 boot 目录挂载的分区，修改为自己的分区。
我自己的是（hd0,gpt2）。
把 insmod part_msdos 修改为 part_gpt。
2. 很多同学遇到说 HelloOS.bin 找不到
这个就是要确认 boot 的挂在路径是 / 还是 /boot

文件系统          1K - 块    已用     可用      已用 % 挂载点
/dev/sda4      48752308 8087584 38158536   18%    /
如果跟老师一样，不用修改。
但是如果挂载点是 /boot，需要把路径改为 multiboot2 /HelloOS.bin
当然你也可以在 grub 命令行里面确认，
如果 ls (hd0,gpt2)/boot 找不到 boot 目录，就 ls (hd0,gpt2)/，如果能看到 HelloOS.bin, 说明 grub 把 boot 设为 root，路径前面不需要加 boot 了。</div><div><p>作者回复：你是对的 正确</p></div><div><div>2021-05-13</div><div><div><i></i><span>12</span></div><div><i></i><span>36</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/27/ea/54/ff47ba65.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Viz</span></div><span>置顶</span></div><div>我也搞了份不需要 GRUB 可以直接用 QEMU 或者其他虚拟机软件跑的版本
https://github.com/vizv/learn_os/tree/master/hello-os

克隆仓库后在 hello-os 目录里

只编译链接并创建镜像：
make hello-os.img

编译链接并创建镜像后用 QEMU 启动磁盘镜像：
make</div><div><p>编辑回复: 6666，佩服佩服，感谢你的分享！教学相长，期待之后课程里，你还有更多的输出。</p></div><div><div>2021-05-15</div><div><div><i></i><span>8</span></div><div><i></i><span>30</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/13/13/9d/d91dc762.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 喜欢吃鱼</span></div><span>置顶</span></div><div>实验注意几个关键问题。

- 将作者提供的代码 git 到本地；

- 安装 nasm、gcc 等工具，否则 make 不通过。随后执行 “make -f Makefile”，得到 HelloOs.bin；

- 在 /boot/grub/grub.cfg 中添加如下引导内容：

  ```shell
  menuentry 'HelloOS' {
       insmod part_msdos #GRUB 加载分区模块识别分区
       insmod ext2 #GRUB 加载 ext 文件系统模块识别 ext 文件系统
       set root='hd0,msdos1' #注意 boot 目录挂载的分区，这是我机器上的情况
       multiboot2 /boot/HelloOS.bin #GRUB 以 multiboot2 协议加载 HelloOS.bin
       boot #GRUB 启动 HelloOS.bin
  }
  ```

- ```she
  #其中 set root='hd0,msdos1' 根据 /boot 挂载的实际情况填写，如我的机器是：
  ubuntu@ubuntu-virtual-machine:~$ df /boot
  Filesystem     1K-blocks    Used Available Use% Mounted on
  /dev/sda1       20509264 7482912  11961496  39% /
  ```

- 将 HelloOs.bin 拷贝到 /boot/ 目录；

- 重启机器，vmvare 长按 shift 进入引导页面，可以看到 HelloOS，选择 HelloOS 进入。</div><div><p>作者回复：对的 </p></div><div><div>2021-07-13</div><div><div><i></i><span>2</span></div><div><i></i><span>14</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/52/8e/07db8450.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 第九天魔王</span></div><span>置顶</span></div><div>实际上 boot 目录只是一个目录，helloos 文件可以放到其它目录，只要把 grub.cfg 里面相应位置改下就行了。把内核文件放到 boot 目录是一个既定的做法，目录下面有个 vmlinuz-xxx 就是 Ubuntu 的内核镜像。另外 grub 本身带有 ext 驱动，所以可以访问文件系统，取出你的内核镜像执行。</div><div><p>编辑回复：对的，666！期待你的更多精彩分享～</p></div><div><div>2021-05-13</div><div><div><i></i></div><div><i></i><span>11</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/27/f8/2c/92969c48.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 青玉白露</span></div><span>置顶</span></div><div>写了一个基于 Vmare 和 Ubuntu16.04 的详细教程，只要手头有电脑就可以运行，大家可以看看：
https://zhuanlan.zhihu.com/p/373996858</div><div><p>作者回复：谢谢</p></div><div><div>2021-05-21</div><div><div><i></i><span>5</span></div><div><i></i><span>9</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://static001.geekbang.org/account/avatar/00/25/e6/2a/5995f26a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Eevee</span></div><span>置顶</span></div><div>将自己遇到的几个小问题总结下，希望能帮助到其他同学（linux 新手）
1. 将 HelloOs.bin 移动到 boot 文件夹时无权限
解决办法：打开终端，运行命令 sudo nautilus 就可以打开一个管理员权限的文件管理器
2.df/boot/ 失效
解决办法：df-h 查看所有文件挂载，找到 boot 即可
3.nasm 安装，参考教程 https://blog.csdn.net/qq_44641344/article/details/104355359?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-0&amp;spm=1001.2101.3001.4242

</div><div><p>作者回复：谢谢</p></div><div><div>2021-05-13</div><div><div><i></i></div><div><i></i><span>8</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1a/11/7c/bf5049b3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Freddy</span></div><span>置顶</span></div><div>我用的是 CentOS 7 虚拟机，有点不一样：
环境说明：
gcc --version
gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44)

[root@node01 ~]# cat /etc/redhat-release 
CentOS Linux release 7.6.1810 (Core)


下面是添加 HelloOS 启动项的流程：
1. 在 /etc/grub.d/40_custom 文件中，添加 HelloOS 在 grub2 中的配置
#!/bin/sh
exec tail -n +3 $0
# This file provides an easy way to add custom menu entries.  Simply type the
# menu entries you want to add after this comment.  Be careful not to change
# the 'exec tail' line above.
# 以下是添加内容
menuentry 'HelloOS' {
     insmod part_msdos #GRUB 加载分区模块识别分区
     insmod ext2 #GRUB 加载 ext 文件系统模块识别 ext 文件系统
     set root='hd0,msdos1' #注意 boot 目录挂载的分区，这是我机器上的情况
     multiboot2 /HelloOS.bin #GRUB 以 multiboot2 协议加载 HelloOS.bin
     boot #GRUB 启动 HelloOS.bin
}

2. 重新生成 /boot/grub2/grub.cfg 文件
[root@node01 grub2]# grub2-mkconfig -o /boot/grub2/grub.cfg

3. 重启 VM，即可在 grub 引导项中看到多了 HelloOS

</div><div><p>作者回复：你好，你这样操作也是对的 </p></div><div><div>2021-05-24</div><div><div><i></i><span>8</span></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/1f/af/b8/458866d3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>Bo</span></div><span>置顶</span></div><div>在输入 df /boot/ 时，要注意下【挂载点】的值是 / 还是 /boot，东哥这里是 /；如果是 /boot，就要注意在修改 /boot/grub/grub.cfg 文件时，multiboot2 这一项直接填写 / HelloOS.bin 即可，而不需要在前面加 /boot 了，因为 /boot 被划分为单独的分区了，即：
multiboot2 /HelloOS.bin #GRUB 以 multiboot2 协议加载 HelloOS.bin

此外，还可以参考楼上 Geek_993581 的回答去验证 HelloOS.bin 的位置</div><div><p>编辑回复：感谢老铁的优质分享！</p></div><div><div>2021-05-13</div><div><div><i></i><span>2</span></div><div><i></i><span>5</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM72LSGBkXDj3jpuhZp45mjwDDAJW6FS6PwtDjaTg03H64fhHyDAIrF9H8iazY3pM6earSr3cOu96ew/132"></div></div><div><div><div><span>royalfarmer</span></div><span>置顶</span></div><div>也来交个作业
既然是从 0 到 1，建议像我一样的小白用户，全部代码自己动手写一遍，哪怕很多细节不懂，但从整体上会有一个感性认识，有了框架，后面慢慢补充相关知识，这样学的会更加牢固。
那些折腾虚拟机直接 copy 老师的代码，是高手玩的，需要有足够的基本功才玩的转。小白一定要先练好自己的基本功，手动抄代码是练基本功非常好的方法，看一遍和写一遍感觉完全不一样。

操作系统算是比较难的了，开始学习之前，自己得先有些基本的知识储备。
首先，要对 Linux 有基本概念，会在物理机上装 Linux，知道 Linux 常用的命令，知道怎么在 Linux 里安装程序。

说下我的作业过程：
一、个人 PC 上直接装的 Linux，版本是 ubuntu。

二、在自己的家目录下新建一个 HelloOS 文件夹，在里面新建 5 个文件，文件内容照着老师给的源码全部手抄一遍，一定要仔细，一个字母都不能差：

entry.asm （汇编文件，进行一些针对电脑硬件的操作）  
main.c （我们自己这个操作系统的主函数源代码，里面就一个 printf 函数，功能是我们这个操作系统运行时显示的那句话）  
vgastr.c （printf 函数的具体实现代码，需要调用到显卡显存） 
vgastr.h （主函数的头文件）  
Makefile (make 命令编译时遵照的格式文件) 

install.md (确切的说，这是一段代码，有没有这个文件都行，把代码补充到 /boot/grub/grub.cfg 文件的末尾，目的是更新 grub 引导程序的配置文件，让 grub 能找到我们的 helloOS，评论里出现最多的找不到文件的问题，基本都是这段代码没写对，更确切说，就是那一句 multiboot2 /boot 或改为 multiboot2 / )

三、途中可能会遇到几个问题   
	1 提示没有装 nasm, 无法编译汇编文件 .asm，解决方法，直接根据系统提示，输入命令安装该程序
	2 提示 make 不是命令，无法编译，解决方法，直接根据系统提示，输入命令安装该程序
	3 源代码抄写错误，都会有提示具体在哪个文件哪一行，写错字符，缺少横杠，字符大小写等（我甚至都没有用编辑器，抄起来确实比较痛苦，但完成后的成就感也更大） 

四、补充一个细节，确认完挂载点后，记得把 helloOS.bin 文件放到挂载点的目录下，要不然，即使 grub.cfg 配置写对了，仍然会提示找不到文件。

五、有个小问题没搞明白，为啥我生成的 helloOS.bin 文件的首字母是小写的？我看别人的截图都是大写的，不过这个貌似不影响系统启动。</div><div><p>作者回复：最后一个问题 看一下代码 可改的 </p></div><div><div>2021-09-25</div><div><div><i></i><span>2</span></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/2a/40/a8/304111d9.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 孟祥毅🇨🇳Xiangyi</span></div><span>置顶</span></div><div>P.S. 不想每次改完程序重启看效果的同学可以考虑用 qemu 来 boot kernel，之前有两个同学给了 solution，但是好像一个制作引导镜像的步骤有点问题，另一个没用 grub，用的自定义的 bootloader。我 follow 老师的课程做了个 grub 版的（包括怎么制作引导镜像）放在了 github 上 https://github.com/xymeng16/helloOS，不想深究直接 make qemu-grub 就可以用，想深究的话脚本也都在 repo 里面～之后我会把联合 gdb 调试的脚本也加进去，方便找 bug...</div><div><p>作者回复: 666666</p></div><div><div>2021-10-21</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/e5/0d/8114646a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>De_sword</span></div><span>置顶</span></div><div>补充一点对于内核文件路径设定的方案。
尝试过 @Vic， @陈诚 ， 的方案。
进入过 grub 模式查看硬盘下的路径，但是仍然遇到 error : file '/boot/HelloOS.bin' not found 的问题。

因此，我这边参考了 grub.cfg 里面，“Ubuntu” 的设置：
menuentry 'Ubuntu' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-c2b35b75-3fa4-4021-b628-65742342045e' {
&nbsp; &nbsp; &nbsp; &nbsp; insmod gzio
&nbsp; &nbsp; &nbsp; &nbsp; insmod part_msdos
&nbsp; &nbsp; &nbsp; &nbsp; insmod ext2
&nbsp; &nbsp; &nbsp; &nbsp; set root='hd0,msdos1'
&nbsp; &nbsp; &nbsp; &nbsp; initrd&nbsp; /initrd.img-4.4.0-57-generic
}
可以发现，默认载入时就已经以 /boot 为根目录， 因此，我也照葫芦画瓢，没有额外设定 /boot 目录。

重新启动，就可以成功运行 HelloOS 内核了。
</div><div><p>作者回复：是的 要看看你的 boot 目录的挂载路径</p></div><div><div>2021-09-10</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/13/d6/278ad881.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 大鱼 Coo</span></div><span>置顶</span></div><div>从开机选项中看到自己的 OS，很有成就感。会一点 C 和 make，gcc 方面不熟，nasm 和 ld 需要额外了解。grub.cfg 文件的挂载分区，一个参考命令，也可以参考里面已经有的 menuentry</div><div><p>编辑回复：太优秀了，再接再厉，这里带大家找找感觉。后面讲解更精彩，敬请期待。</p></div><div><div>2021-05-12</div><div><div><i></i><span>3</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/29/e3/68/f40551d5.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 不安好心</span></div><span>置顶</span></div><div>有一个疑问，汇编代码那里：
; 重新加载
GDTlgdt [GDT_PTR]
jmp dword 0x8 :_32bits_mode
这里明明没有开启保护模式，为什么能这样跳转，而且经验证，也确实使用了 gdt。
但是实模式不是 cs &lt;&lt; 4 + offset 进行寻址吗？</div><div><p>作者回复：因为 GRUB 已经在保护模式下了</p></div><div><div>2021-08-25</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/87/45/9edd38ba.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>超级励辰</span></div></div><div>0x7C00&nbsp;由来的一种说法。当时，搭配的操作系统是 86-DOS。这个操作系统需要的内存最少是 32KB。我们知道，内存地址从 0x0000 开始编号，32KB 的内存就是 0x0000～0x7FFF。8088 芯片本身需要占用 0x0000～0x03FF，用来保存各种中断处理程序的储存位置。（主引导记录本身就是中断信号 INT&nbsp;19h 的处理程序。）所以，内存只剩下 0x0400～0x7FFF 可以使用。为了把尽量多的连续内存留给操作系统，主引导记录就被放到了内存地址的尾部。由于一个扇区是 512 字节，主引导记录本身也会产生数据，需要另外留出 512 字节保存 (自己&nbsp;和&nbsp;产生)。所以，它的预留位置就变成了：
&nbsp;&nbsp;&nbsp;&nbsp;0x7FFF&nbsp;-&nbsp;512&nbsp;-&nbsp;512&nbsp;+&nbsp;1&nbsp;=&nbsp;0x7C00&nbsp;</div><div><p>作者回复：哈哈 你是计算机历史学家</p></div><div><div>2021-05-27</div><div><div><i></i></div><div><i></i><span>16</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/6d/7f/e1c189c7.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 陈诚</span></div></div><div>如果看过王爽老师的《汇编语言》和李忠老师的《X86 汇编语言：从实模式到保护模式》，这段的理解将非常简单，建议大家可以配合使用</div><div><p>作者回复：目前不需要搞懂 先感受一下，我后面课程也会介绍 的
 </p></div><div><div>2021-05-12</div><div><div><i></i><span>2</span></div><div><i></i><span>13</span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".a"><outline class="toc-level-h1" data-reactid=".a.0" style="width: 175px;"><active data-reactid=".a.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".a.0.1"><span data-reactid=".a.0.1.0"> 02 | 几行汇编几行 C：实现一个最简单的内核</span></a></outline><outline class="toc-level-h2" data-reactid=".a.1" style="width: 165px;"><active data-reactid=".a.1.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".a.1.1"><span data-reactid=".a.1.1.0">PC 机的引导流程</span></a></outline><outline class="toc-level-h2" data-reactid=".a.2" style="width: 165px;"><active data-reactid=".a.2.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".a.2.1"><span data-reactid=".a.2.1.0">Hello OS 引导汇编代码</span></a></outline><outline class="toc-level-h2" data-reactid=".a.3" style="width: 165px;"><active data-reactid=".a.3.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".a.3.1"><span data-reactid=".a.3.1.0">Hello OS 的主函数</span></a></outline><outline class="toc-level-h2" data-reactid=".a.4" style="width: 165px;"><active data-reactid=".a.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".a.4.1"><span data-reactid=".a.4.1.0">控制计算机屏幕</span></a></outline><outline class="toc-level-h2" data-reactid=".a.5" style="width: 165px;"><active data-reactid=".a.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".a.5.1"><span data-reactid=".a.5.1.0">编译和安装 Hello OS</span></a></outline><outline class="toc-level-h2" data-reactid=".a.6" style="width: 165px;"><active data-reactid=".a.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".a.6.1"><span data-reactid=".a.6.1.0">make 工具</span></a></outline><outline class="toc-level-h2" data-reactid=".a.7" style="width: 165px;"><active data-reactid=".a.7.0"></active><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".a.7.1"><span data-reactid=".a.7.1.0">编译</span></a></outline><outline class="toc-level-h2" data-reactid=".a.8" style="width: 165px;"><active data-reactid=".a.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".a.8.1"><span data-reactid=".a.8.1.0">安装 Hello OS</span></a></outline><outline class="toc-level-h2" data-reactid=".a.9" style="width: 165px;"><active data-reactid=".a.9.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".a.9.1"><span data-reactid=".a.9.1.0">重点回顾</span></a></outline><outline class="toc-level-h2" data-reactid=".a.a" style="width: 165px;"><active data-reactid=".a.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".a.a.1"><span data-reactid=".a.a.1.0">思考题</span></a></outline><outline class="toc-level-h2" data-reactid=".a.b" style="width: 165px;"><active data-reactid=".a.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".a.b.1"><span data-reactid=".a.b.1.0">精选留言 (240)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/369502" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>