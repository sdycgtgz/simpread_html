
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAAA7VBMVEUAAAD///8ZGRnw8PBWVlb4+PgeHh719fVEREQlJSUODg6Ojo7Ly8v9/f1NTU2VlZUFBQV6enrCwsLy8vLh4eE0NDQLCwu8vLyXl5dxcXHa2trAwMCFhYVDQ0OysrKampo7OzssLCwICAioqKjJyckhISHu7u4/Pz9TU1NQUFBLS0tAQED6+vrS0tKRkZFISEgvLy+goKB+fn5vb29nZ2fm5uYbGxvk5OTX19d2dnZaWlre3t5hYWEyMjK5ubkoKCgVFRXQ0NDMzMzFxcW0tLSsrKykpKSMjIzq6urU1NSAgICvr6+cnJyHh4dsbGyfc25QAAAFkElEQVRIx4WXB3faMBCA74wHxgMMGAOh1MyyVyBAmtVmd/3/n1OdDtWstt/Li5JD35MtnU4CMnCIlkLEOpSKuMPhuI4FE444L9+dyv3zciad/rAjfU/yOPpGcjWS1NKSGsk29WTSD1IeYsIPkvsAJF+C5BIZkieYMNjJnsF4+JHk61wOSlVDyOIPqKBgZIxYTrqy/AmNtC1ps7yqlgE6dgYa1WqD5aV9SbKDbe6ZNnCq5A5ILlhGjEASIoawJdmHHo98AZLOnmxzKM9yK9Aht63FoAWBBmEgsEHnkfMgsZU8PJbpbXJd3MIep/Lg/MjbRqMRRuNtQ4Tthga5RiNzfmSWD97ZExQ64HhtgLb3CmbBGyj54vixjyeMsKjnV4AvOAHTwsHphKnH9toXki7Li3jLsgswizskv+c3PHKXe7ZHu5E/YMKcM2yqZIJkAclZTPClbJezivI1yTr4f+TeMib5qXxHsr7XtUFJDIc8pLAHA7Su4JXkd8ySnKZddQXH2NohswIutRu0Qu0jyS46JPugU+gISB1R8NBKWegVUsahTKEjAP9Bm5bKAc3DPlzjKaDvscE7PeEJu63WUg9a82tdA1O/ESupL9Cr6C1cXetjIe9zgQ4kvKLgHi6xC5LcGq9hhmiK0AYgUvLQtzm3n/x0jnum/Vo9j1jxg/pL3/f9W8isMOsv6/Ubf47rvl+u17nnZ1xQ+4iIXa6IpRVeimEEE3pnxO8kIz4CbFDyidVSpooBCCLLsj5noFlqUg2rwK0l+Anmm+VhCzKfrRHtqjGOLANxUKIUiYvFEcuaaZpXANniD5ZzpiBDTSRkuDJfWM6awxGuikUArp7fIOE7RlB6OygGTyhfsMyrtwDNIAkcp1YRhKC9Oh2IHUFQ6UPupnLL3icODaD5zVlUto7zhm1n7kmZ5kDSQBxykfZhD66eaQBoWriEGPcA182C4Crst90Z9NwvHgahDTALw/Ae4D500Pjq3oj/4sjtwcwVrCkkgB01HB8cdM0iIlWSr6IpNqFO+1mDHQFWORtO5EIi08b4jxy6giBsgKDnRnEYYdd9nIYvaLmuhS/h9DF5bEFr/7HTKAjUqWY1oUUBKgYEZdgIP6gJE2xQIWVvLhZBcAWx843kz87PDDi4cgR92s8/1FLpAGNeKiUbGtRQEIPkGb9TM1EF8MpCVEni7pIkkUdDs1ZcI/ZUer6YZg4WxTtqMmYsZJWebbOzEekZV4sCKaNhBaXQQ0NtjL71ZooNE1vWLfyyyFUbw7MsD0fWOFMSqAnbwj1Kuk0Aqp4aJ91MZhhvyS7+oQoMy5v63Jfoz/UYfPSiep2KQb5e4/gt1Ycdc7Se6jNyVbpuQNI08FrICQ6ccKnSXddrKCnqkqWFupJFAewKudSTBVAyBEjrLSXjCYnc5rrdQVl6VaiKqOTToi/kaSrlcW5fpGpgrlJTLvoGVxKDOg7PHzc6NLXOmuUHTZQhTWvS4T7T5ixPqGPz/EHXp/azkMeQoGOqBBOSq1gD4vwRe1culz8W8HlZKQt6Sjbm5XeS9eWizJw73HcsOW8mSpa0eT8zfK1w85LdtWKTf5dWfCPzMg5J+MBdsvvy6Q2QD/d91sfzouRz9zAdBp6HCcUzskccyBdKzjTC9ZE8HT8+JHLxtiE4d33Ud0uleOObvpXZk4E4/9h2sKD9t6oxgaCFxs9AHiI3wYJCndMbIMs9lLi7vEHFLxAUURyciOnTyzrLH6qSJwo+8CWuQIFL2wSoVyvQea/qtk2yvPtb4mekZMhJQkPwyvIzBbJGJD+jX3eGcfIFhWVmxsVAG5FMgSzm9y4wKL8aJdzvyctoTqEgep6K5lckWGM3uuuA5DadFvIhiTzBL1xzVtT0UDEDxd9ldeutcJLoyvUaoPgNdiqckZLamd0AAAAASUVORK5CYII=")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 28｜应用保障：如何让 Pod 运行得更健康？</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>28｜应用保障：如何让 Pod 运行得更健康？</sr-rd-title>
                    
                    <sr-rd-content><h1 id="sr-toc-0">28｜应用保障：如何让 Pod 运行得更健康？</h1><div><span>Chrono</span> <span>2022-08-26</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/21/d4/216ff88d248ed64d38b3f7e06dbcc5d4.jpeg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：Chrono</span><span> 大小：13.20M</span><span> 时长：14:27</span></div></div><audio title="28｜应用保障：如何让Pod运行得更健康？" src="https://res001.geekbang.org/media/audio/30/22/309d06feeyy1019834de4c69d1c70d22/ld/ld.m3u8" __idm_id__="884766"></audio></div><div><div><div><div data-slate-editor="true" data-key="14583" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="14584"><span data-slate-object="text" data-key="14585"><span data-slate-leaf="true" data-offset-key="14585:0" data-first-offset="true"><span data-slate-string="true">你好，我是 Chrono。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14586"><span data-slate-object="text" data-key="14587"><span data-slate-leaf="true" data-offset-key="14587:0" data-first-offset="true"><span data-slate-string="true">在前面这么多节的课程中，我们都是在研究如何使用各种 API 对象来管理、操作 Pod，而对 Pod 本身的关注却不是太多。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14588"><span data-slate-object="text" data-key="14589"><span data-slate-leaf="true" data-offset-key="14589:0" data-first-offset="true"><span data-slate-string="true">作为 Kubernetes 里的核心概念和原子调度单位，Pod 的主要职责是管理容器，以逻辑主机、容器集合、进程组的形式来代表应用，它的重要性是不言而喻的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14590"><span data-slate-object="text" data-key="14591"><span data-slate-leaf="true" data-offset-key="14591:0" data-first-offset="true"><span data-slate-string="true">那么今天我们回过头来，在之前那些上层 API 对象的基础上，一起来看看在 Kubernetes 里配置 Pod 的两种方法：资源配额 Resources、检查探针 Probe，它们能够给 Pod 添加各种运行保障，让应用运行得更健康。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14592" id="sr-toc-1"><span data-slate-object="text" data-key="14593"><span data-slate-leaf="true" data-offset-key="14593:0" data-first-offset="true"><span data-slate-string="true">容器资源配额</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14594"><span data-slate-object="text" data-key="14595"><span data-slate-leaf="true" data-offset-key="14595:0" data-first-offset="true"><span data-slate-string="true">早在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14596"><span data-slate-object="text" data-key="14597"><span data-slate-leaf="true" data-offset-key="14597:0" data-first-offset="true"><span data-slate-string="true">第 2 讲</span></span></span></a><span data-slate-object="text" data-key="14598"><span data-slate-leaf="true" data-offset-key="14598:0" data-first-offset="true"><span data-slate-string="true">的时候我们就说过，创建容器有三大隔离技术：namespace、cgroup、chroot。其中的 namespace 实现了独立的进程空间，chroot 实现了独立的文件系统，但唯独没有看到 cgroup 的具体应用。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14599"><span data-slate-object="text" data-key="14600"><span data-slate-leaf="true" data-offset-key="14600:0" data-first-offset="true"><span data-slate-string="true">cgroup 的作用是管控 CPU、内存，保证容器不会无节制地占用基础资源，进而影响到系统里的其他应用。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14601"><span data-slate-object="text" data-key="14602"><span data-slate-leaf="true" data-offset-key="14602:0" data-first-offset="true"><span data-slate-string="true">不过，容器总是要使用 CPU 和内存的，该怎么处理好需求与限制这两者之间的关系呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14603"><span data-slate-object="text" data-key="14604"><span data-slate-leaf="true" data-offset-key="14604:0" data-first-offset="true"><span data-slate-string="true">Kubernetes 的做法与我们在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14605"><span data-slate-object="text" data-key="14606"><span data-slate-leaf="true" data-offset-key="14606:0" data-first-offset="true"><span data-slate-string="true">第 24 讲</span></span></span></a><span data-slate-object="text" data-key="14607"><span data-slate-leaf="true" data-offset-key="14607:0" data-first-offset="true"><span data-slate-string="true">里提到的 PersistentVolumeClaim 用法有些类似，就是容器需要先提出一个 “书面申请”，Kubernetes 再依据这个 “申请” 决定资源是否分配和如何分配。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14608"><span data-slate-object="text" data-key="14609"><span data-slate-leaf="true" data-offset-key="14609:0" data-first-offset="true"><span data-slate-string="true">但是 CPU、内存与存储卷有明显的不同，因为它是直接 “内置” 在系统里的，不像硬盘那样需要 “外挂”，所以申请和管理的过程也就会简单很多。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14610"><span data-slate-object="text" data-key="14611"><span data-slate-leaf="true" data-offset-key="14611:0" data-first-offset="true"><span data-slate-string="true">具体的申请方法很简单，</span></span></span><span data-slate-object="text" data-key="14612"><span data-slate-leaf="true" data-offset-key="14612:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">只要在 Pod 容器的描述部分添加一个新字段 </span></span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14613"><span data-slate-object="text" data-key="14614"><span data-slate-leaf="true" data-offset-key="14614:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">resources</span></span></span></span></span><span data-slate-object="text" data-key="14615"><span data-slate-leaf="true" data-offset-key="14615:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true"> 就可以了</span></span></span></span><span data-slate-object="text" data-key="14616"><span data-slate-leaf="true" data-offset-key="14616:0" data-first-offset="true"><span data-slate-string="true">，它就相当于申请资源的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14617"><span data-slate-object="text" data-key="14618"><span data-slate-leaf="true" data-offset-key="14618:0" data-first-offset="true"><span data-slate-string="true">Claim</span></span></span></span><span data-slate-object="text" data-key="14619"><span data-slate-leaf="true" data-offset-key="14619:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14620"><span data-slate-object="text" data-key="14621"><span data-slate-leaf="true" data-offset-key="14621:0" data-first-offset="true"><span data-slate-string="true">来看一个 YAML 示例：</span></span></span></div><div data-slate-type="pre" data-slate-object="block" data-key="14622"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14623"><span data-slate-object="text" data-key="14624"><span data-slate-leaf="true" data-offset-key="14624:0" data-first-offset="true"><span data-slate-string="true">apiVersion: v1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14625"><span data-slate-object="text" data-key="14626"><span data-slate-leaf="true" data-offset-key="14626:0" data-first-offset="true"><span data-slate-string="true">kind: Pod</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14627"><span data-slate-object="text" data-key="14628"><span data-slate-leaf="true" data-offset-key="14628:0" data-first-offset="true"><span data-slate-string="true">metadata:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14629"><span data-slate-object="text" data-key="14630"><span data-slate-leaf="true" data-offset-key="14630:0" data-first-offset="true"><span data-slate-string="true">  name: ngx-pod-resources</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14631"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14632"><span data-slate-object="text" data-key="14633"><span data-slate-leaf="true" data-offset-key="14633:0" data-first-offset="true"><span data-slate-string="true">spec:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14634"><span data-slate-object="text" data-key="14635"><span data-slate-leaf="true" data-offset-key="14635:0" data-first-offset="true"><span data-slate-string="true">  containers:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14636"><span data-slate-object="text" data-key="14637"><span data-slate-leaf="true" data-offset-key="14637:0" data-first-offset="true"><span data-slate-string="true">  - image: nginx:alpine</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14638"><span data-slate-object="text" data-key="14639"><span data-slate-leaf="true" data-offset-key="14639:0" data-first-offset="true"><span data-slate-string="true">    name: ngx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14640"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14641"><span data-slate-object="text" data-key="14642"><span data-slate-leaf="true" data-offset-key="14642:0" data-first-offset="true"><span data-slate-string="true">    resources:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14643"><span data-slate-object="text" data-key="14644"><span data-slate-leaf="true" data-offset-key="14644:0" data-first-offset="true"><span data-slate-string="true">      requests:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14645"><span data-slate-object="text" data-key="14646"><span data-slate-leaf="true" data-offset-key="14646:0" data-first-offset="true"><span data-slate-string="true">        cpu: 10m</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14647"><span data-slate-object="text" data-key="14648"><span data-slate-leaf="true" data-offset-key="14648:0" data-first-offset="true"><span data-slate-string="true">        memory: 100Mi</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14649"><span data-slate-object="text" data-key="14650"><span data-slate-leaf="true" data-offset-key="14650:0" data-first-offset="true"><span data-slate-string="true">      limits:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14651"><span data-slate-object="text" data-key="14652"><span data-slate-leaf="true" data-offset-key="14652:0" data-first-offset="true"><span data-slate-string="true">        cpu: 20m</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14653"><span data-slate-object="text" data-key="14654"><span data-slate-leaf="true" data-offset-key="14654:0" data-first-offset="true"><span data-slate-string="true">        memory: 200Mi</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14655"><span data-slate-object="text" data-key="14656"><span data-slate-leaf="true" data-offset-key="14656:0" data-first-offset="true"><span data-slate-string="true">这个 YAML 文件定义了一个 Nginx Pod，我们需要重点学习的是 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14657"><span data-slate-object="text" data-key="14658"><span data-slate-leaf="true" data-offset-key="14658:0" data-first-offset="true"><span data-slate-string="true">containers.resources</span></span></span></span><span data-slate-object="text" data-key="14659"><span data-slate-leaf="true" data-offset-key="14659:0" data-first-offset="true"><span data-slate-string="true">，它下面有两个字段：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14660"><div data-slate-type="list-line" data-slate-object="block" data-key="14661"><span data-slate-object="text" data-key="14662"><span data-slate-leaf="true" data-offset-key="14662:0" data-first-offset="true"><span data-slate-string="true">“</span></span></span><span data-slate-object="text" data-key="14663"><span data-slate-leaf="true" data-offset-key="14663:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">requests</span></span></span></span><span data-slate-object="text" data-key="14664"><span data-slate-leaf="true" data-offset-key="14664:0" data-first-offset="true"><span data-slate-string="true">”，意思是容器要申请的资源，也就是说要求 Kubernetes 在创建 Pod 的时候必须分配这里列出的资源，否则容器就无法运行。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14665"><span data-slate-object="text" data-key="14666"><span data-slate-leaf="true" data-offset-key="14666:0" data-first-offset="true"><span data-slate-string="true">“</span></span></span><span data-slate-object="text" data-key="14667"><span data-slate-leaf="true" data-offset-key="14667:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">limits</span></span></span></span><span data-slate-object="text" data-key="14668"><span data-slate-leaf="true" data-offset-key="14668:0" data-first-offset="true"><span data-slate-string="true">”，意思是容器使用资源的上限，不能超过设定值，否则就有可能被强制停止运行。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14669"><span data-slate-object="text" data-key="14670"><span data-slate-leaf="true" data-offset-key="14670:0" data-first-offset="true"><span data-slate-string="true">在请求 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14671"><span data-slate-object="text" data-key="14672"><span data-slate-leaf="true" data-offset-key="14672:0" data-first-offset="true"><span data-slate-string="true">cpu</span></span></span></span><span data-slate-object="text" data-key="14673"><span data-slate-leaf="true" data-offset-key="14673:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14674"><span data-slate-object="text" data-key="14675"><span data-slate-leaf="true" data-offset-key="14675:0" data-first-offset="true"><span data-slate-string="true">memory</span></span></span></span><span data-slate-object="text" data-key="14676"><span data-slate-leaf="true" data-offset-key="14676:0" data-first-offset="true"><span data-slate-string="true"> 这两种资源的时候，你需要特别注意它们的表示方式。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14677"><span data-slate-object="text" data-key="14678"><span data-slate-leaf="true" data-offset-key="14678:0" data-first-offset="true"><span data-slate-string="true">内存的写法和磁盘容量一样，使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14679"><span data-slate-object="text" data-key="14680"><span data-slate-leaf="true" data-offset-key="14680:0" data-first-offset="true"><span data-slate-string="true">Ki</span></span></span></span><span data-slate-object="text" data-key="14681"><span data-slate-leaf="true" data-offset-key="14681:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14682"><span data-slate-object="text" data-key="14683"><span data-slate-leaf="true" data-offset-key="14683:0" data-first-offset="true"><span data-slate-string="true">Mi</span></span></span></span><span data-slate-object="text" data-key="14684"><span data-slate-leaf="true" data-offset-key="14684:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14685"><span data-slate-object="text" data-key="14686"><span data-slate-leaf="true" data-offset-key="14686:0" data-first-offset="true"><span data-slate-string="true">Gi</span></span></span></span><span data-slate-object="text" data-key="14687"><span data-slate-leaf="true" data-offset-key="14687:0" data-first-offset="true"><span data-slate-string="true"> 来表示 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14688"><span data-slate-object="text" data-key="14689"><span data-slate-leaf="true" data-offset-key="14689:0" data-first-offset="true"><span data-slate-string="true">KB</span></span></span></span><span data-slate-object="text" data-key="14690"><span data-slate-leaf="true" data-offset-key="14690:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14691"><span data-slate-object="text" data-key="14692"><span data-slate-leaf="true" data-offset-key="14692:0" data-first-offset="true"><span data-slate-string="true">MB</span></span></span></span><span data-slate-object="text" data-key="14693"><span data-slate-leaf="true" data-offset-key="14693:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14694"><span data-slate-object="text" data-key="14695"><span data-slate-leaf="true" data-offset-key="14695:0" data-first-offset="true"><span data-slate-string="true">GB</span></span></span></span><span data-slate-object="text" data-key="14696"><span data-slate-leaf="true" data-offset-key="14696:0" data-first-offset="true"><span data-slate-string="true">，比如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14697"><span data-slate-object="text" data-key="14698"><span data-slate-leaf="true" data-offset-key="14698:0" data-first-offset="true"><span data-slate-string="true">512Ki</span></span></span></span><span data-slate-object="text" data-key="14699"><span data-slate-leaf="true" data-offset-key="14699:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14700"><span data-slate-object="text" data-key="14701"><span data-slate-leaf="true" data-offset-key="14701:0" data-first-offset="true"><span data-slate-string="true">100Mi</span></span></span></span><span data-slate-object="text" data-key="14702"><span data-slate-leaf="true" data-offset-key="14702:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14703"><span data-slate-object="text" data-key="14704"><span data-slate-leaf="true" data-offset-key="14704:0" data-first-offset="true"><span data-slate-string="true">0.5Gi</span></span></span></span><span data-slate-object="text" data-key="14705"><span data-slate-leaf="true" data-offset-key="14705:0" data-first-offset="true"><span data-slate-string="true"> 等。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14706"><span data-slate-object="text" data-key="14707"><span data-slate-leaf="true" data-offset-key="14707:0" data-first-offset="true"><span data-slate-string="true">而 CPU 因为在计算机中数量有限，非常宝贵，所以 Kubernetes 允许容器精细分割 CPU，即可以 1 个、2 个地完整使用 CPU，也可以用小数 0.1、0.2 的方式来部分使用 CPU。这其实是效仿了 UNIX “时间片” 的用法，意思是进程最多可以占用多少 CPU 时间。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14708"><span data-slate-object="text" data-key="14709"><span data-slate-leaf="true" data-offset-key="14709:0" data-first-offset="true"><span data-slate-string="true">不过 CPU 时间也不能无限分割，</span></span></span><span data-slate-object="text" data-key="14710"><span data-slate-leaf="true" data-offset-key="14710:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Kubernetes 里 CPU 的最小使用单位是 0.001，为了方便表示用了一个特别的单位 </span></span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14711"><span data-slate-object="text" data-key="14712"><span data-slate-leaf="true" data-offset-key="14712:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">m</span></span></span></span></span><span data-slate-object="text" data-key="14713"><span data-slate-leaf="true" data-offset-key="14713:0" data-first-offset="true"><span data-slate-string="true">，也就是 “milli”“毫” 的意思，比如说 500m 就相当于 0.5。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14714"><span data-slate-object="text" data-key="14715"><span data-slate-leaf="true" data-offset-key="14715:0" data-first-offset="true"><span data-slate-string="true">现在我们再来看这个 YAML，你就应该明白了，它向系统申请的是 1% 的 CPU 时间和 100MB 的内存，运行时的资源上限是 2% CPU 时间和 200MB 内存。有了这个申请，Kubernetes 就会在集群中查找最符合这个资源要求的节点去运行 Pod。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14716"><span data-slate-object="text" data-key="14717"><span data-slate-leaf="true" data-offset-key="14717:0" data-first-offset="true"><span data-slate-string="true">下面是我在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14718"><span data-slate-object="text" data-key="14719"><span data-slate-leaf="true" data-offset-key="14719:0" data-first-offset="true"><span data-slate-string="true">网上</span></span></span></a><span data-slate-object="text" data-key="14720"><span data-slate-leaf="true" data-offset-key="14720:0" data-first-offset="true"><span data-slate-string="true">找的一张动图，Kubernetes 会根据每个 Pod 声明的需求，像搭积木或者玩俄罗斯方块一样，把节点尽量 “塞满”，充分利用每个节点的资源，让集群的效益最大化。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14721"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/39/91/397bfabd8234f8d859ca877a58f0d191.gif?wh=800x765" style="width: auto;"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14722"><span data-slate-object="text" data-key="14723"><span data-slate-leaf="true" data-offset-key="14723:0" data-first-offset="true"><span data-slate-string="true">你可能会有疑问：如果 Pod 不写 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14724"><span data-slate-object="text" data-key="14725"><span data-slate-leaf="true" data-offset-key="14725:0" data-first-offset="true"><span data-slate-string="true">resources</span></span></span></span><span data-slate-object="text" data-key="14726"><span data-slate-leaf="true" data-offset-key="14726:0" data-first-offset="true"><span data-slate-string="true"> 字段，Kubernetes 会如何处理呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14727"><span data-slate-object="text" data-key="14728"><span data-slate-leaf="true" data-offset-key="14728:0" data-first-offset="true"><span data-slate-string="true">这就意味着 Pod 对运行的资源要求 “既没有下限，也没有上限”，Kubernetes 不用管 CPU 和内存是否足够，可以把 Pod 调度到任意的节点上，而且后续 Pod 运行时也可以无限制地使用 CPU 和内存。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14729"><span data-slate-object="text" data-key="14730"><span data-slate-leaf="true" data-offset-key="14730:0" data-first-offset="true"><span data-slate-string="true">我们课程里是实验环境，这样做是当然是没有问题的，但如果是生产环境就很危险了，Pod 可能会因为资源不足而运行缓慢，或者是占用太多资源而影响其他应用，所以我们应当合理评估 Pod 的资源使用情况，尽量为 Pod 加上限制。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14731"><span data-slate-object="text" data-key="14732"><span data-slate-leaf="true" data-offset-key="14732:0" data-first-offset="true"><span data-slate-string="true">看到这里估计你会继续追问：如果预估错误，Pod 申请的资源太多，系统无法满足会怎么样呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14733"><span data-slate-object="text" data-key="14734"><span data-slate-leaf="true" data-offset-key="14734:0" data-first-offset="true"><span data-slate-string="true">让我们来试一下吧，先删除 Pod 的资源限制 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14735"><span data-slate-object="text" data-key="14736"><span data-slate-leaf="true" data-offset-key="14736:0" data-first-offset="true"><span data-slate-string="true">resources.limits</span></span></span></span><span data-slate-object="text" data-key="14737"><span data-slate-leaf="true" data-offset-key="14737:0" data-first-offset="true"><span data-slate-string="true">，把 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14738"><span data-slate-object="text" data-key="14739"><span data-slate-leaf="true" data-offset-key="14739:0" data-first-offset="true"><span data-slate-string="true">resources.request.cpu</span></span></span></span><span data-slate-object="text" data-key="14740"><span data-slate-leaf="true" data-offset-key="14740:0" data-first-offset="true"><span data-slate-string="true"> 改成比较极端的 “10”，也就是要求 10 个 CPU：</span></span></span></div><div data-slate-type="pre" data-slate-object="block" data-key="14741"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14742"><span data-slate-object="text" data-key="14743"><span data-slate-leaf="true" data-offset-key="14743:0" data-first-offset="true"><span data-slate-string="true">  ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14744"><span data-slate-object="text" data-key="14745"><span data-slate-leaf="true" data-offset-key="14745:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14746"><span data-slate-object="text" data-key="14747"><span data-slate-leaf="true" data-offset-key="14747:0" data-first-offset="true"><span data-slate-string="true">    resources:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14748"><span data-slate-object="text" data-key="14749"><span data-slate-leaf="true" data-offset-key="14749:0" data-first-offset="true"><span data-slate-string="true">      requests:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14750"><span data-slate-object="text" data-key="14751"><span data-slate-leaf="true" data-offset-key="14751:0" data-first-offset="true"><span data-slate-string="true">        cpu: 10</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14752"><span data-slate-object="text" data-key="14753"><span data-slate-leaf="true" data-offset-key="14753:0" data-first-offset="true"><span data-slate-string="true">然后使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14754"><span data-slate-object="text" data-key="14755"><span data-slate-leaf="true" data-offset-key="14755:0" data-first-offset="true"><span data-slate-string="true">kubectl apply</span></span></span></span><span data-slate-object="text" data-key="14756"><span data-slate-leaf="true" data-offset-key="14756:0" data-first-offset="true"><span data-slate-string="true"> 创建这个 Pod，你可能会惊奇地发现，虽然我们的 Kubernetes 集群里只有 3 个 CPU，但 Pod 也能创建成功。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14757"><span data-slate-object="text" data-key="14758"><span data-slate-leaf="true" data-offset-key="14758:0" data-first-offset="true"><span data-slate-string="true">不过我们再用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14759"><span data-slate-object="text" data-key="14760"><span data-slate-leaf="true" data-offset-key="14760:0" data-first-offset="true"><span data-slate-string="true">kubectl get pod</span></span></span></span><span data-slate-object="text" data-key="14761"><span data-slate-leaf="true" data-offset-key="14761:0" data-first-offset="true"><span data-slate-string="true"> 去查看的话，就会发现它处于 “Pending” 状态，实际上并没有真正被调度运行：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14762"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/b1/d4/b1154e089533df5cfabc18c7e9c442d4.png?wh=1380x176"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14763"><span data-slate-object="text" data-key="14764"><span data-slate-leaf="true" data-offset-key="14764:0" data-first-offset="true"><span data-slate-string="true">使用命令 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14765"><span data-slate-object="text" data-key="14766"><span data-slate-leaf="true" data-offset-key="14766:0" data-first-offset="true"><span data-slate-string="true">kubectl describe</span></span></span></span><span data-slate-object="text" data-key="14767"><span data-slate-leaf="true" data-offset-key="14767:0" data-first-offset="true"><span data-slate-string="true"> 来查看具体原因，会发现有这么一句提示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14768"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/95/02/9577c36e53c723b8e28ddb2d5e77e502.png?wh=1920x156"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14769"><span data-slate-object="text" data-key="14770"><span data-slate-leaf="true" data-offset-key="14770:0" data-first-offset="true"><span data-slate-string="true">这就很明确地告诉我们 Kubernetes 调度失败，当前集群里的所有节点都无法运行这个 Pod，因为它要求的 CPU 实在是太多了。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14771" id="sr-toc-2"><span data-slate-object="text" data-key="14772"><span data-slate-leaf="true" data-offset-key="14772:0" data-first-offset="true"><span data-slate-string="true">什么是容器状态探针</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14773"><span data-slate-object="text" data-key="14774"><span data-slate-leaf="true" data-offset-key="14774:0" data-first-offset="true"><span data-slate-string="true">现在，我们使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14775"><span data-slate-object="text" data-key="14776"><span data-slate-leaf="true" data-offset-key="14776:0" data-first-offset="true"><span data-slate-string="true">resources</span></span></span></span><span data-slate-object="text" data-key="14777"><span data-slate-leaf="true" data-offset-key="14777:0" data-first-offset="true"><span data-slate-string="true"> 字段加上资源配额之后，Pod 在 Kubernetes 里的运行就有了初步保障，Kubernetes 会监控 Pod 的资源使用情况，让它既不会 “饿死” 也不会 “撑死”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14778"><span data-slate-object="text" data-key="14779"><span data-slate-leaf="true" data-offset-key="14779:0" data-first-offset="true"><span data-slate-string="true">但这只是最初级的运行保障，如果你开发或者运维过实际的后台服务就会知道，一个程序即使正常启动了，它也有可能因为某些原因无法对外提供服务。其中最常见的情况就是运行时发生 “死锁” 或者 “死循环” 的故障，这个时候从外部来看进程一切都是正常的，但内部已经是一团糟了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14780"><span data-slate-object="text" data-key="14781"><span data-slate-leaf="true" data-offset-key="14781:0" data-first-offset="true"><span data-slate-string="true">所以，我们还希望 Kubernetes 这个 “保姆” 能够更细致地监控 Pod 的状态，除了保证崩溃重启，还必须要能够探查到 Pod 的内部运行状态，定时给应用做 “体检”，让应用时刻保持 “健康”，能够满负荷稳定工作。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14782"><span data-slate-object="text" data-key="14783"><span data-slate-leaf="true" data-offset-key="14783:0" data-first-offset="true"><span data-slate-string="true">那应该用什么手段来检查应用的健康状态呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14784"><span data-slate-object="text" data-key="14785"><span data-slate-leaf="true" data-offset-key="14785:0" data-first-offset="true"><span data-slate-string="true">因为应用程序各式各样，对于外界来说就是一个</span></span></span><span data-slate-object="text" data-key="14786"><span data-slate-leaf="true" data-offset-key="14786:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">黑盒子</span></span></span></span><span data-slate-object="text" data-key="14787"><span data-slate-leaf="true" data-offset-key="14787:0" data-first-offset="true"><span data-slate-string="true">，只能看到启动、运行、停止这三个基本状态，此外就没有什么好的办法来知道它内部是否正常了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14788"><span data-slate-object="text" data-key="14789"><span data-slate-leaf="true" data-offset-key="14789:0" data-first-offset="true"><span data-slate-string="true">所以，我们必须把应用变成</span></span></span><span data-slate-object="text" data-key="14790"><span data-slate-leaf="true" data-offset-key="14790:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">灰盒子</span></span></span></span><span data-slate-object="text" data-key="14791"><span data-slate-leaf="true" data-offset-key="14791:0" data-first-offset="true"><span data-slate-string="true">，让部分内部信息对外可见，这样 Kubernetes 才能够探查到内部的状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14792"><span data-slate-object="text" data-key="14793"><span data-slate-leaf="true" data-offset-key="14793:0" data-first-offset="true"><span data-slate-string="true">这么说起来，检查的过程倒是有点像现在我们很熟悉的核酸检测，Kubernetes 用一根小棉签在应用的 “检查口” 里提取点数据，就可以从这些信息来判断应用是否 “健康” 了，这项功能也就被形象地命名为 “</span></span></span><span data-slate-object="text" data-key="14794"><span data-slate-leaf="true" data-offset-key="14794:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">探针</span></span></span></span><span data-slate-object="text" data-key="14795"><span data-slate-leaf="true" data-offset-key="14795:0" data-first-offset="true"><span data-slate-string="true">”（Probe），也可以叫 “探测器”。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14796"><span data-slate-object="text" data-key="14797"><span data-slate-leaf="true" data-offset-key="14797:0" data-first-offset="true"><span data-slate-string="true">Kubernetes 为检查应用状态定义了三种探针，它们分别对应容器不同的状态：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14798"><div data-slate-type="list-line" data-slate-object="block" data-key="14799"><span data-slate-object="text" data-key="14800"><span data-slate-leaf="true" data-offset-key="14800:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Startup</span></span></span></span><span data-slate-object="text" data-key="14801"><span data-slate-leaf="true" data-offset-key="14801:0" data-first-offset="true"><span data-slate-string="true">，启动探针，用来检查应用是否已经启动成功，适合那些有大量初始化工作要做，启动很慢的应用。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14802"><span data-slate-object="text" data-key="14803"><span data-slate-leaf="true" data-offset-key="14803:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Liveness</span></span></span></span><span data-slate-object="text" data-key="14804"><span data-slate-leaf="true" data-offset-key="14804:0" data-first-offset="true"><span data-slate-string="true">，存活探针，用来检查应用是否正常运行，是否存在死锁、死循环。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14805"><span data-slate-object="text" data-key="14806"><span data-slate-leaf="true" data-offset-key="14806:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Readiness</span></span></span></span><span data-slate-object="text" data-key="14807"><span data-slate-leaf="true" data-offset-key="14807:0" data-first-offset="true"><span data-slate-string="true">，就绪探针，用来检查应用是否可以接收流量，是否能够对外提供服务。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14808"><span data-slate-object="text" data-key="14809"><span data-slate-leaf="true" data-offset-key="14809:0" data-first-offset="true"><span data-slate-string="true">你需要注意这三种探针是递进的关系：应用程序先启动，加载完配置文件等基本的初始化数据就进入了 Startup 状态，之后如果没有什么异常就是 Liveness 存活状态，但可能有一些准备工作没有完成，还不一定能对外提供服务，只有到最后的 Readiness 状态才是一个容器最健康可用的状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14810"><span data-slate-object="text" data-key="14811"><span data-slate-leaf="true" data-offset-key="14811:0" data-first-offset="true"><span data-slate-string="true">初次接触这三种状态可能有点难理解，我画了一张图，你可以看一下状态与探针的对应关系：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14812"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/ea/84/eaff5e640171984a4b1b2285982ee184.jpg?wh=1920x1000"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14813"><span data-slate-object="text" data-key="14814"><span data-slate-leaf="true" data-offset-key="14814:0" data-first-offset="true"><span data-slate-string="true">那 Kubernetes 具体是如何使用状态和探针来管理容器的呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14815"><span data-slate-object="text" data-key="14816"><span data-slate-leaf="true" data-offset-key="14816:0" data-first-offset="true"><span data-slate-string="true">如果一个 Pod 里的容器配置了探针，</span></span></span><span data-slate-object="text" data-key="14817"><span data-slate-leaf="true" data-offset-key="14817:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Kubernetes 在启动容器后就会不断地调用探针来检查容器的状态</span></span></span></span><span data-slate-object="text" data-key="14818"><span data-slate-leaf="true" data-offset-key="14818:0" data-first-offset="true"><span data-slate-string="true">：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14819"><div data-slate-type="list-line" data-slate-object="block" data-key="14820"><span data-slate-object="text" data-key="14821"><span data-slate-leaf="true" data-offset-key="14821:0" data-first-offset="true"><span data-slate-string="true">如果 Startup 探针失败，Kubernetes 会认为容器没有正常启动，就会尝试反复重启，当然其后面的 Liveness 探针和 Readiness 探针也不会启动。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14822"><span data-slate-object="text" data-key="14823"><span data-slate-leaf="true" data-offset-key="14823:0" data-first-offset="true"><span data-slate-string="true">如果 Liveness 探针失败，Kubernetes 就会认为容器发生了异常，也会重启容器。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14824"><span data-slate-object="text" data-key="14825"><span data-slate-leaf="true" data-offset-key="14825:0" data-first-offset="true"><span data-slate-string="true">如果 Readiness 探针失败，Kubernetes 会认为容器虽然在运行，但内部有错误，不能正常提供服务，就会把容器从 Service 对象的负载均衡集合中排除，不会给它分配流量。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14826"><span data-slate-object="text" data-key="14827"><span data-slate-leaf="true" data-offset-key="14827:0" data-first-offset="true"><span data-slate-string="true">知道了 Kubernetes 对这三种状态的处理方式，我们就可以在开发应用的时候编写适当的检查机制，让 Kubernetes 用 “探针” 定时为应用做 “体检” 了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14828"><span data-slate-object="text" data-key="14829"><span data-slate-leaf="true" data-offset-key="14829:0" data-first-offset="true"><span data-slate-string="true">在刚才图的基础上，我又补充了 Kubernetes 的处理动作，看这张图你就能很好地理解容器探针的工作流程了：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14830"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/64/d9/64fde55dd2eab68f9968ff34218646d9.jpg?wh=1920x1200"></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14831" id="sr-toc-3"><span data-slate-object="text" data-key="14832"><span data-slate-leaf="true" data-offset-key="14832:0" data-first-offset="true"><span data-slate-string="true">如何使用容器状态探针</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14833"><span data-slate-object="text" data-key="14834"><span data-slate-leaf="true" data-offset-key="14834:0" data-first-offset="true"><span data-slate-string="true">掌握了资源配额和检查探针的概念，我们进入今天的高潮部分，看看如何在 Pod 的 YAML 描述文件里定义探针。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14835"><span data-slate-object="text" data-key="14836"><span data-slate-leaf="true" data-offset-key="14836:0" data-first-offset="true"><span data-slate-string="true">startupProbe、livenessProbe、readinessProbe 这三种探针的配置方式都是一样的，关键字段有这么几个：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14837"><div data-slate-type="list-line" data-slate-object="block" data-key="14838"><span data-slate-object="text" data-key="14839"><span data-slate-leaf="true" data-offset-key="14839:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">periodSeconds</span></span></span></span><span data-slate-object="text" data-key="14840"><span data-slate-leaf="true" data-offset-key="14840:0" data-first-offset="true"><span data-slate-string="true">，执行探测动作的时间间隔，默认是 10 秒探测一次。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14841"><span data-slate-object="text" data-key="14842"><span data-slate-leaf="true" data-offset-key="14842:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">timeoutSeconds</span></span></span></span><span data-slate-object="text" data-key="14843"><span data-slate-leaf="true" data-offset-key="14843:0" data-first-offset="true"><span data-slate-string="true">，探测动作的超时时间，如果超时就认为探测失败，默认是 1 秒。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14844"><span data-slate-object="text" data-key="14845"><span data-slate-leaf="true" data-offset-key="14845:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">successThreshold</span></span></span></span><span data-slate-object="text" data-key="14846"><span data-slate-leaf="true" data-offset-key="14846:0" data-first-offset="true"><span data-slate-string="true">，连续几次探测成功才认为是正常，对于 startupProbe 和 livenessProbe 来说它只能是 1。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14847"><span data-slate-object="text" data-key="14848"><span data-slate-leaf="true" data-offset-key="14848:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">failureThreshold</span></span></span></span><span data-slate-object="text" data-key="14849"><span data-slate-leaf="true" data-offset-key="14849:0" data-first-offset="true"><span data-slate-string="true">，连续探测失败几次才认为是真正发生了异常，默认是 3 次。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14850"><span data-slate-object="text" data-key="14851"><span data-slate-leaf="true" data-offset-key="14851:0" data-first-offset="true"><span data-slate-string="true">至于探测方式，Kubernetes 支持 3 种：Shell、TCP Socket、HTTP GET，它们也需要在探针里配置：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14852"><div data-slate-type="list-line" data-slate-object="block" data-key="14853"><span data-slate-object="text" data-key="14854"><span data-slate-leaf="true" data-offset-key="14854:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">exec</span></span></span></span><span data-slate-object="text" data-key="14855"><span data-slate-leaf="true" data-offset-key="14855:0" data-first-offset="true"><span data-slate-string="true">，执行一个 Linux 命令，比如 ps、cat 等等，和 container 的 command 字段很类似。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14856"><span data-slate-object="text" data-key="14857"><span data-slate-leaf="true" data-offset-key="14857:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">tcpSocket</span></span></span></span><span data-slate-object="text" data-key="14858"><span data-slate-leaf="true" data-offset-key="14858:0" data-first-offset="true"><span data-slate-string="true">，使用 TCP 协议尝试连接容器的指定端口。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14859"><span data-slate-object="text" data-key="14860"><span data-slate-leaf="true" data-offset-key="14860:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">httpGet</span></span></span></span><span data-slate-object="text" data-key="14861"><span data-slate-leaf="true" data-offset-key="14861:0" data-first-offset="true"><span data-slate-string="true">，连接端口并发送 HTTP GET 请求。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14862"><span data-slate-object="text" data-key="14863"><span data-slate-leaf="true" data-offset-key="14863:0" data-first-offset="true"><span data-slate-string="true">要使用这些探针，我们必须要在开发应用时预留出 “检查口”，这样 Kubernetes 才能调用探针获取信息。这里我还是以 Nginx 作为示例，用 ConfigMap 编写一个配置文件：</span></span></span></div><div data-code-language="javascript" data-slate-type="pre" data-slate-object="block" data-key="14864"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14865"><span data-slate-object="text" data-key="14866"><span data-slate-leaf="true" data-offset-key="14866:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">apiVersion</span></span></span></span><span data-slate-object="text" data-key="14867"><span data-slate-leaf="true" data-offset-key="14867:0" data-first-offset="true"><span data-slate-string="true">: v1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14868"><span data-slate-object="text" data-key="14869"><span data-slate-leaf="true" data-offset-key="14869:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">kind</span></span></span></span><span data-slate-object="text" data-key="14870"><span data-slate-leaf="true" data-offset-key="14870:0" data-first-offset="true"><span data-slate-string="true">: </span></span></span><span data-slate-object="text" data-key="14871"><span data-slate-leaf="true" data-offset-key="14871:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">ConfigMap</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14872"><span data-slate-object="text" data-key="14873"><span data-slate-leaf="true" data-offset-key="14873:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">metadata</span></span></span></span><span data-slate-object="text" data-key="14874"><span data-slate-leaf="true" data-offset-key="14874:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14875"><span data-slate-object="text" data-key="14876"><span data-slate-leaf="true" data-offset-key="14876:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="14877"><span data-slate-leaf="true" data-offset-key="14877:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">name</span></span></span></span><span data-slate-object="text" data-key="14878"><span data-slate-leaf="true" data-offset-key="14878:0" data-first-offset="true"><span data-slate-string="true">: ngx-conf</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14879"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14880"><span data-slate-object="text" data-key="14881"><span data-slate-leaf="true" data-offset-key="14881:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">data</span></span></span></span><span data-slate-object="text" data-key="14882"><span data-slate-leaf="true" data-offset-key="14882:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14883"><span data-slate-object="text" data-key="14884"><span data-slate-leaf="true" data-offset-key="14884:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="14885"><span data-slate-leaf="true" data-offset-key="14885:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">default</span></span></span></span><span data-slate-object="text" data-key="14886"><span data-slate-leaf="true" data-offset-key="14886:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span><span data-slate-object="text" data-key="14887"><span data-slate-leaf="true" data-offset-key="14887:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">conf</span></span></span></span><span data-slate-object="text" data-key="14888"><span data-slate-leaf="true" data-offset-key="14888:0" data-first-offset="true"><span data-slate-string="true">: |</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14889"><span data-slate-object="text" data-key="14890"><span data-slate-leaf="true" data-offset-key="14890:0" data-first-offset="true"><span data-slate-string="true">    server {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14891"><span data-slate-object="text" data-key="14892"><span data-slate-leaf="true" data-offset-key="14892:0" data-first-offset="true"><span data-slate-string="true">      listen </span></span></span><span data-slate-object="text" data-key="14893"><span data-slate-leaf="true" data-offset-key="14893:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">80</span></span></span></span><span data-slate-object="text" data-key="14894"><span data-slate-leaf="true" data-offset-key="14894:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14895"><span data-slate-object="text" data-key="14896"><span data-slate-leaf="true" data-offset-key="14896:0" data-first-offset="true"><span data-slate-string="true">      location = /ready {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14897"><span data-slate-object="text" data-key="14898"><span data-slate-leaf="true" data-offset-key="14898:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14899"><span data-slate-leaf="true" data-offset-key="14899:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14900"><span data-slate-leaf="true" data-offset-key="14900:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14901"><span data-slate-leaf="true" data-offset-key="14901:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">200</span></span></span></span><span data-slate-object="text" data-key="14902"><span data-slate-leaf="true" data-offset-key="14902:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14903"><span data-slate-leaf="true" data-offset-key="14903:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'I am ready'</span></span></span></span><span data-slate-object="text" data-key="14904"><span data-slate-leaf="true" data-offset-key="14904:0" data-first-offset="true"><span data-slate-string="true">;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14905"><span data-slate-object="text" data-key="14906"><span data-slate-leaf="true" data-offset-key="14906:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14907"><span data-slate-object="text" data-key="14908"><span data-slate-leaf="true" data-offset-key="14908:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14909"><span data-slate-object="text" data-key="14910"><span data-slate-leaf="true" data-offset-key="14910:0" data-first-offset="true"><span data-slate-string="true">你可能不是太熟悉 Nginx 的配置语法，我简单解释一下。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14911"><span data-slate-object="text" data-key="14912"><span data-slate-leaf="true" data-offset-key="14912:0" data-first-offset="true"><span data-slate-string="true">在这个配置文件里，我们启用了 80 端口，然后用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14913"><span data-slate-object="text" data-key="14914"><span data-slate-leaf="true" data-offset-key="14914:0" data-first-offset="true"><span data-slate-string="true">location</span></span></span></span><span data-slate-object="text" data-key="14915"><span data-slate-leaf="true" data-offset-key="14915:0" data-first-offset="true"><span data-slate-string="true"> 指令定义了 HTTP 路径 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14916"><span data-slate-object="text" data-key="14917"><span data-slate-leaf="true" data-offset-key="14917:0" data-first-offset="true"><span data-slate-string="true">/ready</span></span></span></span><span data-slate-object="text" data-key="14918"><span data-slate-leaf="true" data-offset-key="14918:0" data-first-offset="true"><span data-slate-string="true">，它作为对外暴露的 “检查口”，用来检测就绪状态，返回简单的 200 状态码和一个字符串表示工作正常。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14919"><span data-slate-object="text" data-key="14920"><span data-slate-leaf="true" data-offset-key="14920:0" data-first-offset="true"><span data-slate-string="true">现在我们来看一下 Pod 里三种探针的具体定义：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="14921"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14922"><span data-slate-object="text" data-key="14923"><span data-slate-leaf="true" data-offset-key="14923:0" data-first-offset="true"><span data-slate-string="true">apiVersion: v1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14924"><span data-slate-object="text" data-key="14925"><span data-slate-leaf="true" data-offset-key="14925:0" data-first-offset="true"><span data-slate-string="true">kind: Pod</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14926"><span data-slate-object="text" data-key="14927"><span data-slate-leaf="true" data-offset-key="14927:0" data-first-offset="true"><span data-slate-string="true">metadata:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14928"><span data-slate-object="text" data-key="14929"><span data-slate-leaf="true" data-offset-key="14929:0" data-first-offset="true"><span data-slate-string="true">  name: ngx-pod-probe</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14930"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14931"><span data-slate-object="text" data-key="14932"><span data-slate-leaf="true" data-offset-key="14932:0" data-first-offset="true"><span data-slate-string="true">spec:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14933"><span data-slate-object="text" data-key="14934"><span data-slate-leaf="true" data-offset-key="14934:0" data-first-offset="true"><span data-slate-string="true">  volumes:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14935"><span data-slate-object="text" data-key="14936"><span data-slate-leaf="true" data-offset-key="14936:0" data-first-offset="true"><span data-slate-string="true">  - name: ngx-conf-vol</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14937"><span data-slate-object="text" data-key="14938"><span data-slate-leaf="true" data-offset-key="14938:0" data-first-offset="true"><span data-slate-string="true">    configMap:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14939"><span data-slate-object="text" data-key="14940"><span data-slate-leaf="true" data-offset-key="14940:0" data-first-offset="true"><span data-slate-string="true">      name: ngx-conf</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14941"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14942"><span data-slate-object="text" data-key="14943"><span data-slate-leaf="true" data-offset-key="14943:0" data-first-offset="true"><span data-slate-string="true">  containers:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14944"><span data-slate-object="text" data-key="14945"><span data-slate-leaf="true" data-offset-key="14945:0" data-first-offset="true"><span data-slate-string="true">  - image: nginx:alpine</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14946"><span data-slate-object="text" data-key="14947"><span data-slate-leaf="true" data-offset-key="14947:0" data-first-offset="true"><span data-slate-string="true">    name: ngx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14948"><span data-slate-object="text" data-key="14949"><span data-slate-leaf="true" data-offset-key="14949:0" data-first-offset="true"><span data-slate-string="true">    ports:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14950"><span data-slate-object="text" data-key="14951"><span data-slate-leaf="true" data-offset-key="14951:0" data-first-offset="true"><span data-slate-string="true">    - containerPort: 80</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14952"><span data-slate-object="text" data-key="14953"><span data-slate-leaf="true" data-offset-key="14953:0" data-first-offset="true"><span data-slate-string="true">    volumeMounts:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14954"><span data-slate-object="text" data-key="14955"><span data-slate-leaf="true" data-offset-key="14955:0" data-first-offset="true"><span data-slate-string="true">    - mountPath: /etc/nginx/conf.d</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14956"><span data-slate-object="text" data-key="14957"><span data-slate-leaf="true" data-offset-key="14957:0" data-first-offset="true"><span data-slate-string="true">      name: ngx-conf-vol</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14958"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14959"><span data-slate-object="text" data-key="14960"><span data-slate-leaf="true" data-offset-key="14960:0" data-first-offset="true"><span data-slate-string="true">    startupProbe:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14961"><span data-slate-object="text" data-key="14962"><span data-slate-leaf="true" data-offset-key="14962:0" data-first-offset="true"><span data-slate-string="true">      periodSeconds: 1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14963"><span data-slate-object="text" data-key="14964"><span data-slate-leaf="true" data-offset-key="14964:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14965"><span data-slate-leaf="true" data-offset-key="14965:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">exec</span></span></span></span><span data-slate-object="text" data-key="14966"><span data-slate-leaf="true" data-offset-key="14966:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14967"><span data-slate-object="text" data-key="14968"><span data-slate-leaf="true" data-offset-key="14968:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="14969"><span data-slate-leaf="true" data-offset-key="14969:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">command</span></span></span></span><span data-slate-object="text" data-key="14970"><span data-slate-leaf="true" data-offset-key="14970:0" data-first-offset="true"><span data-slate-string="true">: [</span></span></span><span data-slate-object="text" data-key="14971"><span data-slate-leaf="true" data-offset-key="14971:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"cat"</span></span></span></span><span data-slate-object="text" data-key="14972"><span data-slate-leaf="true" data-offset-key="14972:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="14973"><span data-slate-leaf="true" data-offset-key="14973:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/var/run/nginx.pid"</span></span></span></span><span data-slate-object="text" data-key="14974"><span data-slate-leaf="true" data-offset-key="14974:0" data-first-offset="true"><span data-slate-string="true">]</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14975"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14976"><span data-slate-object="text" data-key="14977"><span data-slate-leaf="true" data-offset-key="14977:0" data-first-offset="true"><span data-slate-string="true">    livenessProbe:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14978"><span data-slate-object="text" data-key="14979"><span data-slate-leaf="true" data-offset-key="14979:0" data-first-offset="true"><span data-slate-string="true">      periodSeconds: 10</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14980"><span data-slate-object="text" data-key="14981"><span data-slate-leaf="true" data-offset-key="14981:0" data-first-offset="true"><span data-slate-string="true">      tcpSocket:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14982"><span data-slate-object="text" data-key="14983"><span data-slate-leaf="true" data-offset-key="14983:0" data-first-offset="true"><span data-slate-string="true">        port: 80</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14984"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14985"><span data-slate-object="text" data-key="14986"><span data-slate-leaf="true" data-offset-key="14986:0" data-first-offset="true"><span data-slate-string="true">    readinessProbe:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14987"><span data-slate-object="text" data-key="14988"><span data-slate-leaf="true" data-offset-key="14988:0" data-first-offset="true"><span data-slate-string="true">      periodSeconds: 5</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14989"><span data-slate-object="text" data-key="14990"><span data-slate-leaf="true" data-offset-key="14990:0" data-first-offset="true"><span data-slate-string="true">      httpGet:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14991"><span data-slate-object="text" data-key="14992"><span data-slate-leaf="true" data-offset-key="14992:0" data-first-offset="true"><span data-slate-string="true">        path: /ready</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14993"><span data-slate-object="text" data-key="14994"><span data-slate-leaf="true" data-offset-key="14994:0" data-first-offset="true"><span data-slate-string="true">        port: 80</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14995"><span data-slate-object="text" data-key="14996"><span data-slate-leaf="true" data-offset-key="14996:0" data-first-offset="true"><span data-slate-string="true">StartupProbe 使用了 Shell 方式，使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14997"><span data-slate-object="text" data-key="14998"><span data-slate-leaf="true" data-offset-key="14998:0" data-first-offset="true"><span data-slate-string="true">cat</span></span></span></span><span data-slate-object="text" data-key="14999"><span data-slate-leaf="true" data-offset-key="14999:0" data-first-offset="true"><span data-slate-string="true"> 命令检查 Nginx 存在磁盘上的进程号文件（/var/run/nginx.pid），如果存在就认为是启动成功，它的执行频率是每秒探测一次。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15000"><span data-slate-object="text" data-key="15001"><span data-slate-leaf="true" data-offset-key="15001:0" data-first-offset="true"><span data-slate-string="true">LivenessProbe 使用了 TCP Socket 方式，尝试连接 Nginx 的 80 端口，每 10 秒探测一次。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15002"><span data-slate-object="text" data-key="15003"><span data-slate-leaf="true" data-offset-key="15003:0" data-first-offset="true"><span data-slate-string="true">ReadinessProbe 使用的是 HTTP GET 方式，访问容器的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="15004"><span data-slate-object="text" data-key="15005"><span data-slate-leaf="true" data-offset-key="15005:0" data-first-offset="true"><span data-slate-string="true">/ready</span></span></span></span><span data-slate-object="text" data-key="15006"><span data-slate-leaf="true" data-offset-key="15006:0" data-first-offset="true"><span data-slate-string="true"> 路径，每 5 秒发一次请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15007"><span data-slate-object="text" data-key="15008"><span data-slate-leaf="true" data-offset-key="15008:0" data-first-offset="true"><span data-slate-string="true">现在我们用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="15009"><span data-slate-object="text" data-key="15010"><span data-slate-leaf="true" data-offset-key="15010:0" data-first-offset="true"><span data-slate-string="true">kubectl apply</span></span></span></span><span data-slate-object="text" data-key="15011"><span data-slate-leaf="true" data-offset-key="15011:0" data-first-offset="true"><span data-slate-string="true"> 创建这个 Pod，然后查看它的状态：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15012"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/ac/6c/ac6b405074a5e93d33dd7154f299486c.png?wh=1272x174"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15013"><span data-slate-object="text" data-key="15014"><span data-slate-leaf="true" data-offset-key="15014:0" data-first-offset="true"><span data-slate-string="true">当然，因为这个 Nginx 应用非常简单，它启动后探针的检查都会是正常的，你可以用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="15015"><span data-slate-object="text" data-key="15016"><span data-slate-leaf="true" data-offset-key="15016:0" data-first-offset="true"><span data-slate-string="true">kubectl logs</span></span></span></span><span data-slate-object="text" data-key="15017"><span data-slate-leaf="true" data-offset-key="15017:0" data-first-offset="true"><span data-slate-string="true"> 来查看 Nginx 的访问日志，里面会记录 HTTP GET 探针的执行情况：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15018"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/ed/6b/edf9fb3337bf3dd5a9b2fba8dfbc326b.png?wh=1920x527"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15019"><span data-slate-object="text" data-key="15020"><span data-slate-leaf="true" data-offset-key="15020:0" data-first-offset="true"><span data-slate-string="true">从截图中你可以看到，Kubernetes 正是以大约 5 秒一次的频率，向 URI </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="15021"><span data-slate-object="text" data-key="15022"><span data-slate-leaf="true" data-offset-key="15022:0" data-first-offset="true"><span data-slate-string="true">/ready</span></span></span></span><span data-slate-object="text" data-key="15023"><span data-slate-leaf="true" data-offset-key="15023:0" data-first-offset="true"><span data-slate-string="true"> 发送 HTTP 请求，不断地检查容器是否处于就绪状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15024"><span data-slate-object="text" data-key="15025"><span data-slate-leaf="true" data-offset-key="15025:0" data-first-offset="true"><span data-slate-string="true">为了验证另两个探针的工作情况，我们可以修改探针，比如把命令改成检查错误的文件、错误的端口号：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="15026"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="15027"><span data-slate-object="text" data-key="15028"><span data-slate-leaf="true" data-offset-key="15028:0" data-first-offset="true"><span data-slate-string="true">    startupProbe:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15029"><span data-slate-object="text" data-key="15030"><span data-slate-leaf="true" data-offset-key="15030:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="15031"><span data-slate-leaf="true" data-offset-key="15031:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">exec</span></span></span></span><span data-slate-object="text" data-key="15032"><span data-slate-leaf="true" data-offset-key="15032:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15033"><span data-slate-object="text" data-key="15034"><span data-slate-leaf="true" data-offset-key="15034:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="15035"><span data-slate-leaf="true" data-offset-key="15035:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">command</span></span></span></span><span data-slate-object="text" data-key="15036"><span data-slate-leaf="true" data-offset-key="15036:0" data-first-offset="true"><span data-slate-string="true">: [</span></span></span><span data-slate-object="text" data-key="15037"><span data-slate-leaf="true" data-offset-key="15037:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"cat"</span></span></span></span><span data-slate-object="text" data-key="15038"><span data-slate-leaf="true" data-offset-key="15038:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="15039"><span data-slate-leaf="true" data-offset-key="15039:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"nginx.pid"</span></span></span></span><span data-slate-object="text" data-key="15040"><span data-slate-leaf="true" data-offset-key="15040:0" data-first-offset="true"><span data-slate-string="true">]  </span></span></span><span data-slate-object="text" data-key="15041"><span data-slate-leaf="true" data-offset-key="15041:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#错误的文件</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15042"></div><div data-slate-type="code-line" data-slate-object="block" data-key="15043"><span data-slate-object="text" data-key="15044"><span data-slate-leaf="true" data-offset-key="15044:0" data-first-offset="true"><span data-slate-string="true">    livenessProbe:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15045"><span data-slate-object="text" data-key="15046"><span data-slate-leaf="true" data-offset-key="15046:0" data-first-offset="true"><span data-slate-string="true">      tcpSocket:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15047"><span data-slate-object="text" data-key="15048"><span data-slate-leaf="true" data-offset-key="15048:0" data-first-offset="true"><span data-slate-string="true">        port: 8080                     </span></span></span><span data-slate-object="text" data-key="15049"><span data-slate-leaf="true" data-offset-key="15049:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#错误的端口号</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15050"><span data-slate-object="text" data-key="15051"><span data-slate-leaf="true" data-offset-key="15051:0" data-first-offset="true"><span data-slate-string="true">然后我们重新创建 Pod 对象，观察它的状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15052"><span data-slate-object="text" data-key="15053"><span data-slate-leaf="true" data-offset-key="15053:0" data-first-offset="true"><span data-slate-string="true">当 StartupProbe 探测失败的时候，Kubernetes 就会不停地重启容器，现象就是 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="15054"><span data-slate-object="text" data-key="15055"><span data-slate-leaf="true" data-offset-key="15055:0" data-first-offset="true"><span data-slate-string="true">RESTARTS</span></span></span></span><span data-slate-object="text" data-key="15056"><span data-slate-leaf="true" data-offset-key="15056:0" data-first-offset="true"><span data-slate-string="true"> 次数不停地增加，而 livenessProbe 和 readinessProbePod 没有执行，Pod 虽然是 Running 状态，也永远不会 READY：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15057"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/90/7f/900468e4b86c241a53256584e514b47f.png?wh=1348x182"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15058"><span data-slate-object="text" data-key="15059"><span data-slate-leaf="true" data-offset-key="15059:0" data-first-offset="true"><span data-slate-string="true">因为 failureThreshold 的次数默认是三次，所以 Kubernetes 会连续执行三次 livenessProbe TCP Socket 探测，每次间隔 10 秒，30 秒之后都失败才重启容器：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15060"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/c3/e1/c31bf2cf6672c62ebd42f305534dbae1.png?wh=1366x178"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15061"><span data-slate-object="text" data-key="15062"><span data-slate-leaf="true" data-offset-key="15062:0" data-first-offset="true"><span data-slate-string="true">你也可以自己试着改一下 readinessProbe，看看它失败时 Pod 会是什么样的状态。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="15063" id="sr-toc-4"><span data-slate-object="text" data-key="15064"><span data-slate-leaf="true" data-offset-key="15064:0" data-first-offset="true"><span data-slate-string="true">小结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="15065"><span data-slate-object="text" data-key="15066"><span data-slate-leaf="true" data-offset-key="15066:0" data-first-offset="true"><span data-slate-string="true">好了，今天我们学习了两种为 Pod 配置运行保障的方式：Resources 和 Probe。Resources 就是为容器加上资源限制，而 Probe 就是主动健康检查，让 Kubernetes 实时地监控应用的运行状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15067"><span data-slate-object="text" data-key="15068"><span data-slate-leaf="true" data-offset-key="15068:0" data-first-offset="true"><span data-slate-string="true">再简单小结一下今天的内容：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="15069"><div data-slate-type="list-line" data-slate-object="block" data-key="15070"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="15071"><span data-slate-leaf="true" data-offset-key="15071:0" data-first-offset="true"><span data-slate-string="true">资源配额使用的是 cgroup 技术，可以限制容器使用的 CPU 和内存数量，让 Pod 合理利用系统资源，也能够让 Kubernetes 更容易调度 Pod。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="15072"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="15073"><span data-slate-leaf="true" data-offset-key="15073:0" data-first-offset="true"><span data-slate-string="true">Kubernetes 定义了 Startup、Liveness、Readiness 三种健康探针，它们分别探测应用的启动、存活和就绪状态。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="15074"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="15075"><span data-slate-leaf="true" data-offset-key="15075:0" data-first-offset="true"><span data-slate-string="true">探测状态可以使用 Shell、TCP Socket、HTTP Get 三种方式，还可以调整探测的频率和超时时间等参数。</span></span></span></div></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="15076" id="sr-toc-5"><span data-slate-object="text" data-key="15077"><span data-slate-leaf="true" data-offset-key="15077:0" data-first-offset="true"><span data-slate-string="true">课下作业</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="15078"><span data-slate-object="text" data-key="15079"><span data-slate-leaf="true" data-offset-key="15079:0" data-first-offset="true"><span data-slate-string="true">最后是课下作业时间，给你留两个思考题：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="15080"><div data-slate-type="list-line" data-slate-object="block" data-key="15081"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="15082"><span data-slate-leaf="true" data-offset-key="15082:0" data-first-offset="true"><span data-slate-string="true">你能够解释一下 Liveness 和 Readiness 这两种探针的区别吗？</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="15083"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="15084"><span data-slate-leaf="true" data-offset-key="15084:0" data-first-offset="true"><span data-slate-string="true">你认为 Shell、TCP Socket、HTTP GET 这三种探测方式各有什么优缺点？</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15085"><span data-slate-object="text" data-key="15086"><span data-slate-leaf="true" data-offset-key="15086:0" data-first-offset="true"><span data-slate-string="true">欢迎在下方留言区留言参与讨论，课程快要完结了，感谢你坚持学习了这么久。我们下节课再见。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15087"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/5e/68/5eef65a1abf0cc4ff70c0e3df7a93168.jpg?wh=1920x2580"></div></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/94/c1/9415076c60e63fc6303d9a3bc900b5c1.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-6">精选留言 (3)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/b3/d9/cf061262.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>新时代农民工</span></div></div><div>老师请问，Startup、Liveness、Readiness 三种探针是按顺序执行还是并行呢？</div><div><p>作者回复: Startup 成功之后才能执行后两个探针，后面两个是并行的。</p></div><div><div>2022-08-26</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>YueShi</span></div></div><div>"postStart"'"preStop" 感觉可以做 CICD，或者各种 webhock 钩子，或者简单的通知</div><div><p>作者回复：是的，这些都是 Kubernetes 为我们提供的回调接口。</p></div><div><div>2022-08-31</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>peter</span></div></div><div>请教老师几个问题：
Q1：第 27 讲中，创建 4 个 nginx 实例，没有端口冲突问题吗？
四个 nginx 实例，两个在 master，两个在 worker。同一台机器上有两个 pod，而 pod 的定义是一样的，即端口相同，那么，不存在端口冲突问题吗？

Q2：第 27 讲中，创建四个 nginx 实例后，不能访问 nginx 的欢迎页。
service 也创建了。 用虚拟机上浏览器来访问 127.0.0.1，失败，
执行 “kubectl port-forward svc/ngx-svc 8080:80 &amp;” 以后，
浏览器上访问 127.0.0.1:8080，报错：
E0826 14:32:28.734987   42769 portforward.go:391] error copying from local connection to remote stream: read tcp4 127.0.0.1:8080-&gt;127.0.0.1:59752: read: connection reset by peer

Q3：nginx 的配置文件中，竖线是什么意思？
data: default.conf: |， 这里的竖线是什么意思？ 

Q4：操作系统能够看到的 CPU，是指逻辑核吗？还是时间片？</div><div><p>作者回复: 
1. 每个 Nginx 都是运行在 pod 里，被容器环境隔离，当然不会冲突，可以复习一下入门篇。

2. 这个暂时没看出是什么原因。

3. 竖线是 YAML 的长字符串语法，看前面的课程。

4. 是逻辑核。</p></div><div><div>2022-08-26</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".2m"><outline class="toc-level-h1" data-reactid=".2m.0" style="width: 175px;"><active data-reactid=".2m.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".2m.0.1"><span data-reactid=".2m.0.1.0">28｜应用保障：如何让 Pod 运行得更健康？</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.1" style="width: 165px;"><active data-reactid=".2m.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".2m.1.1"><span data-reactid=".2m.1.1.0">容器资源配额</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.2" style="width: 165px;"><active data-reactid=".2m.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".2m.2.1"><span data-reactid=".2m.2.1.0">什么是容器状态探针</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.3" style="width: 165px;"><active data-reactid=".2m.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".2m.3.1"><span data-reactid=".2m.3.1.0">如何使用容器状态探针</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.4" style="width: 165px;"><active data-reactid=".2m.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".2m.4.1"><span data-reactid=".2m.4.1.0">小结</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.5" style="width: 165px;"><active data-reactid=".2m.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".2m.5.1"><span data-reactid=".2m.5.1.0">课下作业</span></a></outline><outline class="toc-level-h2" data-reactid=".2m.6" style="width: 165px;"><active data-reactid=".2m.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".2m.6.1"><span data-reactid=".2m.6.1.0">精选留言 (3)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/548736" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>