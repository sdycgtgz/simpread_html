
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 20 | 日志处理（上）：如何设计日志包并记录日志？</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>20 | 日志处理（上）：如何设计日志包并记录日志？</sr-rd-title>
                    
                    <sr-rd-content><h1 id="sr-toc-0">20 | 日志处理（上）：如何设计日志包并记录日志？</h1><div><span>孔令飞</span> <span> 2021-07-10</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/2a/d2/2aebf0c04fb5d3266c1443a8fd3edfd2.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：孔令飞</span><span>大小：22.66M</span><span> 时长：24:49</span></div></div><audio title="20 | 日志处理（上）：如何设计日志包并记录日志？" src="https://res001.geekbang.org/media/audio/9f/88/9f5287541d1fa4d5696a911e4da7a188/ld/ld.m3u8" __idm_id__="311317"></audio></div><div><div><div><div data-slate-editor="true" data-key="17555" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="17556"><span data-slate-object="text" data-key="17557"><span data-slate-leaf="true" data-offset-key="17557:0" data-first-offset="true"><span data-slate-string="true">你好，我是孔令飞，接下来的两讲，我们来聊聊如何设计和开发日志包。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17558"><span data-slate-object="text" data-key="17559"><span data-slate-leaf="true" data-offset-key="17559:0" data-first-offset="true"><span data-slate-string="true">在做 Go 项目开发时，除了处理错误之外，我们必须要做的另外一件事是记录日志。通过记录日志，可以完成一些基本功能，</span></span><span data-slate-leaf="true" data-offset-key="17559:1"><span data-slate-object="annotation" data-annotation-key="gkann_08339010" data-attr-id="31143" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">比如开发、测试期间的 Debug，故障排除，数据分析，监控告警，以及记录发生的事件等。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17560"><span data-slate-object="text" data-key="17561"><span data-slate-leaf="true" data-offset-key="17561:0" data-first-offset="true"><span data-slate-string="true">要实现这些功能，首先我们需要一个优秀的日志包。另外，我还发现不少 Go 项目开发者记录日志很随意，输出的日志并不能有效定位到问题。所以，我们还需要知道怎么更好地记录日志，这就需要一个日志记录规范。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17562"><span data-slate-object="text" data-key="17563"><span data-slate-leaf="true" data-offset-key="17563:0" data-first-offset="true"><span data-slate-string="true">有了优秀的日志包和日志记录规范，我们就能很快地定位到问题，获取足够的信息，并完成后期的数据分析和监控告警，也可以很方便地进行调试了。这一讲，我就来详细介绍下，如何设计日志包和日志记录规范。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17564"><span data-slate-object="text" data-key="17565"><span data-slate-leaf="true" data-offset-key="17565:0" data-first-offset="true"><span data-slate-string="true">首先，我们来看下如何设计日志包。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="17566" id="sr-toc-1"><span data-slate-object="text" data-key="17567"><span data-slate-leaf="true" data-offset-key="17567:0" data-first-offset="true"><span data-slate-string="true">如何设计日志包</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="17568"><span data-slate-object="text" data-key="17569"><span data-slate-leaf="true" data-offset-key="17569:0" data-first-offset="true"><span data-slate-string="true">目前，虽然有很多优秀的开源日志包可供我们选择，但在一个大型系统中，这些开源日志包很可能无法满足我们定制化的需求，这时候我们就需要自己开发日志包。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17570"><span data-slate-object="text" data-key="17571"><span data-slate-leaf="true" data-offset-key="17571:0" data-first-offset="true"><span data-slate-string="true">这些日志包可能是基于某个，或某几个开源的日志包改造而来，也可能是全新开发的日志包。那么在开发日志包时，我们需要实现哪些功能，又如何实现呢？接下来，我们就来详细聊聊。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17572"><span data-slate-object="text" data-key="17573"><span data-slate-leaf="true" data-offset-key="17573:0" data-first-offset="true"><span data-slate-string="true">先来看下日志包需要具备哪些功能。根据功能的重要性，我将日志包需要实现的功能分为</span></span></span><span data-slate-object="text" data-key="17574"><span data-slate-leaf="true" data-offset-key="17574:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">基础功能</span></span></span></span><span data-slate-object="text" data-key="17575"><span data-slate-leaf="true" data-offset-key="17575:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-object="text" data-key="17576"><span data-slate-leaf="true" data-offset-key="17576:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">高级功能</span></span></span></span><span data-slate-object="text" data-key="17577"><span data-slate-leaf="true" data-offset-key="17577:0" data-first-offset="true"><span data-slate-string="true">和</span></span></span><span data-slate-object="text" data-key="17578"><span data-slate-leaf="true" data-offset-key="17578:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">可选功能</span></span></span></span><span data-slate-object="text" data-key="17579"><span data-slate-leaf="true" data-offset-key="17579:0" data-first-offset="true"><span data-slate-string="true">。基础功能是一个日志包必须要具备的功能；高级功能、可选功能都是在特定场景下可增加的功能。我们先来说基础功能。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="17580" id="sr-toc-2"><span data-slate-object="text" data-key="17581"><span data-slate-leaf="true" data-offset-key="17581:0" data-first-offset="true"><span data-slate-string="true">基础功能</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="17582"><span data-slate-object="text" data-key="17583"><span data-slate-leaf="true" data-offset-key="17583:0" data-first-offset="true"><span data-slate-string="true">基础功能，是优秀日志包必备的功能，能够满足绝大部分的使用场景，适合一些中小型的项目。一个日志包应该具备以下 4 个基础功能。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17584"><div data-slate-type="list-line" data-slate-object="block" data-key="17585"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="17586"><span data-slate-leaf="true" data-offset-key="17586:0" data-first-offset="true"><span data-slate-string="true">支持基本的日志信息</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17587"><span data-slate-object="text" data-key="17588"><span data-slate-leaf="true" data-offset-key="17588:0" data-first-offset="true"><span data-slate-string="true">日志包需要支持基本的日志信息，包括时间戳、文件名、行号、日志级别和日志信息。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17589"><span data-slate-object="text" data-key="17590"><span data-slate-leaf="true" data-offset-key="17590:0" data-first-offset="true"><span data-slate-string="true">时间戳可以记录日志发生的时间。在定位问题时，我们往往需要根据时间戳，来复原请求过程，核对相同时间戳下的上下文，从而定位出问题。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17591"><span data-slate-object="text" data-key="17592"><span data-slate-leaf="true" data-offset-key="17592:0" data-first-offset="true"><span data-slate-string="true">文件名和行号，可以使我们更快速定位到打印日志的位置，找到问题代码。一个日志库如果不支持文件名和行号，排查故障就会变得非常困难，基本只能靠 grep 和记忆来定位代码。对于企业级的服务，需要保证服务在故障后能够快速恢复，恢复的时间越久，造成的损失就越大，影响就越大。这就要求研发人员能够快速定位并解决问题。通过文件名和行号，我们可以精准定位到问题代码，尽快地修复问题并恢复服务。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17593"><span data-slate-object="text" data-key="17594"><span data-slate-leaf="true" data-offset-key="17594:0" data-first-offset="true"><span data-slate-string="true">通过日志级别，可以知道日志的错误类型，最通常的用法是：直接过滤出 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17595"><span data-slate-object="text" data-key="17596"><span data-slate-leaf="true" data-offset-key="17596:0" data-first-offset="true"><span data-slate-string="true">Error</span></span></span></span><span data-slate-object="text" data-key="17597"><span data-slate-leaf="true" data-offset-key="17597:0" data-first-offset="true"><span data-slate-string="true"> 级别的日志，这样就可以直接定位出问题出错点，然后再结合其他日志定位出出错的原因。如果不支持日志级别，在定位问题时，可能要查看一大堆无用的日志。在大型系统中，一次请求的日志量很多，这会大大延长我们定位问题的时间。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17598"><span data-slate-object="text" data-key="17599"><span data-slate-leaf="true" data-offset-key="17599:0" data-first-offset="true"><span data-slate-string="true">而通过日志信息，我们可以知道错误发生的具体原因。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17600"><div data-slate-type="list-line" data-slate-object="block" data-key="17601"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="17602"><span data-slate-leaf="true" data-offset-key="17602:0" data-first-offset="true"><span data-slate-string="true">支持不同的日志级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17603"><span data-slate-object="text" data-key="17604"><span data-slate-leaf="true" data-offset-key="17604:0" data-first-offset="true"><span data-slate-string="true">不同的日志级别代表不同的日志类型，例如：Error 级别的日志，说明日志是错误类型，在排障时，会首先查看错误级别的日志。Warn 级别日志说明出现异常，但还不至于影响程序运行，如果程序执行的结果不符合预期，则可以参考 Warn 级别的日志，定位出异常所在。Info 级别的日志，可以协助我们 Debug，并记录一些有用的信息，供后期进行分析。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17605"><span data-slate-object="text" data-key="17606"><span data-slate-leaf="true" data-offset-key="17606:0" data-first-offset="true"><span data-slate-string="true">通常一个日志包至少要实现 6 个级别，我给你提供了一张表格，按优先级从低到高排列如下：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="17607"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/bb/2b/bb1356bd3cf332ddeb30d3aef8fc8d2b.png?wh=1794x1120"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17608"><span data-slate-object="text" data-key="17609"><span data-slate-leaf="true" data-offset-key="17609:0" data-first-offset="true"><span data-slate-string="true">有些日志包，例如 logrus，还支持 Trace 日志级别。Trace 级别比 Debug 级别还低，能够打印更细粒度的日志信息。在我看来，Trace 级别不是必须的，你可以根据需要自行选择。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17610"><span data-slate-object="text" data-key="17611"><span data-slate-leaf="true" data-offset-key="17611:0" data-first-offset="true"><span data-slate-string="true">打印日志时，一个日志调用其实具有两个属性：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17612"><div data-slate-type="list-line" data-slate-object="block" data-key="17613"><span data-slate-object="text" data-key="17614"><span data-slate-leaf="true" data-offset-key="17614:0" data-first-offset="true"><span data-slate-string="true">输出级别：打印日志时，我们期望日志的输出级别。例如，我们调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17615"><span data-slate-object="text" data-key="17616"><span data-slate-leaf="true" data-offset-key="17616:0" data-first-offset="true"><span data-slate-string="true">glog.Info("This is info message")</span></span></span></span><span data-slate-object="text" data-key="17617"><span data-slate-leaf="true" data-offset-key="17617:0" data-first-offset="true"><span data-slate-string="true"> 打印一条日志，则输出日志级别为 Info。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17618"><span data-slate-object="text" data-key="17619"><span data-slate-leaf="true" data-offset-key="17619:0" data-first-offset="true"><span data-slate-string="true">开关级别：启动应用程序时，期望哪些输出级别的日志被打印。例如，使用 glog 时 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17620"><span data-slate-object="text" data-key="17621"><span data-slate-leaf="true" data-offset-key="17621:0" data-first-offset="true"><span data-slate-string="true">-v=4</span></span></span></span><span data-slate-object="text" data-key="17622"><span data-slate-leaf="true" data-offset-key="17622:0" data-first-offset="true"><span data-slate-string="true"> ，说明了只有日志级别高于 4 的日志才会被打印。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17623"><span data-slate-object="text" data-key="17624"><span data-slate-leaf="true" data-offset-key="17624:0" data-first-offset="true"><span data-slate-string="true">如果开关级别设置为 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17625"><span data-slate-object="text" data-key="17626"><span data-slate-leaf="true" data-offset-key="17626:0" data-first-offset="true"><span data-slate-string="true">L</span></span></span></span><span data-slate-object="text" data-key="17627"><span data-slate-leaf="true" data-offset-key="17627:0" data-first-offset="true"><span data-slate-string="true"> ，只有输出级别 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17628"><span data-slate-object="text" data-key="17629"><span data-slate-leaf="true" data-offset-key="17629:0" data-first-offset="true"><span data-slate-string="true">&gt;=L</span></span></span></span><span data-slate-object="text" data-key="17630"><span data-slate-leaf="true" data-offset-key="17630:0" data-first-offset="true"><span data-slate-string="true"> 时，日志才会被打印。例如，开关级别为 Warn，则只会记录 Warn、Error 、Panic 和 Fatal 级别的日志。具体的输出关系如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="17631"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/dd/ed/dd4e9c3ed26b254cb5b65ff1fddd40ed.png?wh=1654x526"></div></div><div data-slate-type="list" data-slate-object="block" data-key="17632"><div data-slate-type="list-line" data-slate-object="block" data-key="17633"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="17634"><span data-slate-leaf="true" data-offset-key="17634:0" data-first-offset="true"><span data-slate-string="true">支持自定义配置</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17635"><span data-slate-object="text" data-key="17636"><span data-slate-leaf="true" data-offset-key="17636:0" data-first-offset="true"><span data-slate-string="true">不同的运行环境，需要不同的日志输出配置，例如：开发测试环境为了能够方便地 Debug，需要设置日志级别为 Debug 级别；现网环境为了提高应用程序的性能，则需要设置日志级别为 Info 级别。又比如，现网环境为了方便日志采集，通常会输出 JSON 格式的日志；开发测试环境为了方便查看日志，会输出 TEXT 格式的日志。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17637"><span data-slate-object="text" data-key="17638"><span data-slate-leaf="true" data-offset-key="17638:0" data-first-offset="true"><span data-slate-string="true">所以，我们的日志包需要能够被配置，还要不同环境采用不同的配置。通过配置，可以在不重新编译代码的情况下，改变记录日志的行为。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17639"><div data-slate-type="list-line" data-slate-object="block" data-key="17640"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="17641"><span data-slate-leaf="true" data-offset-key="17641:0" data-first-offset="true"><span data-slate-string="true">支持输出到标准输出和文件</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17642"><span data-slate-object="text" data-key="17643"><span data-slate-leaf="true" data-offset-key="17643:0" data-first-offset="true"><span data-slate-string="true">日志总是要被读的，要么输出到标准输出，供开发者实时读取，要么保存到文件，供开发者日后查看。输出到标准输出和保存到文件是一个日志包最基本的功能。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="17644" id="sr-toc-3"><span data-slate-object="text" data-key="17645"><span data-slate-leaf="true" data-offset-key="17645:0" data-first-offset="true"><span data-slate-string="true">高级功能</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="17646"><span data-slate-object="text" data-key="17647"><span data-slate-leaf="true" data-offset-key="17647:0" data-first-offset="true"><span data-slate-string="true">除了上面提到的这些基本功能外，在一些大型系统中，通常还会要求日志包具备一些高级功能。这些高级功能可以帮我们更好地记录日志，并实现更丰富的功能，例如日志告警。那么一个日志包可以具备哪些高级功能呢？</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17648"><div data-slate-type="list-line" data-slate-object="block" data-key="17649"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="17650"><span data-slate-leaf="true" data-offset-key="17650:0" data-first-offset="true"><span data-slate-string="true">支持多种日志格式</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17651"><span data-slate-object="text" data-key="17652"><span data-slate-leaf="true" data-offset-key="17652:0" data-first-offset="true"><span data-slate-string="true">日志格式也是我们要考虑的一个点，一个好的日志格式，不仅方便查看日志，还能方便一些日志采集组件采集日志，并对接类似 Elasticsearch 这样的日志搜索引擎。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17653"><span data-slate-object="text" data-key="17654"><span data-slate-leaf="true" data-offset-key="17654:0" data-first-offset="true"><span data-slate-string="true">一个日志包至少需要提供以下两种格式：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17655"><div data-slate-type="list-line" data-slate-object="block" data-key="17656"><span data-slate-object="text" data-key="17657"><span data-slate-leaf="true" data-offset-key="17657:0" data-first-offset="true"><span data-slate-string="true">TEXT 格式：TEXT 格式的日志具有良好的可读性，可以方便我们在开发联调阶段查看日志，例如：</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17658"><span data-slate-object="text" data-key="17659"><span data-slate-leaf="true" data-offset-key="17659:0" data-first-offset="true"><span data-slate-string="true">2020-12-02T01:16:18+08:00 INFO example.go:11 std log</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17660"><span data-slate-object="text" data-key="17661"><span data-slate-leaf="true" data-offset-key="17661:0" data-first-offset="true"><span data-slate-string="true">2020-12-02T01:16:18+08:00 DEBUG example.go:13 change std log to debug level</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17662"><div data-slate-type="list-line" data-slate-object="block" data-key="17663"><span data-slate-object="text" data-key="17664"><span data-slate-leaf="true" data-offset-key="17664:0" data-first-offset="true"><span data-slate-string="true">JSON 格式：JSON 格式的日志可以记录更详细的信息，日志中包含一些通用的或自定义的字段，可供日后的查询、分析使用，而且可以很方便地供 filebeat、logstash 这类日志采集工具采集并上报。下面是 JSON 格式的日志：</span></span></span></div></div><div data-code-language="javascript" data-slate-type="pre" data-slate-object="block" data-key="17665"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="17666"><span data-slate-object="text" data-key="17667"><span data-slate-leaf="true" data-offset-key="17667:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="17668"><span data-slate-leaf="true" data-offset-key="17668:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"level"</span></span></span></span><span data-slate-object="text" data-key="17669"><span data-slate-leaf="true" data-offset-key="17669:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17670"><span data-slate-leaf="true" data-offset-key="17670:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"DEBUG"</span></span></span></span><span data-slate-object="text" data-key="17671"><span data-slate-leaf="true" data-offset-key="17671:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17672"><span data-slate-leaf="true" data-offset-key="17672:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"time"</span></span></span></span><span data-slate-object="text" data-key="17673"><span data-slate-leaf="true" data-offset-key="17673:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17674"><span data-slate-leaf="true" data-offset-key="17674:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"2020-12-02T01:16:18+08:00"</span></span></span></span><span data-slate-object="text" data-key="17675"><span data-slate-leaf="true" data-offset-key="17675:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17676"><span data-slate-leaf="true" data-offset-key="17676:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"file"</span></span></span></span><span data-slate-object="text" data-key="17677"><span data-slate-leaf="true" data-offset-key="17677:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17678"><span data-slate-leaf="true" data-offset-key="17678:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"example.go:15"</span></span></span></span><span data-slate-object="text" data-key="17679"><span data-slate-leaf="true" data-offset-key="17679:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17680"><span data-slate-leaf="true" data-offset-key="17680:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"func"</span></span></span></span><span data-slate-object="text" data-key="17681"><span data-slate-leaf="true" data-offset-key="17681:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17682"><span data-slate-leaf="true" data-offset-key="17682:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"main.main"</span></span></span></span><span data-slate-object="text" data-key="17683"><span data-slate-leaf="true" data-offset-key="17683:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17684"><span data-slate-leaf="true" data-offset-key="17684:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"message"</span></span></span></span><span data-slate-object="text" data-key="17685"><span data-slate-leaf="true" data-offset-key="17685:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17686"><span data-slate-leaf="true" data-offset-key="17686:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"log in json format"</span></span></span></span><span data-slate-object="text" data-key="17687"><span data-slate-leaf="true" data-offset-key="17687:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17688"><span data-slate-object="text" data-key="17689"><span data-slate-leaf="true" data-offset-key="17689:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="17690"><span data-slate-leaf="true" data-offset-key="17690:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"level"</span></span></span></span><span data-slate-object="text" data-key="17691"><span data-slate-leaf="true" data-offset-key="17691:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17692"><span data-slate-leaf="true" data-offset-key="17692:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"INFO"</span></span></span></span><span data-slate-object="text" data-key="17693"><span data-slate-leaf="true" data-offset-key="17693:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17694"><span data-slate-leaf="true" data-offset-key="17694:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"time"</span></span></span></span><span data-slate-object="text" data-key="17695"><span data-slate-leaf="true" data-offset-key="17695:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17696"><span data-slate-leaf="true" data-offset-key="17696:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"2020-12-02T01:16:18+08:00"</span></span></span></span><span data-slate-object="text" data-key="17697"><span data-slate-leaf="true" data-offset-key="17697:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17698"><span data-slate-leaf="true" data-offset-key="17698:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"file"</span></span></span></span><span data-slate-object="text" data-key="17699"><span data-slate-leaf="true" data-offset-key="17699:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17700"><span data-slate-leaf="true" data-offset-key="17700:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"example.go:16"</span></span></span></span><span data-slate-object="text" data-key="17701"><span data-slate-leaf="true" data-offset-key="17701:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17702"><span data-slate-leaf="true" data-offset-key="17702:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"func"</span></span></span></span><span data-slate-object="text" data-key="17703"><span data-slate-leaf="true" data-offset-key="17703:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17704"><span data-slate-leaf="true" data-offset-key="17704:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"main.main"</span></span></span></span><span data-slate-object="text" data-key="17705"><span data-slate-leaf="true" data-offset-key="17705:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17706"><span data-slate-leaf="true" data-offset-key="17706:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"message"</span></span></span></span><span data-slate-object="text" data-key="17707"><span data-slate-leaf="true" data-offset-key="17707:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17708"><span data-slate-leaf="true" data-offset-key="17708:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"another log in json format"</span></span></span></span><span data-slate-object="text" data-key="17709"><span data-slate-leaf="true" data-offset-key="17709:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17710"><span data-slate-object="text" data-key="17711"><span data-slate-leaf="true" data-offset-key="17711:0" data-first-offset="true"><span data-slate-string="true">我建议在开发联调阶段使用 TEXT 格式的日志，在现网环境使用 JSON 格式的日志。一个优秀的日志库，例如 logrus，除了提供基本的输出格式外，还应该允许开发者自定义日志输出格式。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17712"><div data-slate-type="list-line" data-slate-object="block" data-key="17713"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="17714"><span data-slate-leaf="true" data-offset-key="17714:0" data-first-offset="true"><span data-slate-string="true">能够按级别分类输出</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17715"><span data-slate-object="text" data-key="17716"><span data-slate-leaf="true" data-offset-key="17716:0" data-first-offset="true"><span data-slate-string="true">为了能够快速定位到需要的日志，一个比较好的做法是将日志按级别分类输出，至少错误级别的日志可以输出到独立的文件中。这样，出现问题时，可以直接查找错误文件定位问题。例如，glog 就支持分类输出，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="17717"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/10/4b/100af3121e8d4e84428979f9d0yydf4b.png?wh=2091x326"></div></div><div data-slate-type="list" data-slate-object="block" data-key="17718"><div data-slate-type="list-line" data-slate-object="block" data-key="17719"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="17720"><span data-slate-leaf="true" data-offset-key="17720:0" data-first-offset="true"><span data-slate-string="true">支持结构化日志</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17721"><span data-slate-object="text" data-key="17722"><span data-slate-leaf="true" data-offset-key="17722:0" data-first-offset="true"><span data-slate-string="true">结构化日志（Structured Logging），就是使用 JSON 或者其他编码方式使日志结构化，这样可以方便后续使用 Filebeat、Logstash Shipper 等各种工具，对日志进行采集、过滤、分析和查找。就像下面这个案例，使用 zap 进行日志打印：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="17723"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="17724"><span data-slate-object="text" data-key="17725"><span data-slate-leaf="true" data-offset-key="17725:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="17726"><span data-slate-leaf="true" data-offset-key="17726:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17727"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17728"><span data-slate-object="text" data-key="17729"><span data-slate-leaf="true" data-offset-key="17729:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="17730"><span data-slate-leaf="true" data-offset-key="17730:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17731"><span data-slate-object="text" data-key="17732"><span data-slate-leaf="true" data-offset-key="17732:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17733"><span data-slate-leaf="true" data-offset-key="17733:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"time"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17734"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17735"><span data-slate-object="text" data-key="17736"><span data-slate-leaf="true" data-offset-key="17736:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17737"><span data-slate-leaf="true" data-offset-key="17737:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"go.uber.org/zap"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17738"><span data-slate-object="text" data-key="17739"><span data-slate-leaf="true" data-offset-key="17739:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17740"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17741"><span data-slate-object="text" data-key="17742"><span data-slate-leaf="true" data-offset-key="17742:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="17743"><span data-slate-leaf="true" data-offset-key="17743:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="17744"><span data-slate-leaf="true" data-offset-key="17744:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="17745"><span data-slate-leaf="true" data-offset-key="17745:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="17746"><span data-slate-leaf="true" data-offset-key="17746:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17747"><span data-slate-object="text" data-key="17748"><span data-slate-leaf="true" data-offset-key="17748:0" data-first-offset="true"><span data-slate-string="true">    logger, _ := zap.NewProduction()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17749"><span data-slate-object="text" data-key="17750"><span data-slate-leaf="true" data-offset-key="17750:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17751"><span data-slate-leaf="true" data-offset-key="17751:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">defer</span></span></span></span><span data-slate-object="text" data-key="17752"><span data-slate-leaf="true" data-offset-key="17752:0" data-first-offset="true"><span data-slate-string="true"> logger.Sync() </span></span></span><span data-slate-object="text" data-key="17753"><span data-slate-leaf="true" data-offset-key="17753:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// flushes buffer, if any</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17754"><span data-slate-object="text" data-key="17755"><span data-slate-leaf="true" data-offset-key="17755:0" data-first-offset="true"><span data-slate-string="true">    url := </span></span></span><span data-slate-object="text" data-key="17756"><span data-slate-leaf="true" data-offset-key="17756:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"http://marmotedu.com"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17757"><span data-slate-object="text" data-key="17758"><span data-slate-leaf="true" data-offset-key="17758:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17759"><span data-slate-leaf="true" data-offset-key="17759:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 结构化日志打印</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17760"><span data-slate-object="text" data-key="17761"><span data-slate-leaf="true" data-offset-key="17761:0" data-first-offset="true"><span data-slate-string="true">    logger.Sugar().Infow(</span></span></span><span data-slate-object="text" data-key="17762"><span data-slate-leaf="true" data-offset-key="17762:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"failed to fetch URL"</span></span></span></span><span data-slate-object="text" data-key="17763"><span data-slate-leaf="true" data-offset-key="17763:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="17764"><span data-slate-leaf="true" data-offset-key="17764:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"url"</span></span></span></span><span data-slate-object="text" data-key="17765"><span data-slate-leaf="true" data-offset-key="17765:0" data-first-offset="true"><span data-slate-string="true">, url, </span></span></span><span data-slate-object="text" data-key="17766"><span data-slate-leaf="true" data-offset-key="17766:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"attempt"</span></span></span></span><span data-slate-object="text" data-key="17767"><span data-slate-leaf="true" data-offset-key="17767:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="17768"><span data-slate-leaf="true" data-offset-key="17768:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">3</span></span></span></span><span data-slate-object="text" data-key="17769"><span data-slate-leaf="true" data-offset-key="17769:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="17770"><span data-slate-leaf="true" data-offset-key="17770:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"backoff"</span></span></span></span><span data-slate-object="text" data-key="17771"><span data-slate-leaf="true" data-offset-key="17771:0" data-first-offset="true"><span data-slate-string="true">, time.Second)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17772"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17773"><span data-slate-object="text" data-key="17774"><span data-slate-leaf="true" data-offset-key="17774:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17775"><span data-slate-leaf="true" data-offset-key="17775:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 非结构化日志打印</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17776"><span data-slate-object="text" data-key="17777"><span data-slate-leaf="true" data-offset-key="17777:0" data-first-offset="true"><span data-slate-string="true">    logger.Sugar().Infof(</span></span></span><span data-slate-object="text" data-key="17778"><span data-slate-leaf="true" data-offset-key="17778:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"failed to fetch URL: %s"</span></span></span></span><span data-slate-object="text" data-key="17779"><span data-slate-leaf="true" data-offset-key="17779:0" data-first-offset="true"><span data-slate-string="true">, url)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17780"><span data-slate-object="text" data-key="17781"><span data-slate-leaf="true" data-offset-key="17781:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17782"><span data-slate-object="text" data-key="17783"><span data-slate-leaf="true" data-offset-key="17783:0" data-first-offset="true"><span data-slate-string="true">上述代码输出为：</span></span></span></div><div data-code-language="javascript" data-slate-type="pre" data-slate-object="block" data-key="17784"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="17785"><span data-slate-object="text" data-key="17786"><span data-slate-leaf="true" data-offset-key="17786:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="17787"><span data-slate-leaf="true" data-offset-key="17787:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"level"</span></span></span></span><span data-slate-object="text" data-key="17788"><span data-slate-leaf="true" data-offset-key="17788:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17789"><span data-slate-leaf="true" data-offset-key="17789:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"info"</span></span></span></span><span data-slate-object="text" data-key="17790"><span data-slate-leaf="true" data-offset-key="17790:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17791"><span data-slate-leaf="true" data-offset-key="17791:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"ts"</span></span></span></span><span data-slate-object="text" data-key="17792"><span data-slate-leaf="true" data-offset-key="17792:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17793"><span data-slate-leaf="true" data-offset-key="17793:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1607303966.9903321</span></span></span></span><span data-slate-object="text" data-key="17794"><span data-slate-leaf="true" data-offset-key="17794:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17795"><span data-slate-leaf="true" data-offset-key="17795:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"caller"</span></span></span></span><span data-slate-object="text" data-key="17796"><span data-slate-leaf="true" data-offset-key="17796:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17797"><span data-slate-leaf="true" data-offset-key="17797:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"zap/structured_log.go:14"</span></span></span></span><span data-slate-object="text" data-key="17798"><span data-slate-leaf="true" data-offset-key="17798:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17799"><span data-slate-leaf="true" data-offset-key="17799:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"msg"</span></span></span></span><span data-slate-object="text" data-key="17800"><span data-slate-leaf="true" data-offset-key="17800:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17801"><span data-slate-leaf="true" data-offset-key="17801:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"failed to fetch URL"</span></span></span></span><span data-slate-object="text" data-key="17802"><span data-slate-leaf="true" data-offset-key="17802:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17803"><span data-slate-leaf="true" data-offset-key="17803:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"url"</span></span></span></span><span data-slate-object="text" data-key="17804"><span data-slate-leaf="true" data-offset-key="17804:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17805"><span data-slate-leaf="true" data-offset-key="17805:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"http://marmotedu.com"</span></span></span></span><span data-slate-object="text" data-key="17806"><span data-slate-leaf="true" data-offset-key="17806:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17807"><span data-slate-leaf="true" data-offset-key="17807:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"attempt"</span></span></span></span><span data-slate-object="text" data-key="17808"><span data-slate-leaf="true" data-offset-key="17808:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17809"><span data-slate-leaf="true" data-offset-key="17809:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">3</span></span></span></span><span data-slate-object="text" data-key="17810"><span data-slate-leaf="true" data-offset-key="17810:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17811"><span data-slate-leaf="true" data-offset-key="17811:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"backoff"</span></span></span></span><span data-slate-object="text" data-key="17812"><span data-slate-leaf="true" data-offset-key="17812:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17813"><span data-slate-leaf="true" data-offset-key="17813:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1</span></span></span></span><span data-slate-object="text" data-key="17814"><span data-slate-leaf="true" data-offset-key="17814:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17815"><span data-slate-object="text" data-key="17816"><span data-slate-leaf="true" data-offset-key="17816:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="17817"><span data-slate-leaf="true" data-offset-key="17817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"level"</span></span></span></span><span data-slate-object="text" data-key="17818"><span data-slate-leaf="true" data-offset-key="17818:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17819"><span data-slate-leaf="true" data-offset-key="17819:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"info"</span></span></span></span><span data-slate-object="text" data-key="17820"><span data-slate-leaf="true" data-offset-key="17820:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17821"><span data-slate-leaf="true" data-offset-key="17821:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"ts"</span></span></span></span><span data-slate-object="text" data-key="17822"><span data-slate-leaf="true" data-offset-key="17822:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17823"><span data-slate-leaf="true" data-offset-key="17823:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">1607303966.9904354</span></span></span></span><span data-slate-object="text" data-key="17824"><span data-slate-leaf="true" data-offset-key="17824:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17825"><span data-slate-leaf="true" data-offset-key="17825:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"caller"</span></span></span></span><span data-slate-object="text" data-key="17826"><span data-slate-leaf="true" data-offset-key="17826:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17827"><span data-slate-leaf="true" data-offset-key="17827:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"zap/structured_log.go:17"</span></span></span></span><span data-slate-object="text" data-key="17828"><span data-slate-leaf="true" data-offset-key="17828:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="17829"><span data-slate-leaf="true" data-offset-key="17829:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"msg"</span></span></span></span><span data-slate-object="text" data-key="17830"><span data-slate-leaf="true" data-offset-key="17830:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="17831"><span data-slate-leaf="true" data-offset-key="17831:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"failed to fetch URL: http://marmotedu.com"</span></span></span></span><span data-slate-object="text" data-key="17832"><span data-slate-leaf="true" data-offset-key="17832:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="17833"><div data-slate-type="list-line" data-slate-object="block" data-key="17834"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="17835"><span data-slate-leaf="true" data-offset-key="17835:0" data-first-offset="true"><span data-slate-string="true">支持日志轮转</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17836"><span data-slate-object="text" data-key="17837"><span data-slate-leaf="true" data-offset-key="17837:0" data-first-offset="true"><span data-slate-string="true">在一个大型项目中，一天可能会产生几十个 G 的日志。为了防止日志把磁盘空间占满，导致服务器或者程序异常，就需要确保日志大小达到一定量级时，对日志进行切割、压缩，并转存。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17838"><span data-slate-object="text" data-key="17839"><span data-slate-leaf="true" data-offset-key="17839:0" data-first-offset="true"><span data-slate-string="true">如何切割呢？你可以按照日志大小进行切割，也可以按日期切割。日志的切割、压缩和转存功能可以基于 GitHub 上一些优秀的开源包来封装，例如：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="17840"><span data-slate-object="text" data-key="17841"><span data-slate-leaf="true" data-offset-key="17841:0" data-first-offset="true"><span data-slate-string="true">lumberjack</span></span></span></a><span data-slate-object="text" data-key="17842"><span data-slate-leaf="true" data-offset-key="17842:0" data-first-offset="true"><span data-slate-string="true"> 可以支持按大小和日期归档日志，</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="17843"><span data-slate-object="text" data-key="17844"><span data-slate-leaf="true" data-offset-key="17844:0" data-first-offset="true"><span data-slate-string="true">file-rotatelogs</span></span></span></a><span data-slate-object="text" data-key="17845"><span data-slate-leaf="true" data-offset-key="17845:0" data-first-offset="true"><span data-slate-string="true"> 支持按小时数进行日志切割。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17846"><span data-slate-object="text" data-key="17847"><span data-slate-leaf="true" data-offset-key="17847:0" data-first-offset="true"><span data-slate-string="true">对于日志轮转功能，其实我不建议在日志包中添加，因为这会增加日志包的复杂度，我更建议的做法是借助其他的工具来实现日志轮转。例如，在 Linux 系统中可以使用 Logrotate 来轮转日志。Logrotate 功能强大，是一个专业的日志轮转工具。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17848"><div data-slate-type="list-line" data-slate-object="block" data-key="17849"><div data-code-line-number="5"></div><div><span data-slate-object="text" data-key="17850"><span data-slate-leaf="true" data-offset-key="17850:0" data-first-offset="true"><span data-slate-string="true">具备 Hook 能力</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17851"><span data-slate-object="text" data-key="17852"><span data-slate-leaf="true" data-offset-key="17852:0" data-first-offset="true"><span data-slate-string="true">Hook 能力可以使我们对日志内容进行自定义处理。例如，</span></span><span data-slate-leaf="true" data-offset-key="17852:1"><span data-slate-object="annotation" data-annotation-key="gkann_e23eb43f" data-attr-id="44054" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">当某个级别的日志产生时，发送邮件或者调用告警接口进行告警。</span></span></span><span data-slate-leaf="true" data-offset-key="17852:2"><span data-slate-string="true">很多优秀的开源日志包提供了 Hook 能力，例如 logrus 和 zap。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17853"><span data-slate-object="text" data-key="17854"><span data-slate-leaf="true" data-offset-key="17854:0" data-first-offset="true"><span data-slate-string="true">在一个大型系统中，日志告警是非常重要的功能，但更好的实现方式是将告警能力做成旁路功能。通过旁路功能，可以保证日志包功能聚焦、简洁。例如：可以将日志收集到 Elasticsearch，并通过 ElastAlert 进行日志告警。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="17855" id="sr-toc-4"><span data-slate-object="text" data-key="17856"><span data-slate-leaf="true" data-offset-key="17856:0" data-first-offset="true"><span data-slate-string="true">可选功能</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="17857"><span data-slate-object="text" data-key="17858"><span data-slate-leaf="true" data-offset-key="17858:0" data-first-offset="true"><span data-slate-string="true">除了基础功能和高级功能外，还有一些功能。这些功能不会影响到日志包的核心功能，但是如果具有这些功能，会使日志包更加易用。比如下面的这三个功能。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17859"><div data-slate-type="list-line" data-slate-object="block" data-key="17860"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="17861"><span data-slate-leaf="true" data-offset-key="17861:0" data-first-offset="true"><span data-slate-string="true">支持颜色输出</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17862"><span data-slate-object="text" data-key="17863"><span data-slate-leaf="true" data-offset-key="17863:0" data-first-offset="true"><span data-slate-string="true">在开发、测试时开启颜色输出，不同级别的日志会被不同颜色标识，这样我们可以很轻松地发现一些 Error、Warn 级别的日志，方便开发调试。发布到生产环境时，可以关闭颜色输出，以提高性能。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17864"><div data-slate-type="list-line" data-slate-object="block" data-key="17865"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="17866"><span data-slate-leaf="true" data-offset-key="17866:0" data-first-offset="true"><span data-slate-string="true">兼容标准库 log 包</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17867"><span data-slate-object="text" data-key="17868"><span data-slate-leaf="true" data-offset-key="17868:0" data-first-offset="true"><span data-slate-string="true">一些早期的 Go 项目大量使用了标准库 log 包，如果我们的日志库能够兼容标准库 log 包，我们就可以很容易地替换掉标准库 log 包。例如，logrus 就兼容标准库 log 包。这里，我们来看一个使用了标准库 log 包的代码：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="17869"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="17870"><span data-slate-object="text" data-key="17871"><span data-slate-leaf="true" data-offset-key="17871:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="17872"><span data-slate-leaf="true" data-offset-key="17872:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17873"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17874"><span data-slate-object="text" data-key="17875"><span data-slate-leaf="true" data-offset-key="17875:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="17876"><span data-slate-leaf="true" data-offset-key="17876:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17877"><span data-slate-object="text" data-key="17878"><span data-slate-leaf="true" data-offset-key="17878:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="17879"><span data-slate-leaf="true" data-offset-key="17879:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"log"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17880"><span data-slate-object="text" data-key="17881"><span data-slate-leaf="true" data-offset-key="17881:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17882"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17883"><span data-slate-object="text" data-key="17884"><span data-slate-leaf="true" data-offset-key="17884:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="17885"><span data-slate-leaf="true" data-offset-key="17885:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="17886"><span data-slate-leaf="true" data-offset-key="17886:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="17887"><span data-slate-leaf="true" data-offset-key="17887:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="17888"><span data-slate-leaf="true" data-offset-key="17888:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17889"><span data-slate-object="text" data-key="17890"><span data-slate-leaf="true" data-offset-key="17890:0" data-first-offset="true"><span data-slate-string="true">    log.Print(</span></span></span><span data-slate-object="text" data-key="17891"><span data-slate-leaf="true" data-offset-key="17891:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"call Print: line1"</span></span></span></span><span data-slate-object="text" data-key="17892"><span data-slate-leaf="true" data-offset-key="17892:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17893"><span data-slate-object="text" data-key="17894"><span data-slate-leaf="true" data-offset-key="17894:0" data-first-offset="true"><span data-slate-string="true">    log.Println(</span></span></span><span data-slate-object="text" data-key="17895"><span data-slate-leaf="true" data-offset-key="17895:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"call Println: line2"</span></span></span></span><span data-slate-object="text" data-key="17896"><span data-slate-leaf="true" data-offset-key="17896:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17897"><span data-slate-object="text" data-key="17898"><span data-slate-leaf="true" data-offset-key="17898:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17899"><span data-slate-object="text" data-key="17900"><span data-slate-leaf="true" data-offset-key="17900:0" data-first-offset="true"><span data-slate-string="true">只需要使用</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17901"><span data-slate-object="text" data-key="17902"><span data-slate-leaf="true" data-offset-key="17902:0" data-first-offset="true"><span data-slate-string="true"> log "github.com/sirupsen/logrus"</span></span></span></span><span data-slate-object="text" data-key="17903"><span data-slate-leaf="true" data-offset-key="17903:0" data-first-offset="true"><span data-slate-string="true"> 替换</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17904"><span data-slate-object="text" data-key="17905"><span data-slate-leaf="true" data-offset-key="17905:0" data-first-offset="true"><span data-slate-string="true"> "log"</span></span></span></span><span data-slate-object="text" data-key="17906"><span data-slate-leaf="true" data-offset-key="17906:0" data-first-offset="true"><span data-slate-string="true"> 就可以完成标准库 log 包的切换：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="17907"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="17908"><span data-slate-object="text" data-key="17909"><span data-slate-leaf="true" data-offset-key="17909:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="17910"><span data-slate-leaf="true" data-offset-key="17910:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17911"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17912"><span data-slate-object="text" data-key="17913"><span data-slate-leaf="true" data-offset-key="17913:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="17914"><span data-slate-leaf="true" data-offset-key="17914:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17915"><span data-slate-object="text" data-key="17916"><span data-slate-leaf="true" data-offset-key="17916:0" data-first-offset="true"><span data-slate-string="true">    log </span></span></span><span data-slate-object="text" data-key="17917"><span data-slate-leaf="true" data-offset-key="17917:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/sirupsen/logrus"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17918"><span data-slate-object="text" data-key="17919"><span data-slate-leaf="true" data-offset-key="17919:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17920"></div><div data-slate-type="code-line" data-slate-object="block" data-key="17921"><span data-slate-object="text" data-key="17922"><span data-slate-leaf="true" data-offset-key="17922:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="17923"><span data-slate-leaf="true" data-offset-key="17923:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="17924"><span data-slate-leaf="true" data-offset-key="17924:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="17925"><span data-slate-leaf="true" data-offset-key="17925:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="17926"><span data-slate-leaf="true" data-offset-key="17926:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17927"><span data-slate-object="text" data-key="17928"><span data-slate-leaf="true" data-offset-key="17928:0" data-first-offset="true"><span data-slate-string="true">    log.Print(</span></span></span><span data-slate-object="text" data-key="17929"><span data-slate-leaf="true" data-offset-key="17929:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"call Print: line1"</span></span></span></span><span data-slate-object="text" data-key="17930"><span data-slate-leaf="true" data-offset-key="17930:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17931"><span data-slate-object="text" data-key="17932"><span data-slate-leaf="true" data-offset-key="17932:0" data-first-offset="true"><span data-slate-string="true">    log.Println(</span></span></span><span data-slate-object="text" data-key="17933"><span data-slate-leaf="true" data-offset-key="17933:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"call Println: line2"</span></span></span></span><span data-slate-object="text" data-key="17934"><span data-slate-leaf="true" data-offset-key="17934:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="17935"><span data-slate-object="text" data-key="17936"><span data-slate-leaf="true" data-offset-key="17936:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="17937"><div data-slate-type="list-line" data-slate-object="block" data-key="17938"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="17939"><span data-slate-leaf="true" data-offset-key="17939:0" data-first-offset="true"><span data-slate-string="true">支持输出到不同的位置</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17940"><span data-slate-object="text" data-key="17941"><span data-slate-leaf="true" data-offset-key="17941:0" data-first-offset="true"><span data-slate-string="true">在分布式系统中，一个服务会被部署在多台机器上，这时候如果我们要查看日志，就需要分别登录不同的机器查看，非常麻烦。我们更希望将日志统一投递到 Elasticsearch 上，在 Elasticsearch 上查看日志。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17942"><span data-slate-object="text" data-key="17943"><span data-slate-leaf="true" data-offset-key="17943:0" data-first-offset="true"><span data-slate-string="true">我们还可能需要从日志中分析某个接口的调用次数、某个用户的请求次数等信息，这就需要我们能够对日志进行处理。一般的做法是将日志投递到 Kafka，数据处理服务消费 Kafka 中保存的日志，从而分析出调用次数等信息。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17944"><span data-slate-object="text" data-key="17945"><span data-slate-leaf="true" data-offset-key="17945:0" data-first-offset="true"><span data-slate-string="true">以上两种场景，分别需要把日志投递到 Elasticsearch、Kafka 等组件，如果我们的日志包支持将日志投递到不同的目的端，那会是一项非常让人期待的功能：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="17946"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/bd/4b/bda7177a7a627b0117bfffdbd129914b.png?wh=1904x842"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17947"><span data-slate-object="text" data-key="17948"><span data-slate-leaf="true" data-offset-key="17948:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_4f1307fb" data-attr-id="32535" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">如果日志不支持投递到不同的下游组件，例如 Elasticsearch、Kafka、Fluentd、Logstash 等位置，也可以通过 Filebeat 采集磁盘上的日志文件，进而投递到下游组件。</span></span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="17949" id="sr-toc-5"><span data-slate-object="text" data-key="17950"><span data-slate-leaf="true" data-offset-key="17950:0" data-first-offset="true"><span data-slate-string="true">设计日志包时需要关注的点</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="17951"><span data-slate-object="text" data-key="17952"><span data-slate-leaf="true" data-offset-key="17952:0" data-first-offset="true"><span data-slate-string="true">上面，我们介绍了日志包具备的功能，这些功能可以指导我们完成日志包设计。这里，我们再来看下设计日志包时，我们还需要关注的几个层面：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17953"><div data-slate-type="list-line" data-slate-object="block" data-key="17954"><span data-slate-object="text" data-key="17955"><span data-slate-leaf="true" data-offset-key="17955:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">高性能：</span></span></span></span><span data-slate-object="text" data-key="17956"><span data-slate-leaf="true" data-offset-key="17956:0" data-first-offset="true"><span data-slate-string="true">因为我们要在代码中频繁调用日志包，记录日志，所以日志包的性能是首先要考虑的点，一个性能很差的日志包必然会导致整个应用性能很差。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17957"><span data-slate-object="text" data-key="17958"><span data-slate-leaf="true" data-offset-key="17958:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">并发安全：</span></span></span></span><span data-slate-object="text" data-key="17959"><span data-slate-leaf="true" data-offset-key="17959:0" data-first-offset="true"><span data-slate-string="true">Go 应用程序会大量使用 Go 语言的并发特性，也就意味着需要并发地记录日志，这就需要日志包是并发安全的。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17960"><span data-slate-object="text" data-key="17961"><span data-slate-leaf="true" data-offset-key="17961:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">插件化能力：</span></span></span></span><span data-slate-object="text" data-key="17962"><span data-slate-leaf="true" data-offset-key="17962:0" data-first-offset="true"><span data-slate-string="true">日志包应该能提供一些插件化的能力，比如允许开发者自定义输出格式，自定义存储位置，自定义错误发生时的行为（例如 告警、发邮件等）。插件化的能力不是必需的，因为日志自身的特性就能满足绝大部分的使用需求，例如：输出格式支持 JSON 和 TEXT，存储位置支持标准输出和文件，日志监控可以通过一些旁路系统来实现。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17963"><span data-slate-object="text" data-key="17964"><span data-slate-leaf="true" data-offset-key="17964:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">日志参数控制：</span></span></span></span><span data-slate-object="text" data-key="17965"><span data-slate-leaf="true" data-offset-key="17965:0" data-first-offset="true"><span data-slate-string="true">日志包应该能够灵活地进行配置，初始化时配置或者程序运行时配置。例如：初始化配置可以通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17966"><span data-slate-object="text" data-key="17967"><span data-slate-leaf="true" data-offset-key="17967:0" data-first-offset="true"><span data-slate-string="true">Init</span></span></span></span><span data-slate-object="text" data-key="17968"><span data-slate-leaf="true" data-offset-key="17968:0" data-first-offset="true"><span data-slate-string="true"> 函数完成，运行时配置可以通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17969"><span data-slate-object="text" data-key="17970"><span data-slate-leaf="true" data-offset-key="17970:0" data-first-offset="true"><span data-slate-string="true">SetOptions</span></span></span></span><span data-slate-object="text" data-key="17971"><span data-slate-leaf="true" data-offset-key="17971:0" data-first-offset="true"><span data-slate-string="true"> / </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="17972"><span data-slate-object="text" data-key="17973"><span data-slate-leaf="true" data-offset-key="17973:0" data-first-offset="true"><span data-slate-string="true">SetLevel</span></span></span></span><span data-slate-object="text" data-key="17974"><span data-slate-leaf="true" data-offset-key="17974:0" data-first-offset="true"><span data-slate-string="true"> 等函数来完成。</span></span></span></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="17975" id="sr-toc-6"><span data-slate-object="text" data-key="17976"><span data-slate-leaf="true" data-offset-key="17976:0" data-first-offset="true"><span data-slate-string="true">如何记录日志？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="17977"><span data-slate-object="text" data-key="17978"><span data-slate-leaf="true" data-offset-key="17978:0" data-first-offset="true"><span data-slate-string="true">前面我们介绍了在设计日志包时，要包含的一些功能、实现方法和注意事项。但在这个过程中，还有一项重要工作需要注意，那就是日志记录问题。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17979"><span data-slate-object="text" data-key="17980"><span data-slate-leaf="true" data-offset-key="17980:0" data-first-offset="true"><span data-slate-string="true">日志并不是越多越好，在实际开发中，经常会遇到一大堆无用的日志，却没有我们需要的日志；或者有效的日志被大量无用的日志淹没，查找起来非常困难。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17981"><span data-slate-object="text" data-key="17982"><span data-slate-leaf="true" data-offset-key="17982:0" data-first-offset="true"><span data-slate-string="true">一个优秀的日志包可以协助我们更好地记录、查看和分析日志，但是如何记录日志决定了我们能否获取到有用的信息。日志包是工具，日志记录才是灵魂。这里，我就来详细讲讲如何记录日志。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="17983"><span data-slate-object="text" data-key="17984"><span data-slate-leaf="true" data-offset-key="17984:0" data-first-offset="true"><span data-slate-string="true">想要更好地记录日志，我们需要解决以下几个问题：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17985"><div data-slate-type="list-line" data-slate-object="block" data-key="17986"><span data-slate-object="text" data-key="17987"><span data-slate-leaf="true" data-offset-key="17987:0" data-first-offset="true"><span data-slate-string="true">在何处打印日志？</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17988"><span data-slate-object="text" data-key="17989"><span data-slate-leaf="true" data-offset-key="17989:0" data-first-offset="true"><span data-slate-string="true">在哪个日志级别打印日志？</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="17990"><span data-slate-object="text" data-key="17991"><span data-slate-leaf="true" data-offset-key="17991:0" data-first-offset="true"><span data-slate-string="true">如何记录日志内容？</span></span></span></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="17992" id="sr-toc-7"><span data-slate-object="text" data-key="17993"><span data-slate-leaf="true" data-offset-key="17993:0" data-first-offset="true"><span data-slate-string="true">在何处打印日志？</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="17994"><span data-slate-object="text" data-key="17995"><span data-slate-leaf="true" data-offset-key="17995:0" data-first-offset="true"><span data-slate-string="true">日志主要是用来定位问题的，所以整体来说，我们要在有需要的地方打印日志。那么具体是哪些地方呢？我给你几个建议。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="17996"><div data-slate-type="list-line" data-slate-object="block" data-key="17997"><span data-slate-object="text" data-key="17998"><span data-slate-leaf="true" data-offset-key="17998:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在分支语句处打印日志。</span></span></span></span><span data-slate-object="text" data-key="17999"><span data-slate-leaf="true" data-offset-key="17999:0" data-first-offset="true"><span data-slate-string="true">在分支语句处打印日志，可以判断出代码走了哪个分支，有助于判断请求的下一跳，继而继续排查问题。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18000"><span data-slate-object="text" data-key="18001"><span data-slate-leaf="true" data-offset-key="18001:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">写操作必须打印日志。</span></span></span></span><span data-slate-object="text" data-key="18002"><span data-slate-leaf="true" data-offset-key="18002:0" data-first-offset="true"><span data-slate-string="true">写操作最可能会引起比较严重的业务故障，写操作打印日志，可以在出问题时找到关键信息。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18003"><span data-slate-object="text" data-key="18004"><span data-slate-leaf="true" data-offset-key="18004:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在循环中打印日志要慎重。</span></span></span></span><span data-slate-object="text" data-key="18005"><span data-slate-leaf="true" data-offset-key="18005:0" data-first-offset="true"><span data-slate-string="true">如果循环次数过多，会导致打印大量的日志，严重拖累代码的性能，建议的办法是在循环中记录要点，在循环外面总结打印出来。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18006"><span data-slate-object="text" data-key="18007"><span data-slate-leaf="true" data-offset-key="18007:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在错误产生的最原始位置打印日志。</span></span></span></span><span data-slate-object="text" data-key="18008"><span data-slate-leaf="true" data-offset-key="18008:0" data-first-offset="true"><span data-slate-string="true">对于嵌套的 Error，可在 Error 产生的最初位置打印 Error 日志，上层如果不需要添加必要的信息，可以直接返回下层的 Error。我给你举个例子：</span></span></span></div></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18009"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18010"><span data-slate-object="text" data-key="18011"><span data-slate-leaf="true" data-offset-key="18011:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="18012"><span data-slate-leaf="true" data-offset-key="18012:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18013"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18014"><span data-slate-object="text" data-key="18015"><span data-slate-leaf="true" data-offset-key="18015:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="18016"><span data-slate-leaf="true" data-offset-key="18016:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18017"><span data-slate-object="text" data-key="18018"><span data-slate-leaf="true" data-offset-key="18018:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18019"><span data-slate-leaf="true" data-offset-key="18019:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"flag"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18020"><span data-slate-object="text" data-key="18021"><span data-slate-leaf="true" data-offset-key="18021:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18022"><span data-slate-leaf="true" data-offset-key="18022:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"fmt"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18023"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18024"><span data-slate-object="text" data-key="18025"><span data-slate-leaf="true" data-offset-key="18025:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18026"><span data-slate-leaf="true" data-offset-key="18026:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/golang/glog"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18027"><span data-slate-object="text" data-key="18028"><span data-slate-leaf="true" data-offset-key="18028:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18029"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18030"><span data-slate-object="text" data-key="18031"><span data-slate-leaf="true" data-offset-key="18031:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18032"><span data-slate-leaf="true" data-offset-key="18032:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18033"><span data-slate-leaf="true" data-offset-key="18033:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="18034"><span data-slate-leaf="true" data-offset-key="18034:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="18035"><span data-slate-leaf="true" data-offset-key="18035:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18036"><span data-slate-object="text" data-key="18037"><span data-slate-leaf="true" data-offset-key="18037:0" data-first-offset="true"><span data-slate-string="true">    flag.Parse()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18038"><span data-slate-object="text" data-key="18039"><span data-slate-leaf="true" data-offset-key="18039:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18040"><span data-slate-leaf="true" data-offset-key="18040:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">defer</span></span></span></span><span data-slate-object="text" data-key="18041"><span data-slate-leaf="true" data-offset-key="18041:0" data-first-offset="true"><span data-slate-string="true"> glog.Flush()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18042"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18043"><span data-slate-object="text" data-key="18044"><span data-slate-leaf="true" data-offset-key="18044:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18045"><span data-slate-leaf="true" data-offset-key="18045:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="18046"><span data-slate-leaf="true" data-offset-key="18046:0" data-first-offset="true"><span data-slate-string="true"> err := loadConfig(); err != </span></span></span><span data-slate-object="text" data-key="18047"><span data-slate-leaf="true" data-offset-key="18047:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="18048"><span data-slate-leaf="true" data-offset-key="18048:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18049"><span data-slate-object="text" data-key="18050"><span data-slate-leaf="true" data-offset-key="18050:0" data-first-offset="true"><span data-slate-string="true">        glog.Error(err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18051"><span data-slate-object="text" data-key="18052"><span data-slate-leaf="true" data-offset-key="18052:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18053"><span data-slate-object="text" data-key="18054"><span data-slate-leaf="true" data-offset-key="18054:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18055"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18056"><span data-slate-object="text" data-key="18057"><span data-slate-leaf="true" data-offset-key="18057:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18058"><span data-slate-leaf="true" data-offset-key="18058:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18059"><span data-slate-leaf="true" data-offset-key="18059:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">loadConfig</span></span></span></span></span><span data-slate-object="text" data-key="18060"><span data-slate-leaf="true" data-offset-key="18060:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="18061"><span data-slate-leaf="true" data-offset-key="18061:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18062"><span data-slate-leaf="true" data-offset-key="18062:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18063"><span data-slate-leaf="true" data-offset-key="18063:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18064"><span data-slate-object="text" data-key="18065"><span data-slate-leaf="true" data-offset-key="18065:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18066"><span data-slate-leaf="true" data-offset-key="18066:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="18067"><span data-slate-leaf="true" data-offset-key="18067:0" data-first-offset="true"><span data-slate-string="true"> decodeConfig() </span></span></span><span data-slate-object="text" data-key="18068"><span data-slate-leaf="true" data-offset-key="18068:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 直接返回</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18069"><span data-slate-object="text" data-key="18070"><span data-slate-leaf="true" data-offset-key="18070:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18071"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18072"><span data-slate-object="text" data-key="18073"><span data-slate-leaf="true" data-offset-key="18073:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18074"><span data-slate-leaf="true" data-offset-key="18074:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18075"><span data-slate-leaf="true" data-offset-key="18075:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">decodeConfig</span></span></span></span></span><span data-slate-object="text" data-key="18076"><span data-slate-leaf="true" data-offset-key="18076:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="18077"><span data-slate-leaf="true" data-offset-key="18077:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18078"><span data-slate-leaf="true" data-offset-key="18078:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18079"><span data-slate-leaf="true" data-offset-key="18079:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18080"><span data-slate-object="text" data-key="18081"><span data-slate-leaf="true" data-offset-key="18081:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18082"><span data-slate-leaf="true" data-offset-key="18082:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="18083"><span data-slate-leaf="true" data-offset-key="18083:0" data-first-offset="true"><span data-slate-string="true"> err := readConfig(); err != </span></span></span><span data-slate-object="text" data-key="18084"><span data-slate-leaf="true" data-offset-key="18084:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="18085"><span data-slate-leaf="true" data-offset-key="18085:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18086"><span data-slate-object="text" data-key="18087"><span data-slate-leaf="true" data-offset-key="18087:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="18088"><span data-slate-leaf="true" data-offset-key="18088:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="18089"><span data-slate-leaf="true" data-offset-key="18089:0" data-first-offset="true"><span data-slate-string="true"> fmt.Errorf(</span></span></span><span data-slate-object="text" data-key="18090"><span data-slate-leaf="true" data-offset-key="18090:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"could not decode configuration data for user %s: %v"</span></span></span></span><span data-slate-object="text" data-key="18091"><span data-slate-leaf="true" data-offset-key="18091:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="18092"><span data-slate-leaf="true" data-offset-key="18092:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"colin"</span></span></span></span><span data-slate-object="text" data-key="18093"><span data-slate-leaf="true" data-offset-key="18093:0" data-first-offset="true"><span data-slate-string="true">, err) </span></span></span><span data-slate-object="text" data-key="18094"><span data-slate-leaf="true" data-offset-key="18094:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 添加必要的信息，用户名称</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18095"><span data-slate-object="text" data-key="18096"><span data-slate-leaf="true" data-offset-key="18096:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18097"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18098"><span data-slate-object="text" data-key="18099"><span data-slate-leaf="true" data-offset-key="18099:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18100"><span data-slate-leaf="true" data-offset-key="18100:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="18101"><span data-slate-leaf="true" data-offset-key="18101:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18102"><span data-slate-leaf="true" data-offset-key="18102:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18103"><span data-slate-object="text" data-key="18104"><span data-slate-leaf="true" data-offset-key="18104:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18105"></div><div data-slate-type="code-line" data-slate-object="block" data-key="18106"><span data-slate-object="text" data-key="18107"><span data-slate-leaf="true" data-offset-key="18107:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="18108"><span data-slate-leaf="true" data-offset-key="18108:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="18109"><span data-slate-leaf="true" data-offset-key="18109:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">readConfig</span></span></span></span></span><span data-slate-object="text" data-key="18110"><span data-slate-leaf="true" data-offset-key="18110:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="18111"><span data-slate-leaf="true" data-offset-key="18111:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="18112"><span data-slate-leaf="true" data-offset-key="18112:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="18113"><span data-slate-leaf="true" data-offset-key="18113:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18114"><span data-slate-object="text" data-key="18115"><span data-slate-leaf="true" data-offset-key="18115:0" data-first-offset="true"><span data-slate-string="true">    glog.Errorf(</span></span></span><span data-slate-object="text" data-key="18116"><span data-slate-leaf="true" data-offset-key="18116:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"read: end of input."</span></span></span></span><span data-slate-object="text" data-key="18117"><span data-slate-leaf="true" data-offset-key="18117:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18118"><span data-slate-object="text" data-key="18119"><span data-slate-leaf="true" data-offset-key="18119:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="18120"><span data-slate-leaf="true" data-offset-key="18120:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="18121"><span data-slate-leaf="true" data-offset-key="18121:0" data-first-offset="true"><span data-slate-string="true"> fmt.Errorf(</span></span></span><span data-slate-object="text" data-key="18122"><span data-slate-leaf="true" data-offset-key="18122:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"read: end of input"</span></span></span></span><span data-slate-object="text" data-key="18123"><span data-slate-leaf="true" data-offset-key="18123:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18124"><span data-slate-object="text" data-key="18125"><span data-slate-leaf="true" data-offset-key="18125:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18126"><span data-slate-object="text" data-key="18127"><span data-slate-leaf="true" data-offset-key="18127:0" data-first-offset="true"><span data-slate-string="true">通过在最初产生错误的位置打印日志，我们可以很方便地追踪到日志的根源，进而在上层追加一些必要的信息。这可以让我们了解到该错误产生的影响，有助于排障。另外，直接返回下层日志，还可以减少重复的日志打印。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18128"><span data-slate-object="text" data-key="18129"><span data-slate-leaf="true" data-offset-key="18129:0" data-first-offset="true"><span data-slate-string="true">当代码调用第三方包的函数，且第三方包函数出错时，会打印错误信息。比如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="18130"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="18131"><span data-slate-object="text" data-key="18132"><span data-slate-leaf="true" data-offset-key="18132:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="18133"><span data-slate-leaf="true" data-offset-key="18133:0" data-first-offset="true"><span data-slate-string="true"> err := os.Chdir(</span></span></span><span data-slate-object="text" data-key="18134"><span data-slate-leaf="true" data-offset-key="18134:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/root"</span></span></span></span><span data-slate-object="text" data-key="18135"><span data-slate-leaf="true" data-offset-key="18135:0" data-first-offset="true"><span data-slate-string="true">); err != </span></span></span><span data-slate-object="text" data-key="18136"><span data-slate-leaf="true" data-offset-key="18136:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="18137"><span data-slate-leaf="true" data-offset-key="18137:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18138"><span data-slate-object="text" data-key="18139"><span data-slate-leaf="true" data-offset-key="18139:0" data-first-offset="true"><span data-slate-string="true">    log.Errorf(</span></span></span><span data-slate-object="text" data-key="18140"><span data-slate-leaf="true" data-offset-key="18140:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"change dir failed: %v"</span></span></span></span><span data-slate-object="text" data-key="18141"><span data-slate-leaf="true" data-offset-key="18141:0" data-first-offset="true"><span data-slate-string="true">, err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="18142"><span data-slate-object="text" data-key="18143"><span data-slate-leaf="true" data-offset-key="18143:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18144" id="sr-toc-8"><span data-slate-object="text" data-key="18145"><span data-slate-leaf="true" data-offset-key="18145:0" data-first-offset="true"><span data-slate-string="true">在哪个日志级别打印日志？</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18146"><span data-slate-object="text" data-key="18147"><span data-slate-leaf="true" data-offset-key="18147:0" data-first-offset="true"><span data-slate-string="true">不同级别的日志，具有不同的意义，能实现不同的功能，在开发中，我们应该根据目的，在合适的级别记录日志，这里我同样给你一些建议。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18148"><div data-slate-type="list-line" data-slate-object="block" data-key="18149"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="18150"><span data-slate-leaf="true" data-offset-key="18150:0" data-first-offset="true"><span data-slate-string="true">Debug 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18151"><span data-slate-object="text" data-key="18152"><span data-slate-leaf="true" data-offset-key="18152:0" data-first-offset="true"><span data-slate-string="true">为了获取足够的信息进行 Debug，通常会在 Debug 级别打印很多日志。例如，可以打印整个 HTTP 请求的请求 Body 或者响应 Body。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18153"><span data-slate-object="text" data-key="18154"><span data-slate-leaf="true" data-offset-key="18154:0" data-first-offset="true"><span data-slate-string="true">Debug 级别需要打印大量的日志，这会严重拖累程序的性能。并且，Debug 级别的日志，主要是为了能在开发测试阶段更好地 Debug，多是一些不影响现网业务的日志信息。所以，对于 Debug 级别的日志，在服务上线时我们一定要禁止掉。否则，就可能会因为大量的日志导致硬盘空间快速用完，从而造成服务宕机，也可能会影响服务的性能和产品体验。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18155"><span data-slate-object="text" data-key="18156"><span data-slate-leaf="true" data-offset-key="18156:0" data-first-offset="true"><span data-slate-string="true">Debug 这个级别的日志可以随意输出，任何你觉得有助于开发、测试阶段调试的日志，都可以在这个级别打印。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18157"><div data-slate-type="list-line" data-slate-object="block" data-key="18158"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="18159"><span data-slate-leaf="true" data-offset-key="18159:0" data-first-offset="true"><span data-slate-string="true">Info 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18160"><span data-slate-object="text" data-key="18161"><span data-slate-leaf="true" data-offset-key="18161:0" data-first-offset="true"><span data-slate-string="true">Info 级别的日志可以记录一些有用的信息，供以后的运营分析，所以 Info 级别的日志不是越多越好，也不是越少越好，应以满足需求为主要目标。一些关键日志，可以在 Info 级别记录，但如果日志量大、输出频度过高，则要考虑在 Debug 级别记录。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18162"><span data-slate-object="text" data-key="18163"><span data-slate-leaf="true" data-offset-key="18163:0" data-first-offset="true"><span data-slate-string="true">现网的日志级别一般是 Info 级别，为了不使日志文件占满整个磁盘空间，在记录日志时，要注意避免产生过多的 Info 级别的日志。例如，在 for 循环中，就要慎用 Info 级别的日志。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18164"><div data-slate-type="list-line" data-slate-object="block" data-key="18165"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="18166"><span data-slate-leaf="true" data-offset-key="18166:0" data-first-offset="true"><span data-slate-string="true">Warn 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18167"><span data-slate-object="text" data-key="18168"><span data-slate-leaf="true" data-offset-key="18168:0" data-first-offset="true"><span data-slate-string="true">一些警告类的日志可以记录在 Warn 级别，Warn 级别的日志往往说明程序运行异常，不符合预期，但又不影响程序的继续运行，或者是暂时影响，但后续会恢复。像这些日志，就需要你关注起来。Warn 更多的是业务级别的警告日志。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18169"><div data-slate-type="list-line" data-slate-object="block" data-key="18170"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="18171"><span data-slate-leaf="true" data-offset-key="18171:0" data-first-offset="true"><span data-slate-string="true">Error 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18172"><span data-slate-object="text" data-key="18173"><span data-slate-leaf="true" data-offset-key="18173:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_2c032b0d" data-attr-id="42995" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">Error 级别的日志告诉我们程序执行出错，这些错误肯定会影响到程序的执行结果，例如请求失败、创建资源失败等。要记录每一个发生错误的日志，避免日后排障过程中这些错误被忽略掉。大部分的错误可以归在 Error 级别。</span></span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18174"><div data-slate-type="list-line" data-slate-object="block" data-key="18175"><div data-code-line-number="5"></div><div><span data-slate-object="text" data-key="18176"><span data-slate-leaf="true" data-offset-key="18176:0" data-first-offset="true"><span data-slate-string="true">Panic 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18177"><span data-slate-object="text" data-key="18178"><span data-slate-leaf="true" data-offset-key="18178:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_73dade65" data-attr-id="26781" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">Panic 级别的日志在实际开发中很少用，通常只在需要错误堆栈，或者不想因为发生严重错误导致程序退出，而采用 defer 处理错误时使用。</span></span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18179"><div data-slate-type="list-line" data-slate-object="block" data-key="18180"><div data-code-line-number="6"></div><div><span data-slate-object="text" data-key="18181"><span data-slate-leaf="true" data-offset-key="18181:0" data-first-offset="true"><span data-slate-string="true">Fatal 级别</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18182"><span data-slate-object="text" data-key="18183"><span data-slate-leaf="true" data-offset-key="18183:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_503c6dbb" data-attr-id="42996" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">Fatal 是最高级别的日志，这个级别的日志说明问题已经相当严重，严重到程序无法继续运行，通常是系统级的错误。在开发中也很少使用，除非我们觉得某个错误发生时，整个程序无法继续运行。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18184"><span data-slate-object="text" data-key="18185"><span data-slate-leaf="true" data-offset-key="18185:0" data-first-offset="true"><span data-slate-string="true">这里用一张图来总结下，如何选择 Debug、Info、Warn、Error、Panic、Fatal 这几种日志级别。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18186"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/75/35/75e8c71a791f279a68c35734f2451035.png?wh=3646x1542"></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18187" id="sr-toc-9"><span data-slate-object="text" data-key="18188"><span data-slate-leaf="true" data-offset-key="18188:0" data-first-offset="true"><span data-slate-string="true">如何记录日志内容？</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18189"><span data-slate-object="text" data-key="18190"><span data-slate-leaf="true" data-offset-key="18190:0" data-first-offset="true"><span data-slate-string="true">关于如何记录日志内容，我有几条建议：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18191"><div data-slate-type="list-line" data-slate-object="block" data-key="18192"><span data-slate-object="text" data-key="18193"><span data-slate-leaf="true" data-offset-key="18193:0" data-first-offset="true"><span data-slate-string="true">在记录日志时，不要输出一些敏感信息，例如密码、密钥等。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18194"><span data-slate-object="text" data-key="18195"><span data-slate-leaf="true" data-offset-key="18195:0" data-first-offset="true"><span data-slate-string="true">为了方便调试，通常会在 Debug 级别记录一些临时日志，这些日志内容可以用一些特殊的字符开头，例如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18196"><span data-slate-object="text" data-key="18197"><span data-slate-leaf="true" data-offset-key="18197:0" data-first-offset="true"><span data-slate-string="true">log.Debugf("XXXXXXXXXXXX-1:Input key was: %s", setKeyName)</span></span></span></span><span data-slate-object="text" data-key="18198"><span data-slate-leaf="true" data-offset-key="18198:0" data-first-offset="true"><span data-slate-string="true"> 。这样，在完成调试后，可以通过查找 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18199"><span data-slate-object="text" data-key="18200"><span data-slate-leaf="true" data-offset-key="18200:0" data-first-offset="true"><span data-slate-string="true">XXXXXXXXXXXX</span></span></span></span><span data-slate-object="text" data-key="18201"><span data-slate-leaf="true" data-offset-key="18201:0" data-first-offset="true"><span data-slate-string="true"> 字符串，找到这些临时日志，在 commit 前删除。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18202"><span data-slate-object="text" data-key="18203"><span data-slate-leaf="true" data-offset-key="18203:0" data-first-offset="true"><span data-slate-string="true">日志内容应该小写字母开头，以英文点号 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18204"><span data-slate-object="text" data-key="18205"><span data-slate-leaf="true" data-offset-key="18205:0" data-first-offset="true"><span data-slate-string="true">.</span></span></span></span><span data-slate-object="text" data-key="18206"><span data-slate-leaf="true" data-offset-key="18206:0" data-first-offset="true"><span data-slate-string="true"> 结尾，例如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18207"><span data-slate-object="text" data-key="18208"><span data-slate-leaf="true" data-offset-key="18208:0" data-first-offset="true"><span data-slate-string="true">log.Info("update user function called.")</span></span></span></span><span data-slate-object="text" data-key="18209"><span data-slate-leaf="true" data-offset-key="18209:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18210"><span data-slate-object="text" data-key="18211"><span data-slate-leaf="true" data-offset-key="18211:0" data-first-offset="true"><span data-slate-string="true">为了提高性能，尽可能使用明确的类型，例如使用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18212"><span data-slate-object="text" data-key="18213"><span data-slate-leaf="true" data-offset-key="18213:0" data-first-offset="true"><span data-slate-string="true">log.Warnf("init datastore: %s", err.Error())</span></span></span></span><span data-slate-object="text" data-key="18214"><span data-slate-leaf="true" data-offset-key="18214:0" data-first-offset="true"><span data-slate-string="true"> 而非 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18215"><span data-slate-object="text" data-key="18216"><span data-slate-leaf="true" data-offset-key="18216:0" data-first-offset="true"><span data-slate-string="true">log.Warnf("init datastore: %v", err)</span></span></span></span><span data-slate-object="text" data-key="18217"><span data-slate-leaf="true" data-offset-key="18217:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18218"><span data-slate-object="text" data-key="18219"><span data-slate-leaf="true" data-offset-key="18219:0" data-first-offset="true"><span data-slate-string="true">根据需要，日志最好包含两个信息。一个是请求 ID（RequestID），是每次请求的唯一 ID，便于从海量日志中过滤出某次请求的日志，可以将请求 ID 放在请求的通用日志字段中。另一个是用户和行为，用于标识谁做了什么。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18220"><span data-slate-object="text" data-key="18221"><span data-slate-leaf="true" data-offset-key="18221:0" data-first-offset="true"><span data-slate-string="true">不要将日志记录在错误的日志级别上。例如，我在项目开发中，经常会发现有同事将正常的日志信息打印在 Error 级别，将错误的日志信息打印在 Info 级别。</span></span></span></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="18222" id="sr-toc-10"><span data-slate-object="text" data-key="18223"><span data-slate-leaf="true" data-offset-key="18223:0" data-first-offset="true"><span data-slate-string="true">记录日志的 “最佳” 实践总结</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="18224"><span data-slate-object="text" data-key="18225"><span data-slate-leaf="true" data-offset-key="18225:0" data-first-offset="true"><span data-slate-string="true">关于日志记录问题，我从以上三个层面给你讲解了。综合来说，对于日志记录的最佳实践，你在平时都可以注意或进行尝试，我把这些重点放在这里，方便你后续查阅。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18226"><div data-slate-type="list-line" data-slate-object="block" data-key="18227"><span data-slate-object="text" data-key="18228"><span data-slate-leaf="true" data-offset-key="18228:0" data-first-offset="true"><span data-slate-string="true">开发调试、现网故障排障时，不要遗忘一件事情：根据排障的过程优化日志打印。好的日志，可能不是一次就可以写好的，可以在实际开发测试，还有现网定位问题时，不断优化。但这需要你重视日志，而不是把日志仅仅当成记录信息的一种方式，甚至不知道为什么打印一条 Info 日志。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18229"><span data-slate-object="text" data-key="18230"><span data-slate-leaf="true" data-offset-key="18230:0" data-first-offset="true"><span data-slate-string="true">打印日志要 “不多不少”，避免打印没有作用的日志，也不要遗漏关键的日志信息。最好的信息是，仅凭借这些关键的日志就能定位到问题。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18231"><span data-slate-object="text" data-key="18232"><span data-slate-leaf="true" data-offset-key="18232:0" data-first-offset="true"><span data-slate-string="true">支持动态日志输出，方便线上问题定位。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18233"><span data-slate-object="text" data-key="18234"><span data-slate-leaf="true" data-offset-key="18234:0" data-first-offset="true"><span data-slate-string="true">总是将日志记录在本地文件：通过将日志记录在本地文件，可以和日志中心化平台进行解耦，这样当网络不可用，或者日志中心化平台故障时，仍然能够正常的记录日志。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18235"><span data-slate-object="text" data-key="18236"><span data-slate-leaf="true" data-offset-key="18236:0" data-first-offset="true"><span data-slate-string="true">集中化日志存储处理：因为应用可能包含多个服务，一个服务包含多个实例，为了查看日志方便，最好将这些日志统一存储在同一个日志平台上，例如 Elasticsearch，方便集中管理和查看日志。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18237"><span data-slate-object="text" data-key="18238"><span data-slate-leaf="true" data-offset-key="18238:0" data-first-offset="true"><span data-slate-string="true">结构化日志记录：添加一些默认通用的字段到每行日志，方便日志查询和分析。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18239"><span data-slate-object="text" data-key="18240"><span data-slate-leaf="true" data-offset-key="18240:0" data-first-offset="true"><span data-slate-string="true">支持 RequestID：使用 RequestID 串联一次请求的所有日志，这些日志可能分布在不同的组件，不同的机器上。支持 RequestID 可以大大提高排障的效率，降低排障难度。在一些大型分布式系统中，没有 RequestID 排障简直就是灾难。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18241"><span data-slate-object="text" data-key="18242"><span data-slate-leaf="true" data-offset-key="18242:0" data-first-offset="true"><span data-slate-string="true">支持动态开关 Debug 日志：对于定位一些隐藏得比较深的问题，可能需要更多的信息，这时候可能需要打印 Debug 日志。但现网的日志级别会设置为 Info 级别，为了获取 Debug 日志，我们可能会修改日志级别为 Debug 级别并重启服务，定位完问题后，再修改日志级别为 Info 级别，然后再重启服务，这种方式不仅麻烦而且还可能会对现网业务造成影响，</span></span><span data-slate-leaf="true" data-offset-key="18242:1"><span data-slate-object="annotation" data-annotation-key="gkann_72306bfa" data-attr-id="31152" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">最好的办法是能够在请求中通过 </span></span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="18243"><span data-slate-object="text" data-key="18244"><span data-slate-leaf="true" data-offset-key="18244:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_72306bfa" data-attr-id="31152" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">debug=true</span></span></span></span></span><span data-slate-object="text" data-key="18245"><span data-slate-leaf="true" data-offset-key="18245:0" data-first-offset="true"><span data-slate-object="annotation" data-annotation-key="gkann_72306bfa" data-attr-id="31152" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true"> 这类参数动态控制某次请求是否开启 Debug 日志。</span></span></span></span></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18246" id="sr-toc-11"><span data-slate-object="text" data-key="18247"><span data-slate-leaf="true" data-offset-key="18247:0" data-first-offset="true"><span data-slate-string="true">拓展内容：分布式日志解决方案（EFK/ELK）</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18248"><span data-slate-object="text" data-key="18249"><span data-slate-leaf="true" data-offset-key="18249:0" data-first-offset="true"><span data-slate-string="true">前面我们介绍了设计日志包和记录日志的规范，除此之外，还有一个问题你应该了解，那就是：我们记录的日志如何收集、处理和展示。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18250"><span data-slate-object="text" data-key="18251"><span data-slate-leaf="true" data-offset-key="18251:0" data-first-offset="true"><span data-slate-string="true">在实际 Go 项目开发中，为了实现高可用，同一个服务至少需要部署两个实例，通过轮询的负载均衡策略转发请求。另外，一个应用又可能包含多个服务。假设我们的应用包含两个服务，每个服务部署两个实例，如果应用出故障，我们可能需要登陆 4（2 x 2）台服务器查看本地的日志文件，定位问题，非常麻烦，会增加故障恢复时间。所以在真实的企业场景中，我们会将这些日志统一收集并展示。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18252"><span data-slate-object="text" data-key="18253"><span data-slate-leaf="true" data-offset-key="18253:0" data-first-offset="true"><span data-slate-string="true">在业界，日志的收集、处理和展示，早已经有了一套十分流行的日志解决方案：EFK（Elasticsearch + Filebeat + Kibana）或者 ELK（Elasticsearch + Logstash + Kibana），EFK 可以理解为 ELK 的演进版，把日志收集组件从 Logstash 替换成了 Filebeat。用 Filebeat 替换 Logstash，主要原因是 Filebeat 更轻量级，占用的资源更少。关于日志处理架构，你可以参考这张图。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="18254"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/5d/c8/5daabdfea213c05fc0387aa735e54ec8.png?wh=4194x778"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18255"><span data-slate-object="text" data-key="18256"><span data-slate-leaf="true" data-offset-key="18256:0" data-first-offset="true"><span data-slate-string="true">通过 log 包将日志记录在本地文件中（*.log 文件），再通过 Shipper 收集到 Kafka 中。Shipper 可以根据需要灵活选择，常见的 Shipper 有 Logstash Shipper、Flume、Fluentd、Filebeat。其中 Filebeat 和 Logstash Shipper 用得最多。Shipper 没有直接将日志投递到 Logstash indexer，或者 Elasticsearch，是因为 Kafka 能够支持更大的吞吐量，起到削峰填谷的作用。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18257"><span data-slate-object="text" data-key="18258"><span data-slate-leaf="true" data-offset-key="18258:0" data-first-offset="true"><span data-slate-string="true">Kafka 中的日志消息会被 Logstash indexer 消费，处理后投递到 Elasticsearch 中存储起来。Elasticsearch 是实时全文搜索和分析引擎，提供搜集、分析、存储数据三大功能。Elasticsearch 中存储的日志，可以通过 Kibana 提供的图形界面来展示。Kibana 是一个基于 Web 的图形界面，用于搜索、分析和可视化存储在 Elasticsearch 中的日志数据。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18259"><span data-slate-object="text" data-key="18260"><span data-slate-leaf="true" data-offset-key="18260:0" data-first-offset="true"><span data-slate-string="true">Logstash 负责采集、转换和过滤日志。它支持几乎任何类型的日志，包括系统日志、错误日志和自定义应用程序日志。Logstash 又分为 Logstash Shipper 和 Logstash indexer。其中，Logstash Shipper 监控并收集日志，并将日志内容发送到 Logstash indexer，然后 Logstash indexer 过滤日志，并将日志提交给 Elasticsearch。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18261" id="sr-toc-12"><span data-slate-object="text" data-key="18262"><span data-slate-leaf="true" data-offset-key="18262:0" data-first-offset="true"><span data-slate-string="true">总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18263"><span data-slate-object="text" data-key="18264"><span data-slate-leaf="true" data-offset-key="18264:0" data-first-offset="true"><span data-slate-string="true">记录日志，是应用程序必备的功能。记录日志最大的作用是排障，如果想更好地排障，我们需要一个优秀的工具，日志包。那么如何设计日志包呢？首先我们需要知道日志包的功能，在我看来日志包需要具备以下功能：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="18265"><div data-slate-type="list-line" data-slate-object="block" data-key="18266"><span data-slate-object="text" data-key="18267"><span data-slate-leaf="true" data-offset-key="18267:0" data-first-offset="true"><span data-slate-string="true">基础功能：支持基本的日志信息、支持不同的日志级别、支持自定义配置、支持输出到标准输出和文件。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18268"><span data-slate-object="text" data-key="18269"><span data-slate-leaf="true" data-offset-key="18269:0" data-first-offset="true"><span data-slate-string="true">高级功能：支持多种日志格式、能够按级别分类输出、支持结构化日志、支持日志轮转、具备 Hook 能力。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="18270"><span data-slate-object="text" data-key="18271"><span data-slate-leaf="true" data-offset-key="18271:0" data-first-offset="true"><span data-slate-string="true">可选功能：支持颜色输出、兼容标准库 log 包、支持输出到不同的位置。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18272"><span data-slate-object="text" data-key="18273"><span data-slate-leaf="true" data-offset-key="18273:0" data-first-offset="true"><span data-slate-string="true">另外，一个日志包还需要支持不同级别的日志，按日志级别优先级从低到高分别是：Trace &lt; Debug &lt; Info &lt; Warn/Warning &lt; Error &lt; Panic &lt; Fatal。其中 Debug、Info、Warn、Error、Fatal 是比较基础的级别，建议在开发一个日志包时包含这些级别。Trace、Panic 是可选的级别。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18274"><span data-slate-object="text" data-key="18275"><span data-slate-leaf="true" data-offset-key="18275:0" data-first-offset="true"><span data-slate-string="true">在我们掌握了日志包的功能之后，就可以设计、开发日志包了。但我们在开发过程中，还需要确保我们的日志包具有比较高的性能、并发安全、支持插件化的能力，并支持日志参数控制。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18276"><span data-slate-object="text" data-key="18277"><span data-slate-leaf="true" data-offset-key="18277:0" data-first-offset="true"><span data-slate-string="true">有了日志包，我们还需要知道如何更好地使用日志包，也就是如何记录日志。在文中，我给出了一些记录建议，内容比较多，你可以返回文中查看。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18278"><span data-slate-object="text" data-key="18279"><span data-slate-leaf="true" data-offset-key="18279:0" data-first-offset="true"><span data-slate-string="true">最后，我还给出了分布式日志解决方案：EFK/ELK。EFK 是 ELK 的升级版，在实际项目开发中，我们可以直接选择 EFK。在 EFK 方案中，</span></span><span data-slate-leaf="true" data-offset-key="18279:1"><span data-slate-object="annotation" data-annotation-key="gkann_831b6452" data-attr-id="41256" data-attr-name="public" data-annotation-type="public"><span data-slate-string="true">通过 Filebeat 将日志上传到 Kafka，Logstash indexer 消费 Kafka 中的日志，并投递到 Elasticsearch 中存储起来，最后通过 Kibana 图形界面来查看日志。</span></span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="18280" id="sr-toc-13"><span data-slate-object="text" data-key="18281"><span data-slate-leaf="true" data-offset-key="18281:0" data-first-offset="true"><span data-slate-string="true">课后练习</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="18282"><span data-slate-object="text" data-key="18283"><span data-slate-leaf="true" data-offset-key="18283:0" data-first-offset="true"><span data-slate-string="true">思考一下，你的项目中，日志包还需要哪些功能，如何设计？你的日常开发中，如果有比较好的日志记录规范，也欢迎在留言区分享讨论。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="18284"><span data-slate-object="text" data-key="18285"><span data-slate-leaf="true" data-offset-key="18285:0" data-first-offset="true"><span data-slate-string="true">期待你的思考和看法，我们下一讲见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><span>15</span> 人觉得很赞<a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/1f/81/1f6c18433af717a740f1e49389f2f981.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-14">精选留言 (13)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/21/5f/e2/e6d3d9bf.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>XI</span></div></div><div>请问下老师，大型的分布式服务都需要日志的链路追踪，日志的 trance_id 由网关生成，每个微服务在接受请求的时候也应当必传 trance_id 作为请求记录，大公司是这样设计的吗？</div><div><p>作者回复：大公司也是这么设计的。</p></div><div><div>2021-07-13</div><div><div><i></i></div><div><i></i><span>10</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/91/b1/fb117c21.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 先听</span></div></div><div>body 好像只可以读取一次，请问老师有没有什么好的办法来解决这个问题呢？</div><div><p>作者回复：可以看下 github.com/tpkeeper/gin-dump 包的实现，里面会 dump http request body</p></div><div><div>2021-08-02</div><div><div><i></i><span>2</span></div><div><i></i><span>6</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Sch0ng</span></div></div><div>对内，日志的作用是排查问题。
对外，日志的作用是跟人 PK 的时候为自己提供有力的证据。
记录日志是一个高频操作，需要简单、高性能。
实际项目里，如果不刻意治理，即使有日志规范，也是约等于没有。</div><div><p>作者回复：理解的到位！</p></div><div><div>2021-08-11</div><div><div><i></i></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/17/41/be/7c756efa.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>timidsmile</span></div></div><div>对于日志轮转功能，其实我不建议在日志包中添加
------
这里使用 Logrotate 的话，是使用 logrotate 的哪种方式呢？
* copytruncate 方式的话，对于大日志应该有性能问题吧？
* create 方式的话，是需要通过接收特殊 signal 的方式来实现重新打开日志吗？考虑到很多信号已被用到 shutdown 中，这里有 signal 推荐吗？</div><div><p>作者回复: copytruncate 比较好吧，inode 不变，这样应用程序可以继续写文件，也比较简单。一般一个系统一天的日志 50G 算是比较大的了，copy 50G 的日志，不会给服务器带来压力的。</p></div><div><div>2021-07-12</div><div><div><i></i></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>helloworld</span></div></div><div>“日志内容应该小写字母开头，以英文点号。结尾”，如果日志结尾有符号，在代码静态检查时，提示日志内容结尾不应有符号的，这块和您说的不一致</div><div><p>作者回复：可以不以。号结尾，其实影响不大，形成规范即可。</p></div><div><div>2021-07-10</div><div><div><i></i></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/22/2d/91/786ef504.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 兴旺</span></div></div><div>我们现在用 rsyslog+kafka+clickhouse+grafana 做全链路追踪</div><div><div>2022-03-01</div><div><div><i></i><span></span></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 庖丁解牛</span></div></div><div>孔老师，在「在何处打印日志」这个地方，为什么特意提出：写操作时必须打印日志？会引发什么严重的问题？那应该在日志上输出什么信息呢？</div><div><p>作者回复：读操作，一般是类似 List、Get 这种接口，如果报错，影响不大。但是写操作，一般是 Create、Update 这类接口，如果失败会导致功能性接口失败，影响较大。

读操作一般是幂等的，写操作往往不是幂等的，写操作失败，可能还要清理脏数据，比较麻烦。</p></div><div><div>2021-10-14</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>lesserror</span></div></div><div>孔老师，关于：拓展内容：分布式日志解决方案（EFK/ELK）。

这里有没有好的实践文章呢？ 没有自己动手实践过，想学习一下。</div><div><p>作者回复：暂时没有，我从网上搜了一篇，你可以参考下：https://www.cnblogs.com/ludongguoa/p/15318282.html</p></div><div><div>2021-10-07</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/16/1d/53/a7d86ab3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 张先森、</span></div></div><div>老师，golang 单例模式适用于哪些场景？日志对象是否需要是单例？</div><div><p>作者回复：使用场景：只需要初始化一次， 程序中需要全局引用的对象。
日志对象，可以使用单例模式。</p></div><div><div>2021-09-08</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/2d/ab/ed/028ba234.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>🌱背对夕阳看黄昏🔱</span></div></div><div>老师 有关于 elk 对接的案例吗，这这几天在网上找相关案例都没有</div><div><div>2022-05-22</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center"><img class="sr-rd-content-img-load" src="https://thirdwx.qlogo.cn/mmopen/vi_32/rSzzqGwHcvhwPejiaPsCY9XBX7ib7zTxJ6cUDORdhGIakX8dTPVsz6ibud5ec1FeWQGTseF2TPRECCjky5JMlHvDg/132"></div></div><div><div><div><span>Struggle~honor</span></div></div><div>想请教下老师，大公司里面，我们的应用到部署在 K8s 上面，那么这些应用程序的日志应该怎样做持久化呢</div><div><p>作者回复：日志持久化可以试试 EFK 的解决方案。</p></div><div><div>2021-12-19</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>yandongxiao</span></div></div><div>总结：
1. 一个优秀的日志包应该具有哪些功能？分为基础功能、高级功能和可选功能。
2. 设计日志包时，需要关注高性能和并发安全等。
3. 作为日志包的使用者，如何有效地记录日志？在何处打印日志？
  1. 在分支处打印日志
  2. 在写操作处打印日志
  3. 在 for 循环外打印总结性日志
  4. 在错误发生的原始位置打印日志。</div><div><div>2021-11-27</div><div><div><i></i><span></span></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>疯琴</span></div></div><div>感觉 ELK 组件的资源消耗和 es 强大的全文索引能力对于单纯的日志应用有些重了，大公司有充足的硬件资源和技术团队运维 ELK 组件倒是用起来比较省事，还可以考虑 loki。</div><div><p>作者回复：是这样的的。方案需要根据实际情况来制定。</p></div><div><div>2021-10-22</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1s"><outline class="toc-level-h1" data-reactid=".1s.0" style="width: 175px;"><active data-reactid=".1s.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1s.0.1"><span data-reactid=".1s.0.1.0">20 | 日志处理（上）：如何设计日志包并记录日志？</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.1" style="width: 165px;"><active data-reactid=".1s.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1s.1.1"><span data-reactid=".1s.1.1.0">如何设计日志包</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.2" style="width: 155px;"><active data-reactid=".1s.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1s.2.1"><span data-reactid=".1s.2.1.0">基础功能</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.3" style="width: 155px;"><active data-reactid=".1s.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1s.3.1"><span data-reactid=".1s.3.1.0">高级功能</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.4" style="width: 155px;"><active data-reactid=".1s.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".1s.4.1"><span data-reactid=".1s.4.1.0">可选功能</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.5" style="width: 155px;"><active data-reactid=".1s.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1s.5.1"><span data-reactid=".1s.5.1.0">设计日志包时需要关注的点</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.6" style="width: 165px;"><active data-reactid=".1s.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1s.6.1"><span data-reactid=".1s.6.1.0">如何记录日志？</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.7" style="width: 155px;"><active data-reactid=".1s.7.0"></active><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1s.7.1"><span data-reactid=".1s.7.1.0">在何处打印日志？</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.8" style="width: 155px;"><active data-reactid=".1s.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1s.8.1"><span data-reactid=".1s.8.1.0">在哪个日志级别打印日志？</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.9" style="width: 155px;"><active data-reactid=".1s.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1s.9.1"><span data-reactid=".1s.9.1.0">如何记录日志内容？</span></a></outline><outline class="toc-level-h3" data-reactid=".1s.a" style="width: 155px;"><active data-reactid=".1s.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".1s.a.1"><span data-reactid=".1s.a.1.0">记录日志的 “最佳” 实践总结</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.b" style="width: 165px;"><active data-reactid=".1s.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".1s.b.1"><span data-reactid=".1s.b.1.0">拓展内容：分布式日志解决方案（EFK/ELK）</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.c" style="width: 165px;"><active data-reactid=".1s.c.0"></active><a class="toc-outline-theme-github" href="#sr-toc-12" data-reactid=".1s.c.1"><span data-reactid=".1s.c.1.0">总结</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.d" style="width: 165px;"><active data-reactid=".1s.d.0"></active><a class="toc-outline-theme-github" href="#sr-toc-13" data-reactid=".1s.d.1"><span data-reactid=".1s.d.1.0">课后练习</span></a></outline><outline class="toc-level-h2" data-reactid=".1s.e" style="width: 165px;"><active data-reactid=".1s.e.0"></active><a class="toc-outline-theme-github" href="#sr-toc-14" data-reactid=".1s.e.1"><span data-reactid=".1s.e.1.0">精选留言 (13)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/393905" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>