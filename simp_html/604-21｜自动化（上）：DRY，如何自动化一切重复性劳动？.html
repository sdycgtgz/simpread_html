
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 21｜自动化（上）：DRY，如何自动化一切重复性劳动？</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>21｜自动化（上）：DRY，如何自动化一切重复性劳动？</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">细节和生态是 Gin 如此成功核心原因。</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0">21｜自动化（上）：DRY，如何自动化一切重复性劳动？</h1><div><span>叶剑峰</span> <span> 2021-11-03</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/9b/e7/9b45ea68d794a8504ae35807243a7ce7.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：叶剑峰</span><span>大小：16.61M</span><span> 时长：18:11</span></div></div><audio title="21｜自动化（上）：DRY，如何自动化一切重复性劳动？" src="https://res001.geekbang.org/media/audio/8a/e5/8a6ba2c895ae06e904365aca534f12e5/ld/ld.m3u8" __idm_id__="704528"></audio></div><div><div><div><div data-slate-editor="true" data-key="13606" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="13607"><span data-slate-object="text" data-key="13608"><span data-slate-leaf="true" data-offset-key="13608:0" data-first-offset="true"><span data-slate-string="true">你好，我是轩脉刃。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13609"><span data-slate-object="text" data-key="13610"><span data-slate-leaf="true" data-offset-key="13610:0" data-first-offset="true"><span data-slate-string="true">不知道你有没有听过这种说法，优秀程序员应该有三大美德：懒惰、急躁和傲慢，这句话是 Perl 语言的发明者 Larry Wall 说的。其中懒惰这一点指的就是，程序员为了懒惰，不重复做同样的事情，会思考是否能把一切重复性的劳动自动化（don’t repeat yourself）。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13611"><span data-slate-object="text" data-key="13612"><span data-slate-leaf="true" data-offset-key="13612:0" data-first-offset="true"><span data-slate-string="true">而框架开发到这里，我们也需要思考，有哪些重复性劳动可以自动化么？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13613"><span data-slate-object="text" data-key="13614"><span data-slate-leaf="true" data-offset-key="13614:0" data-first-offset="true"><span data-slate-string="true">从第十章到现在我们一直在说，框架核心是服务提供者，在开发具体应用时，一定会有很多需求要创建各种各样的服务，毕竟 “一切皆服务”；而每次创建服务的时候，我们都需要至少编写三个文件，服务接口、服务提供者、服务实例。</span></span></span><span data-slate-object="text" data-key="13615"><span data-slate-leaf="true" data-offset-key="13615:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">如果能自动生成三个文件，提供一个 “自动化创建服务的工具”，应该能节省不少的操作</span></span></span></span><span data-slate-object="text" data-key="13616"><span data-slate-leaf="true" data-offset-key="13616:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13617"><span data-slate-object="text" data-key="13618"><span data-slate-leaf="true" data-offset-key="13618:0" data-first-offset="true"><span data-slate-string="true">说到创建工具，我们经常需要为了一个事情而创建一个命令行工具，而每次创建命令行工具，也都需要创建固定的 Command.go 文件，其中有固定的 Command 结构，这些代码我们能不能偷个懒，“</span></span></span><span data-slate-object="text" data-key="13619"><span data-slate-leaf="true" data-offset-key="13619:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">自动化创建命令行工具</span></span></span></span><span data-slate-object="text" data-key="13620"><span data-slate-leaf="true" data-offset-key="13620:0" data-first-offset="true"><span data-slate-string="true">” 呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13621"><span data-slate-object="text" data-key="13622"><span data-slate-leaf="true" data-offset-key="13622:0" data-first-offset="true"><span data-slate-string="true">另外之前我们做过几次中间件的迁移，先将源码拷贝复制，再修改对应的 Gin 路径，这个操作也是颇为繁琐的。那么，我们是否可以写一个 “</span></span></span><span data-slate-object="text" data-key="13623"><span data-slate-leaf="true" data-offset-key="13623:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">自动化中间件迁移工具</span></span></span></span><span data-slate-object="text" data-key="13624"><span data-slate-leaf="true" data-offset-key="13624:0" data-first-offset="true"><span data-slate-string="true">”，一个命令自动复制和替换呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13625"><span data-slate-object="text" data-key="13626"><span data-slate-leaf="true" data-offset-key="13626:0" data-first-offset="true"><span data-slate-string="true">这些命令都是可以实现的，这节课我们就来尝试完成这三项自动化，“自动化创建服务工具”， “自动化创建命令行工具”，以及 “自动化中间件迁移工具”。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="13627" id="sr-toc-1"><span data-slate-object="text" data-key="13628"><span data-slate-leaf="true" data-offset-key="13628:0" data-first-offset="true"><span data-slate-string="true">自动化创建服务工具</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="13629"><span data-slate-object="text" data-key="13630"><span data-slate-leaf="true" data-offset-key="13630:0" data-first-offset="true"><span data-slate-string="true">在创建各种各样的服务时，“自动化创建服务工具” 能帮我们节省不少开发时间。我们先思考下这个工具应该如何实现。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13631"><span data-slate-object="text" data-key="13632"><span data-slate-leaf="true" data-offset-key="13632:0" data-first-offset="true"><span data-slate-string="true">既然之前已经引入 cobra，将框架修改为可以支持命令行工具，创建命令并不是一个难事，我们来定义一套创建服务的 provider 命令即可。照旧先设计好要创建的命令，再一一实现。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="13633" id="sr-toc-2"><span data-slate-object="text" data-key="13634"><span data-slate-leaf="true" data-offset-key="13634:0" data-first-offset="true"><span data-slate-string="true">命令创建</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="13635"><span data-slate-object="text" data-key="13636"><span data-slate-leaf="true" data-offset-key="13636:0" data-first-offset="true"><span data-slate-string="true">“自动化创建服务工具” 如何设计命令层级呢？我们设计一个一级命令和两个二级命令：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="13637"><div data-slate-type="list-line" data-slate-object="block" data-key="13638"><span data-slate-type="code" data-slate-object="inline" data-key="13639"><span data-slate-object="text" data-key="13640"><span data-slate-leaf="true" data-offset-key="13640:0" data-first-offset="true"><span data-slate-string="true">./hade provider</span></span></span></span><span data-slate-object="text" data-key="13641"><span data-slate-leaf="true" data-offset-key="13641:0" data-first-offset="true"><span data-slate-string="true"> 一级命令，provider，打印帮助信息；</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="13642"><span data-slate-type="code" data-slate-object="inline" data-key="13643"><span data-slate-object="text" data-key="13644"><span data-slate-leaf="true" data-offset-key="13644:0" data-first-offset="true"><span data-slate-string="true">./hade provider new</span></span></span></span><span data-slate-object="text" data-key="13645"><span data-slate-leaf="true" data-offset-key="13645:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，创建一个服务；</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="13646"><span data-slate-type="code" data-slate-object="inline" data-key="13647"><span data-slate-object="text" data-key="13648"><span data-slate-leaf="true" data-offset-key="13648:0" data-first-offset="true"><span data-slate-string="true">./hade provider list</span></span></span></span><span data-slate-object="text" data-key="13649"><span data-slate-leaf="true" data-offset-key="13649:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，列出容器内的所有服务，列出它们的字符串凭证。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13650"><span data-slate-object="text" data-key="13651"><span data-slate-leaf="true" data-offset-key="13651:0" data-first-offset="true"><span data-slate-string="true">首先将 provider 的这两个二级命令，都存放在 command/provider.go 中。而对应的一级命令 providerCommand 是一个打印帮助信息的空实现。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13652"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13653"><span data-slate-object="text" data-key="13654"><span data-slate-leaf="true" data-offset-key="13654:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//providerCommand 一级命令</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13655"><span data-slate-object="text" data-key="13656"><span data-slate-leaf="true" data-offset-key="13656:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="13657"><span data-slate-leaf="true" data-offset-key="13657:0" data-first-offset="true"><span data-slate-string="true"> providerCommand = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13658"><span data-slate-object="text" data-key="13659"><span data-slate-leaf="true" data-offset-key="13659:0" data-first-offset="true"><span data-slate-string="true">   Use:   </span></span></span><span data-slate-object="text" data-key="13660"><span data-slate-leaf="true" data-offset-key="13660:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"provider"</span></span></span></span><span data-slate-object="text" data-key="13661"><span data-slate-leaf="true" data-offset-key="13661:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13662"><span data-slate-object="text" data-key="13663"><span data-slate-leaf="true" data-offset-key="13663:0" data-first-offset="true"><span data-slate-string="true">   Short: </span></span></span><span data-slate-object="text" data-key="13664"><span data-slate-leaf="true" data-offset-key="13664:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"服务提供相关命令"</span></span></span></span><span data-slate-object="text" data-key="13665"><span data-slate-leaf="true" data-offset-key="13665:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13666"><span data-slate-object="text" data-key="13667"><span data-slate-leaf="true" data-offset-key="13667:0" data-first-offset="true"><span data-slate-string="true">   RunE: </span></span></span><span data-slate-object="text" data-key="13668"><span data-slate-leaf="true" data-offset-key="13668:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="13669"><span data-slate-leaf="true" data-offset-key="13669:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *cobra.Command, args []</span></span></span></span></span><span data-slate-object="text" data-key="13670"><span data-slate-leaf="true" data-offset-key="13670:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="13671"><span data-slate-leaf="true" data-offset-key="13671:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="13672"><span data-slate-leaf="true" data-offset-key="13672:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="13673"><span data-slate-leaf="true" data-offset-key="13673:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="13674"><span data-slate-leaf="true" data-offset-key="13674:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13675"><span data-slate-object="text" data-key="13676"><span data-slate-leaf="true" data-offset-key="13676:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13677"><span data-slate-leaf="true" data-offset-key="13677:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="13678"><span data-slate-leaf="true" data-offset-key="13678:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="13679"><span data-slate-leaf="true" data-offset-key="13679:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="13680"><span data-slate-leaf="true" data-offset-key="13680:0" data-first-offset="true"><span data-slate-string="true">(args) == </span></span></span><span data-slate-object="text" data-key="13681"><span data-slate-leaf="true" data-offset-key="13681:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="13682"><span data-slate-leaf="true" data-offset-key="13682:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13683"><span data-slate-object="text" data-key="13684"><span data-slate-leaf="true" data-offset-key="13684:0" data-first-offset="true"><span data-slate-string="true">         c.Help()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13685"><span data-slate-object="text" data-key="13686"><span data-slate-leaf="true" data-offset-key="13686:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13687"><span data-slate-object="text" data-key="13688"><span data-slate-leaf="true" data-offset-key="13688:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13689"><span data-slate-leaf="true" data-offset-key="13689:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13690"><span data-slate-leaf="true" data-offset-key="13690:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="13691"><span data-slate-leaf="true" data-offset-key="13691:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13692"><span data-slate-object="text" data-key="13693"><span data-slate-leaf="true" data-offset-key="13693:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13694"><span data-slate-object="text" data-key="13695"><span data-slate-leaf="true" data-offset-key="13695:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13696"><span data-slate-object="text" data-key="13697"><span data-slate-leaf="true" data-offset-key="13697:0" data-first-offset="true"><span data-slate-string="true">预先将两个二级命令挂载到这个一级命令中，在 framework/command/provider.go：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13698"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13699"><span data-slate-object="text" data-key="13700"><span data-slate-leaf="true" data-offset-key="13700:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 初始化 provider 相关服务</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13701"><span data-slate-object="text" data-key="13702"><span data-slate-leaf="true" data-offset-key="13702:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="13703"><span data-slate-leaf="true" data-offset-key="13703:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="13704"><span data-slate-leaf="true" data-offset-key="13704:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">initProviderCommand</span></span></span></span></span><span data-slate-object="text" data-key="13705"><span data-slate-leaf="true" data-offset-key="13705:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="13706"><span data-slate-leaf="true" data-offset-key="13706:0" data-first-offset="true"><span data-slate-string="true"> *cobra.Command {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13707"><span data-slate-object="text" data-key="13708"><span data-slate-leaf="true" data-offset-key="13708:0" data-first-offset="true"><span data-slate-string="true">   providerCommand.AddCommand(providerCreateCommand)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13709"><span data-slate-object="text" data-key="13710"><span data-slate-leaf="true" data-offset-key="13710:0" data-first-offset="true"><span data-slate-string="true">   providerCommand.AddCommand(providerListCommand)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13711"><span data-slate-object="text" data-key="13712"><span data-slate-leaf="true" data-offset-key="13712:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13713"><span data-slate-leaf="true" data-offset-key="13713:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13714"><span data-slate-leaf="true" data-offset-key="13714:0" data-first-offset="true"><span data-slate-string="true"> providerCommand</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13715"><span data-slate-object="text" data-key="13716"><span data-slate-leaf="true" data-offset-key="13716:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13717"><span data-slate-object="text" data-key="13718"><span data-slate-leaf="true" data-offset-key="13718:0" data-first-offset="true"><span data-slate-string="true">并且在 framework/command/kernel.go，将这个一级命令挂载到一级命令 rootCommand 中：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13719"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13720"><span data-slate-object="text" data-key="13721"><span data-slate-leaf="true" data-offset-key="13721:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="13722"><span data-slate-leaf="true" data-offset-key="13722:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="13723"><span data-slate-leaf="true" data-offset-key="13723:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">AddKernelCommands</span></span></span></span></span><span data-slate-object="text" data-key="13724"><span data-slate-leaf="true" data-offset-key="13724:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(root *cobra.Command)</span></span></span></span></span><span data-slate-object="text" data-key="13725"><span data-slate-leaf="true" data-offset-key="13725:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13726"><span data-slate-object="text" data-key="13727"><span data-slate-leaf="true" data-offset-key="13727:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13728"><span data-slate-leaf="true" data-offset-key="13728:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//provider 一级命令</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13729"><span data-slate-object="text" data-key="13730"><span data-slate-leaf="true" data-offset-key="13730:0" data-first-offset="true"><span data-slate-string="true">   root.AddCommand(initProviderCommand()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13731"><span data-slate-object="text" data-key="13732"><span data-slate-leaf="true" data-offset-key="13732:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13733"><span data-slate-object="text" data-key="13734"><span data-slate-leaf="true" data-offset-key="13734:0" data-first-offset="true"><span data-slate-string="true">下面来实现这两个二级命令 new 和 list。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="13735" id="sr-toc-3"><span data-slate-object="text" data-key="13736"><span data-slate-leaf="true" data-offset-key="13736:0" data-first-offset="true"><span data-slate-string="true">List 命令的实现</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="13737"><span data-slate-object="text" data-key="13738"><span data-slate-leaf="true" data-offset-key="13738:0" data-first-offset="true"><span data-slate-string="true">先说  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="13739"><span data-slate-object="text" data-key="13740"><span data-slate-leaf="true" data-offset-key="13740:0" data-first-offset="true"><span data-slate-string="true">./hade provider list</span></span></span></span><span data-slate-object="text" data-key="13741"><span data-slate-leaf="true" data-offset-key="13741:0" data-first-offset="true"><span data-slate-string="true"> 这个命令，因为列出容器内的所有服务是比较简单的。还记得吗，在十一章实现服务容器的时候，其中有一个 providers，它存储所有的服务容器提供者，放在文件 framework/container.go 中：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13742"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13743"><span data-slate-object="text" data-key="13744"><span data-slate-leaf="true" data-offset-key="13744:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// HadeContainer 是服务容器的具体实现</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13745"><span data-slate-object="text" data-key="13746"><span data-slate-leaf="true" data-offset-key="13746:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="13747"><span data-slate-leaf="true" data-offset-key="13747:0" data-first-offset="true"><span data-slate-string="true"> HadeContainer </span></span></span><span data-slate-object="text" data-key="13748"><span data-slate-leaf="true" data-offset-key="13748:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="13749"><span data-slate-leaf="true" data-offset-key="13749:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13750"><span data-slate-object="text" data-key="13751"><span data-slate-leaf="true" data-offset-key="13751:0" data-first-offset="true"><span data-slate-string="true">  ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13752"><span data-slate-object="text" data-key="13753"><span data-slate-leaf="true" data-offset-key="13753:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="13754"><span data-slate-leaf="true" data-offset-key="13754:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//providers 存储注册的服务提供者，key 为字符串凭证</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13755"><span data-slate-object="text" data-key="13756"><span data-slate-leaf="true" data-offset-key="13756:0" data-first-offset="true"><span data-slate-string="true">  providers </span></span></span><span data-slate-object="text" data-key="13757"><span data-slate-leaf="true" data-offset-key="13757:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">map</span></span></span></span><span data-slate-object="text" data-key="13758"><span data-slate-leaf="true" data-offset-key="13758:0" data-first-offset="true"><span data-slate-string="true">[</span></span></span><span data-slate-object="text" data-key="13759"><span data-slate-leaf="true" data-offset-key="13759:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="13760"><span data-slate-leaf="true" data-offset-key="13760:0" data-first-offset="true"><span data-slate-string="true">]ServiceProvider</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13761"><span data-slate-object="text" data-key="13762"><span data-slate-leaf="true" data-offset-key="13762:0" data-first-offset="true"><span data-slate-string="true">    ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13763"><span data-slate-object="text" data-key="13764"><span data-slate-leaf="true" data-offset-key="13764:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13765"><span data-slate-object="text" data-key="13766"><span data-slate-leaf="true" data-offset-key="13766:0" data-first-offset="true"><span data-slate-string="true">我们只需要将这个 providers 进行遍历，根据其中每个 ServiceProvider 的 Name () 方法，获取字符串凭证列表即可。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13767"><span data-slate-object="text" data-key="13768"><span data-slate-leaf="true" data-offset-key="13768:0" data-first-offset="true"><span data-slate-string="true">所以，在 framework/container.go 的 HadeContainer 中，增加一个 NameList 方法，返回所有提供服务者的字符串凭证，方法也很简单，直接遍历这个 providers 字段。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13769"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13770"><span data-slate-object="text" data-key="13771"><span data-slate-leaf="true" data-offset-key="13771:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// NameList 列出容器中所有服务提供者的字符串凭证</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13772"><span data-slate-object="text" data-key="13773"><span data-slate-leaf="true" data-offset-key="13773:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="13774"><span data-slate-leaf="true" data-offset-key="13774:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="13775"><span data-slate-leaf="true" data-offset-key="13775:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(hade *HadeContainer)</span></span></span></span></span><span data-slate-object="text" data-key="13776"><span data-slate-leaf="true" data-offset-key="13776:0" data-first-offset="true"><span data-slate-string="true"> NameList() []</span></span></span><span data-slate-object="text" data-key="13777"><span data-slate-leaf="true" data-offset-key="13777:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="13778"><span data-slate-leaf="true" data-offset-key="13778:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13779"><span data-slate-object="text" data-key="13780"><span data-slate-leaf="true" data-offset-key="13780:0" data-first-offset="true"><span data-slate-string="true">   ret := []</span></span></span><span data-slate-object="text" data-key="13781"><span data-slate-leaf="true" data-offset-key="13781:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="13782"><span data-slate-leaf="true" data-offset-key="13782:0" data-first-offset="true"><span data-slate-string="true">{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13783"><span data-slate-object="text" data-key="13784"><span data-slate-leaf="true" data-offset-key="13784:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13785"><span data-slate-leaf="true" data-offset-key="13785:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="13786"><span data-slate-leaf="true" data-offset-key="13786:0" data-first-offset="true"><span data-slate-string="true"> _, provider := </span></span></span><span data-slate-object="text" data-key="13787"><span data-slate-leaf="true" data-offset-key="13787:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">range</span></span></span></span><span data-slate-object="text" data-key="13788"><span data-slate-leaf="true" data-offset-key="13788:0" data-first-offset="true"><span data-slate-string="true"> hade.providers {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13789"><span data-slate-object="text" data-key="13790"><span data-slate-leaf="true" data-offset-key="13790:0" data-first-offset="true"><span data-slate-string="true">      name := provider.Name()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13791"><span data-slate-object="text" data-key="13792"><span data-slate-leaf="true" data-offset-key="13792:0" data-first-offset="true"><span data-slate-string="true">      ret = </span></span></span><span data-slate-object="text" data-key="13793"><span data-slate-leaf="true" data-offset-key="13793:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">append</span></span></span></span><span data-slate-object="text" data-key="13794"><span data-slate-leaf="true" data-offset-key="13794:0" data-first-offset="true"><span data-slate-string="true">(ret, name)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13795"><span data-slate-object="text" data-key="13796"><span data-slate-leaf="true" data-offset-key="13796:0" data-first-offset="true"><span data-slate-string="true">   }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13797"><span data-slate-object="text" data-key="13798"><span data-slate-leaf="true" data-offset-key="13798:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13799"><span data-slate-leaf="true" data-offset-key="13799:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13800"><span data-slate-leaf="true" data-offset-key="13800:0" data-first-offset="true"><span data-slate-string="true"> ret</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13801"><span data-slate-object="text" data-key="13802"><span data-slate-leaf="true" data-offset-key="13802:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13803"><span data-slate-object="text" data-key="13804"><span data-slate-leaf="true" data-offset-key="13804:0" data-first-offset="true"><span data-slate-string="true">而在 framework/command/provider.go 中的 providerListCommand 命令中，我们调用这个命令并且打印出来。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13805"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13806"><span data-slate-object="text" data-key="13807"><span data-slate-leaf="true" data-offset-key="13807:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//providerListCommand 列出容器内的所有服务</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13808"><span data-slate-object="text" data-key="13809"><span data-slate-leaf="true" data-offset-key="13809:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="13810"><span data-slate-leaf="true" data-offset-key="13810:0" data-first-offset="true"><span data-slate-string="true"> providerListCommand = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13811"><span data-slate-object="text" data-key="13812"><span data-slate-leaf="true" data-offset-key="13812:0" data-first-offset="true"><span data-slate-string="true">   Use:   </span></span></span><span data-slate-object="text" data-key="13813"><span data-slate-leaf="true" data-offset-key="13813:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"list"</span></span></span></span><span data-slate-object="text" data-key="13814"><span data-slate-leaf="true" data-offset-key="13814:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13815"><span data-slate-object="text" data-key="13816"><span data-slate-leaf="true" data-offset-key="13816:0" data-first-offset="true"><span data-slate-string="true">   Short: </span></span></span><span data-slate-object="text" data-key="13817"><span data-slate-leaf="true" data-offset-key="13817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"列出容器内的所有服务"</span></span></span></span><span data-slate-object="text" data-key="13818"><span data-slate-leaf="true" data-offset-key="13818:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13819"><span data-slate-object="text" data-key="13820"><span data-slate-leaf="true" data-offset-key="13820:0" data-first-offset="true"><span data-slate-string="true">   RunE: </span></span></span><span data-slate-object="text" data-key="13821"><span data-slate-leaf="true" data-offset-key="13821:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="13822"><span data-slate-leaf="true" data-offset-key="13822:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *cobra.Command, args []</span></span></span></span></span><span data-slate-object="text" data-key="13823"><span data-slate-leaf="true" data-offset-key="13823:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="13824"><span data-slate-leaf="true" data-offset-key="13824:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="13825"><span data-slate-leaf="true" data-offset-key="13825:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="13826"><span data-slate-leaf="true" data-offset-key="13826:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="13827"><span data-slate-leaf="true" data-offset-key="13827:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13828"><span data-slate-object="text" data-key="13829"><span data-slate-leaf="true" data-offset-key="13829:0" data-first-offset="true"><span data-slate-string="true">      container := c.GetContainer()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13830"><span data-slate-object="text" data-key="13831"><span data-slate-leaf="true" data-offset-key="13831:0" data-first-offset="true"><span data-slate-string="true">      hadeContainer := container.(*framework.HadeContainer)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13832"><span data-slate-object="text" data-key="13833"><span data-slate-leaf="true" data-offset-key="13833:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13834"><span data-slate-leaf="true" data-offset-key="13834:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 获取字符串凭证</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13835"><span data-slate-object="text" data-key="13836"><span data-slate-leaf="true" data-offset-key="13836:0" data-first-offset="true"><span data-slate-string="true">      list := hadeContainer.NameList()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13837"><span data-slate-object="text" data-key="13838"><span data-slate-leaf="true" data-offset-key="13838:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13839"><span data-slate-leaf="true" data-offset-key="13839:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 打印</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13840"><span data-slate-object="text" data-key="13841"><span data-slate-leaf="true" data-offset-key="13841:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13842"><span data-slate-leaf="true" data-offset-key="13842:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="13843"><span data-slate-leaf="true" data-offset-key="13843:0" data-first-offset="true"><span data-slate-string="true"> _, line := </span></span></span><span data-slate-object="text" data-key="13844"><span data-slate-leaf="true" data-offset-key="13844:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">range</span></span></span></span><span data-slate-object="text" data-key="13845"><span data-slate-leaf="true" data-offset-key="13845:0" data-first-offset="true"><span data-slate-string="true"> list {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13846"><span data-slate-object="text" data-key="13847"><span data-slate-leaf="true" data-offset-key="13847:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="13848"><span data-slate-leaf="true" data-offset-key="13848:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">println</span></span></span></span><span data-slate-object="text" data-key="13849"><span data-slate-leaf="true" data-offset-key="13849:0" data-first-offset="true"><span data-slate-string="true">(line)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13850"><span data-slate-object="text" data-key="13851"><span data-slate-leaf="true" data-offset-key="13851:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13852"><span data-slate-object="text" data-key="13853"><span data-slate-leaf="true" data-offset-key="13853:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13854"><span data-slate-leaf="true" data-offset-key="13854:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13855"><span data-slate-leaf="true" data-offset-key="13855:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="13856"><span data-slate-leaf="true" data-offset-key="13856:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13857"><span data-slate-object="text" data-key="13858"><span data-slate-leaf="true" data-offset-key="13858:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13859"><span data-slate-object="text" data-key="13860"><span data-slate-leaf="true" data-offset-key="13860:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13861"><span data-slate-object="text" data-key="13862"><span data-slate-leaf="true" data-offset-key="13862:0" data-first-offset="true"><span data-slate-string="true">可以验证一下。编译  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="13863"><span data-slate-object="text" data-key="13864"><span data-slate-leaf="true" data-offset-key="13864:0" data-first-offset="true"><span data-slate-string="true">./hade build self</span></span></span></span><span data-slate-object="text" data-key="13865"><span data-slate-leaf="true" data-offset-key="13865:0" data-first-offset="true"><span data-slate-string="true"> 并且执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="13866"><span data-slate-object="text" data-key="13867"><span data-slate-leaf="true" data-offset-key="13867:0" data-first-offset="true"><span data-slate-string="true">./hade provider list</span></span></span></span><span data-slate-object="text" data-key="13868"><span data-slate-leaf="true" data-offset-key="13868:0" data-first-offset="true"><span data-slate-string="true"> ，可以看到如下信息：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="13869"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/0c/35/0c4d1fb73cd17aabc02fe7c3b5f2f335.png?wh=481x215"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13870"><span data-slate-object="text" data-key="13871"><span data-slate-leaf="true" data-offset-key="13871:0" data-first-offset="true"><span data-slate-string="true">你可以很清晰看到容器中绑定了哪些服务提供者，它们的字符串凭证是什么。这样我们在定义一个新的服务的时候，可以很方便看到哪些服务提供者的关键字已经被使用了，避免使用已有的服务关键字。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13872"><span data-slate-object="text" data-key="13873"><span data-slate-leaf="true" data-offset-key="13873:0" data-first-offset="true"><span data-slate-string="true">下面我们来说稍微复杂一点的创建服务的命令  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="13874"><span data-slate-object="text" data-key="13875"><span data-slate-leaf="true" data-offset-key="13875:0" data-first-offset="true"><span data-slate-string="true">./hade provider new</span></span></span></span><span data-slate-object="text" data-key="13876"><span data-slate-leaf="true" data-offset-key="13876:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="13877" id="sr-toc-4"><span data-slate-object="text" data-key="13878"><span data-slate-leaf="true" data-offset-key="13878:0" data-first-offset="true"><span data-slate-string="true">new 命令的实现</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="13879"><span data-slate-object="text" data-key="13880"><span data-slate-leaf="true" data-offset-key="13880:0" data-first-offset="true"><span data-slate-string="true">在实际业务开发过程中，我们一想到一个服务，比如去某个用户系统获取信息，一定会想到创建服务的三步骤：创建一个用户系统的交互协议 contract.go、再创建一个提供协议的用户服务提供者 provider.go、最后才实现具体的用户服务实例 service.go。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13881"><span data-slate-object="text" data-key="13882"><span data-slate-leaf="true" data-offset-key="13882:0" data-first-offset="true"><span data-slate-string="true">每次都需要创建这三个文件，且这三个文件的文件大框架都有套路可言。那我们如何将这些重复的套路性的代码自动化生成呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13883"><span data-slate-object="text" data-key="13884"><span data-slate-leaf="true" data-offset-key="13884:0" data-first-offset="true"><span data-slate-string="true">首先这里有一个增加参数的过程，我们需要知道要创建服务的服务名是什么？创建这个服务的文件夹名字是什么？当然了，这些参数也可以使用在命令后面增加 flag 参数的方式来表示。但是其实还有一种更便捷的方式：交互。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13885"><span data-slate-object="text" data-key="13886"><span data-slate-leaf="true" data-offset-key="13886:0" data-first-offset="true"><span data-slate-string="true">交互的表现形式如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13887"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13888"><span data-slate-object="text" data-key="13889"><span data-slate-leaf="true" data-offset-key="13889:0" data-first-offset="true"><span data-slate-string="true">输入：./hade provider </span></span></span><span data-slate-object="text" data-key="13890"><span data-slate-leaf="true" data-offset-key="13890:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">new</span></span></span></span><span data-slate-object="text" data-key="13891"><span data-slate-leaf="true" data-offset-key="13891:0" data-first-offset="true"><span data-slate-string="true"> (我想创建一个服务)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13892"><span data-slate-object="text" data-key="13893"><span data-slate-leaf="true" data-offset-key="13893:0" data-first-offset="true"><span data-slate-string="true">输出：请输入服务名称 (服务凭证):</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13894"><span data-slate-object="text" data-key="13895"><span data-slate-leaf="true" data-offset-key="13895:0" data-first-offset="true"><span data-slate-string="true">输入：demo</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13896"><span data-slate-object="text" data-key="13897"><span data-slate-leaf="true" data-offset-key="13897:0" data-first-offset="true"><span data-slate-string="true">输出：请求输入服务目录名称 (默认和服务名称相同)：</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13898"><span data-slate-object="text" data-key="13899"><span data-slate-leaf="true" data-offset-key="13899:0" data-first-offset="true"><span data-slate-string="true">输入：demo</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13900"><span data-slate-object="text" data-key="13901"><span data-slate-leaf="true" data-offset-key="13901:0" data-first-offset="true"><span data-slate-string="true">输出：创建服务成功，文件夹地址：xxxxx</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13902"><span data-slate-object="text" data-key="13903"><span data-slate-leaf="true" data-offset-key="13903:0" data-first-offset="true"><span data-slate-string="true">输出：请不要忘记挂载新创建的服务</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13904"><span data-slate-object="text" data-key="13905"><span data-slate-leaf="true" data-offset-key="13905:0" data-first-offset="true"><span data-slate-string="true">这种命令行交互的方式是不是更智能化？但是如何实现呢？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13906"><span data-slate-object="text" data-key="13907"><span data-slate-leaf="true" data-offset-key="13907:0" data-first-offset="true"><span data-slate-string="true">这里我们借助一个第三方库 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="13908"><span data-slate-object="text" data-key="13909"><span data-slate-leaf="true" data-offset-key="13909:0" data-first-offset="true"><span data-slate-string="true">survey</span></span></span></a><span data-slate-object="text" data-key="13910"><span data-slate-leaf="true" data-offset-key="13910:0" data-first-offset="true"><span data-slate-string="true">。这个库目前在 GitHub 上已经有 2.7k 个 star，最新版本是 v2 版本，使用的是 MIT License 协议，可以放心使用。这个 survey 库支持多种交互模式：单行输入、多行输入、单选、多选、y/n 确认选择，在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="13911"><span data-slate-object="text" data-key="13912"><span data-slate-leaf="true" data-offset-key="13912:0" data-first-offset="true"><span data-slate-string="true">项目 GitHub 首页</span></span></span></a><span data-slate-object="text" data-key="13913"><span data-slate-leaf="true" data-offset-key="13913:0" data-first-offset="true"><span data-slate-string="true">上就能很清晰看到这个库的使用方式。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13914"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13915"><span data-slate-object="text" data-key="13916"><span data-slate-leaf="true" data-offset-key="13916:0" data-first-offset="true"><span data-slate-string="true">name := </span></span></span><span data-slate-object="text" data-key="13917"><span data-slate-leaf="true" data-offset-key="13917:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">false</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13918"><span data-slate-object="text" data-key="13919"><span data-slate-leaf="true" data-offset-key="13919:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 使用 survey.XXX 的方式来选择交互形式</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13920"><span data-slate-object="text" data-key="13921"><span data-slate-leaf="true" data-offset-key="13921:0" data-first-offset="true"><span data-slate-string="true">prompt := &amp;survey.Confirm{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13922"><span data-slate-object="text" data-key="13923"><span data-slate-leaf="true" data-offset-key="13923:0" data-first-offset="true"><span data-slate-string="true">    Message: </span></span></span><span data-slate-object="text" data-key="13924"><span data-slate-leaf="true" data-offset-key="13924:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Do you like pie?"</span></span></span></span><span data-slate-object="text" data-key="13925"><span data-slate-leaf="true" data-offset-key="13925:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13926"><span data-slate-object="text" data-key="13927"><span data-slate-leaf="true" data-offset-key="13927:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13928"><span data-slate-object="text" data-key="13929"><span data-slate-leaf="true" data-offset-key="13929:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 使用 &amp; 将最终的选择存储进入变量</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13930"><span data-slate-object="text" data-key="13931"><span data-slate-leaf="true" data-offset-key="13931:0" data-first-offset="true"><span data-slate-string="true">survey.AskOne(prompt, &amp;name)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13932"><span data-slate-object="text" data-key="13933"><span data-slate-leaf="true" data-offset-key="13933:0" data-first-offset="true"><span data-slate-string="true">在 provider new 命令中，我们也可以用 survey 来增加交互性。通过交互，我们可以确认用户想创建的服务凭证，以及想把这个服务创建在 app/provider/ 下的哪个目录中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13934"><span data-slate-object="text" data-key="13935"><span data-slate-leaf="true" data-offset-key="13935:0" data-first-offset="true"><span data-slate-string="true">当然，</span></span></span><span data-slate-object="text" data-key="13936"><span data-slate-leaf="true" data-offset-key="13936:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">在用户通过交互输入了服务凭证和服务目录之后，是需要进行参数判断的</span></span></span></span><span data-slate-object="text" data-key="13937"><span data-slate-leaf="true" data-offset-key="13937:0" data-first-offset="true"><span data-slate-string="true">。服务凭证需要和容器中已注册服务的字符串凭证进行比较，如果已经存在了，应该报错；而服务目录如果已经存在，也应该直接报错。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13938"><span data-slate-object="text" data-key="13939"><span data-slate-leaf="true" data-offset-key="13939:0" data-first-offset="true"><span data-slate-string="true">如果都验证 ok 了，最后一步就是在 app/provider/ 下创建对应的服务目录，在目录下创建 contract.go、provider.go、service.go 三个文件，并且在三个文件中根据预先定义好的模版填充内容。这里我们如何实现呢？使用模版、变更模版中的某些字段、形成新的文本，这个你应该能联想到 Golang 标准库中的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="13940"><span data-slate-object="text" data-key="13941"><span data-slate-leaf="true" data-offset-key="13941:0" data-first-offset="true"><span data-slate-string="true">text/template</span></span></span></a><span data-slate-object="text" data-key="13942"><span data-slate-leaf="true" data-offset-key="13942:0" data-first-offset="true"><span data-slate-string="true"> 库。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13943"><span data-slate-object="text" data-key="13944"><span data-slate-leaf="true" data-offset-key="13944:0" data-first-offset="true"><span data-slate-string="true">这个库的使用方法比较多，我这里把我们用得到的方法解说一下，解析 contract.go 文件的生成过程，就可以了解其使用方法了。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="13945"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="13946"><span data-slate-object="text" data-key="13947"><span data-slate-leaf="true" data-offset-key="13947:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 创建 title 这个模版方法</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13948"><span data-slate-object="text" data-key="13949"><span data-slate-leaf="true" data-offset-key="13949:0" data-first-offset="true"><span data-slate-string="true">funcs := template.FuncMap{</span></span></span><span data-slate-object="text" data-key="13950"><span data-slate-leaf="true" data-offset-key="13950:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"title"</span></span></span></span><span data-slate-object="text" data-key="13951"><span data-slate-leaf="true" data-offset-key="13951:0" data-first-offset="true"><span data-slate-string="true">: strings.Title}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13952"><span data-slate-object="text" data-key="13953"><span data-slate-leaf="true" data-offset-key="13953:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13954"><span data-slate-object="text" data-key="13955"><span data-slate-leaf="true" data-offset-key="13955:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13956"><span data-slate-leaf="true" data-offset-key="13956:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//  创建 contract.go</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13957"><span data-slate-object="text" data-key="13958"><span data-slate-leaf="true" data-offset-key="13958:0" data-first-offset="true"><span data-slate-string="true">   file := filepath.Join(pFolder, folder, </span></span></span><span data-slate-object="text" data-key="13959"><span data-slate-leaf="true" data-offset-key="13959:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"contract.go"</span></span></span></span><span data-slate-object="text" data-key="13960"><span data-slate-leaf="true" data-offset-key="13960:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13961"><span data-slate-object="text" data-key="13962"><span data-slate-leaf="true" data-offset-key="13962:0" data-first-offset="true"><span data-slate-string="true">   f, err := os.Create(file)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13963"><span data-slate-object="text" data-key="13964"><span data-slate-leaf="true" data-offset-key="13964:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13965"><span data-slate-leaf="true" data-offset-key="13965:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="13966"><span data-slate-leaf="true" data-offset-key="13966:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="13967"><span data-slate-leaf="true" data-offset-key="13967:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="13968"><span data-slate-leaf="true" data-offset-key="13968:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13969"><span data-slate-object="text" data-key="13970"><span data-slate-leaf="true" data-offset-key="13970:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13971"><span data-slate-leaf="true" data-offset-key="13971:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13972"><span data-slate-leaf="true" data-offset-key="13972:0" data-first-offset="true"><span data-slate-string="true"> errors.Cause(err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13973"><span data-slate-object="text" data-key="13974"><span data-slate-leaf="true" data-offset-key="13974:0" data-first-offset="true"><span data-slate-string="true">   }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13975"><span data-slate-object="text" data-key="13976"><span data-slate-leaf="true" data-offset-key="13976:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13977"><span data-slate-leaf="true" data-offset-key="13977:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 使用 contractTmp 模版来初始化 template，并且让这个模版支持 title 方法，即支持 {{.|title}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13978"><span data-slate-object="text" data-key="13979"><span data-slate-leaf="true" data-offset-key="13979:0" data-first-offset="true"><span data-slate-string="true">   t := template.Must(template.New(</span></span></span><span data-slate-object="text" data-key="13980"><span data-slate-leaf="true" data-offset-key="13980:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"contract"</span></span></span></span><span data-slate-object="text" data-key="13981"><span data-slate-leaf="true" data-offset-key="13981:0" data-first-offset="true"><span data-slate-string="true">).Funcs(funcs).Parse(contractTmp))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13982"><span data-slate-object="text" data-key="13983"><span data-slate-leaf="true" data-offset-key="13983:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13984"><span data-slate-leaf="true" data-offset-key="13984:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 将 name 传递进入到 template 中渲染，并且输出到 contract.go 中</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13985"><span data-slate-object="text" data-key="13986"><span data-slate-leaf="true" data-offset-key="13986:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="13987"><span data-slate-leaf="true" data-offset-key="13987:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="13988"><span data-slate-leaf="true" data-offset-key="13988:0" data-first-offset="true"><span data-slate-string="true"> err := t.Execute(f, name); err != </span></span></span><span data-slate-object="text" data-key="13989"><span data-slate-leaf="true" data-offset-key="13989:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="13990"><span data-slate-leaf="true" data-offset-key="13990:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13991"><span data-slate-object="text" data-key="13992"><span data-slate-leaf="true" data-offset-key="13992:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="13993"><span data-slate-leaf="true" data-offset-key="13993:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="13994"><span data-slate-leaf="true" data-offset-key="13994:0" data-first-offset="true"><span data-slate-string="true"> errors.Cause(err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13995"><span data-slate-object="text" data-key="13996"><span data-slate-leaf="true" data-offset-key="13996:0" data-first-offset="true"><span data-slate-string="true">   }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="13997"><span data-slate-object="text" data-key="13998"><span data-slate-leaf="true" data-offset-key="13998:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="13999"><span data-slate-object="text" data-key="14000"><span data-slate-leaf="true" data-offset-key="14000:0" data-first-offset="true"><span data-slate-string="true">上面代码的逻辑最核心的就是创建模版的 template.Must 和渲染模版的 t.Execute 方法。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14001"><span data-slate-object="text" data-key="14002"><span data-slate-leaf="true" data-offset-key="14002:0" data-first-offset="true"><span data-slate-string="true">但是在创建模版之前，我们使用了一个 </span></span></span><span data-slate-object="text" data-key="14003"><span data-slate-leaf="true" data-offset-key="14003:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">template.FuncMap 方法，它比较不好理解，主要作用就是在模版中，让我们可以使用定义的模版方法来控制渲染效果</span></span></span></span><span data-slate-object="text" data-key="14004"><span data-slate-leaf="true" data-offset-key="14004:0" data-first-offset="true"><span data-slate-string="true">。这个 FuncMap 结构定义了模版中支持的模版方法，比如我支持 title 这个方法，这个方法实际调用的是 string.Title 函数，把字符串首字母大写。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14005"><span data-slate-object="text" data-key="14006"><span data-slate-leaf="true" data-offset-key="14006:0" data-first-offset="true"><span data-slate-string="true">在刚才的代码中，我们使用 contractTmp 来创建模版，在渲染 contractTmp 的时候，传递了一个 name 变量。假设这个 name 变量代表的是字符串 user，而我希望创建一个字符串 “NameKey” 的变量，可以这么定义 contractTmp：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14007"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14008"><span data-slate-object="text" data-key="14009"><span data-slate-leaf="true" data-offset-key="14009:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14010"><span data-slate-leaf="true" data-offset-key="14010:0" data-first-offset="true"><span data-slate-string="true"> contractTmp </span></span></span><span data-slate-object="text" data-key="14011"><span data-slate-leaf="true" data-offset-key="14011:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14012"><span data-slate-leaf="true" data-offset-key="14012:0" data-first-offset="true"><span data-slate-string="true"> = </span></span></span><span data-slate-object="text" data-key="14013"><span data-slate-leaf="true" data-offset-key="14013:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`package {{.}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14014"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14015"><span data-slate-object="text" data-key="14016"><span data-slate-leaf="true" data-offset-key="14016:0" data-first-offset="true"><span data-slate-string="true">const {{.|title}}Key = "{{.}}"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14017"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14018"><span data-slate-object="text" data-key="14019"><span data-slate-leaf="true" data-offset-key="14019:0" data-first-offset="true"><span data-slate-string="true">type Service interface {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14020"><span data-slate-object="text" data-key="14021"><span data-slate-leaf="true" data-offset-key="14021:0" data-first-offset="true"><span data-slate-string="true">   // 请在这里定义你的方法</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14022"><span data-slate-object="text" data-key="14023"><span data-slate-leaf="true" data-offset-key="14023:0" data-first-offset="true"><span data-slate-string="true">    Foo() string</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14024"><span data-slate-object="text" data-key="14025"><span data-slate-leaf="true" data-offset-key="14025:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14026"><span data-slate-object="text" data-key="14027"><span data-slate-leaf="true" data-offset-key="14027:0" data-first-offset="true"><span data-slate-string="true">`</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14028"><span data-slate-object="text" data-key="14029"><span data-slate-leaf="true" data-offset-key="14029:0" data-first-offset="true"><span data-slate-string="true">注意到了么，其中的 {{.|title}} 实际上是相当于调用了 strings.Title (name) 的方法填充，能将字符串 name 替换为字符串 Name。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14030"><span data-slate-object="text" data-key="14031"><span data-slate-leaf="true" data-offset-key="14031:0" data-first-offset="true"><span data-slate-string="true">而定义好了 FuncMap 之后，我们随后使用了 os.Create 创建 contract.go 文件，然后初始化 template：</span></span></span></div><div data-code-language="css" data-slate-type="pre" data-slate-object="block" data-key="14032"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14033"><span data-slate-object="text" data-key="14034"><span data-slate-leaf="true" data-offset-key="14034:0" data-first-offset="true"><span data-slate-string="true">t := template.</span></span></span><span data-slate-object="text" data-key="14035"><span data-slate-leaf="true" data-offset-key="14035:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">Must</span></span></span></span><span data-slate-object="text" data-key="14036"><span data-slate-leaf="true" data-offset-key="14036:0" data-first-offset="true"><span data-slate-string="true">(template.</span></span></span><span data-slate-object="text" data-key="14037"><span data-slate-leaf="true" data-offset-key="14037:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">New</span></span></span></span><span data-slate-object="text" data-key="14038"><span data-slate-leaf="true" data-offset-key="14038:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14039"><span data-slate-leaf="true" data-offset-key="14039:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"contract"</span></span></span></span><span data-slate-object="text" data-key="14040"><span data-slate-leaf="true" data-offset-key="14040:0" data-first-offset="true"><span data-slate-string="true">).</span></span></span><span data-slate-object="text" data-key="14041"><span data-slate-leaf="true" data-offset-key="14041:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">Funcs</span></span></span></span><span data-slate-object="text" data-key="14042"><span data-slate-leaf="true" data-offset-key="14042:0" data-first-offset="true"><span data-slate-string="true">(funcs).</span></span></span><span data-slate-object="text" data-key="14043"><span data-slate-leaf="true" data-offset-key="14043:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">Parse</span></span></span></span><span data-slate-object="text" data-key="14044"><span data-slate-leaf="true" data-offset-key="14044:0" data-first-offset="true"><span data-slate-string="true">(contractTmp))</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14045"><span data-slate-object="text" data-key="14046"><span data-slate-leaf="true" data-offset-key="14046:0" data-first-offset="true"><span data-slate-string="true">这行代码的几个函数我们来看看。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14047"><span data-slate-object="text" data-key="14048"><span data-slate-leaf="true" data-offset-key="14048:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">template.Must 表示后面的 template 创建必须成功，否则会 panic</span></span></span></span><span data-slate-object="text" data-key="14049"><span data-slate-leaf="true" data-offset-key="14049:0" data-first-offset="true"><span data-slate-string="true">。这种 Must 的方法来简化代码的 error 处理逻辑，在标准库中经常使用。我们的 hade 框架的 MustMake 也是同样的原理。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14050"><span data-slate-object="text" data-key="14051"><span data-slate-leaf="true" data-offset-key="14051:0" data-first-offset="true"><span data-slate-string="true">template.New () 方法，创建一个 text/template 的 Template 结构，其中的参数 contract 字符串是为这个 Template 结构命名的，后面的 Funcs () 方法是将签名定义的模版函数注册到这个 Template 结构中，最后的 Parse () 是使用这个 Template 结构解析具体的模版文本。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14052"><span data-slate-object="text" data-key="14053"><span data-slate-leaf="true" data-offset-key="14053:0" data-first-offset="true"><span data-slate-string="true">定义好了模版 t 之后，使用代码：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14054"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14055"><span data-slate-object="text" data-key="14056"><span data-slate-leaf="true" data-offset-key="14056:0" data-first-offset="true"><span data-slate-string="true">t.Execute(f, name)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14057"><span data-slate-object="text" data-key="14058"><span data-slate-leaf="true" data-offset-key="14058:0" data-first-offset="true"><span data-slate-string="true">来将变量 name 注册进入模版 t，并且输出到 f。这里的 f，是我们之前创建的 contract.go 文件。也就是使用变量 name 解析模版 t，输出到 contract.go 文件中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14059"><span data-slate-object="text" data-key="14060"><span data-slate-leaf="true" data-offset-key="14060:0" data-first-offset="true"><span data-slate-string="true">这里的变量可以是一个 struct 结构，也可以是基础变量，比如我们这里定义的字符串。在模版中 {{.}} 就代表这个结构。所以再回顾前面定义的 contractTmp 模版，你会看出其中变量 name 为字符串 user 的时候，最终的显示是什么吗？</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14061"><span data-slate-object="text" data-key="14062"><span data-slate-leaf="true" data-offset-key="14062:0" data-first-offset="true"><span data-slate-string="true">好，创建服务命令的所有思路我们就梳理清楚了，最后也贴出完整的代码供你参考，关键步骤都在注释中详细说明了，实现并不难：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14063"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div><div data-code-line-number="52"></div><div data-code-line-number="53"></div><div data-code-line-number="54"></div><div data-code-line-number="55"></div><div data-code-line-number="56"></div><div data-code-line-number="57"></div><div data-code-line-number="58"></div><div data-code-line-number="59"></div><div data-code-line-number="60"></div><div data-code-line-number="61"></div><div data-code-line-number="62"></div><div data-code-line-number="63"></div><div data-code-line-number="64"></div><div data-code-line-number="65"></div><div data-code-line-number="66"></div><div data-code-line-number="67"></div><div data-code-line-number="68"></div><div data-code-line-number="69"></div><div data-code-line-number="70"></div><div data-code-line-number="71"></div><div data-code-line-number="72"></div><div data-code-line-number="73"></div><div data-code-line-number="74"></div><div data-code-line-number="75"></div><div data-code-line-number="76"></div><div data-code-line-number="77"></div><div data-code-line-number="78"></div><div data-code-line-number="79"></div><div data-code-line-number="80"></div><div data-code-line-number="81"></div><div data-code-line-number="82"></div><div data-code-line-number="83"></div><div data-code-line-number="84"></div><div data-code-line-number="85"></div><div data-code-line-number="86"></div><div data-code-line-number="87"></div><div data-code-line-number="88"></div><div data-code-line-number="89"></div><div data-code-line-number="90"></div><div data-code-line-number="91"></div><div data-code-line-number="92"></div><div data-code-line-number="93"></div><div data-code-line-number="94"></div><div data-code-line-number="95"></div><div data-code-line-number="96"></div><div data-code-line-number="97"></div><div data-code-line-number="98"></div><div data-code-line-number="99"></div><div data-code-line-number="100"></div><div data-code-line-number="101"></div><div data-code-line-number="102"></div><div data-code-line-number="103"></div><div data-code-line-number="104"></div><div data-code-line-number="105"></div><div data-code-line-number="106"></div><div data-code-line-number="107"></div><div data-code-line-number="108"></div><div data-code-line-number="109"></div><div data-code-line-number="110"></div><div data-code-line-number="111"></div><div data-code-line-number="112"></div><div data-code-line-number="113"></div><div data-code-line-number="114"></div><div data-code-line-number="115"></div><div data-code-line-number="116"></div><div data-code-line-number="117"></div><div data-code-line-number="118"></div><div data-code-line-number="119"></div><div data-code-line-number="120"></div><div data-code-line-number="121"></div><div data-code-line-number="122"></div><div data-code-line-number="123"></div><div data-code-line-number="124"></div><div data-code-line-number="125"></div><div data-code-line-number="126"></div><div data-code-line-number="127"></div><div data-code-line-number="128"></div><div data-code-line-number="129"></div><div data-code-line-number="130"></div><div data-code-line-number="131"></div><div data-code-line-number="132"></div><div data-code-line-number="133"></div><div data-code-line-number="134"></div><div data-code-line-number="135"></div><div data-code-line-number="136"></div><div data-code-line-number="137"></div><div data-code-line-number="138"></div><div data-code-line-number="139"></div><div data-code-line-number="140"></div><div data-code-line-number="141"></div><div data-code-line-number="142"></div><div data-code-line-number="143"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14064"><span data-slate-object="text" data-key="14065"><span data-slate-leaf="true" data-offset-key="14065:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//providerCreateCommand 创建一个新的服务，包括服务提供者，服务接口协议，服务实例</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14066"><span data-slate-object="text" data-key="14067"><span data-slate-leaf="true" data-offset-key="14067:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14068"><span data-slate-leaf="true" data-offset-key="14068:0" data-first-offset="true"><span data-slate-string="true"> providerCreateCommand = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14069"><span data-slate-object="text" data-key="14070"><span data-slate-leaf="true" data-offset-key="14070:0" data-first-offset="true"><span data-slate-string="true">   Use:     </span></span></span><span data-slate-object="text" data-key="14071"><span data-slate-leaf="true" data-offset-key="14071:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"new"</span></span></span></span><span data-slate-object="text" data-key="14072"><span data-slate-leaf="true" data-offset-key="14072:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14073"><span data-slate-object="text" data-key="14074"><span data-slate-leaf="true" data-offset-key="14074:0" data-first-offset="true"><span data-slate-string="true">   Aliases: []</span></span></span><span data-slate-object="text" data-key="14075"><span data-slate-leaf="true" data-offset-key="14075:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14076"><span data-slate-leaf="true" data-offset-key="14076:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="14077"><span data-slate-leaf="true" data-offset-key="14077:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"create"</span></span></span></span><span data-slate-object="text" data-key="14078"><span data-slate-leaf="true" data-offset-key="14078:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="14079"><span data-slate-leaf="true" data-offset-key="14079:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"init"</span></span></span></span><span data-slate-object="text" data-key="14080"><span data-slate-leaf="true" data-offset-key="14080:0" data-first-offset="true"><span data-slate-string="true">},</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14081"><span data-slate-object="text" data-key="14082"><span data-slate-leaf="true" data-offset-key="14082:0" data-first-offset="true"><span data-slate-string="true">   Short:   </span></span></span><span data-slate-object="text" data-key="14083"><span data-slate-leaf="true" data-offset-key="14083:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"创建一个服务"</span></span></span></span><span data-slate-object="text" data-key="14084"><span data-slate-leaf="true" data-offset-key="14084:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14085"><span data-slate-object="text" data-key="14086"><span data-slate-leaf="true" data-offset-key="14086:0" data-first-offset="true"><span data-slate-string="true">   RunE: </span></span></span><span data-slate-object="text" data-key="14087"><span data-slate-leaf="true" data-offset-key="14087:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="14088"><span data-slate-leaf="true" data-offset-key="14088:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *cobra.Command, args []</span></span></span></span></span><span data-slate-object="text" data-key="14089"><span data-slate-leaf="true" data-offset-key="14089:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="14090"><span data-slate-leaf="true" data-offset-key="14090:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="14091"><span data-slate-leaf="true" data-offset-key="14091:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14092"><span data-slate-leaf="true" data-offset-key="14092:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="14093"><span data-slate-leaf="true" data-offset-key="14093:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14094"><span data-slate-object="text" data-key="14095"><span data-slate-leaf="true" data-offset-key="14095:0" data-first-offset="true"><span data-slate-string="true">      container := c.GetContainer()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14096"><span data-slate-object="text" data-key="14097"><span data-slate-leaf="true" data-offset-key="14097:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14098"><span data-slate-leaf="true" data-offset-key="14098:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"创建一个服务"</span></span></span></span><span data-slate-object="text" data-key="14099"><span data-slate-leaf="true" data-offset-key="14099:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14100"><span data-slate-object="text" data-key="14101"><span data-slate-leaf="true" data-offset-key="14101:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14102"><span data-slate-leaf="true" data-offset-key="14102:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14103"><span data-slate-leaf="true" data-offset-key="14103:0" data-first-offset="true"><span data-slate-string="true"> name </span></span></span><span data-slate-object="text" data-key="14104"><span data-slate-leaf="true" data-offset-key="14104:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14105"><span data-slate-object="text" data-key="14106"><span data-slate-leaf="true" data-offset-key="14106:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14107"><span data-slate-leaf="true" data-offset-key="14107:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14108"><span data-slate-leaf="true" data-offset-key="14108:0" data-first-offset="true"><span data-slate-string="true"> folder </span></span></span><span data-slate-object="text" data-key="14109"><span data-slate-leaf="true" data-offset-key="14109:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14110"><span data-slate-object="text" data-key="14111"><span data-slate-leaf="true" data-offset-key="14111:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14112"><span data-slate-object="text" data-key="14113"><span data-slate-leaf="true" data-offset-key="14113:0" data-first-offset="true"><span data-slate-string="true">         prompt := &amp;survey.Input{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14114"><span data-slate-object="text" data-key="14115"><span data-slate-leaf="true" data-offset-key="14115:0" data-first-offset="true"><span data-slate-string="true">            Message: </span></span></span><span data-slate-object="text" data-key="14116"><span data-slate-leaf="true" data-offset-key="14116:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"请输入服务名称 (服务凭证)："</span></span></span></span><span data-slate-object="text" data-key="14117"><span data-slate-leaf="true" data-offset-key="14117:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14118"><span data-slate-object="text" data-key="14119"><span data-slate-leaf="true" data-offset-key="14119:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14120"><span data-slate-object="text" data-key="14121"><span data-slate-leaf="true" data-offset-key="14121:0" data-first-offset="true"><span data-slate-string="true">         err := survey.AskOne(prompt, &amp;name)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14122"><span data-slate-object="text" data-key="14123"><span data-slate-leaf="true" data-offset-key="14123:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14124"><span data-slate-leaf="true" data-offset-key="14124:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14125"><span data-slate-leaf="true" data-offset-key="14125:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14126"><span data-slate-leaf="true" data-offset-key="14126:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14127"><span data-slate-leaf="true" data-offset-key="14127:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14128"><span data-slate-object="text" data-key="14129"><span data-slate-leaf="true" data-offset-key="14129:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14130"><span data-slate-leaf="true" data-offset-key="14130:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14131"><span data-slate-leaf="true" data-offset-key="14131:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14132"><span data-slate-object="text" data-key="14133"><span data-slate-leaf="true" data-offset-key="14133:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14134"><span data-slate-object="text" data-key="14135"><span data-slate-leaf="true" data-offset-key="14135:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14136"><span data-slate-object="text" data-key="14137"><span data-slate-leaf="true" data-offset-key="14137:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14138"><span data-slate-object="text" data-key="14139"><span data-slate-leaf="true" data-offset-key="14139:0" data-first-offset="true"><span data-slate-string="true">         prompt := &amp;survey.Input{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14140"><span data-slate-object="text" data-key="14141"><span data-slate-leaf="true" data-offset-key="14141:0" data-first-offset="true"><span data-slate-string="true">            Message: </span></span></span><span data-slate-object="text" data-key="14142"><span data-slate-leaf="true" data-offset-key="14142:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"请输入服务所在目录名称 (默认：同服务名称):"</span></span></span></span><span data-slate-object="text" data-key="14143"><span data-slate-leaf="true" data-offset-key="14143:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14144"><span data-slate-object="text" data-key="14145"><span data-slate-leaf="true" data-offset-key="14145:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14146"><span data-slate-object="text" data-key="14147"><span data-slate-leaf="true" data-offset-key="14147:0" data-first-offset="true"><span data-slate-string="true">         err := survey.AskOne(prompt, &amp;folder)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14148"><span data-slate-object="text" data-key="14149"><span data-slate-leaf="true" data-offset-key="14149:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14150"><span data-slate-leaf="true" data-offset-key="14150:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14151"><span data-slate-leaf="true" data-offset-key="14151:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14152"><span data-slate-leaf="true" data-offset-key="14152:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14153"><span data-slate-leaf="true" data-offset-key="14153:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14154"><span data-slate-object="text" data-key="14155"><span data-slate-leaf="true" data-offset-key="14155:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14156"><span data-slate-leaf="true" data-offset-key="14156:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14157"><span data-slate-leaf="true" data-offset-key="14157:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14158"><span data-slate-object="text" data-key="14159"><span data-slate-leaf="true" data-offset-key="14159:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14160"><span data-slate-object="text" data-key="14161"><span data-slate-leaf="true" data-offset-key="14161:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14162"><span data-slate-object="text" data-key="14163"><span data-slate-leaf="true" data-offset-key="14163:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14164"><span data-slate-leaf="true" data-offset-key="14164:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 检查服务是否存在</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14165"><span data-slate-object="text" data-key="14166"><span data-slate-leaf="true" data-offset-key="14166:0" data-first-offset="true"><span data-slate-string="true">      providers := container.(*framework.HadeContainer).NameList()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14167"><span data-slate-object="text" data-key="14168"><span data-slate-leaf="true" data-offset-key="14168:0" data-first-offset="true"><span data-slate-string="true">      providerColl := collection.NewStrCollection(providers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14169"><span data-slate-object="text" data-key="14170"><span data-slate-leaf="true" data-offset-key="14170:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14171"><span data-slate-leaf="true" data-offset-key="14171:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14172"><span data-slate-leaf="true" data-offset-key="14172:0" data-first-offset="true"><span data-slate-string="true"> providerColl.Contains(name) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14173"><span data-slate-object="text" data-key="14174"><span data-slate-leaf="true" data-offset-key="14174:0" data-first-offset="true"><span data-slate-string="true">         fmt.Println(</span></span></span><span data-slate-object="text" data-key="14175"><span data-slate-leaf="true" data-offset-key="14175:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"服务名称已经存在"</span></span></span></span><span data-slate-object="text" data-key="14176"><span data-slate-leaf="true" data-offset-key="14176:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14177"><span data-slate-object="text" data-key="14178"><span data-slate-leaf="true" data-offset-key="14178:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14179"><span data-slate-leaf="true" data-offset-key="14179:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14180"><span data-slate-leaf="true" data-offset-key="14180:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14181"><span data-slate-leaf="true" data-offset-key="14181:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14182"><span data-slate-object="text" data-key="14183"><span data-slate-leaf="true" data-offset-key="14183:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14184"><span data-slate-object="text" data-key="14185"><span data-slate-leaf="true" data-offset-key="14185:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14186"><span data-slate-leaf="true" data-offset-key="14186:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14187"><span data-slate-leaf="true" data-offset-key="14187:0" data-first-offset="true"><span data-slate-string="true"> folder == </span></span></span><span data-slate-object="text" data-key="14188"><span data-slate-leaf="true" data-offset-key="14188:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="14189"><span data-slate-leaf="true" data-offset-key="14189:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14190"><span data-slate-object="text" data-key="14191"><span data-slate-leaf="true" data-offset-key="14191:0" data-first-offset="true"><span data-slate-string="true">         folder = name</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14192"><span data-slate-object="text" data-key="14193"><span data-slate-leaf="true" data-offset-key="14193:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14194"><span data-slate-object="text" data-key="14195"><span data-slate-leaf="true" data-offset-key="14195:0" data-first-offset="true"><span data-slate-string="true">      app := container.MustMake(contract.AppKey).(contract.App)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14196"><span data-slate-object="text" data-key="14197"><span data-slate-leaf="true" data-offset-key="14197:0" data-first-offset="true"><span data-slate-string="true">      pFolder := app.ProviderFolder()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14198"><span data-slate-object="text" data-key="14199"><span data-slate-leaf="true" data-offset-key="14199:0" data-first-offset="true"><span data-slate-string="true">      subFolders, err := util.SubDir(pFolder)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14200"><span data-slate-object="text" data-key="14201"><span data-slate-leaf="true" data-offset-key="14201:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14202"><span data-slate-leaf="true" data-offset-key="14202:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14203"><span data-slate-leaf="true" data-offset-key="14203:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14204"><span data-slate-leaf="true" data-offset-key="14204:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14205"><span data-slate-leaf="true" data-offset-key="14205:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14206"><span data-slate-object="text" data-key="14207"><span data-slate-leaf="true" data-offset-key="14207:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14208"><span data-slate-leaf="true" data-offset-key="14208:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14209"><span data-slate-leaf="true" data-offset-key="14209:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14210"><span data-slate-object="text" data-key="14211"><span data-slate-leaf="true" data-offset-key="14211:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14212"><span data-slate-object="text" data-key="14213"><span data-slate-leaf="true" data-offset-key="14213:0" data-first-offset="true"><span data-slate-string="true">      subColl := collection.NewStrCollection(subFolders)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14214"><span data-slate-object="text" data-key="14215"><span data-slate-leaf="true" data-offset-key="14215:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14216"><span data-slate-leaf="true" data-offset-key="14216:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14217"><span data-slate-leaf="true" data-offset-key="14217:0" data-first-offset="true"><span data-slate-string="true"> subColl.Contains(folder) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14218"><span data-slate-object="text" data-key="14219"><span data-slate-leaf="true" data-offset-key="14219:0" data-first-offset="true"><span data-slate-string="true">         fmt.Println(</span></span></span><span data-slate-object="text" data-key="14220"><span data-slate-leaf="true" data-offset-key="14220:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"目录名称已经存在"</span></span></span></span><span data-slate-object="text" data-key="14221"><span data-slate-leaf="true" data-offset-key="14221:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14222"><span data-slate-object="text" data-key="14223"><span data-slate-leaf="true" data-offset-key="14223:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14224"><span data-slate-leaf="true" data-offset-key="14224:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14225"><span data-slate-leaf="true" data-offset-key="14225:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14226"><span data-slate-leaf="true" data-offset-key="14226:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14227"><span data-slate-object="text" data-key="14228"><span data-slate-leaf="true" data-offset-key="14228:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14229"><span data-slate-object="text" data-key="14230"><span data-slate-leaf="true" data-offset-key="14230:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14231"><span data-slate-leaf="true" data-offset-key="14231:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 开始创建文件</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14232"><span data-slate-object="text" data-key="14233"><span data-slate-leaf="true" data-offset-key="14233:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14234"><span data-slate-leaf="true" data-offset-key="14234:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14235"><span data-slate-leaf="true" data-offset-key="14235:0" data-first-offset="true"><span data-slate-string="true"> err := os.Mkdir(filepath.Join(pFolder, folder), </span></span></span><span data-slate-object="text" data-key="14236"><span data-slate-leaf="true" data-offset-key="14236:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0700</span></span></span></span><span data-slate-object="text" data-key="14237"><span data-slate-leaf="true" data-offset-key="14237:0" data-first-offset="true"><span data-slate-string="true">); err != </span></span></span><span data-slate-object="text" data-key="14238"><span data-slate-leaf="true" data-offset-key="14238:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14239"><span data-slate-leaf="true" data-offset-key="14239:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14240"><span data-slate-object="text" data-key="14241"><span data-slate-leaf="true" data-offset-key="14241:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14242"><span data-slate-leaf="true" data-offset-key="14242:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14243"><span data-slate-leaf="true" data-offset-key="14243:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14244"><span data-slate-object="text" data-key="14245"><span data-slate-leaf="true" data-offset-key="14245:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14246"><span data-slate-object="text" data-key="14247"><span data-slate-leaf="true" data-offset-key="14247:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14248"><span data-slate-leaf="true" data-offset-key="14248:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 创建 title 这个模版方法</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14249"><span data-slate-object="text" data-key="14250"><span data-slate-leaf="true" data-offset-key="14250:0" data-first-offset="true"><span data-slate-string="true">      funcs := template.FuncMap{</span></span></span><span data-slate-object="text" data-key="14251"><span data-slate-leaf="true" data-offset-key="14251:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"title"</span></span></span></span><span data-slate-object="text" data-key="14252"><span data-slate-leaf="true" data-offset-key="14252:0" data-first-offset="true"><span data-slate-string="true">: strings.Title}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14253"><span data-slate-object="text" data-key="14254"><span data-slate-leaf="true" data-offset-key="14254:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14255"><span data-slate-object="text" data-key="14256"><span data-slate-leaf="true" data-offset-key="14256:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14257"><span data-slate-leaf="true" data-offset-key="14257:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//  创建 contract.go</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14258"><span data-slate-object="text" data-key="14259"><span data-slate-leaf="true" data-offset-key="14259:0" data-first-offset="true"><span data-slate-string="true">         file := filepath.Join(pFolder, folder, </span></span></span><span data-slate-object="text" data-key="14260"><span data-slate-leaf="true" data-offset-key="14260:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"contract.go"</span></span></span></span><span data-slate-object="text" data-key="14261"><span data-slate-leaf="true" data-offset-key="14261:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14262"><span data-slate-object="text" data-key="14263"><span data-slate-leaf="true" data-offset-key="14263:0" data-first-offset="true"><span data-slate-string="true">         f, err := os.Create(file)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14264"><span data-slate-object="text" data-key="14265"><span data-slate-leaf="true" data-offset-key="14265:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14266"><span data-slate-leaf="true" data-offset-key="14266:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14267"><span data-slate-leaf="true" data-offset-key="14267:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14268"><span data-slate-leaf="true" data-offset-key="14268:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14269"><span data-slate-leaf="true" data-offset-key="14269:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14270"><span data-slate-object="text" data-key="14271"><span data-slate-leaf="true" data-offset-key="14271:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14272"><span data-slate-leaf="true" data-offset-key="14272:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14273"><span data-slate-leaf="true" data-offset-key="14273:0" data-first-offset="true"><span data-slate-string="true"> errors.Cause(err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14274"><span data-slate-object="text" data-key="14275"><span data-slate-leaf="true" data-offset-key="14275:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14276"><span data-slate-object="text" data-key="14277"><span data-slate-leaf="true" data-offset-key="14277:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14278"><span data-slate-leaf="true" data-offset-key="14278:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 使用 contractTmp 模版来初始化 template，并且让这个模版支持 title 方法，即支持 {{.|title}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14279"><span data-slate-object="text" data-key="14280"><span data-slate-leaf="true" data-offset-key="14280:0" data-first-offset="true"><span data-slate-string="true">         t := template.Must(template.New(</span></span></span><span data-slate-object="text" data-key="14281"><span data-slate-leaf="true" data-offset-key="14281:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"contract"</span></span></span></span><span data-slate-object="text" data-key="14282"><span data-slate-leaf="true" data-offset-key="14282:0" data-first-offset="true"><span data-slate-string="true">).Funcs(funcs).Parse(contractTmp))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14283"><span data-slate-object="text" data-key="14284"><span data-slate-leaf="true" data-offset-key="14284:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14285"><span data-slate-leaf="true" data-offset-key="14285:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 将 name 传递进入到 template 中渲染，并且输出到 contract.go 中</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14286"><span data-slate-object="text" data-key="14287"><span data-slate-leaf="true" data-offset-key="14287:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14288"><span data-slate-leaf="true" data-offset-key="14288:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14289"><span data-slate-leaf="true" data-offset-key="14289:0" data-first-offset="true"><span data-slate-string="true"> err := t.Execute(f, name); err != </span></span></span><span data-slate-object="text" data-key="14290"><span data-slate-leaf="true" data-offset-key="14290:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14291"><span data-slate-leaf="true" data-offset-key="14291:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14292"><span data-slate-object="text" data-key="14293"><span data-slate-leaf="true" data-offset-key="14293:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14294"><span data-slate-leaf="true" data-offset-key="14294:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14295"><span data-slate-leaf="true" data-offset-key="14295:0" data-first-offset="true"><span data-slate-string="true"> errors.Cause(err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14296"><span data-slate-object="text" data-key="14297"><span data-slate-leaf="true" data-offset-key="14297:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14298"><span data-slate-object="text" data-key="14299"><span data-slate-leaf="true" data-offset-key="14299:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14300"><span data-slate-object="text" data-key="14301"><span data-slate-leaf="true" data-offset-key="14301:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14302"><span data-slate-object="text" data-key="14303"><span data-slate-leaf="true" data-offset-key="14303:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14304"><span data-slate-leaf="true" data-offset-key="14304:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 创建 provider.go</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14305"><span data-slate-object="text" data-key="14306"><span data-slate-leaf="true" data-offset-key="14306:0" data-first-offset="true"><span data-slate-string="true">         file := filepath.Join(pFolder, folder, </span></span></span><span data-slate-object="text" data-key="14307"><span data-slate-leaf="true" data-offset-key="14307:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"provider.go"</span></span></span></span><span data-slate-object="text" data-key="14308"><span data-slate-leaf="true" data-offset-key="14308:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14309"><span data-slate-object="text" data-key="14310"><span data-slate-leaf="true" data-offset-key="14310:0" data-first-offset="true"><span data-slate-string="true">         f, err := os.Create(file)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14311"><span data-slate-object="text" data-key="14312"><span data-slate-leaf="true" data-offset-key="14312:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14313"><span data-slate-leaf="true" data-offset-key="14313:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14314"><span data-slate-leaf="true" data-offset-key="14314:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14315"><span data-slate-leaf="true" data-offset-key="14315:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14316"><span data-slate-leaf="true" data-offset-key="14316:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14317"><span data-slate-object="text" data-key="14318"><span data-slate-leaf="true" data-offset-key="14318:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14319"><span data-slate-leaf="true" data-offset-key="14319:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14320"><span data-slate-leaf="true" data-offset-key="14320:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14321"><span data-slate-object="text" data-key="14322"><span data-slate-leaf="true" data-offset-key="14322:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14323"><span data-slate-object="text" data-key="14324"><span data-slate-leaf="true" data-offset-key="14324:0" data-first-offset="true"><span data-slate-string="true">         t := template.Must(template.New(</span></span></span><span data-slate-object="text" data-key="14325"><span data-slate-leaf="true" data-offset-key="14325:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"provider"</span></span></span></span><span data-slate-object="text" data-key="14326"><span data-slate-leaf="true" data-offset-key="14326:0" data-first-offset="true"><span data-slate-string="true">).Funcs(funcs).Parse(providerTmp))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14327"><span data-slate-object="text" data-key="14328"><span data-slate-leaf="true" data-offset-key="14328:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14329"><span data-slate-leaf="true" data-offset-key="14329:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14330"><span data-slate-leaf="true" data-offset-key="14330:0" data-first-offset="true"><span data-slate-string="true"> err := t.Execute(f, name); err != </span></span></span><span data-slate-object="text" data-key="14331"><span data-slate-leaf="true" data-offset-key="14331:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14332"><span data-slate-leaf="true" data-offset-key="14332:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14333"><span data-slate-object="text" data-key="14334"><span data-slate-leaf="true" data-offset-key="14334:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14335"><span data-slate-leaf="true" data-offset-key="14335:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14336"><span data-slate-leaf="true" data-offset-key="14336:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14337"><span data-slate-object="text" data-key="14338"><span data-slate-leaf="true" data-offset-key="14338:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14339"><span data-slate-object="text" data-key="14340"><span data-slate-leaf="true" data-offset-key="14340:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14341"><span data-slate-object="text" data-key="14342"><span data-slate-leaf="true" data-offset-key="14342:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14343"><span data-slate-object="text" data-key="14344"><span data-slate-leaf="true" data-offset-key="14344:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14345"><span data-slate-leaf="true" data-offset-key="14345:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//  创建 service.go</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14346"><span data-slate-object="text" data-key="14347"><span data-slate-leaf="true" data-offset-key="14347:0" data-first-offset="true"><span data-slate-string="true">         file := filepath.Join(pFolder, folder, </span></span></span><span data-slate-object="text" data-key="14348"><span data-slate-leaf="true" data-offset-key="14348:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"service.go"</span></span></span></span><span data-slate-object="text" data-key="14349"><span data-slate-leaf="true" data-offset-key="14349:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14350"><span data-slate-object="text" data-key="14351"><span data-slate-leaf="true" data-offset-key="14351:0" data-first-offset="true"><span data-slate-string="true">         f, err := os.Create(file)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14352"><span data-slate-object="text" data-key="14353"><span data-slate-leaf="true" data-offset-key="14353:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14354"><span data-slate-leaf="true" data-offset-key="14354:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14355"><span data-slate-leaf="true" data-offset-key="14355:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14356"><span data-slate-leaf="true" data-offset-key="14356:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14357"><span data-slate-leaf="true" data-offset-key="14357:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14358"><span data-slate-object="text" data-key="14359"><span data-slate-leaf="true" data-offset-key="14359:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14360"><span data-slate-leaf="true" data-offset-key="14360:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14361"><span data-slate-leaf="true" data-offset-key="14361:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14362"><span data-slate-object="text" data-key="14363"><span data-slate-leaf="true" data-offset-key="14363:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14364"><span data-slate-object="text" data-key="14365"><span data-slate-leaf="true" data-offset-key="14365:0" data-first-offset="true"><span data-slate-string="true">         t := template.Must(template.New(</span></span></span><span data-slate-object="text" data-key="14366"><span data-slate-leaf="true" data-offset-key="14366:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"service"</span></span></span></span><span data-slate-object="text" data-key="14367"><span data-slate-leaf="true" data-offset-key="14367:0" data-first-offset="true"><span data-slate-string="true">).Funcs(funcs).Parse(serviceTmp))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14368"><span data-slate-object="text" data-key="14369"><span data-slate-leaf="true" data-offset-key="14369:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14370"><span data-slate-leaf="true" data-offset-key="14370:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14371"><span data-slate-leaf="true" data-offset-key="14371:0" data-first-offset="true"><span data-slate-string="true"> err := t.Execute(f, name); err != </span></span></span><span data-slate-object="text" data-key="14372"><span data-slate-leaf="true" data-offset-key="14372:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14373"><span data-slate-leaf="true" data-offset-key="14373:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14374"><span data-slate-object="text" data-key="14375"><span data-slate-leaf="true" data-offset-key="14375:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14376"><span data-slate-leaf="true" data-offset-key="14376:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14377"><span data-slate-leaf="true" data-offset-key="14377:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14378"><span data-slate-object="text" data-key="14379"><span data-slate-leaf="true" data-offset-key="14379:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14380"><span data-slate-object="text" data-key="14381"><span data-slate-leaf="true" data-offset-key="14381:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14382"><span data-slate-object="text" data-key="14383"><span data-slate-leaf="true" data-offset-key="14383:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14384"><span data-slate-leaf="true" data-offset-key="14384:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"创建服务成功，文件夹地址:"</span></span></span></span><span data-slate-object="text" data-key="14385"><span data-slate-leaf="true" data-offset-key="14385:0" data-first-offset="true"><span data-slate-string="true">, filepath.Join(pFolder, folder))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14386"><span data-slate-object="text" data-key="14387"><span data-slate-leaf="true" data-offset-key="14387:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14388"><span data-slate-leaf="true" data-offset-key="14388:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"请不要忘记挂载新创建的服务"</span></span></span></span><span data-slate-object="text" data-key="14389"><span data-slate-leaf="true" data-offset-key="14389:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14390"><span data-slate-object="text" data-key="14391"><span data-slate-leaf="true" data-offset-key="14391:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14392"><span data-slate-leaf="true" data-offset-key="14392:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14393"><span data-slate-leaf="true" data-offset-key="14393:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14394"><span data-slate-leaf="true" data-offset-key="14394:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14395"><span data-slate-object="text" data-key="14396"><span data-slate-leaf="true" data-offset-key="14396:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14397"><span data-slate-object="text" data-key="14398"><span data-slate-leaf="true" data-offset-key="14398:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14399"><span data-slate-object="text" data-key="14400"><span data-slate-leaf="true" data-offset-key="14400:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14401"><span data-slate-leaf="true" data-offset-key="14401:0" data-first-offset="true"><span data-slate-string="true"> contractTmp </span></span></span><span data-slate-object="text" data-key="14402"><span data-slate-leaf="true" data-offset-key="14402:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14403"><span data-slate-leaf="true" data-offset-key="14403:0" data-first-offset="true"><span data-slate-string="true"> = </span></span></span><span data-slate-object="text" data-key="14404"><span data-slate-leaf="true" data-offset-key="14404:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`package {{.}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14405"><span data-slate-object="text" data-key="14406"><span data-slate-leaf="true" data-offset-key="14406:0" data-first-offset="true"><span data-slate-string="true">const {{.|title}}Key = "{{.}}"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14407"><span data-slate-object="text" data-key="14408"><span data-slate-leaf="true" data-offset-key="14408:0" data-first-offset="true"><span data-slate-string="true">type Service interface {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14409"><span data-slate-object="text" data-key="14410"><span data-slate-leaf="true" data-offset-key="14410:0" data-first-offset="true"><span data-slate-string="true">   // 请在这里定义你的方法</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14411"><span data-slate-object="text" data-key="14412"><span data-slate-leaf="true" data-offset-key="14412:0" data-first-offset="true"><span data-slate-string="true">    Foo() string</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14413"><span data-slate-object="text" data-key="14414"><span data-slate-leaf="true" data-offset-key="14414:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14415"><span data-slate-object="text" data-key="14416"><span data-slate-leaf="true" data-offset-key="14416:0" data-first-offset="true"><span data-slate-string="true">`</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14417"><span data-slate-object="text" data-key="14418"><span data-slate-leaf="true" data-offset-key="14418:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14419"><span data-slate-leaf="true" data-offset-key="14419:0" data-first-offset="true"><span data-slate-string="true"> providerTmp </span></span></span><span data-slate-object="text" data-key="14420"><span data-slate-leaf="true" data-offset-key="14420:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14421"><span data-slate-leaf="true" data-offset-key="14421:0" data-first-offset="true"><span data-slate-string="true"> = </span></span></span><span data-slate-object="text" data-key="14422"><span data-slate-leaf="true" data-offset-key="14422:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`package {{.}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14423"><span data-slate-object="text" data-key="14424"><span data-slate-leaf="true" data-offset-key="14424:0" data-first-offset="true"><span data-slate-string="true">import (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14425"><span data-slate-object="text" data-key="14426"><span data-slate-leaf="true" data-offset-key="14426:0" data-first-offset="true"><span data-slate-string="true">   "github.com/gohade/hade/framework"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14427"><span data-slate-object="text" data-key="14428"><span data-slate-leaf="true" data-offset-key="14428:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14429"><span data-slate-object="text" data-key="14430"><span data-slate-leaf="true" data-offset-key="14430:0" data-first-offset="true"><span data-slate-string="true">type {{.|title}}Provider struct {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14431"><span data-slate-object="text" data-key="14432"><span data-slate-leaf="true" data-offset-key="14432:0" data-first-offset="true"><span data-slate-string="true">   framework.ServiceProvider</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14433"><span data-slate-object="text" data-key="14434"><span data-slate-leaf="true" data-offset-key="14434:0" data-first-offset="true"><span data-slate-string="true">   c framework.Container</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14435"><span data-slate-object="text" data-key="14436"><span data-slate-leaf="true" data-offset-key="14436:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14437"><span data-slate-object="text" data-key="14438"><span data-slate-leaf="true" data-offset-key="14438:0" data-first-offset="true"><span data-slate-string="true">func (sp *{{.|title}}Provider) Name() string {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14439"><span data-slate-object="text" data-key="14440"><span data-slate-leaf="true" data-offset-key="14440:0" data-first-offset="true"><span data-slate-string="true">   return {{.|title}}Key</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14441"><span data-slate-object="text" data-key="14442"><span data-slate-leaf="true" data-offset-key="14442:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14443"><span data-slate-object="text" data-key="14444"><span data-slate-leaf="true" data-offset-key="14444:0" data-first-offset="true"><span data-slate-string="true">func (sp *{{.|title}}Provider) Register(c framework.Container) framework.NewInstance {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14445"><span data-slate-object="text" data-key="14446"><span data-slate-leaf="true" data-offset-key="14446:0" data-first-offset="true"><span data-slate-string="true">   return New{{.|title}}Service</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14447"><span data-slate-object="text" data-key="14448"><span data-slate-leaf="true" data-offset-key="14448:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14449"><span data-slate-object="text" data-key="14450"><span data-slate-leaf="true" data-offset-key="14450:0" data-first-offset="true"><span data-slate-string="true">func (sp *{{.|title}}Provider) IsDefer() bool {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14451"><span data-slate-object="text" data-key="14452"><span data-slate-leaf="true" data-offset-key="14452:0" data-first-offset="true"><span data-slate-string="true">   return false</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14453"><span data-slate-object="text" data-key="14454"><span data-slate-leaf="true" data-offset-key="14454:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14455"><span data-slate-object="text" data-key="14456"><span data-slate-leaf="true" data-offset-key="14456:0" data-first-offset="true"><span data-slate-string="true">func (sp *{{.|title}}Provider) Params(c framework.Container) []interface{} {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14457"><span data-slate-object="text" data-key="14458"><span data-slate-leaf="true" data-offset-key="14458:0" data-first-offset="true"><span data-slate-string="true">   return []interface{}{c}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14459"><span data-slate-object="text" data-key="14460"><span data-slate-leaf="true" data-offset-key="14460:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14461"><span data-slate-object="text" data-key="14462"><span data-slate-leaf="true" data-offset-key="14462:0" data-first-offset="true"><span data-slate-string="true">func (sp *{{.|title}}Provider) Boot(c framework.Container) error {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14463"><span data-slate-object="text" data-key="14464"><span data-slate-leaf="true" data-offset-key="14464:0" data-first-offset="true"><span data-slate-string="true">   return nil</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14465"><span data-slate-object="text" data-key="14466"><span data-slate-leaf="true" data-offset-key="14466:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14467"><span data-slate-object="text" data-key="14468"><span data-slate-leaf="true" data-offset-key="14468:0" data-first-offset="true"><span data-slate-string="true">`</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14469"><span data-slate-object="text" data-key="14470"><span data-slate-leaf="true" data-offset-key="14470:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14471"><span data-slate-leaf="true" data-offset-key="14471:0" data-first-offset="true"><span data-slate-string="true"> serviceTmp </span></span></span><span data-slate-object="text" data-key="14472"><span data-slate-leaf="true" data-offset-key="14472:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14473"><span data-slate-leaf="true" data-offset-key="14473:0" data-first-offset="true"><span data-slate-string="true"> = </span></span></span><span data-slate-object="text" data-key="14474"><span data-slate-leaf="true" data-offset-key="14474:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`package {{.}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14475"><span data-slate-object="text" data-key="14476"><span data-slate-leaf="true" data-offset-key="14476:0" data-first-offset="true"><span data-slate-string="true">import "github.com/gohade/hade/framework"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14477"><span data-slate-object="text" data-key="14478"><span data-slate-leaf="true" data-offset-key="14478:0" data-first-offset="true"><span data-slate-string="true">type {{.|title}}Service struct {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14479"><span data-slate-object="text" data-key="14480"><span data-slate-leaf="true" data-offset-key="14480:0" data-first-offset="true"><span data-slate-string="true">   container framework.Container</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14481"><span data-slate-object="text" data-key="14482"><span data-slate-leaf="true" data-offset-key="14482:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14483"><span data-slate-object="text" data-key="14484"><span data-slate-leaf="true" data-offset-key="14484:0" data-first-offset="true"><span data-slate-string="true">func New{{.|title}}Service(params ...interface{}) (interface{}, error) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14485"><span data-slate-object="text" data-key="14486"><span data-slate-leaf="true" data-offset-key="14486:0" data-first-offset="true"><span data-slate-string="true">   container := params[0].(framework.Container)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14487"><span data-slate-object="text" data-key="14488"><span data-slate-leaf="true" data-offset-key="14488:0" data-first-offset="true"><span data-slate-string="true">   return &amp;{{.|title}}Service{container: container}, nil</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14489"><span data-slate-object="text" data-key="14490"><span data-slate-leaf="true" data-offset-key="14490:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14491"><span data-slate-object="text" data-key="14492"><span data-slate-leaf="true" data-offset-key="14492:0" data-first-offset="true"><span data-slate-string="true">func (s *{{.|title}}Service) Foo() string {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14493"><span data-slate-object="text" data-key="14494"><span data-slate-leaf="true" data-offset-key="14494:0" data-first-offset="true"><span data-slate-string="true">    return ""</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14495"><span data-slate-object="text" data-key="14496"><span data-slate-leaf="true" data-offset-key="14496:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14497"><span data-slate-object="text" data-key="14498"><span data-slate-leaf="true" data-offset-key="14498:0" data-first-offset="true"><span data-slate-string="true">`</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14499"></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14500"><span data-slate-object="text" data-key="14501"><span data-slate-leaf="true" data-offset-key="14501:0" data-first-offset="true"><span data-slate-string="true">最后我们验证一下这个创建服务命令。同样编译./hade 命令之后，执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14502"><span data-slate-object="text" data-key="14503"><span data-slate-leaf="true" data-offset-key="14503:0" data-first-offset="true"><span data-slate-string="true">./hade provider new</span></span></span></span><span data-slate-object="text" data-key="14504"><span data-slate-leaf="true" data-offset-key="14504:0" data-first-offset="true"><span data-slate-string="true"> , 定义服务凭证为 user，目录名称同样为 user。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14505"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/b7/3c/b7ae3ba7edee1ce7a216e891d1b8e23c.png?wh=620x193"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14506"><span data-slate-object="text" data-key="14507"><span data-slate-leaf="true" data-offset-key="14507:0" data-first-offset="true"><span data-slate-string="true">能看到 app/provider/ 目录下创建了 user 文件夹，其中有 contract.go、provider.go、service.go 三个文件：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14508"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/46/e6/46900bb2ea53135b890763687f4cc0e6.png?wh=376x276"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14509"><span data-slate-object="text" data-key="14510"><span data-slate-leaf="true" data-offset-key="14510:0" data-first-offset="true"><span data-slate-string="true">其中每个文件的定义都完整，且可以直接再次编译通过，验证完成！</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14511" id="sr-toc-5"><span data-slate-object="text" data-key="14512"><span data-slate-leaf="true" data-offset-key="14512:0" data-first-offset="true"><span data-slate-string="true">自动化创建命令行工具</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14513"><span data-slate-object="text" data-key="14514"><span data-slate-leaf="true" data-offset-key="14514:0" data-first-offset="true"><span data-slate-string="true">到这里我们就完成了创建服务工具的自动化。开头提到具体运营一个应用的时候，我们也会经常需要创建一个自定义的命令行。比如运营一个网站，可能会创建一个命令来统计网站注册人数，也可能要创建一个命令来定期检查是否有违禁的文章需要封禁等。所以自动创建命令行工具在实际工作中是非常有必要的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14515"><span data-slate-object="text" data-key="14516"><span data-slate-leaf="true" data-offset-key="14516:0" data-first-offset="true"><span data-slate-string="true">同服务命令一样，我们可以有一套创建命令行工具的命令。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14517"><div data-slate-type="list-line" data-slate-object="block" data-key="14518"><span data-slate-type="code" data-slate-object="inline" data-key="14519"><span data-slate-object="text" data-key="14520"><span data-slate-leaf="true" data-offset-key="14520:0" data-first-offset="true"><span data-slate-string="true">./hade command</span></span></span></span><span data-slate-object="text" data-key="14521"><span data-slate-leaf="true" data-offset-key="14521:0" data-first-offset="true"><span data-slate-string="true"> 一级命令，显示帮助信息</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14522"><span data-slate-type="code" data-slate-object="inline" data-key="14523"><span data-slate-object="text" data-key="14524"><span data-slate-leaf="true" data-offset-key="14524:0" data-first-offset="true"><span data-slate-string="true">./hade command list</span></span></span></span><span data-slate-object="text" data-key="14525"><span data-slate-leaf="true" data-offset-key="14525:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，列出所有控制台命令</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14526"><span data-slate-type="code" data-slate-object="inline" data-key="14527"><span data-slate-object="text" data-key="14528"><span data-slate-leaf="true" data-offset-key="14528:0" data-first-offset="true"><span data-slate-string="true">./hade command new</span></span></span></span><span data-slate-object="text" data-key="14529"><span data-slate-leaf="true" data-offset-key="14529:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，创建一个控制台命令</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14530"><span data-slate-object="text" data-key="14531"><span data-slate-leaf="true" data-offset-key="14531:0" data-first-offset="true"><span data-slate-string="true">command 相关的命令和 provider 的命令的实现基本是一致的。这里我们简要解说下重点，具体对应的代码详情可以参考 GitHub 上的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14532"><span data-slate-object="text" data-key="14533"><span data-slate-leaf="true" data-offset-key="14533:0" data-first-offset="true"><span data-slate-string="true">framework/command/cmd.go</span></span></span></a><span data-slate-object="text" data-key="14534"><span data-slate-leaf="true" data-offset-key="14534:0" data-first-offset="true"><span data-slate-string="true"> 文件。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14535"><span data-slate-object="text" data-key="14536"><span data-slate-leaf="true" data-offset-key="14536:0" data-first-offset="true"><span data-slate-string="true">一级命令./hade command 我们就不说了，是简单地显示帮助信息。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14537"><span data-slate-object="text" data-key="14538"><span data-slate-leaf="true" data-offset-key="14538:0" data-first-offset="true"><span data-slate-string="true">二级命令 ./hade command list。功能是列出所有的控制台命令。这个功能实际上和直接调用 ./hade 显示的帮助信息差不多，把一级根命令全部列了出来，只不过我们使用了一个更为语义化的 ./hade command list 来显示。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="14539"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/85/9e/85fd992ca12552e3d5fef51994b1079e.png?wh=946x722"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14540"><span data-slate-object="text" data-key="14541"><span data-slate-leaf="true" data-offset-key="14541:0" data-first-offset="true"><span data-slate-string="true">它的实现也并不复杂，具体就是使用 Root ().Commands () 方法遍历一级跟命令的所有一级命令。</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14542"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14543"><span data-slate-object="text" data-key="14544"><span data-slate-leaf="true" data-offset-key="14544:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//cmdListCommand 列出所有的控制台命令</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14545"><span data-slate-object="text" data-key="14546"><span data-slate-leaf="true" data-offset-key="14546:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14547"><span data-slate-leaf="true" data-offset-key="14547:0" data-first-offset="true"><span data-slate-string="true"> cmdListCommand = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14548"><span data-slate-object="text" data-key="14549"><span data-slate-leaf="true" data-offset-key="14549:0" data-first-offset="true"><span data-slate-string="true">   Use:   </span></span></span><span data-slate-object="text" data-key="14550"><span data-slate-leaf="true" data-offset-key="14550:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"list"</span></span></span></span><span data-slate-object="text" data-key="14551"><span data-slate-leaf="true" data-offset-key="14551:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14552"><span data-slate-object="text" data-key="14553"><span data-slate-leaf="true" data-offset-key="14553:0" data-first-offset="true"><span data-slate-string="true">   Short: </span></span></span><span data-slate-object="text" data-key="14554"><span data-slate-leaf="true" data-offset-key="14554:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"列出所有控制台命令"</span></span></span></span><span data-slate-object="text" data-key="14555"><span data-slate-leaf="true" data-offset-key="14555:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14556"><span data-slate-object="text" data-key="14557"><span data-slate-leaf="true" data-offset-key="14557:0" data-first-offset="true"><span data-slate-string="true">   RunE: </span></span></span><span data-slate-object="text" data-key="14558"><span data-slate-leaf="true" data-offset-key="14558:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="14559"><span data-slate-leaf="true" data-offset-key="14559:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *cobra.Command, args []</span></span></span></span></span><span data-slate-object="text" data-key="14560"><span data-slate-leaf="true" data-offset-key="14560:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="14561"><span data-slate-leaf="true" data-offset-key="14561:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="14562"><span data-slate-leaf="true" data-offset-key="14562:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14563"><span data-slate-leaf="true" data-offset-key="14563:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="14564"><span data-slate-leaf="true" data-offset-key="14564:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14565"><span data-slate-object="text" data-key="14566"><span data-slate-leaf="true" data-offset-key="14566:0" data-first-offset="true"><span data-slate-string="true">      cmds := c.Root().Commands()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14567"><span data-slate-object="text" data-key="14568"><span data-slate-leaf="true" data-offset-key="14568:0" data-first-offset="true"><span data-slate-string="true">      ps := [][]</span></span></span><span data-slate-object="text" data-key="14569"><span data-slate-leaf="true" data-offset-key="14569:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14570"><span data-slate-leaf="true" data-offset-key="14570:0" data-first-offset="true"><span data-slate-string="true">{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14571"><span data-slate-object="text" data-key="14572"><span data-slate-leaf="true" data-offset-key="14572:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14573"><span data-slate-leaf="true" data-offset-key="14573:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">for</span></span></span></span><span data-slate-object="text" data-key="14574"><span data-slate-leaf="true" data-offset-key="14574:0" data-first-offset="true"><span data-slate-string="true"> _, cmd := </span></span></span><span data-slate-object="text" data-key="14575"><span data-slate-leaf="true" data-offset-key="14575:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">range</span></span></span></span><span data-slate-object="text" data-key="14576"><span data-slate-leaf="true" data-offset-key="14576:0" data-first-offset="true"><span data-slate-string="true"> cmds {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14577"><span data-slate-object="text" data-key="14578"><span data-slate-leaf="true" data-offset-key="14578:0" data-first-offset="true"><span data-slate-string="true">         line := []</span></span></span><span data-slate-object="text" data-key="14579"><span data-slate-leaf="true" data-offset-key="14579:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14580"><span data-slate-leaf="true" data-offset-key="14580:0" data-first-offset="true"><span data-slate-string="true">{cmd.Name(), cmd.Short}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14581"><span data-slate-object="text" data-key="14582"><span data-slate-leaf="true" data-offset-key="14582:0" data-first-offset="true"><span data-slate-string="true">         ps = </span></span></span><span data-slate-object="text" data-key="14583"><span data-slate-leaf="true" data-offset-key="14583:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">append</span></span></span></span><span data-slate-object="text" data-key="14584"><span data-slate-leaf="true" data-offset-key="14584:0" data-first-offset="true"><span data-slate-string="true">(ps, line)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14585"><span data-slate-object="text" data-key="14586"><span data-slate-leaf="true" data-offset-key="14586:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14587"><span data-slate-object="text" data-key="14588"><span data-slate-leaf="true" data-offset-key="14588:0" data-first-offset="true"><span data-slate-string="true">      util.PrettyPrint(ps)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14589"><span data-slate-object="text" data-key="14590"><span data-slate-leaf="true" data-offset-key="14590:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14591"><span data-slate-leaf="true" data-offset-key="14591:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14592"><span data-slate-leaf="true" data-offset-key="14592:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14593"><span data-slate-leaf="true" data-offset-key="14593:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14594"><span data-slate-object="text" data-key="14595"><span data-slate-leaf="true" data-offset-key="14595:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14596"><span data-slate-object="text" data-key="14597"><span data-slate-leaf="true" data-offset-key="14597:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14598"><span data-slate-object="text" data-key="14599"><span data-slate-leaf="true" data-offset-key="14599:0" data-first-offset="true"><span data-slate-string="true">二级命令 ./hade command new 创建命令行工具，就是在 app/console/command/ 文件夹下增加一个目录，然后在这个目录中存放命令的相关代码。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14600"><span data-slate-object="text" data-key="14601"><span data-slate-leaf="true" data-offset-key="14601:0" data-first-offset="true"><span data-slate-string="true">比如要创建一个 foo 命令，就是要在 app/console/command/ 目录下创建一个 foo 目录，其中创建一个 foo.go 文件名，这个文件名可以随意起，这里我们就和目录名保持一致。然后在 app/console/command/foo.go 文件中输入模版：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14602"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14603"><span data-slate-object="text" data-key="14604"><span data-slate-leaf="true" data-offset-key="14604:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 命令行工具模版</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14605"><span data-slate-object="text" data-key="14606"><span data-slate-leaf="true" data-offset-key="14606:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14607"><span data-slate-leaf="true" data-offset-key="14607:0" data-first-offset="true"><span data-slate-string="true"> cmdTmpl </span></span></span><span data-slate-object="text" data-key="14608"><span data-slate-leaf="true" data-offset-key="14608:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="14609"><span data-slate-leaf="true" data-offset-key="14609:0" data-first-offset="true"><span data-slate-string="true"> = </span></span></span><span data-slate-object="text" data-key="14610"><span data-slate-leaf="true" data-offset-key="14610:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`package {{.}}</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14611"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14612"><span data-slate-object="text" data-key="14613"><span data-slate-leaf="true" data-offset-key="14613:0" data-first-offset="true"><span data-slate-string="true">import (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14614"><span data-slate-object="text" data-key="14615"><span data-slate-leaf="true" data-offset-key="14615:0" data-first-offset="true"><span data-slate-string="true">   "fmt"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14616"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14617"><span data-slate-object="text" data-key="14618"><span data-slate-leaf="true" data-offset-key="14618:0" data-first-offset="true"><span data-slate-string="true">   "github.com/gohade/hade/framework/cobra"</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14619"><span data-slate-object="text" data-key="14620"><span data-slate-leaf="true" data-offset-key="14620:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14621"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14622"><span data-slate-object="text" data-key="14623"><span data-slate-leaf="true" data-offset-key="14623:0" data-first-offset="true"><span data-slate-string="true">var {{.|title}}Command = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14624"><span data-slate-object="text" data-key="14625"><span data-slate-leaf="true" data-offset-key="14625:0" data-first-offset="true"><span data-slate-string="true">   Use:   "{{.}}",</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14626"><span data-slate-object="text" data-key="14627"><span data-slate-leaf="true" data-offset-key="14627:0" data-first-offset="true"><span data-slate-string="true">   Short: "{{.}}",</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14628"><span data-slate-object="text" data-key="14629"><span data-slate-leaf="true" data-offset-key="14629:0" data-first-offset="true"><span data-slate-string="true">   RunE: func(c *cobra.Command, args []string) error {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14630"><span data-slate-object="text" data-key="14631"><span data-slate-leaf="true" data-offset-key="14631:0" data-first-offset="true"><span data-slate-string="true">        container := c.GetContainer()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14632"><span data-slate-object="text" data-key="14633"><span data-slate-leaf="true" data-offset-key="14633:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(container)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14634"><span data-slate-object="text" data-key="14635"><span data-slate-leaf="true" data-offset-key="14635:0" data-first-offset="true"><span data-slate-string="true">      return nil</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14636"><span data-slate-object="text" data-key="14637"><span data-slate-leaf="true" data-offset-key="14637:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14638"><span data-slate-object="text" data-key="14639"><span data-slate-leaf="true" data-offset-key="14639:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14640"><span data-slate-object="text" data-key="14641"><span data-slate-leaf="true" data-offset-key="14641:0" data-first-offset="true"><span data-slate-string="true">实现步骤也很简单：survery 交互先要求用户输入命令名称；然后要求用户输入文件夹名称，记得检查命令名称和文件夹名称是否合理；之后创建文件夹 app/console/command/xxx 和文件 app/console/command/xxx/xxx.go；最后使用 template 将模版写入文件中。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="14642" id="sr-toc-6"><span data-slate-object="text" data-key="14643"><span data-slate-leaf="true" data-offset-key="14643:0" data-first-offset="true"><span data-slate-string="true">自动化中间件迁移工具</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="14644"><span data-slate-object="text" data-key="14645"><span data-slate-leaf="true" data-offset-key="14645:0" data-first-offset="true"><span data-slate-string="true">除了服务工具和命令行工具的创建，对于中间件，我们在开发过程中也是经常会使用创建的，同样的，可以为中间件定义一系列的命令来自动化。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14646"><div data-slate-type="list-line" data-slate-object="block" data-key="14647"><span data-slate-type="code" data-slate-object="inline" data-key="14648"><span data-slate-object="text" data-key="14649"><span data-slate-leaf="true" data-offset-key="14649:0" data-first-offset="true"><span data-slate-string="true">./hade middleware</span></span></span></span><span data-slate-object="text" data-key="14650"><span data-slate-leaf="true" data-offset-key="14650:0" data-first-offset="true"><span data-slate-string="true"> 一级命令，显示帮助信息</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14651"><span data-slate-type="code" data-slate-object="inline" data-key="14652"><span data-slate-object="text" data-key="14653"><span data-slate-leaf="true" data-offset-key="14653:0" data-first-offset="true"><span data-slate-string="true">./hade middleware list</span></span></span></span><span data-slate-object="text" data-key="14654"><span data-slate-leaf="true" data-offset-key="14654:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，列出所有的业务中间件</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14655"><span data-slate-type="code" data-slate-object="inline" data-key="14656"><span data-slate-object="text" data-key="14657"><span data-slate-leaf="true" data-offset-key="14657:0" data-first-offset="true"><span data-slate-string="true">./hade middleware new</span></span></span></span><span data-slate-object="text" data-key="14658"><span data-slate-leaf="true" data-offset-key="14658:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，创建一个新的业务中间件</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="14659"><span data-slate-type="code" data-slate-object="inline" data-key="14660"><span data-slate-object="text" data-key="14661"><span data-slate-leaf="true" data-offset-key="14661:0" data-first-offset="true"><span data-slate-string="true">./hade middleware migrate</span></span></span></span><span data-slate-object="text" data-key="14662"><span data-slate-leaf="true" data-offset-key="14662:0" data-first-offset="true"><span data-slate-string="true"> 二级命令，迁移 Gin 已有的中间件</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14663"><span data-slate-object="text" data-key="14664"><span data-slate-leaf="true" data-offset-key="14664:0" data-first-offset="true"><span data-slate-string="true">其中的前面三个命令基本上和 provider、command 命令如出一辙，我们就不赘述了，同样你可以通过 GitHub 上的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14665"><span data-slate-object="text" data-key="14666"><span data-slate-leaf="true" data-offset-key="14666:0" data-first-offset="true"><span data-slate-string="true">framework/command/middleware.go 文件</span></span></span></a><span data-slate-object="text" data-key="14667"><span data-slate-leaf="true" data-offset-key="14667:0" data-first-offset="true"><span data-slate-string="true">参考其具体实现，相信你可以顺利写出来。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14668"><span data-slate-object="text" data-key="14669"><span data-slate-leaf="true" data-offset-key="14669:0" data-first-offset="true"><span data-slate-string="true">这里重点说一下  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14670"><span data-slate-object="text" data-key="14671"><span data-slate-leaf="true" data-offset-key="14671:0" data-first-offset="true"><span data-slate-string="true">./hade middleware migrate</span></span></span></span><span data-slate-object="text" data-key="14672"><span data-slate-leaf="true" data-offset-key="14672:0" data-first-offset="true"><span data-slate-string="true"> 命令。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14673"><span data-slate-object="text" data-key="14674"><span data-slate-leaf="true" data-offset-key="14674:0" data-first-offset="true"><span data-slate-string="true">不知道你有没有好奇，为什么迁移也要写一个命令？当时在将 Gin 迁移进入 hade 框架的时候我们说，Gin 作为一个成熟的开源作品，有丰富的中间件库，存放 GitHub 的一个项目 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14675"><span data-slate-object="text" data-key="14676"><span data-slate-leaf="true" data-offset-key="14676:0" data-first-offset="true"><span data-slate-string="true">gin-contrib</span></span></span></a><span data-slate-object="text" data-key="14677"><span data-slate-leaf="true" data-offset-key="14677:0" data-first-offset="true"><span data-slate-string="true"> 中。那么在开发过程中，我们一定会经常需要使用到这些中间件。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14678"><span data-slate-object="text" data-key="14679"><span data-slate-leaf="true" data-offset-key="14679:0" data-first-offset="true"><span data-slate-string="true">但是由于这些中间件使用到的 Gin 框架的地址为 ：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="14680"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14681"><span data-slate-object="text" data-key="14682"><span data-slate-leaf="true" data-offset-key="14682:0" data-first-offset="true"><span data-slate-string="true">github.com/gin-gonic/gin</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14683"><span data-slate-object="text" data-key="14684"><span data-slate-leaf="true" data-offset-key="14684:0" data-first-offset="true"><span data-slate-string="true">而我们的 Gin 框架地址为：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="14685"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14686"><span data-slate-object="text" data-key="14687"><span data-slate-leaf="true" data-offset-key="14687:0" data-first-offset="true"><span data-slate-string="true">github.com/gohade/hade/framework/gin</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14688"><span data-slate-object="text" data-key="14689"><span data-slate-leaf="true" data-offset-key="14689:0" data-first-offset="true"><span data-slate-string="true">所以我们不能使用 import 直接使用这些中间件，那么有没有一个办法，能直接一键迁移 gin-contrib 下的某个中间件呢？比如  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14690"><span data-slate-object="text" data-key="14691"><span data-slate-leaf="true" data-offset-key="14691:0" data-first-offset="true"><span data-slate-string="true">git@github.com:gin-contrib/cors.git</span></span></span></span><span data-slate-object="text" data-key="14692"><span data-slate-leaf="true" data-offset-key="14692:0" data-first-offset="true"><span data-slate-string="true"> ，直接拷贝并且自动修改好 Gin 框架引用地址，放到我们的 app/http/middleware/ 目录中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14693"><span data-slate-object="text" data-key="14694"><span data-slate-leaf="true" data-offset-key="14694:0" data-first-offset="true"><span data-slate-string="true">于是就有了这个  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14695"><span data-slate-object="text" data-key="14696"><span data-slate-leaf="true" data-offset-key="14696:0" data-first-offset="true"><span data-slate-string="true">./hade middleware migragte</span></span></span></span><span data-slate-object="text" data-key="14697"><span data-slate-leaf="true" data-offset-key="14697:0" data-first-offset="true"><span data-slate-string="true"> 命令。下面就梳理一下这个命令的逻辑步骤。以下载 cors 中间件为例，我们的思路是从 GitHub 上将这个 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14698"><span data-slate-object="text" data-key="14699"><span data-slate-leaf="true" data-offset-key="14699:0" data-first-offset="true"><span data-slate-string="true">cors 项目</span></span></span></a><span data-slate-object="text" data-key="14700"><span data-slate-leaf="true" data-offset-key="14700:0" data-first-offset="true"><span data-slate-string="true">复制下来，</span></span></span><span data-slate-object="text" data-key="14701"><span data-slate-leaf="true" data-offset-key="14701:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">并且删除这个项目的一些不必要的文件</span></span></span></span><span data-slate-object="text" data-key="14702"><span data-slate-leaf="true" data-offset-key="14702:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14703"><span data-slate-object="text" data-key="14704"><span data-slate-leaf="true" data-offset-key="14704:0" data-first-offset="true"><span data-slate-string="true">什么是不必要的文件呢？.git 目录、go.mod、go.sum，这些都是作为一个 “项目” 才会需要的，而我们要把项目中的这些删掉，让它成为一个文件，存放在我们的 app/http/middleware/cors 目录下。最后再遍历这个目录的所有文件，将所有出现 “github.com/gin-gonic/gin” 的地方替换为 “github.com/gohade/hade/framework/gin” 就可以了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14705"><span data-slate-object="text" data-key="14706"><span data-slate-leaf="true" data-offset-key="14706:0" data-first-offset="true"><span data-slate-string="true">从 git 上复制一个项目，在 Golang 中可以使用一个第三方库 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="14707"><span data-slate-object="text" data-key="14708"><span data-slate-leaf="true" data-offset-key="14708:0" data-first-offset="true"><span data-slate-string="true">go-git</span></span></span></a><span data-slate-object="text" data-key="14709"><span data-slate-leaf="true" data-offset-key="14709:0" data-first-offset="true"><span data-slate-string="true">，这个第三方库已经有 2.7k 个 star，且基于 Apache 的 Licence，是可以直接 import 使用的。目前这个库最新的版本为 v5。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14710"><span data-slate-object="text" data-key="14711"><span data-slate-leaf="true" data-offset-key="14711:0" data-first-offset="true"><span data-slate-string="true">它的使用方式如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14712"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14713"><span data-slate-object="text" data-key="14714"><span data-slate-leaf="true" data-offset-key="14714:0" data-first-offset="true"><span data-slate-string="true">_, err := git.PlainClone(</span></span></span><span data-slate-object="text" data-key="14715"><span data-slate-leaf="true" data-offset-key="14715:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/tmp/foo"</span></span></span></span><span data-slate-object="text" data-key="14716"><span data-slate-leaf="true" data-offset-key="14716:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="14717"><span data-slate-leaf="true" data-offset-key="14717:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">false</span></span></span></span><span data-slate-object="text" data-key="14718"><span data-slate-leaf="true" data-offset-key="14718:0" data-first-offset="true"><span data-slate-string="true">, &amp;git.CloneOptions{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14719"><span data-slate-object="text" data-key="14720"><span data-slate-leaf="true" data-offset-key="14720:0" data-first-offset="true"><span data-slate-string="true">    URL:      </span></span></span><span data-slate-object="text" data-key="14721"><span data-slate-leaf="true" data-offset-key="14721:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"https://github.com/go-git/go-git"</span></span></span></span><span data-slate-object="text" data-key="14722"><span data-slate-leaf="true" data-offset-key="14722:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14723"><span data-slate-object="text" data-key="14724"><span data-slate-leaf="true" data-offset-key="14724:0" data-first-offset="true"><span data-slate-string="true">    Progress: os.Stdout,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14725"><span data-slate-object="text" data-key="14726"><span data-slate-leaf="true" data-offset-key="14726:0" data-first-offset="true"><span data-slate-string="true">})</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14727"><span data-slate-object="text" data-key="14728"><span data-slate-leaf="true" data-offset-key="14728:0" data-first-offset="true"><span data-slate-string="true">将某个 Git 的 URL 地址使用 gitclone，下载到 /tmp/foo 目录，并且把输出也输出到控制台。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14729"><span data-slate-object="text" data-key="14730"><span data-slate-leaf="true" data-offset-key="14730:0" data-first-offset="true"><span data-slate-string="true">我们也可以使用这样的方式进行复制。具体的代码逻辑也不难，归纳一下，migrate 的实现步骤如下：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="14731"><div data-slate-type="list-line" data-slate-object="block" data-key="14732"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="14733"><span data-slate-leaf="true" data-offset-key="14733:0" data-first-offset="true"><span data-slate-string="true">参数中获取中间件名称；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="14734"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="14735"><span data-slate-leaf="true" data-offset-key="14735:0" data-first-offset="true"><span data-slate-string="true">使用 go-git，将对应的 gin-contrib 的项目 clone 到目录 /app/http/middleware；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="14736"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="14737"><span data-slate-leaf="true" data-offset-key="14737:0" data-first-offset="true"><span data-slate-string="true">删除不必要的文件 go.mod、go.sum、.git；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="14738"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="14739"><span data-slate-leaf="true" data-offset-key="14739:0" data-first-offset="true"><span data-slate-string="true">替换关键字 “github.com/gin-gonic/gin”。</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14740"><span data-slate-object="text" data-key="14741"><span data-slate-leaf="true" data-offset-key="14741:0" data-first-offset="true"><span data-slate-string="true">在 framework/command/middleware.go 中，对应的代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="14742"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div><div data-code-line-number="52"></div><div data-code-line-number="53"></div><div data-code-line-number="54"></div><div data-code-line-number="55"></div><div data-code-line-number="56"></div><div data-code-line-number="57"></div><div data-code-line-number="58"></div><div data-code-line-number="59"></div><div data-code-line-number="60"></div><div data-code-line-number="61"></div><div data-code-line-number="62"></div><div data-code-line-number="63"></div><div data-code-line-number="64"></div><div data-code-line-number="65"></div><div data-code-line-number="66"></div><div data-code-line-number="67"></div><div data-code-line-number="68"></div><div data-code-line-number="69"></div><div data-code-line-number="70"></div><div data-code-line-number="71"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="14743"><span data-slate-object="text" data-key="14744"><span data-slate-leaf="true" data-offset-key="14744:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 从 gin-contrib 中迁移中间件</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14745"><span data-slate-object="text" data-key="14746"><span data-slate-leaf="true" data-offset-key="14746:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14747"><span data-slate-leaf="true" data-offset-key="14747:0" data-first-offset="true"><span data-slate-string="true"> middlewareMigrateCommand = &amp;cobra.Command{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14748"><span data-slate-object="text" data-key="14749"><span data-slate-leaf="true" data-offset-key="14749:0" data-first-offset="true"><span data-slate-string="true">   Use:   </span></span></span><span data-slate-object="text" data-key="14750"><span data-slate-leaf="true" data-offset-key="14750:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"migrate"</span></span></span></span><span data-slate-object="text" data-key="14751"><span data-slate-leaf="true" data-offset-key="14751:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14752"><span data-slate-object="text" data-key="14753"><span data-slate-leaf="true" data-offset-key="14753:0" data-first-offset="true"><span data-slate-string="true">   Short: </span></span></span><span data-slate-object="text" data-key="14754"><span data-slate-leaf="true" data-offset-key="14754:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"迁移 gin-contrib 中间件，迁移地址：https://github.com/gin-contrib/[middleware].git"</span></span></span></span><span data-slate-object="text" data-key="14755"><span data-slate-leaf="true" data-offset-key="14755:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14756"><span data-slate-object="text" data-key="14757"><span data-slate-leaf="true" data-offset-key="14757:0" data-first-offset="true"><span data-slate-string="true">   RunE: </span></span></span><span data-slate-object="text" data-key="14758"><span data-slate-leaf="true" data-offset-key="14758:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="14759"><span data-slate-leaf="true" data-offset-key="14759:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *cobra.Command, args []</span></span></span></span></span><span data-slate-object="text" data-key="14760"><span data-slate-leaf="true" data-offset-key="14760:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="14761"><span data-slate-leaf="true" data-offset-key="14761:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="14762"><span data-slate-leaf="true" data-offset-key="14762:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14763"><span data-slate-leaf="true" data-offset-key="14763:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="14764"><span data-slate-leaf="true" data-offset-key="14764:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14765"><span data-slate-object="text" data-key="14766"><span data-slate-leaf="true" data-offset-key="14766:0" data-first-offset="true"><span data-slate-string="true">      container := c.GetContainer()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14767"><span data-slate-object="text" data-key="14768"><span data-slate-leaf="true" data-offset-key="14768:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14769"><span data-slate-leaf="true" data-offset-key="14769:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"迁移一个 Gin 中间件"</span></span></span></span><span data-slate-object="text" data-key="14770"><span data-slate-leaf="true" data-offset-key="14770:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14771"><span data-slate-object="text" data-key="14772"><span data-slate-leaf="true" data-offset-key="14772:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14773"><span data-slate-leaf="true" data-offset-key="14773:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//step1: 获取参数</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14774"><span data-slate-object="text" data-key="14775"><span data-slate-leaf="true" data-offset-key="14775:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14776"><span data-slate-leaf="true" data-offset-key="14776:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="14777"><span data-slate-leaf="true" data-offset-key="14777:0" data-first-offset="true"><span data-slate-string="true"> repo </span></span></span><span data-slate-object="text" data-key="14778"><span data-slate-leaf="true" data-offset-key="14778:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14779"><span data-slate-object="text" data-key="14780"><span data-slate-leaf="true" data-offset-key="14780:0" data-first-offset="true"><span data-slate-string="true">      {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14781"><span data-slate-object="text" data-key="14782"><span data-slate-leaf="true" data-offset-key="14782:0" data-first-offset="true"><span data-slate-string="true">         prompt := &amp;survey.Input{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14783"><span data-slate-object="text" data-key="14784"><span data-slate-leaf="true" data-offset-key="14784:0" data-first-offset="true"><span data-slate-string="true">            Message: </span></span></span><span data-slate-object="text" data-key="14785"><span data-slate-leaf="true" data-offset-key="14785:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"请输入中间件名称："</span></span></span></span><span data-slate-object="text" data-key="14786"><span data-slate-leaf="true" data-offset-key="14786:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14787"><span data-slate-object="text" data-key="14788"><span data-slate-leaf="true" data-offset-key="14788:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14789"><span data-slate-object="text" data-key="14790"><span data-slate-leaf="true" data-offset-key="14790:0" data-first-offset="true"><span data-slate-string="true">         err := survey.AskOne(prompt, &amp;repo)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14791"><span data-slate-object="text" data-key="14792"><span data-slate-leaf="true" data-offset-key="14792:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14793"><span data-slate-leaf="true" data-offset-key="14793:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14794"><span data-slate-leaf="true" data-offset-key="14794:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14795"><span data-slate-leaf="true" data-offset-key="14795:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14796"><span data-slate-leaf="true" data-offset-key="14796:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14797"><span data-slate-object="text" data-key="14798"><span data-slate-leaf="true" data-offset-key="14798:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14799"><span data-slate-leaf="true" data-offset-key="14799:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14800"><span data-slate-leaf="true" data-offset-key="14800:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14801"><span data-slate-object="text" data-key="14802"><span data-slate-leaf="true" data-offset-key="14802:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14803"><span data-slate-object="text" data-key="14804"><span data-slate-leaf="true" data-offset-key="14804:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14805"><span data-slate-object="text" data-key="14806"><span data-slate-leaf="true" data-offset-key="14806:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14807"><span data-slate-leaf="true" data-offset-key="14807:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//step2 : 下载 git 到一个目录中</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14808"><span data-slate-object="text" data-key="14809"><span data-slate-leaf="true" data-offset-key="14809:0" data-first-offset="true"><span data-slate-string="true">      appService := container.MustMake(contract.AppKey).(contract.App)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14810"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14811"><span data-slate-object="text" data-key="14812"><span data-slate-leaf="true" data-offset-key="14812:0" data-first-offset="true"><span data-slate-string="true">      middlewarePath := appService.MiddlewareFolder()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14813"><span data-slate-object="text" data-key="14814"><span data-slate-leaf="true" data-offset-key="14814:0" data-first-offset="true"><span data-slate-string="true">      url := </span></span></span><span data-slate-object="text" data-key="14815"><span data-slate-leaf="true" data-offset-key="14815:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"https://github.com/gin-contrib/"</span></span></span></span><span data-slate-object="text" data-key="14816"><span data-slate-leaf="true" data-offset-key="14816:0" data-first-offset="true"><span data-slate-string="true"> + repo + </span></span></span><span data-slate-object="text" data-key="14817"><span data-slate-leaf="true" data-offset-key="14817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".git"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14818"><span data-slate-object="text" data-key="14819"><span data-slate-leaf="true" data-offset-key="14819:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14820"><span data-slate-leaf="true" data-offset-key="14820:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"下载中间件 gin-contrib:"</span></span></span></span><span data-slate-object="text" data-key="14821"><span data-slate-leaf="true" data-offset-key="14821:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14822"><span data-slate-object="text" data-key="14823"><span data-slate-leaf="true" data-offset-key="14823:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(url)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14824"><span data-slate-object="text" data-key="14825"><span data-slate-leaf="true" data-offset-key="14825:0" data-first-offset="true"><span data-slate-string="true">      _, err := git.PlainClone(path.Join(middlewarePath, repo), </span></span></span><span data-slate-object="text" data-key="14826"><span data-slate-leaf="true" data-offset-key="14826:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">false</span></span></span></span><span data-slate-object="text" data-key="14827"><span data-slate-leaf="true" data-offset-key="14827:0" data-first-offset="true"><span data-slate-string="true">, &amp;git.CloneOptions{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14828"><span data-slate-object="text" data-key="14829"><span data-slate-leaf="true" data-offset-key="14829:0" data-first-offset="true"><span data-slate-string="true">         URL:      url,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14830"><span data-slate-object="text" data-key="14831"><span data-slate-leaf="true" data-offset-key="14831:0" data-first-offset="true"><span data-slate-string="true">         Progress: os.Stdout,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14832"><span data-slate-object="text" data-key="14833"><span data-slate-leaf="true" data-offset-key="14833:0" data-first-offset="true"><span data-slate-string="true">      })</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14834"><span data-slate-object="text" data-key="14835"><span data-slate-leaf="true" data-offset-key="14835:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14836"><span data-slate-leaf="true" data-offset-key="14836:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14837"><span data-slate-leaf="true" data-offset-key="14837:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14838"><span data-slate-leaf="true" data-offset-key="14838:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14839"><span data-slate-leaf="true" data-offset-key="14839:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14840"><span data-slate-object="text" data-key="14841"><span data-slate-leaf="true" data-offset-key="14841:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14842"><span data-slate-leaf="true" data-offset-key="14842:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14843"><span data-slate-leaf="true" data-offset-key="14843:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14844"><span data-slate-object="text" data-key="14845"><span data-slate-leaf="true" data-offset-key="14845:0" data-first-offset="true"><span data-slate-string="true">      }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14846"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14847"><span data-slate-object="text" data-key="14848"><span data-slate-leaf="true" data-offset-key="14848:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14849"><span data-slate-leaf="true" data-offset-key="14849:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//step3: 删除不必要的文件 go.mod, go.sum, .git</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14850"><span data-slate-object="text" data-key="14851"><span data-slate-leaf="true" data-offset-key="14851:0" data-first-offset="true"><span data-slate-string="true">      repoFolder := path.Join(middlewarePath, repo)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14852"><span data-slate-object="text" data-key="14853"><span data-slate-leaf="true" data-offset-key="14853:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14854"><span data-slate-leaf="true" data-offset-key="14854:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"remove"</span></span></span></span><span data-slate-object="text" data-key="14855"><span data-slate-leaf="true" data-offset-key="14855:0" data-first-offset="true"><span data-slate-string="true"> + path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14856"><span data-slate-leaf="true" data-offset-key="14856:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"go.mod"</span></span></span></span><span data-slate-object="text" data-key="14857"><span data-slate-leaf="true" data-offset-key="14857:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14858"><span data-slate-object="text" data-key="14859"><span data-slate-leaf="true" data-offset-key="14859:0" data-first-offset="true"><span data-slate-string="true">      os.Remove(path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14860"><span data-slate-leaf="true" data-offset-key="14860:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"go.mod"</span></span></span></span><span data-slate-object="text" data-key="14861"><span data-slate-leaf="true" data-offset-key="14861:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14862"><span data-slate-object="text" data-key="14863"><span data-slate-leaf="true" data-offset-key="14863:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14864"><span data-slate-leaf="true" data-offset-key="14864:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"remove"</span></span></span></span><span data-slate-object="text" data-key="14865"><span data-slate-leaf="true" data-offset-key="14865:0" data-first-offset="true"><span data-slate-string="true"> + path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14866"><span data-slate-leaf="true" data-offset-key="14866:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"go.sum"</span></span></span></span><span data-slate-object="text" data-key="14867"><span data-slate-leaf="true" data-offset-key="14867:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14868"><span data-slate-object="text" data-key="14869"><span data-slate-leaf="true" data-offset-key="14869:0" data-first-offset="true"><span data-slate-string="true">      os.Remove(path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14870"><span data-slate-leaf="true" data-offset-key="14870:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"go.sum"</span></span></span></span><span data-slate-object="text" data-key="14871"><span data-slate-leaf="true" data-offset-key="14871:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14872"><span data-slate-object="text" data-key="14873"><span data-slate-leaf="true" data-offset-key="14873:0" data-first-offset="true"><span data-slate-string="true">      fmt.Println(</span></span></span><span data-slate-object="text" data-key="14874"><span data-slate-leaf="true" data-offset-key="14874:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"remove"</span></span></span></span><span data-slate-object="text" data-key="14875"><span data-slate-leaf="true" data-offset-key="14875:0" data-first-offset="true"><span data-slate-string="true"> + path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14876"><span data-slate-leaf="true" data-offset-key="14876:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".git"</span></span></span></span><span data-slate-object="text" data-key="14877"><span data-slate-leaf="true" data-offset-key="14877:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14878"><span data-slate-object="text" data-key="14879"><span data-slate-leaf="true" data-offset-key="14879:0" data-first-offset="true"><span data-slate-string="true">      os.RemoveAll(path.Join(repoFolder, </span></span></span><span data-slate-object="text" data-key="14880"><span data-slate-leaf="true" data-offset-key="14880:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".git"</span></span></span></span><span data-slate-object="text" data-key="14881"><span data-slate-leaf="true" data-offset-key="14881:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14882"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14883"><span data-slate-object="text" data-key="14884"><span data-slate-leaf="true" data-offset-key="14884:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14885"><span data-slate-leaf="true" data-offset-key="14885:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">//step4 : 替换关键词</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14886"><span data-slate-object="text" data-key="14887"><span data-slate-leaf="true" data-offset-key="14887:0" data-first-offset="true"><span data-slate-string="true">      filepath.Walk(repoFolder, </span></span></span><span data-slate-object="text" data-key="14888"><span data-slate-leaf="true" data-offset-key="14888:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="14889"><span data-slate-leaf="true" data-offset-key="14889:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(path </span></span></span></span></span><span data-slate-object="text" data-key="14890"><span data-slate-leaf="true" data-offset-key="14890:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></span></span><span data-slate-object="text" data-key="14891"><span data-slate-leaf="true" data-offset-key="14891:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">, info os.FileInfo, err </span></span></span></span></span><span data-slate-object="text" data-key="14892"><span data-slate-leaf="true" data-offset-key="14892:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span></span></span><span data-slate-object="text" data-key="14893"><span data-slate-leaf="true" data-offset-key="14893:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">)</span></span></span></span></span><span data-slate-object="text" data-key="14894"><span data-slate-leaf="true" data-offset-key="14894:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14895"><span data-slate-leaf="true" data-offset-key="14895:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="14896"><span data-slate-leaf="true" data-offset-key="14896:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14897"><span data-slate-object="text" data-key="14898"><span data-slate-leaf="true" data-offset-key="14898:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14899"><span data-slate-leaf="true" data-offset-key="14899:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14900"><span data-slate-leaf="true" data-offset-key="14900:0" data-first-offset="true"><span data-slate-string="true"> info.IsDir() {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14901"><span data-slate-object="text" data-key="14902"><span data-slate-leaf="true" data-offset-key="14902:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14903"><span data-slate-leaf="true" data-offset-key="14903:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14904"><span data-slate-leaf="true" data-offset-key="14904:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14905"><span data-slate-leaf="true" data-offset-key="14905:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14906"><span data-slate-object="text" data-key="14907"><span data-slate-leaf="true" data-offset-key="14907:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14908"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14909"><span data-slate-object="text" data-key="14910"><span data-slate-leaf="true" data-offset-key="14910:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14911"><span data-slate-leaf="true" data-offset-key="14911:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14912"><span data-slate-leaf="true" data-offset-key="14912:0" data-first-offset="true"><span data-slate-string="true"> filepath.Ext(path) != </span></span></span><span data-slate-object="text" data-key="14913"><span data-slate-leaf="true" data-offset-key="14913:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".go"</span></span></span></span><span data-slate-object="text" data-key="14914"><span data-slate-leaf="true" data-offset-key="14914:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14915"><span data-slate-object="text" data-key="14916"><span data-slate-leaf="true" data-offset-key="14916:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14917"><span data-slate-leaf="true" data-offset-key="14917:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14918"><span data-slate-leaf="true" data-offset-key="14918:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14919"><span data-slate-leaf="true" data-offset-key="14919:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14920"><span data-slate-object="text" data-key="14921"><span data-slate-leaf="true" data-offset-key="14921:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14922"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14923"><span data-slate-object="text" data-key="14924"><span data-slate-leaf="true" data-offset-key="14924:0" data-first-offset="true"><span data-slate-string="true">         c, err := ioutil.ReadFile(path)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14925"><span data-slate-object="text" data-key="14926"><span data-slate-leaf="true" data-offset-key="14926:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14927"><span data-slate-leaf="true" data-offset-key="14927:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14928"><span data-slate-leaf="true" data-offset-key="14928:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14929"><span data-slate-leaf="true" data-offset-key="14929:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14930"><span data-slate-leaf="true" data-offset-key="14930:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14931"><span data-slate-object="text" data-key="14932"><span data-slate-leaf="true" data-offset-key="14932:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14933"><span data-slate-leaf="true" data-offset-key="14933:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14934"><span data-slate-leaf="true" data-offset-key="14934:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14935"><span data-slate-object="text" data-key="14936"><span data-slate-leaf="true" data-offset-key="14936:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14937"><span data-slate-object="text" data-key="14938"><span data-slate-leaf="true" data-offset-key="14938:0" data-first-offset="true"><span data-slate-string="true">         isContain := bytes.Contains(c, []</span></span></span><span data-slate-object="text" data-key="14939"><span data-slate-leaf="true" data-offset-key="14939:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">byte</span></span></span></span><span data-slate-object="text" data-key="14940"><span data-slate-leaf="true" data-offset-key="14940:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14941"><span data-slate-leaf="true" data-offset-key="14941:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/gin-gonic/gin"</span></span></span></span><span data-slate-object="text" data-key="14942"><span data-slate-leaf="true" data-offset-key="14942:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14943"><span data-slate-object="text" data-key="14944"><span data-slate-leaf="true" data-offset-key="14944:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14945"><span data-slate-leaf="true" data-offset-key="14945:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14946"><span data-slate-leaf="true" data-offset-key="14946:0" data-first-offset="true"><span data-slate-string="true"> isContain {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14947"><span data-slate-object="text" data-key="14948"><span data-slate-leaf="true" data-offset-key="14948:0" data-first-offset="true"><span data-slate-string="true">            fmt.Println(</span></span></span><span data-slate-object="text" data-key="14949"><span data-slate-leaf="true" data-offset-key="14949:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"更新文件:"</span></span></span></span><span data-slate-object="text" data-key="14950"><span data-slate-leaf="true" data-offset-key="14950:0" data-first-offset="true"><span data-slate-string="true"> + path)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14951"><span data-slate-object="text" data-key="14952"><span data-slate-leaf="true" data-offset-key="14952:0" data-first-offset="true"><span data-slate-string="true">            c = bytes.ReplaceAll(c, []</span></span></span><span data-slate-object="text" data-key="14953"><span data-slate-leaf="true" data-offset-key="14953:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">byte</span></span></span></span><span data-slate-object="text" data-key="14954"><span data-slate-leaf="true" data-offset-key="14954:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14955"><span data-slate-leaf="true" data-offset-key="14955:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/gin-gonic/gin"</span></span></span></span><span data-slate-object="text" data-key="14956"><span data-slate-leaf="true" data-offset-key="14956:0" data-first-offset="true"><span data-slate-string="true">), []</span></span></span><span data-slate-object="text" data-key="14957"><span data-slate-leaf="true" data-offset-key="14957:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">byte</span></span></span></span><span data-slate-object="text" data-key="14958"><span data-slate-leaf="true" data-offset-key="14958:0" data-first-offset="true"><span data-slate-string="true">(</span></span></span><span data-slate-object="text" data-key="14959"><span data-slate-leaf="true" data-offset-key="14959:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/gohade/hade/framework/gin"</span></span></span></span><span data-slate-object="text" data-key="14960"><span data-slate-leaf="true" data-offset-key="14960:0" data-first-offset="true"><span data-slate-string="true">))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14961"><span data-slate-object="text" data-key="14962"><span data-slate-leaf="true" data-offset-key="14962:0" data-first-offset="true"><span data-slate-string="true">            err = ioutil.WriteFile(path, c, </span></span></span><span data-slate-object="text" data-key="14963"><span data-slate-leaf="true" data-offset-key="14963:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0644</span></span></span></span><span data-slate-object="text" data-key="14964"><span data-slate-leaf="true" data-offset-key="14964:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14965"><span data-slate-object="text" data-key="14966"><span data-slate-leaf="true" data-offset-key="14966:0" data-first-offset="true"><span data-slate-string="true">            </span></span></span><span data-slate-object="text" data-key="14967"><span data-slate-leaf="true" data-offset-key="14967:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="14968"><span data-slate-leaf="true" data-offset-key="14968:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="14969"><span data-slate-leaf="true" data-offset-key="14969:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="14970"><span data-slate-leaf="true" data-offset-key="14970:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14971"><span data-slate-object="text" data-key="14972"><span data-slate-leaf="true" data-offset-key="14972:0" data-first-offset="true"><span data-slate-string="true">               </span></span></span><span data-slate-object="text" data-key="14973"><span data-slate-leaf="true" data-offset-key="14973:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14974"><span data-slate-leaf="true" data-offset-key="14974:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14975"><span data-slate-object="text" data-key="14976"><span data-slate-leaf="true" data-offset-key="14976:0" data-first-offset="true"><span data-slate-string="true">            }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14977"><span data-slate-object="text" data-key="14978"><span data-slate-leaf="true" data-offset-key="14978:0" data-first-offset="true"><span data-slate-string="true">         }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14979"></div><div data-slate-type="code-line" data-slate-object="block" data-key="14980"><span data-slate-object="text" data-key="14981"><span data-slate-leaf="true" data-offset-key="14981:0" data-first-offset="true"><span data-slate-string="true">         </span></span></span><span data-slate-object="text" data-key="14982"><span data-slate-leaf="true" data-offset-key="14982:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14983"><span data-slate-leaf="true" data-offset-key="14983:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14984"><span data-slate-leaf="true" data-offset-key="14984:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14985"><span data-slate-object="text" data-key="14986"><span data-slate-leaf="true" data-offset-key="14986:0" data-first-offset="true"><span data-slate-string="true">      })</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14987"><span data-slate-object="text" data-key="14988"><span data-slate-leaf="true" data-offset-key="14988:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="14989"><span data-slate-leaf="true" data-offset-key="14989:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="14990"><span data-slate-leaf="true" data-offset-key="14990:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="14991"><span data-slate-leaf="true" data-offset-key="14991:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14992"><span data-slate-object="text" data-key="14993"><span data-slate-leaf="true" data-offset-key="14993:0" data-first-offset="true"><span data-slate-string="true">   },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="14994"><span data-slate-object="text" data-key="14995"><span data-slate-leaf="true" data-offset-key="14995:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="14996"><span data-slate-object="text" data-key="14997"><span data-slate-leaf="true" data-offset-key="14997:0" data-first-offset="true"><span data-slate-string="true">我们可以下载 cors 项目做一下验证，运行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="14998"><span data-slate-object="text" data-key="14999"><span data-slate-leaf="true" data-offset-key="14999:0" data-first-offset="true"><span data-slate-string="true">./hade middleware migrate</span></span></span></span><span data-slate-object="text" data-key="15000"><span data-slate-leaf="true" data-offset-key="15000:0" data-first-offset="true"><span data-slate-string="true"> 命令，并且输入 cors。你会在控制台看到这些信息：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15001"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/6f/5f/6fd8197207c92b3b362a89cc4676015f.png?wh=682x384"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15002"><span data-slate-object="text" data-key="15003"><span data-slate-leaf="true" data-offset-key="15003:0" data-first-offset="true"><span data-slate-string="true">并且在目录中看到 cors 中间件已经完整下载下来了。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15004"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/70/09/709dbbc8c2140byy56459c202aa66909.png?wh=343x610"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15005"><span data-slate-object="text" data-key="15006"><span data-slate-leaf="true" data-offset-key="15006:0" data-first-offset="true"><span data-slate-string="true">然后，可以直接在 app/http/route.go 中直接使用这个 cors 中间件：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="15007"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="15008"><span data-slate-object="text" data-key="15009"><span data-slate-leaf="true" data-offset-key="15009:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15010"></div><div data-slate-type="code-line" data-slate-object="block" data-key="15011"><span data-slate-object="text" data-key="15012"><span data-slate-leaf="true" data-offset-key="15012:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// Routes 绑定业务层路由</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15013"><span data-slate-object="text" data-key="15014"><span data-slate-leaf="true" data-offset-key="15014:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="15015"><span data-slate-leaf="true" data-offset-key="15015:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="15016"><span data-slate-leaf="true" data-offset-key="15016:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">Routes</span></span></span></span></span><span data-slate-object="text" data-key="15017"><span data-slate-leaf="true" data-offset-key="15017:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *gin.Engine)</span></span></span></span></span><span data-slate-object="text" data-key="15018"><span data-slate-leaf="true" data-offset-key="15018:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15019"><span data-slate-object="text" data-key="15020"><span data-slate-leaf="true" data-offset-key="15020:0" data-first-offset="true"><span data-slate-string="true">   ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15021"><span data-slate-object="text" data-key="15022"><span data-slate-leaf="true" data-offset-key="15022:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="15023"><span data-slate-leaf="true" data-offset-key="15023:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 使用 cors 中间件</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15024"><span data-slate-object="text" data-key="15025"><span data-slate-leaf="true" data-offset-key="15025:0" data-first-offset="true"><span data-slate-string="true">   r.Use(cors.Default())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15026"><span data-slate-object="text" data-key="15027"><span data-slate-leaf="true" data-offset-key="15027:0" data-first-offset="true"><span data-slate-string="true">   ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="15028"><span data-slate-object="text" data-key="15029"><span data-slate-leaf="true" data-offset-key="15029:0" data-first-offset="true"><span data-slate-string="true"> }</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15030"><span data-slate-object="text" data-key="15031"><span data-slate-leaf="true" data-offset-key="15031:0" data-first-offset="true"><span data-slate-string="true">验证完成！</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15032"><span data-slate-object="text" data-key="15033"><span data-slate-leaf="true" data-offset-key="15033:0" data-first-offset="true"><span data-slate-string="true">今天所有代码都保存在 GitHub 上的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="15034"><span data-slate-object="text" data-key="15035"><span data-slate-leaf="true" data-offset-key="15035:0" data-first-offset="true"><span data-slate-string="true">geekbang/21</span></span></span></a><span data-slate-object="text" data-key="15036"><span data-slate-leaf="true" data-offset-key="15036:0" data-first-offset="true"><span data-slate-string="true"> 分支了。附上目录结构供你对比查看，只修改了 framework/command/ 目录下的 cmd.go、provider.go、middleware.go 文件。</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="15037"><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/78/89/7889877151dc4d4e306554a64c550c89.png?wh=476x936" style="width: auto;"></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="15038" id="sr-toc-7"><span data-slate-object="text" data-key="15039"><span data-slate-leaf="true" data-offset-key="15039:0" data-first-offset="true"><span data-slate-string="true">小结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="15040"><span data-slate-object="text" data-key="15041"><span data-slate-leaf="true" data-offset-key="15041:0" data-first-offset="true"><span data-slate-string="true">今天增加的命令不少，自动化创建服务工具、命令行工具，以及中间件迁移工具，这些命令都为我们后续开发应用提供了不少便利。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15042"><span data-slate-object="text" data-key="15043"><span data-slate-leaf="true" data-offset-key="15043:0" data-first-offset="true"><span data-slate-string="true">其实每个自动化命令行工具实现的思路都是差不多的，先思考清楚对于这个工具我们要自动化生成什么，然后使用代码和对应的模版生成对应的文件，并且替换其中特有的单词。原理不复杂，但是对于实际的工作，是非常有帮助的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15044"><span data-slate-object="text" data-key="15045"><span data-slate-leaf="true" data-offset-key="15045:0" data-first-offset="true"><span data-slate-string="true">这一节课你应该可以感受到之前将 cobra 引入我们的框架是一个多么正确的决定，在 cobra 之上，我们才能实现这些方便的自动化工具。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="15046" id="sr-toc-8"><span data-slate-object="text" data-key="15047"><span data-slate-leaf="true" data-offset-key="15047:0" data-first-offset="true"><span data-slate-string="true">思考题</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="15048"><span data-slate-object="text" data-key="15049"><span data-slate-leaf="true" data-offset-key="15049:0" data-first-offset="true"><span data-slate-string="true">我们实现的自动化服务./hade command list 命令，目前只展示了一级命令，在写这篇文章的时候我反思了一下，其实可以扩展成为树形结构展示，同时展示一级 / 二级 / 三级 / 命令。你可以想想如何实现，如果可以的话，可以去 github.com/gohade/hade 项目中提交一个 merge request 来补充这个功能吧！</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="15050"><span data-slate-object="text" data-key="15051"><span data-slate-leaf="true" data-offset-key="15051:0" data-first-offset="true"><span data-slate-string="true">欢迎在留言区分享你的思考。我们下节课见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/60/8b/601539e39d1f599f26bffa89653fca8b.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-9">精选留言 (3)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/b2/e0/bf56878a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>kkxue</span><span><div class="sr-rd-content-center"><img class="" src="https://static001.geekbang.org/resource/image/89/43/89yyff4c4c2e2b73ce4931bb01a6a943.png"></div></span></div></div><div>课程设计的好棒</div><div><div>2021-11-05</div><div><div><i></i><span></span></div><div><i></i><span>3</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>qinsi</span></div></div><div>中间件也要拷贝代码吗... 是否可以安装以后在 go.mod 里 replace 呢？</div><div><div>2021-11-05</div><div><div><i></i><span>1</span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/12/d6/98/e2d8f2a9.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span>zzq</span></div></div><div>大佬， 在 framework/command/middleware.go 文件中缺少了    默认：同中间件名称。 if folder == "" {folder = name}   </div><div><p>作者回复：感谢，github 已经更新，也合并到 hade 的 master 上了</p></div><div><div>2021-12-01</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1a"><outline class="toc-level-h1" data-reactid=".1a.0" style="width: 175px;"><active data-reactid=".1a.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1a.0.1"><span data-reactid=".1a.0.1.0">21｜自动化（上）：DRY，如何自动化一切重复性劳动？</span></a></outline><outline class="toc-level-h2" data-reactid=".1a.1" style="width: 165px;"><active data-reactid=".1a.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1a.1.1"><span data-reactid=".1a.1.1.0">自动化创建服务工具</span></a></outline><outline class="toc-level-h3" data-reactid=".1a.2" style="width: 155px;"><active data-reactid=".1a.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1a.2.1"><span data-reactid=".1a.2.1.0">命令创建</span></a></outline><outline class="toc-level-h3" data-reactid=".1a.3" style="width: 155px;"><active data-reactid=".1a.3.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1a.3.1"><span data-reactid=".1a.3.1.0">List 命令的实现</span></a></outline><outline class="toc-level-h3" data-reactid=".1a.4" style="width: 155px;"><active data-reactid=".1a.4.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".1a.4.1"><span data-reactid=".1a.4.1.0">new 命令的实现</span></a></outline><outline class="toc-level-h2" data-reactid=".1a.5" style="width: 165px;"><active data-reactid=".1a.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1a.5.1"><span data-reactid=".1a.5.1.0">自动化创建命令行工具</span></a></outline><outline class="toc-level-h2" data-reactid=".1a.6" style="width: 165px;"><active data-reactid=".1a.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1a.6.1"><span data-reactid=".1a.6.1.0">自动化中间件迁移工具</span></a></outline><outline class="toc-level-h2" data-reactid=".1a.7" style="width: 165px;"><active data-reactid=".1a.7.0"></active><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1a.7.1"><span data-reactid=".1a.7.1.0">小结</span></a></outline><outline class="toc-level-h3" data-reactid=".1a.8" style="width: 155px;"><active data-reactid=".1a.8.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1a.8.1"><span data-reactid=".1a.8.1.0">思考题</span></a></outline><outline class="toc-level-h2" data-reactid=".1a.9" style="width: 165px;"><active data-reactid=".1a.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1a.9.1"><span data-reactid=".1a.9.1.0">精选留言 (3)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/435518" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>