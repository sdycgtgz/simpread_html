
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 34 | SDK 设计（下）：IAM 项目 Go SDK 设计和实现</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>34 | SDK 设计（下）：IAM 项目 Go SDK 设计和实现</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">这一讲我们来了解目前业界有哪些优秀的开源日志包，以及手把手教你从 0 编写一个日志包</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0"> 34 | SDK 设计（下）：IAM 项目 Go SDK 设计和实现</h1><div><span>孔令飞</span> <span> 2021-08-12</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/9c/f4/9cbb918a43c8808b3a9958cda32dbff4.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：孔令飞</span><span>大小：11.35M</span><span> 时长：12:25</span></div></div><audio title="34 | SDK 设计（下）：IAM项目Go SDK设计和实现" src="https://res001.geekbang.org/media/audio/7b/01/7b72394f7175da9db183106b51076101/ld/ld.m3u8" __idm_id__="319502"></audio></div><div><div><div><div data-slate-editor="true" data-key="19637" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="19638"><span data-slate-object="text" data-key="19639"><span data-slate-leaf="true" data-offset-key="19639:0" data-first-offset="true"><span data-slate-string="true">你好，我是孔令飞。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19640"><span data-slate-object="text" data-key="19641"><span data-slate-leaf="true" data-offset-key="19641:0" data-first-offset="true"><span data-slate-string="true">上一讲，我介绍了公有云厂商普遍采用的 SDK 设计方式。其实，还有一些比较优秀的 SDK 设计方式，比如 Kubernetes 的 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19642"><span data-slate-object="text" data-key="19643"><span data-slate-leaf="true" data-offset-key="19643:0" data-first-offset="true"><span data-slate-string="true">client-go</span></span></span></a><span data-slate-object="text" data-key="19644"><span data-slate-leaf="true" data-offset-key="19644:0" data-first-offset="true"><span data-slate-string="true"> SDK 设计方式。IAM 项目参考 client-go，也实现了 client-go 风格的 SDK：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19645"><span data-slate-object="text" data-key="19646"><span data-slate-leaf="true" data-offset-key="19646:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go</span></span></span></a><span data-slate-object="text" data-key="19647"><span data-slate-leaf="true" data-offset-key="19647:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19648"><span data-slate-object="text" data-key="19649"><span data-slate-leaf="true" data-offset-key="19649:0" data-first-offset="true"><span data-slate-string="true">和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19650"><span data-slate-object="text" data-key="19651"><span data-slate-leaf="true" data-offset-key="19651:0" data-first-offset="true"><span data-slate-string="true">33 讲</span></span></span></a><span data-slate-object="text" data-key="19652"><span data-slate-leaf="true" data-offset-key="19652:0" data-first-offset="true"><span data-slate-string="true"> 介绍的 SDK 设计方式相比，client-go 风格的 SDK 具有以下优点：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19653"><div data-slate-type="list-line" data-slate-object="block" data-key="19654"><span data-slate-object="text" data-key="19655"><span data-slate-leaf="true" data-offset-key="19655:0" data-first-offset="true"><span data-slate-string="true">大量使用了 Go interface 特性，将接口的定义和实现解耦，可以支持多种实现方式。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19656"><span data-slate-object="text" data-key="19657"><span data-slate-leaf="true" data-offset-key="19657:0" data-first-offset="true"><span data-slate-string="true">接口调用层级跟资源的层级相匹配，调用方式更加友好。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19658"><span data-slate-object="text" data-key="19659"><span data-slate-leaf="true" data-offset-key="19659:0" data-first-offset="true"><span data-slate-string="true">多版本共存。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19660"><span data-slate-object="text" data-key="19661"><span data-slate-leaf="true" data-offset-key="19661:0" data-first-offset="true"><span data-slate-string="true">所以，我更推荐你使用 marmotedu-sdk-go。接下来，我们就来看下 marmotedu-sdk-go 是如何设计和实现的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="19662" id="sr-toc-1"><span data-slate-object="text" data-key="19663"><span data-slate-leaf="true" data-offset-key="19663:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 设计</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="19664"><span data-slate-object="text" data-key="19665"><span data-slate-leaf="true" data-offset-key="19665:0" data-first-offset="true"><span data-slate-string="true">和 medu-sdk-go 相比，marmotedu-sdk-go 的设计和实现要复杂一些，但功能更强大，使用体验也更好。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19666"><span data-slate-object="text" data-key="19667"><span data-slate-leaf="true" data-offset-key="19667:0" data-first-offset="true"><span data-slate-string="true">这里，我们先来看一个使用 SDK 调用 iam-authz-server  </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19668"><span data-slate-object="text" data-key="19669"><span data-slate-leaf="true" data-offset-key="19669:0" data-first-offset="true"><span data-slate-string="true">/v1/authz</span></span></span></span><span data-slate-object="text" data-key="19670"><span data-slate-leaf="true" data-offset-key="19670:0" data-first-offset="true"><span data-slate-string="true"> 接口的示例，代码保存在</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19671"><span data-slate-object="text" data-key="19672"><span data-slate-leaf="true" data-offset-key="19672:0" data-first-offset="true"><span data-slate-string="true"> marmotedu-sdk-go/examples/authz_clientset/main.go</span></span></span></a><span data-slate-object="text" data-key="19673"><span data-slate-leaf="true" data-offset-key="19673:0" data-first-offset="true"><span data-slate-string="true"> 文件中：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19674"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div><div data-code-line-number="39"></div><div data-code-line-number="40"></div><div data-code-line-number="41"></div><div data-code-line-number="42"></div><div data-code-line-number="43"></div><div data-code-line-number="44"></div><div data-code-line-number="45"></div><div data-code-line-number="46"></div><div data-code-line-number="47"></div><div data-code-line-number="48"></div><div data-code-line-number="49"></div><div data-code-line-number="50"></div><div data-code-line-number="51"></div><div data-code-line-number="52"></div><div data-code-line-number="53"></div><div data-code-line-number="54"></div><div data-code-line-number="55"></div><div data-code-line-number="56"></div><div data-code-line-number="57"></div><div data-code-line-number="58"></div><div data-code-line-number="59"></div><div data-code-line-number="60"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19675"><span data-slate-object="text" data-key="19676"><span data-slate-leaf="true" data-offset-key="19676:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">package</span></span></span></span><span data-slate-object="text" data-key="19677"><span data-slate-leaf="true" data-offset-key="19677:0" data-first-offset="true"><span data-slate-string="true"> main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19678"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19679"><span data-slate-object="text" data-key="19680"><span data-slate-leaf="true" data-offset-key="19680:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">import</span></span></span></span><span data-slate-object="text" data-key="19681"><span data-slate-leaf="true" data-offset-key="19681:0" data-first-offset="true"><span data-slate-string="true"> (</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19682"><span data-slate-object="text" data-key="19683"><span data-slate-leaf="true" data-offset-key="19683:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19684"><span data-slate-leaf="true" data-offset-key="19684:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"context"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19685"><span data-slate-object="text" data-key="19686"><span data-slate-leaf="true" data-offset-key="19686:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19687"><span data-slate-leaf="true" data-offset-key="19687:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"flag"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19688"><span data-slate-object="text" data-key="19689"><span data-slate-leaf="true" data-offset-key="19689:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19690"><span data-slate-leaf="true" data-offset-key="19690:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"fmt"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19691"><span data-slate-object="text" data-key="19692"><span data-slate-leaf="true" data-offset-key="19692:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19693"><span data-slate-leaf="true" data-offset-key="19693:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"path/filepath"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19694"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19695"><span data-slate-object="text" data-key="19696"><span data-slate-leaf="true" data-offset-key="19696:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19697"><span data-slate-leaf="true" data-offset-key="19697:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/ory/ladon"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19698"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19699"><span data-slate-object="text" data-key="19700"><span data-slate-leaf="true" data-offset-key="19700:0" data-first-offset="true"><span data-slate-string="true">  metav1 </span></span></span><span data-slate-object="text" data-key="19701"><span data-slate-leaf="true" data-offset-key="19701:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/component-base/pkg/meta/v1"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19702"><span data-slate-object="text" data-key="19703"><span data-slate-leaf="true" data-offset-key="19703:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19704"><span data-slate-leaf="true" data-offset-key="19704:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/component-base/pkg/util/homedir"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19705"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19706"><span data-slate-object="text" data-key="19707"><span data-slate-leaf="true" data-offset-key="19707:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19708"><span data-slate-leaf="true" data-offset-key="19708:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/marmotedu-sdk-go/marmotedu"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19709"><span data-slate-object="text" data-key="19710"><span data-slate-leaf="true" data-offset-key="19710:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19711"><span data-slate-leaf="true" data-offset-key="19711:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"github.com/marmotedu/marmotedu-sdk-go/tools/clientcmd"</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19712"><span data-slate-object="text" data-key="19713"><span data-slate-leaf="true" data-offset-key="19713:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19714"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19715"><span data-slate-object="text" data-key="19716"><span data-slate-leaf="true" data-offset-key="19716:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="19717"><span data-slate-leaf="true" data-offset-key="19717:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="19718"><span data-slate-leaf="true" data-offset-key="19718:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">main</span></span></span></span></span><span data-slate-object="text" data-key="19719"><span data-slate-leaf="true" data-offset-key="19719:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="19720"><span data-slate-leaf="true" data-offset-key="19720:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19721"><span data-slate-object="text" data-key="19722"><span data-slate-leaf="true" data-offset-key="19722:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19723"><span data-slate-leaf="true" data-offset-key="19723:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="19724"><span data-slate-leaf="true" data-offset-key="19724:0" data-first-offset="true"><span data-slate-string="true"> iamconfig *</span></span></span><span data-slate-object="text" data-key="19725"><span data-slate-leaf="true" data-offset-key="19725:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19726"><span data-slate-object="text" data-key="19727"><span data-slate-leaf="true" data-offset-key="19727:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19728"><span data-slate-leaf="true" data-offset-key="19728:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19729"><span data-slate-leaf="true" data-offset-key="19729:0" data-first-offset="true"><span data-slate-string="true"> home := homedir.HomeDir(); home != </span></span></span><span data-slate-object="text" data-key="19730"><span data-slate-leaf="true" data-offset-key="19730:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="19731"><span data-slate-leaf="true" data-offset-key="19731:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19732"><span data-slate-object="text" data-key="19733"><span data-slate-leaf="true" data-offset-key="19733:0" data-first-offset="true"><span data-slate-string="true">    iamconfig = flag.String(</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19734"><span data-slate-object="text" data-key="19735"><span data-slate-leaf="true" data-offset-key="19735:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="19736"><span data-slate-leaf="true" data-offset-key="19736:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"iamconfig"</span></span></span></span><span data-slate-object="text" data-key="19737"><span data-slate-leaf="true" data-offset-key="19737:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19738"><span data-slate-object="text" data-key="19739"><span data-slate-leaf="true" data-offset-key="19739:0" data-first-offset="true"><span data-slate-string="true">      filepath.Join(home, </span></span></span><span data-slate-object="text" data-key="19740"><span data-slate-leaf="true" data-offset-key="19740:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".iam"</span></span></span></span><span data-slate-object="text" data-key="19741"><span data-slate-leaf="true" data-offset-key="19741:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="19742"><span data-slate-leaf="true" data-offset-key="19742:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"config"</span></span></span></span><span data-slate-object="text" data-key="19743"><span data-slate-leaf="true" data-offset-key="19743:0" data-first-offset="true"><span data-slate-string="true">),</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19744"><span data-slate-object="text" data-key="19745"><span data-slate-leaf="true" data-offset-key="19745:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="19746"><span data-slate-leaf="true" data-offset-key="19746:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"(optional) absolute path to the iamconfig file"</span></span></span></span><span data-slate-object="text" data-key="19747"><span data-slate-leaf="true" data-offset-key="19747:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19748"><span data-slate-object="text" data-key="19749"><span data-slate-leaf="true" data-offset-key="19749:0" data-first-offset="true"><span data-slate-string="true">    )</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19750"><span data-slate-object="text" data-key="19751"><span data-slate-leaf="true" data-offset-key="19751:0" data-first-offset="true"><span data-slate-string="true">  } </span></span></span><span data-slate-object="text" data-key="19752"><span data-slate-leaf="true" data-offset-key="19752:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">else</span></span></span></span><span data-slate-object="text" data-key="19753"><span data-slate-leaf="true" data-offset-key="19753:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19754"><span data-slate-object="text" data-key="19755"><span data-slate-leaf="true" data-offset-key="19755:0" data-first-offset="true"><span data-slate-string="true">    iamconfig = flag.String(</span></span></span><span data-slate-object="text" data-key="19756"><span data-slate-leaf="true" data-offset-key="19756:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"iamconfig"</span></span></span></span><span data-slate-object="text" data-key="19757"><span data-slate-leaf="true" data-offset-key="19757:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="19758"><span data-slate-leaf="true" data-offset-key="19758:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="19759"><span data-slate-leaf="true" data-offset-key="19759:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="19760"><span data-slate-leaf="true" data-offset-key="19760:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"absolute path to the iamconfig file"</span></span></span></span><span data-slate-object="text" data-key="19761"><span data-slate-leaf="true" data-offset-key="19761:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19762"><span data-slate-object="text" data-key="19763"><span data-slate-leaf="true" data-offset-key="19763:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19764"><span data-slate-object="text" data-key="19765"><span data-slate-leaf="true" data-offset-key="19765:0" data-first-offset="true"><span data-slate-string="true">  flag.Parse()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19766"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19767"><span data-slate-object="text" data-key="19768"><span data-slate-leaf="true" data-offset-key="19768:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19769"><span data-slate-leaf="true" data-offset-key="19769:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// use the current context in iamconfig</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19770"><span data-slate-object="text" data-key="19771"><span data-slate-leaf="true" data-offset-key="19771:0" data-first-offset="true"><span data-slate-string="true">  config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="19772"><span data-slate-leaf="true" data-offset-key="19772:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="19773"><span data-slate-leaf="true" data-offset-key="19773:0" data-first-offset="true"><span data-slate-string="true">, *iamconfig)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19774"><span data-slate-object="text" data-key="19775"><span data-slate-leaf="true" data-offset-key="19775:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19776"><span data-slate-leaf="true" data-offset-key="19776:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19777"><span data-slate-leaf="true" data-offset-key="19777:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19778"><span data-slate-leaf="true" data-offset-key="19778:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19779"><span data-slate-leaf="true" data-offset-key="19779:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19780"><span data-slate-object="text" data-key="19781"><span data-slate-leaf="true" data-offset-key="19781:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19782"><span data-slate-leaf="true" data-offset-key="19782:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">panic</span></span></span></span><span data-slate-object="text" data-key="19783"><span data-slate-leaf="true" data-offset-key="19783:0" data-first-offset="true"><span data-slate-string="true">(err.Error())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19784"><span data-slate-object="text" data-key="19785"><span data-slate-leaf="true" data-offset-key="19785:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19786"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19787"><span data-slate-object="text" data-key="19788"><span data-slate-leaf="true" data-offset-key="19788:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19789"><span data-slate-leaf="true" data-offset-key="19789:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// create the clientset</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19790"><span data-slate-object="text" data-key="19791"><span data-slate-leaf="true" data-offset-key="19791:0" data-first-offset="true"><span data-slate-string="true">  clientset, err := marmotedu.NewForConfig(config)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19792"><span data-slate-object="text" data-key="19793"><span data-slate-leaf="true" data-offset-key="19793:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19794"><span data-slate-leaf="true" data-offset-key="19794:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19795"><span data-slate-leaf="true" data-offset-key="19795:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19796"><span data-slate-leaf="true" data-offset-key="19796:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19797"><span data-slate-leaf="true" data-offset-key="19797:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19798"><span data-slate-object="text" data-key="19799"><span data-slate-leaf="true" data-offset-key="19799:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19800"><span data-slate-leaf="true" data-offset-key="19800:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">panic</span></span></span></span><span data-slate-object="text" data-key="19801"><span data-slate-leaf="true" data-offset-key="19801:0" data-first-offset="true"><span data-slate-string="true">(err.Error())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19802"><span data-slate-object="text" data-key="19803"><span data-slate-leaf="true" data-offset-key="19803:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19804"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19805"><span data-slate-object="text" data-key="19806"><span data-slate-leaf="true" data-offset-key="19806:0" data-first-offset="true"><span data-slate-string="true">  request := &amp;ladon.Request{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19807"><span data-slate-object="text" data-key="19808"><span data-slate-leaf="true" data-offset-key="19808:0" data-first-offset="true"><span data-slate-string="true">    Resource: </span></span></span><span data-slate-object="text" data-key="19809"><span data-slate-leaf="true" data-offset-key="19809:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"resources:articles:ladon-introduction"</span></span></span></span><span data-slate-object="text" data-key="19810"><span data-slate-leaf="true" data-offset-key="19810:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19811"><span data-slate-object="text" data-key="19812"><span data-slate-leaf="true" data-offset-key="19812:0" data-first-offset="true"><span data-slate-string="true">    Action:   </span></span></span><span data-slate-object="text" data-key="19813"><span data-slate-leaf="true" data-offset-key="19813:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"delete"</span></span></span></span><span data-slate-object="text" data-key="19814"><span data-slate-leaf="true" data-offset-key="19814:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19815"><span data-slate-object="text" data-key="19816"><span data-slate-leaf="true" data-offset-key="19816:0" data-first-offset="true"><span data-slate-string="true">    Subject:  </span></span></span><span data-slate-object="text" data-key="19817"><span data-slate-leaf="true" data-offset-key="19817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"users:peter"</span></span></span></span><span data-slate-object="text" data-key="19818"><span data-slate-leaf="true" data-offset-key="19818:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19819"><span data-slate-object="text" data-key="19820"><span data-slate-leaf="true" data-offset-key="19820:0" data-first-offset="true"><span data-slate-string="true">    Context: ladon.Context{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19821"><span data-slate-object="text" data-key="19822"><span data-slate-leaf="true" data-offset-key="19822:0" data-first-offset="true"><span data-slate-string="true">      </span></span></span><span data-slate-object="text" data-key="19823"><span data-slate-leaf="true" data-offset-key="19823:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"remoteIP"</span></span></span></span><span data-slate-object="text" data-key="19824"><span data-slate-leaf="true" data-offset-key="19824:0" data-first-offset="true"><span data-slate-string="true">: </span></span></span><span data-slate-object="text" data-key="19825"><span data-slate-leaf="true" data-offset-key="19825:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"192.168.0.5"</span></span></span></span><span data-slate-object="text" data-key="19826"><span data-slate-leaf="true" data-offset-key="19826:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19827"><span data-slate-object="text" data-key="19828"><span data-slate-leaf="true" data-offset-key="19828:0" data-first-offset="true"><span data-slate-string="true">    },</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19829"><span data-slate-object="text" data-key="19830"><span data-slate-leaf="true" data-offset-key="19830:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19831"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19832"><span data-slate-object="text" data-key="19833"><span data-slate-leaf="true" data-offset-key="19833:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19834"><span data-slate-leaf="true" data-offset-key="19834:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// Authorize the request</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19835"><span data-slate-object="text" data-key="19836"><span data-slate-leaf="true" data-offset-key="19836:0" data-first-offset="true"><span data-slate-string="true">  fmt.Println(</span></span></span><span data-slate-object="text" data-key="19837"><span data-slate-leaf="true" data-offset-key="19837:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorize request..."</span></span></span></span><span data-slate-object="text" data-key="19838"><span data-slate-leaf="true" data-offset-key="19838:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19839"><span data-slate-object="text" data-key="19840"><span data-slate-leaf="true" data-offset-key="19840:0" data-first-offset="true"><span data-slate-string="true">  ret, err := clientset.Iam().AuthzV1().Authz().Authorize(context.TODO(), request, metav1.AuthorizeOptions{})</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19841"><span data-slate-object="text" data-key="19842"><span data-slate-leaf="true" data-offset-key="19842:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="19843"><span data-slate-leaf="true" data-offset-key="19843:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19844"><span data-slate-leaf="true" data-offset-key="19844:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19845"><span data-slate-leaf="true" data-offset-key="19845:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19846"><span data-slate-leaf="true" data-offset-key="19846:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19847"><span data-slate-object="text" data-key="19848"><span data-slate-leaf="true" data-offset-key="19848:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19849"><span data-slate-leaf="true" data-offset-key="19849:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">panic</span></span></span></span><span data-slate-object="text" data-key="19850"><span data-slate-leaf="true" data-offset-key="19850:0" data-first-offset="true"><span data-slate-string="true">(err.Error())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19851"><span data-slate-object="text" data-key="19852"><span data-slate-leaf="true" data-offset-key="19852:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19853"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19854"><span data-slate-object="text" data-key="19855"><span data-slate-leaf="true" data-offset-key="19855:0" data-first-offset="true"><span data-slate-string="true">  fmt.Printf(</span></span></span><span data-slate-object="text" data-key="19856"><span data-slate-leaf="true" data-offset-key="19856:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorize response: %s.\n"</span></span></span></span><span data-slate-object="text" data-key="19857"><span data-slate-leaf="true" data-offset-key="19857:0" data-first-offset="true"><span data-slate-string="true">, ret.ToString())</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19858"><span data-slate-object="text" data-key="19859"><span data-slate-leaf="true" data-offset-key="19859:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19860"><span data-slate-object="text" data-key="19861"><span data-slate-leaf="true" data-offset-key="19861:0" data-first-offset="true"><span data-slate-string="true">在上面的代码示例中，包含了下面的操作。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19862"><div data-slate-type="list-line" data-slate-object="block" data-key="19863"><span data-slate-object="text" data-key="19864"><span data-slate-leaf="true" data-offset-key="19864:0" data-first-offset="true"><span data-slate-string="true">首先，调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19865"><span data-slate-object="text" data-key="19866"><span data-slate-leaf="true" data-offset-key="19866:0" data-first-offset="true"><span data-slate-string="true">BuildConfigFromFlags</span></span></span></span><span data-slate-object="text" data-key="19867"><span data-slate-leaf="true" data-offset-key="19867:0" data-first-offset="true"><span data-slate-string="true"> 函数，创建出 SDK 的配置实例 config；</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19868"><span data-slate-object="text" data-key="19869"><span data-slate-leaf="true" data-offset-key="19869:0" data-first-offset="true"><span data-slate-string="true">接着，调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19870"><span data-slate-object="text" data-key="19871"><span data-slate-leaf="true" data-offset-key="19871:0" data-first-offset="true"><span data-slate-string="true">marmotedu.NewForConfig(config)</span></span></span></span><span data-slate-object="text" data-key="19872"><span data-slate-leaf="true" data-offset-key="19872:0" data-first-offset="true"><span data-slate-string="true"> 创建了 IAM 项目的客户端 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19873"><span data-slate-object="text" data-key="19874"><span data-slate-leaf="true" data-offset-key="19874:0" data-first-offset="true"><span data-slate-string="true">clientset</span></span></span></span><span data-slate-object="text" data-key="19875"><span data-slate-leaf="true" data-offset-key="19875:0" data-first-offset="true"><span data-slate-string="true"> ;</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19876"><span data-slate-object="text" data-key="19877"><span data-slate-leaf="true" data-offset-key="19877:0" data-first-offset="true"><span data-slate-string="true">最后，调用以下代码请求 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19878"><span data-slate-object="text" data-key="19879"><span data-slate-leaf="true" data-offset-key="19879:0" data-first-offset="true"><span data-slate-string="true">/v1/authz</span></span></span></span><span data-slate-object="text" data-key="19880"><span data-slate-leaf="true" data-offset-key="19880:0" data-first-offset="true"><span data-slate-string="true"> 接口执行资源授权请求：</span></span></span></div></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19881"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19882"><span data-slate-object="text" data-key="19883"><span data-slate-leaf="true" data-offset-key="19883:0" data-first-offset="true"><span data-slate-string="true">ret, err := clientset.Iam().AuthzV1().Authz().Authorize(context.TODO(), request, metav1.AuthorizeOptions{})    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19884"><span data-slate-object="text" data-key="19885"><span data-slate-leaf="true" data-offset-key="19885:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="19886"><span data-slate-leaf="true" data-offset-key="19886:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="19887"><span data-slate-leaf="true" data-offset-key="19887:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="19888"><span data-slate-leaf="true" data-offset-key="19888:0" data-first-offset="true"><span data-slate-string="true"> {           </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19889"><span data-slate-object="text" data-key="19890"><span data-slate-leaf="true" data-offset-key="19890:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="19891"><span data-slate-leaf="true" data-offset-key="19891:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">panic</span></span></span></span><span data-slate-object="text" data-key="19892"><span data-slate-leaf="true" data-offset-key="19892:0" data-first-offset="true"><span data-slate-string="true">(err.Error())    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19893"><span data-slate-object="text" data-key="19894"><span data-slate-leaf="true" data-offset-key="19894:0" data-first-offset="true"><span data-slate-string="true">}    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19895"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19896"><span data-slate-object="text" data-key="19897"><span data-slate-leaf="true" data-offset-key="19897:0" data-first-offset="true"><span data-slate-string="true">fmt.Printf(</span></span></span><span data-slate-object="text" data-key="19898"><span data-slate-leaf="true" data-offset-key="19898:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorize response: %s.\n"</span></span></span></span><span data-slate-object="text" data-key="19899"><span data-slate-leaf="true" data-offset-key="19899:0" data-first-offset="true"><span data-slate-string="true">, ret.ToString())</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19900"><span data-slate-object="text" data-key="19901"><span data-slate-leaf="true" data-offset-key="19901:0" data-first-offset="true"><span data-slate-string="true">调用格式为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19902"><span data-slate-object="text" data-key="19903"><span data-slate-leaf="true" data-offset-key="19903:0" data-first-offset="true"><span data-slate-string="true">项目客户端。应用客户端。服务客户端。资源名。接口</span></span></span></span><span data-slate-object="text" data-key="19904"><span data-slate-leaf="true" data-offset-key="19904:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19905"><span data-slate-object="text" data-key="19906"><span data-slate-leaf="true" data-offset-key="19906:0" data-first-offset="true"><span data-slate-string="true">所以，上面的代码通过创建项目级别的客户端、应用级别的客户端和服务级别的客户端，来调用资源的 API 接口。接下来，我们来看下如何创建这些客户端。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="19907" id="sr-toc-2"><span data-slate-object="text" data-key="19908"><span data-slate-leaf="true" data-offset-key="19908:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 客户端设计</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="19909"><span data-slate-object="text" data-key="19910"><span data-slate-leaf="true" data-offset-key="19910:0" data-first-offset="true"><span data-slate-string="true">在讲客户端创建之前，我们先来看下客户端的设计思路。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19911"><span data-slate-object="text" data-key="19912"><span data-slate-leaf="true" data-offset-key="19912:0" data-first-offset="true"><span data-slate-string="true">Go 项目的组织方式是有层级的：</span></span></span><span data-slate-object="text" data-key="19913"><span data-slate-leaf="true" data-offset-key="19913:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">Project -&gt; Application -&gt; Service</span></span></span></span><span data-slate-object="text" data-key="19914"><span data-slate-leaf="true" data-offset-key="19914:0" data-first-offset="true"><span data-slate-string="true">。marmotedu-sdk-go 很好地体现了这种层级关系，使得 SDK 的调用更加易懂、易用。marmotedu-sdk-go 的层级关系如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="19915"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/3a/21/3a4721afa7fe365c0954019087d82021.jpg?wh=2248x1043"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19916"><span data-slate-object="text" data-key="19917"><span data-slate-leaf="true" data-offset-key="19917:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 定义了 3 类接口，分别代表了项目、应用和服务级别的 API 接口：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="19918"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19919"><span data-slate-object="text" data-key="19920"><span data-slate-leaf="true" data-offset-key="19920:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 项目级别的接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19921"><span data-slate-object="text" data-key="19922"><span data-slate-leaf="true" data-offset-key="19922:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="19923"><span data-slate-leaf="true" data-offset-key="19923:0" data-first-offset="true"><span data-slate-string="true"> Interface </span></span></span><span data-slate-object="text" data-key="19924"><span data-slate-leaf="true" data-offset-key="19924:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19925"><span data-slate-leaf="true" data-offset-key="19925:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19926"><span data-slate-object="text" data-key="19927"><span data-slate-leaf="true" data-offset-key="19927:0" data-first-offset="true"><span data-slate-string="true">    Iam() iam.IamInterface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19928"><span data-slate-object="text" data-key="19929"><span data-slate-leaf="true" data-offset-key="19929:0" data-first-offset="true"><span data-slate-string="true">    Tms() tms.TmsInterface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19930"><span data-slate-object="text" data-key="19931"><span data-slate-leaf="true" data-offset-key="19931:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19932"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19933"><span data-slate-object="text" data-key="19934"><span data-slate-leaf="true" data-offset-key="19934:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 应用级别的接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19935"><span data-slate-object="text" data-key="19936"><span data-slate-leaf="true" data-offset-key="19936:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="19937"><span data-slate-leaf="true" data-offset-key="19937:0" data-first-offset="true"><span data-slate-string="true"> IamInterface </span></span></span><span data-slate-object="text" data-key="19938"><span data-slate-leaf="true" data-offset-key="19938:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19939"><span data-slate-leaf="true" data-offset-key="19939:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19940"><span data-slate-object="text" data-key="19941"><span data-slate-leaf="true" data-offset-key="19941:0" data-first-offset="true"><span data-slate-string="true">    APIV1() apiv1.APIV1Interface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19942"><span data-slate-object="text" data-key="19943"><span data-slate-leaf="true" data-offset-key="19943:0" data-first-offset="true"><span data-slate-string="true">    AuthzV1() authzv1.AuthzV1Interface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19944"><span data-slate-object="text" data-key="19945"><span data-slate-leaf="true" data-offset-key="19945:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19946"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19947"><span data-slate-object="text" data-key="19948"><span data-slate-leaf="true" data-offset-key="19948:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 服务级别的接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19949"><span data-slate-object="text" data-key="19950"><span data-slate-leaf="true" data-offset-key="19950:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="19951"><span data-slate-leaf="true" data-offset-key="19951:0" data-first-offset="true"><span data-slate-string="true"> APIV1Interface </span></span></span><span data-slate-object="text" data-key="19952"><span data-slate-leaf="true" data-offset-key="19952:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19953"><span data-slate-leaf="true" data-offset-key="19953:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19954"><span data-slate-object="text" data-key="19955"><span data-slate-leaf="true" data-offset-key="19955:0" data-first-offset="true"><span data-slate-string="true">    RESTClient() rest.Interface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19956"><span data-slate-object="text" data-key="19957"><span data-slate-leaf="true" data-offset-key="19957:0" data-first-offset="true"><span data-slate-string="true">    SecretsGetter</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19958"><span data-slate-object="text" data-key="19959"><span data-slate-leaf="true" data-offset-key="19959:0" data-first-offset="true"><span data-slate-string="true">    UsersGetter</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19960"><span data-slate-object="text" data-key="19961"><span data-slate-leaf="true" data-offset-key="19961:0" data-first-offset="true"><span data-slate-string="true">    PoliciesGetter</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19962"><span data-slate-object="text" data-key="19963"><span data-slate-leaf="true" data-offset-key="19963:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19964"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19965"><span data-slate-object="text" data-key="19966"><span data-slate-leaf="true" data-offset-key="19966:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 资源级别的客户端</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19967"><span data-slate-object="text" data-key="19968"><span data-slate-leaf="true" data-offset-key="19968:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="19969"><span data-slate-leaf="true" data-offset-key="19969:0" data-first-offset="true"><span data-slate-string="true"> SecretsGetter </span></span></span><span data-slate-object="text" data-key="19970"><span data-slate-leaf="true" data-offset-key="19970:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19971"><span data-slate-leaf="true" data-offset-key="19971:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19972"><span data-slate-object="text" data-key="19973"><span data-slate-leaf="true" data-offset-key="19973:0" data-first-offset="true"><span data-slate-string="true">    Secrets() SecretInterface</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19974"><span data-slate-object="text" data-key="19975"><span data-slate-leaf="true" data-offset-key="19975:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19976"></div><div data-slate-type="code-line" data-slate-object="block" data-key="19977"><span data-slate-object="text" data-key="19978"><span data-slate-leaf="true" data-offset-key="19978:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// 资源的接口定义</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19979"><span data-slate-object="text" data-key="19980"><span data-slate-leaf="true" data-offset-key="19980:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="19981"><span data-slate-leaf="true" data-offset-key="19981:0" data-first-offset="true"><span data-slate-string="true"> SecretInterface </span></span></span><span data-slate-object="text" data-key="19982"><span data-slate-leaf="true" data-offset-key="19982:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="19983"><span data-slate-leaf="true" data-offset-key="19983:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19984"><span data-slate-object="text" data-key="19985"><span data-slate-leaf="true" data-offset-key="19985:0" data-first-offset="true"><span data-slate-string="true">    Create(ctx context.Context, secret *v1.Secret, opts metav1.CreateOptions) (*v1.Secret, </span></span></span><span data-slate-object="text" data-key="19986"><span data-slate-leaf="true" data-offset-key="19986:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19987"><span data-slate-leaf="true" data-offset-key="19987:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19988"><span data-slate-object="text" data-key="19989"><span data-slate-leaf="true" data-offset-key="19989:0" data-first-offset="true"><span data-slate-string="true">    Update(ctx context.Context, secret *v1.Secret, opts metav1.UpdateOptions) (*v1.Secret, </span></span></span><span data-slate-object="text" data-key="19990"><span data-slate-leaf="true" data-offset-key="19990:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="19991"><span data-slate-leaf="true" data-offset-key="19991:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19992"><span data-slate-object="text" data-key="19993"><span data-slate-leaf="true" data-offset-key="19993:0" data-first-offset="true"><span data-slate-string="true">    Delete(ctx context.Context, name </span></span></span><span data-slate-object="text" data-key="19994"><span data-slate-leaf="true" data-offset-key="19994:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="19995"><span data-slate-leaf="true" data-offset-key="19995:0" data-first-offset="true"><span data-slate-string="true">, opts metav1.DeleteOptions) </span></span></span><span data-slate-object="text" data-key="19996"><span data-slate-leaf="true" data-offset-key="19996:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19997"><span data-slate-object="text" data-key="19998"><span data-slate-leaf="true" data-offset-key="19998:0" data-first-offset="true"><span data-slate-string="true">    DeleteCollection(ctx context.Context, opts metav1.DeleteOptions, listOpts metav1.ListOptions) </span></span></span><span data-slate-object="text" data-key="19999"><span data-slate-leaf="true" data-offset-key="19999:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20000"><span data-slate-object="text" data-key="20001"><span data-slate-leaf="true" data-offset-key="20001:0" data-first-offset="true"><span data-slate-string="true">    Get(ctx context.Context, name </span></span></span><span data-slate-object="text" data-key="20002"><span data-slate-leaf="true" data-offset-key="20002:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20003"><span data-slate-leaf="true" data-offset-key="20003:0" data-first-offset="true"><span data-slate-string="true">, opts metav1.GetOptions) (*v1.Secret, </span></span></span><span data-slate-object="text" data-key="20004"><span data-slate-leaf="true" data-offset-key="20004:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="20005"><span data-slate-leaf="true" data-offset-key="20005:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20006"><span data-slate-object="text" data-key="20007"><span data-slate-leaf="true" data-offset-key="20007:0" data-first-offset="true"><span data-slate-string="true">    List(ctx context.Context, opts metav1.ListOptions) (*v1.SecretList, </span></span></span><span data-slate-object="text" data-key="20008"><span data-slate-leaf="true" data-offset-key="20008:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="20009"><span data-slate-leaf="true" data-offset-key="20009:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20010"><span data-slate-object="text" data-key="20011"><span data-slate-leaf="true" data-offset-key="20011:0" data-first-offset="true"><span data-slate-string="true">    SecretExpansion</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20012"><span data-slate-object="text" data-key="20013"><span data-slate-leaf="true" data-offset-key="20013:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20014"><span data-slate-type="code" data-slate-object="inline" data-key="20015"><span data-slate-object="text" data-key="20016"><span data-slate-leaf="true" data-offset-key="20016:0" data-first-offset="true"><span data-slate-string="true">Interface</span></span></span></span><span data-slate-object="text" data-key="20017"><span data-slate-leaf="true" data-offset-key="20017:0" data-first-offset="true"><span data-slate-string="true"> 代表了项目级别的接口，里面包含了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20018"><span data-slate-object="text" data-key="20019"><span data-slate-leaf="true" data-offset-key="20019:0" data-first-offset="true"><span data-slate-string="true">Iam</span></span></span></span><span data-slate-object="text" data-key="20020"><span data-slate-leaf="true" data-offset-key="20020:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20021"><span data-slate-object="text" data-key="20022"><span data-slate-leaf="true" data-offset-key="20022:0" data-first-offset="true"><span data-slate-string="true">Tms</span></span></span></span><span data-slate-object="text" data-key="20023"><span data-slate-leaf="true" data-offset-key="20023:0" data-first-offset="true"><span data-slate-string="true">  两个应用； </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20024"><span data-slate-object="text" data-key="20025"><span data-slate-leaf="true" data-offset-key="20025:0" data-first-offset="true"><span data-slate-string="true">IamInterface</span></span></span></span><span data-slate-object="text" data-key="20026"><span data-slate-leaf="true" data-offset-key="20026:0" data-first-offset="true"><span data-slate-string="true"> 代表了应用级别的接口，里面包含了 api（iam-apiserver）和 authz（iam-authz-server）两个服务级别的接口。api 和 authz 服务中，又包含了各自服务中 REST 资源的 CURD 接口。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20027"><span data-slate-object="text" data-key="20028"><span data-slate-leaf="true" data-offset-key="20028:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20029"><span data-slate-object="text" data-key="20030"><span data-slate-leaf="true" data-offset-key="20030:0" data-first-offset="true"><span data-slate-string="true">XxxV1</span></span></span></span><span data-slate-object="text" data-key="20031"><span data-slate-leaf="true" data-offset-key="20031:0" data-first-offset="true"><span data-slate-string="true"> 这种命名方式来支持不同版本的 API 接口，好处是可以在程序中同时调用同一个 API 接口的不同版本，例如：</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20032"><span data-slate-type="code" data-slate-object="inline" data-key="20033"><span data-slate-object="text" data-key="20034"><span data-slate-leaf="true" data-offset-key="20034:0" data-first-offset="true"><span data-slate-string="true">clientset.Iam().AuthzV1().Authz().Authorize()</span></span></span></span><span data-slate-object="text" data-key="20035"><span data-slate-leaf="true" data-offset-key="20035:0" data-first-offset="true"><span data-slate-string="true">  、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20036"><span data-slate-object="text" data-key="20037"><span data-slate-leaf="true" data-offset-key="20037:0" data-first-offset="true"><span data-slate-string="true">clientset.Iam().AuthzV2().Authz().Authorize()</span></span></span></span><span data-slate-object="text" data-key="20038"><span data-slate-leaf="true" data-offset-key="20038:0" data-first-offset="true"><span data-slate-string="true"> 分别调用了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20039"><span data-slate-object="text" data-key="20040"><span data-slate-leaf="true" data-offset-key="20040:0" data-first-offset="true"><span data-slate-string="true">/v1/authz</span></span></span></span><span data-slate-object="text" data-key="20041"><span data-slate-leaf="true" data-offset-key="20041:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20042"><span data-slate-object="text" data-key="20043"><span data-slate-leaf="true" data-offset-key="20043:0" data-first-offset="true"><span data-slate-string="true">/v2/authz</span></span></span></span><span data-slate-object="text" data-key="20044"><span data-slate-leaf="true" data-offset-key="20044:0" data-first-offset="true"><span data-slate-string="true">  两个版本的 API 接口。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20045"><span data-slate-object="text" data-key="20046"><span data-slate-leaf="true" data-offset-key="20046:0" data-first-offset="true"><span data-slate-string="true">上述关系也可以从目录结构中反映出来，marmotedu-sdk-go 目录设计如下（只列出了一些重要的文件）：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20047"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20048"><span data-slate-object="text" data-key="20049"><span data-slate-leaf="true" data-offset-key="20049:0" data-first-offset="true"><span data-slate-string="true">├── examples                        </span></span></span><span data-slate-object="text" data-key="20050"><span data-slate-leaf="true" data-offset-key="20050:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 存放 SDK 的使用示例</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20051"><span data-slate-object="text" data-key="20052"><span data-slate-leaf="true" data-offset-key="20052:0" data-first-offset="true"><span data-slate-string="true">├── Makefile                        </span></span></span><span data-slate-object="text" data-key="20053"><span data-slate-leaf="true" data-offset-key="20053:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 管理 SDK 源码，静态代码检查、代码格式化、测试、添加版权信息等</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20054"><span data-slate-object="text" data-key="20055"><span data-slate-leaf="true" data-offset-key="20055:0" data-first-offset="true"><span data-slate-string="true">├── marmotedu</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20056"><span data-slate-object="text" data-key="20057"><span data-slate-leaf="true" data-offset-key="20057:0" data-first-offset="true"><span data-slate-string="true">│   ├── clientset.go                </span></span></span><span data-slate-object="text" data-key="20058"><span data-slate-leaf="true" data-offset-key="20058:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># clientset 实现，clientset 中包含多个应用，多个服务的 API 接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20059"><span data-slate-object="text" data-key="20060"><span data-slate-leaf="true" data-offset-key="20060:0" data-first-offset="true"><span data-slate-string="true">│   ├── fake                        </span></span></span><span data-slate-object="text" data-key="20061"><span data-slate-leaf="true" data-offset-key="20061:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># clientset 的 fake 实现，主要用于单元测试</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20062"><span data-slate-object="text" data-key="20063"><span data-slate-leaf="true" data-offset-key="20063:0" data-first-offset="true"><span data-slate-string="true">│   └── service                     </span></span></span><span data-slate-object="text" data-key="20064"><span data-slate-leaf="true" data-offset-key="20064:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 按应用进行分类，存放应用中各服务 API 接口的具体实现</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20065"><span data-slate-object="text" data-key="20066"><span data-slate-leaf="true" data-offset-key="20066:0" data-first-offset="true"><span data-slate-string="true">│       ├── iam                     </span></span></span><span data-slate-object="text" data-key="20067"><span data-slate-leaf="true" data-offset-key="20067:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 应用的 API 接口实现，包含多个服务</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20068"><span data-slate-object="text" data-key="20069"><span data-slate-leaf="true" data-offset-key="20069:0" data-first-offset="true"><span data-slate-string="true">│       │   ├── apiserver           </span></span></span><span data-slate-object="text" data-key="20070"><span data-slate-leaf="true" data-offset-key="20070:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 应用中，apiserver 服务的 API 接口，包含多个版本</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20071"><span data-slate-object="text" data-key="20072"><span data-slate-leaf="true" data-offset-key="20072:0" data-first-offset="true"><span data-slate-string="true">│       │   │   └── v1              </span></span></span><span data-slate-object="text" data-key="20073"><span data-slate-leaf="true" data-offset-key="20073:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># apiserver v1 版本 API 接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20074"><span data-slate-object="text" data-key="20075"><span data-slate-leaf="true" data-offset-key="20075:0" data-first-offset="true"><span data-slate-string="true">│       │   ├── authz               </span></span></span><span data-slate-object="text" data-key="20076"><span data-slate-leaf="true" data-offset-key="20076:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 应用中，authz 服务的 API 接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20077"><span data-slate-object="text" data-key="20078"><span data-slate-leaf="true" data-offset-key="20078:0" data-first-offset="true"><span data-slate-string="true">│       │   │   └── v1              </span></span></span><span data-slate-object="text" data-key="20079"><span data-slate-leaf="true" data-offset-key="20079:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># authz 服务 v1 版本接口</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20080"><span data-slate-object="text" data-key="20081"><span data-slate-leaf="true" data-offset-key="20081:0" data-first-offset="true"><span data-slate-string="true">│       │   └── iam_client.go       </span></span></span><span data-slate-object="text" data-key="20082"><span data-slate-leaf="true" data-offset-key="20082:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 应用的客户端，包含了 apiserver 和 authz 2 个服务的客户端</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20083"><span data-slate-object="text" data-key="20084"><span data-slate-leaf="true" data-offset-key="20084:0" data-first-offset="true"><span data-slate-string="true">│       └── tms                     </span></span></span><span data-slate-object="text" data-key="20085"><span data-slate-leaf="true" data-offset-key="20085:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># tms 应用的 API 接口实现</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20086"><span data-slate-object="text" data-key="20087"><span data-slate-leaf="true" data-offset-key="20087:0" data-first-offset="true"><span data-slate-string="true">├── pkg                             </span></span></span><span data-slate-object="text" data-key="20088"><span data-slate-leaf="true" data-offset-key="20088:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 存放一些共享包，可对外暴露</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20089"><span data-slate-object="text" data-key="20090"><span data-slate-leaf="true" data-offset-key="20090:0" data-first-offset="true"><span data-slate-string="true">├── rest                            </span></span></span><span data-slate-object="text" data-key="20091"><span data-slate-leaf="true" data-offset-key="20091:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># HTTP 请求的底层实现</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20092"><span data-slate-object="text" data-key="20093"><span data-slate-leaf="true" data-offset-key="20093:0" data-first-offset="true"><span data-slate-string="true">├── third_party                     </span></span></span><span data-slate-object="text" data-key="20094"><span data-slate-leaf="true" data-offset-key="20094:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 存放修改过的第三方包，例如：gorequest</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20095"><span data-slate-object="text" data-key="20096"><span data-slate-leaf="true" data-offset-key="20096:0" data-first-offset="true"><span data-slate-string="true">└── tools</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20097"><span data-slate-object="text" data-key="20098"><span data-slate-leaf="true" data-offset-key="20098:0" data-first-offset="true"><span data-slate-string="true">    └── clientcmd                   </span></span></span><span data-slate-object="text" data-key="20099"><span data-slate-leaf="true" data-offset-key="20099:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 一些函数用来帮助创建 rest.Config 配置</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20100"><span data-slate-object="text" data-key="20101"><span data-slate-leaf="true" data-offset-key="20101:0" data-first-offset="true"><span data-slate-string="true">每种类型的客户端，都可以通过以下相似的方式来创建：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20102"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20103"><span data-slate-object="text" data-key="20104"><span data-slate-leaf="true" data-offset-key="20104:0" data-first-offset="true"><span data-slate-string="true">config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="20105"><span data-slate-leaf="true" data-offset-key="20105:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="20106"><span data-slate-leaf="true" data-offset-key="20106:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="20107"><span data-slate-leaf="true" data-offset-key="20107:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/root/.iam/config"</span></span></span></span><span data-slate-object="text" data-key="20108"><span data-slate-leaf="true" data-offset-key="20108:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20109"><span data-slate-object="text" data-key="20110"><span data-slate-leaf="true" data-offset-key="20110:0" data-first-offset="true"><span data-slate-string="true">clientset, err := xxxx.NewForConfig(config)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20111"><span data-slate-type="code" data-slate-object="inline" data-key="20112"><span data-slate-object="text" data-key="20113"><span data-slate-leaf="true" data-offset-key="20113:0" data-first-offset="true"><span data-slate-string="true">/root/.iam/config</span></span></span></span><span data-slate-object="text" data-key="20114"><span data-slate-leaf="true" data-offset-key="20114:0" data-first-offset="true"><span data-slate-string="true"> 为配置文件，里面包含了服务的地址和认证信息。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20115"><span data-slate-object="text" data-key="20116"><span data-slate-leaf="true" data-offset-key="20116:0" data-first-offset="true"><span data-slate-string="true">BuildConfigFromFlags</span></span></span></span><span data-slate-object="text" data-key="20117"><span data-slate-leaf="true" data-offset-key="20117:0" data-first-offset="true"><span data-slate-string="true"> 函数加载配置文件，创建并返回 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20118"><span data-slate-object="text" data-key="20119"><span data-slate-leaf="true" data-offset-key="20119:0" data-first-offset="true"><span data-slate-string="true">rest.Config</span></span></span></span><span data-slate-object="text" data-key="20120"><span data-slate-leaf="true" data-offset-key="20120:0" data-first-offset="true"><span data-slate-string="true"> 类型的配置变量，并通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20121"><span data-slate-object="text" data-key="20122"><span data-slate-leaf="true" data-offset-key="20122:0" data-first-offset="true"><span data-slate-string="true">xxxx.NewForConfig</span></span></span></span><span data-slate-object="text" data-key="20123"><span data-slate-leaf="true" data-offset-key="20123:0" data-first-offset="true"><span data-slate-string="true"> 函数创建需要的客户端。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20124"><span data-slate-object="text" data-key="20125"><span data-slate-leaf="true" data-offset-key="20125:0" data-first-offset="true"><span data-slate-string="true">xxxx</span></span></span></span><span data-slate-object="text" data-key="20126"><span data-slate-leaf="true" data-offset-key="20126:0" data-first-offset="true"><span data-slate-string="true"> 是所在层级的 client 包，例如 iam、tms。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20127"><span data-slate-object="text" data-key="20128"><span data-slate-leaf="true" data-offset-key="20128:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 客户端定义了 3 类接口，这可以带来两个好处。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20129"><span data-slate-object="text" data-key="20130"><span data-slate-leaf="true" data-offset-key="20130:0" data-first-offset="true"><span data-slate-string="true">第一，API 接口调用格式规范，层次清晰，可以使 API 接口调用更加清晰易记。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20131"><span data-slate-object="text" data-key="20132"><span data-slate-leaf="true" data-offset-key="20132:0" data-first-offset="true"><span data-slate-string="true">第二，可以根据需要，自行选择客户端类型，调用灵活。举个例子，在 A 服务中需要同时用到 iam-apiserver 和 iam-authz-server 提供的接口，就可以创建应用级别的客户端 IamClient，然后通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20133"><span data-slate-object="text" data-key="20134"><span data-slate-leaf="true" data-offset-key="20134:0" data-first-offset="true"><span data-slate-string="true">iamclient.APIV1()</span></span></span></span><span data-slate-object="text" data-key="20135"><span data-slate-leaf="true" data-offset-key="20135:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20136"><span data-slate-object="text" data-key="20137"><span data-slate-leaf="true" data-offset-key="20137:0" data-first-offset="true"><span data-slate-string="true">iamclient.AuthzV1()</span></span></span></span><span data-slate-object="text" data-key="20138"><span data-slate-leaf="true" data-offset-key="20138:0" data-first-offset="true"><span data-slate-string="true"> ，来切换调用不同服务的 API 接口。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20139"><span data-slate-object="text" data-key="20140"><span data-slate-leaf="true" data-offset-key="20140:0" data-first-offset="true"><span data-slate-string="true">接下来，我们来看看如何创建三个不同级别的客户端。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20141" id="sr-toc-3"><span data-slate-object="text" data-key="20142"><span data-slate-leaf="true" data-offset-key="20142:0" data-first-offset="true"><span data-slate-string="true">项目级别客户端创建</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20143"><span data-slate-type="code" data-slate-object="inline" data-key="20144"><span data-slate-object="text" data-key="20145"><span data-slate-leaf="true" data-offset-key="20145:0" data-first-offset="true"><span data-slate-string="true">Interface</span></span></span></span><span data-slate-object="text" data-key="20146"><span data-slate-leaf="true" data-offset-key="20146:0" data-first-offset="true"><span data-slate-string="true"> 对应的客户端实现为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20147"><span data-slate-object="text" data-key="20148"><span data-slate-leaf="true" data-offset-key="20148:0" data-first-offset="true"><span data-slate-string="true">Clientset</span></span></span></a><span data-slate-object="text" data-key="20149"><span data-slate-leaf="true" data-offset-key="20149:0" data-first-offset="true"><span data-slate-string="true">，所在的包为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20150"><span data-slate-object="text" data-key="20151"><span data-slate-leaf="true" data-offset-key="20151:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/marmotedu</span></span></span></a><span data-slate-object="text" data-key="20152"><span data-slate-leaf="true" data-offset-key="20152:0" data-first-offset="true"><span data-slate-string="true">，Clientset 客户端的创建方式为：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20153"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20154"><span data-slate-object="text" data-key="20155"><span data-slate-leaf="true" data-offset-key="20155:0" data-first-offset="true"><span data-slate-string="true">config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="20156"><span data-slate-leaf="true" data-offset-key="20156:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="20157"><span data-slate-leaf="true" data-offset-key="20157:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="20158"><span data-slate-leaf="true" data-offset-key="20158:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/root/.iam/config"</span></span></span></span><span data-slate-object="text" data-key="20159"><span data-slate-leaf="true" data-offset-key="20159:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20160"><span data-slate-object="text" data-key="20161"><span data-slate-leaf="true" data-offset-key="20161:0" data-first-offset="true"><span data-slate-string="true">clientset, err := marmotedu.NewForConfig(config)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20162"><span data-slate-object="text" data-key="20163"><span data-slate-leaf="true" data-offset-key="20163:0" data-first-offset="true"><span data-slate-string="true">调用方式为 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20164"><span data-slate-object="text" data-key="20165"><span data-slate-leaf="true" data-offset-key="20165:0" data-first-offset="true"><span data-slate-string="true">clientset. 应用。服务。资源名。接口</span></span></span></span><span data-slate-object="text" data-key="20166"><span data-slate-leaf="true" data-offset-key="20166:0" data-first-offset="true"><span data-slate-string="true"> ，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20167"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20168"><span data-slate-object="text" data-key="20169"><span data-slate-leaf="true" data-offset-key="20169:0" data-first-offset="true"><span data-slate-string="true">rsp, err := clientset.Iam().AuthzV1().Authz().Authorize()</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20170"><span data-slate-object="text" data-key="20171"><span data-slate-leaf="true" data-offset-key="20171:0" data-first-offset="true"><span data-slate-string="true">参考示例为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20172"><span data-slate-object="text" data-key="20173"><span data-slate-leaf="true" data-offset-key="20173:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/examples/authz_clientset/main.go</span></span></span></a><span data-slate-object="text" data-key="20174"><span data-slate-leaf="true" data-offset-key="20174:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20175" id="sr-toc-4"><span data-slate-object="text" data-key="20176"><span data-slate-leaf="true" data-offset-key="20176:0" data-first-offset="true"><span data-slate-string="true">应用级别客户端创建</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20177"><span data-slate-type="code" data-slate-object="inline" data-key="20178"><span data-slate-object="text" data-key="20179"><span data-slate-leaf="true" data-offset-key="20179:0" data-first-offset="true"><span data-slate-string="true">IamInterface</span></span></span></span><span data-slate-object="text" data-key="20180"><span data-slate-leaf="true" data-offset-key="20180:0" data-first-offset="true"><span data-slate-string="true"> 对应的客户端实现为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20181"><span data-slate-object="text" data-key="20182"><span data-slate-leaf="true" data-offset-key="20182:0" data-first-offset="true"><span data-slate-string="true">IamClient</span></span></span></a><span data-slate-object="text" data-key="20183"><span data-slate-leaf="true" data-offset-key="20183:0" data-first-offset="true"><span data-slate-string="true">，所在的包为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20184"><span data-slate-object="text" data-key="20185"><span data-slate-leaf="true" data-offset-key="20185:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/marmotedu/service/iam</span></span></span></a><span data-slate-object="text" data-key="20186"><span data-slate-leaf="true" data-offset-key="20186:0" data-first-offset="true"><span data-slate-string="true">，IamClient 客户端的创建方式为：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20187"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20188"><span data-slate-object="text" data-key="20189"><span data-slate-leaf="true" data-offset-key="20189:0" data-first-offset="true"><span data-slate-string="true">config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="20190"><span data-slate-leaf="true" data-offset-key="20190:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="20191"><span data-slate-leaf="true" data-offset-key="20191:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="20192"><span data-slate-leaf="true" data-offset-key="20192:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/root/.iam/config"</span></span></span></span><span data-slate-object="text" data-key="20193"><span data-slate-leaf="true" data-offset-key="20193:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20194"><span data-slate-object="text" data-key="20195"><span data-slate-leaf="true" data-offset-key="20195:0" data-first-offset="true"><span data-slate-string="true">iamclient,, err := iam.NewForConfig(config)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20196"><span data-slate-object="text" data-key="20197"><span data-slate-leaf="true" data-offset-key="20197:0" data-first-offset="true"><span data-slate-string="true">调用方式为 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20198"><span data-slate-object="text" data-key="20199"><span data-slate-leaf="true" data-offset-key="20199:0" data-first-offset="true"><span data-slate-string="true">iamclient. 服务。资源名。接口</span></span></span></span><span data-slate-object="text" data-key="20200"><span data-slate-leaf="true" data-offset-key="20200:0" data-first-offset="true"><span data-slate-string="true"> ，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20201"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20202"><span data-slate-object="text" data-key="20203"><span data-slate-leaf="true" data-offset-key="20203:0" data-first-offset="true"><span data-slate-string="true">rsp, err := iamclient.AuthzV1().Authz().Authorize()</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20204"><span data-slate-object="text" data-key="20205"><span data-slate-leaf="true" data-offset-key="20205:0" data-first-offset="true"><span data-slate-string="true">参考示例为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20206"><span data-slate-object="text" data-key="20207"><span data-slate-leaf="true" data-offset-key="20207:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/examples/authz_iam/main.go</span></span></span></a><span data-slate-object="text" data-key="20208"><span data-slate-leaf="true" data-offset-key="20208:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20209" id="sr-toc-5"><span data-slate-object="text" data-key="20210"><span data-slate-leaf="true" data-offset-key="20210:0" data-first-offset="true"><span data-slate-string="true">服务级别客户端创建</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20211"><span data-slate-type="code" data-slate-object="inline" data-key="20212"><span data-slate-object="text" data-key="20213"><span data-slate-leaf="true" data-offset-key="20213:0" data-first-offset="true"><span data-slate-string="true">AuthzV1Interface</span></span></span></span><span data-slate-object="text" data-key="20214"><span data-slate-leaf="true" data-offset-key="20214:0" data-first-offset="true"><span data-slate-string="true"> 对应的客户端实现为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20215"><span data-slate-object="text" data-key="20216"><span data-slate-leaf="true" data-offset-key="20216:0" data-first-offset="true"><span data-slate-string="true">AuthzV1Client</span></span></span></a><span data-slate-object="text" data-key="20217"><span data-slate-leaf="true" data-offset-key="20217:0" data-first-offset="true"><span data-slate-string="true">，所在的包为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20218"><span data-slate-object="text" data-key="20219"><span data-slate-leaf="true" data-offset-key="20219:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/marmotedu/service/iam/authz/v1</span></span></span></a><span data-slate-object="text" data-key="20220"><span data-slate-leaf="true" data-offset-key="20220:0" data-first-offset="true"><span data-slate-string="true">，AuthzV1Client 客户端的创建方式为：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20221"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20222"><span data-slate-object="text" data-key="20223"><span data-slate-leaf="true" data-offset-key="20223:0" data-first-offset="true"><span data-slate-string="true">config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="20224"><span data-slate-leaf="true" data-offset-key="20224:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="20225"><span data-slate-leaf="true" data-offset-key="20225:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="20226"><span data-slate-leaf="true" data-offset-key="20226:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"/root/.iam/config"</span></span></span></span><span data-slate-object="text" data-key="20227"><span data-slate-leaf="true" data-offset-key="20227:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20228"><span data-slate-object="text" data-key="20229"><span data-slate-leaf="true" data-offset-key="20229:0" data-first-offset="true"><span data-slate-string="true">client, err := v1.NewForConfig(config)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20230"><span data-slate-object="text" data-key="20231"><span data-slate-leaf="true" data-offset-key="20231:0" data-first-offset="true"><span data-slate-string="true">调用方式为 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20232"><span data-slate-object="text" data-key="20233"><span data-slate-leaf="true" data-offset-key="20233:0" data-first-offset="true"><span data-slate-string="true">client. 资源名。接口</span></span></span></span><span data-slate-object="text" data-key="20234"><span data-slate-leaf="true" data-offset-key="20234:0" data-first-offset="true"><span data-slate-string="true"> ，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20235"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20236"><span data-slate-object="text" data-key="20237"><span data-slate-leaf="true" data-offset-key="20237:0" data-first-offset="true"><span data-slate-string="true">rsp, err := client.Authz().Authorize()</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20238"><span data-slate-object="text" data-key="20239"><span data-slate-leaf="true" data-offset-key="20239:0" data-first-offset="true"><span data-slate-string="true">参考示例为 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20240"><span data-slate-object="text" data-key="20241"><span data-slate-leaf="true" data-offset-key="20241:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go/examples/authz/main.go</span></span></span></a><span data-slate-object="text" data-key="20242"><span data-slate-leaf="true" data-offset-key="20242:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20243"><span data-slate-object="text" data-key="20244"><span data-slate-leaf="true" data-offset-key="20244:0" data-first-offset="true"><span data-slate-string="true">上面我介绍了 marmotedu-sdk-go 的客户端创建方法，接下来我们再来看下，这些客户端具体是如何执行 REST API 请求的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="20245" id="sr-toc-6"><span data-slate-object="text" data-key="20246"><span data-slate-leaf="true" data-offset-key="20246:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 的实现</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="20247"><span data-slate-object="text" data-key="20248"><span data-slate-leaf="true" data-offset-key="20248:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 的实现和 medu-sdk-go 一样，也是采用分层结构，分为 API 层和基础层。如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="20249"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/c4/b2/c40439c97998a01758923394116c33b2.jpg?wh=2248x2097"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20250"><a data-slate-type="link" data-slate-object="inline" data-key="20251"><span data-slate-object="text" data-key="20252"><span data-slate-leaf="true" data-offset-key="20252:0" data-first-offset="true"><span data-slate-string="true">RESTClient</span></span></span></a><span data-slate-object="text" data-key="20253"><span data-slate-leaf="true" data-offset-key="20253:0" data-first-offset="true"><span data-slate-string="true"> 是整个 SDK 的核心，RESTClient 向下通过调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20254"><span data-slate-object="text" data-key="20255"><span data-slate-leaf="true" data-offset-key="20255:0" data-first-offset="true"><span data-slate-string="true">Request</span></span></span></a><span data-slate-object="text" data-key="20256"><span data-slate-leaf="true" data-offset-key="20256:0" data-first-offset="true"><span data-slate-string="true"> 模块，来完成 HTTP 请求方法、请求路径、请求体、认证信息的构建。Request 模块最终通过调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20257"><span data-slate-object="text" data-key="20258"><span data-slate-leaf="true" data-offset-key="20258:0" data-first-offset="true"><span data-slate-string="true">gorequest</span></span></span></a><span data-slate-object="text" data-key="20259"><span data-slate-leaf="true" data-offset-key="20259:0" data-first-offset="true"><span data-slate-string="true"> 包提供的方法，完成 HTTP 的 POST、PUT、GET、DELETE 等请求，获取 HTTP 返回结果，并解析到指定的结构体中。RESTClient 向上提供 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20260"><span data-slate-object="text" data-key="20261"><span data-slate-leaf="true" data-offset-key="20261:0" data-first-offset="true"><span data-slate-string="true">Post()</span></span></span></span><span data-slate-object="text" data-key="20262"><span data-slate-leaf="true" data-offset-key="20262:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20263"><span data-slate-object="text" data-key="20264"><span data-slate-leaf="true" data-offset-key="20264:0" data-first-offset="true"><span data-slate-string="true">Put()</span></span></span></span><span data-slate-object="text" data-key="20265"><span data-slate-leaf="true" data-offset-key="20265:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20266"><span data-slate-object="text" data-key="20267"><span data-slate-leaf="true" data-offset-key="20267:0" data-first-offset="true"><span data-slate-string="true">Get()</span></span></span></span><span data-slate-object="text" data-key="20268"><span data-slate-leaf="true" data-offset-key="20268:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20269"><span data-slate-object="text" data-key="20270"><span data-slate-leaf="true" data-offset-key="20270:0" data-first-offset="true"><span data-slate-string="true">Delete()</span></span></span></span><span data-slate-object="text" data-key="20271"><span data-slate-leaf="true" data-offset-key="20271:0" data-first-offset="true"><span data-slate-string="true"> 等方法来供客户端完成 HTTP 请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20272"><span data-slate-object="text" data-key="20273"><span data-slate-leaf="true" data-offset-key="20273:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 提供了两类客户端，分别是 RESTClient 客户端和基于 RESTClient 封装的客户端。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20274"><div data-slate-type="list-line" data-slate-object="block" data-key="20275"><span data-slate-object="text" data-key="20276"><span data-slate-leaf="true" data-offset-key="20276:0" data-first-offset="true"><span data-slate-string="true">RESTClient：Raw 类型的客户端，可以通过指定 HTTP 的请求方法、请求路径、请求参数等信息，直接发送 HTTP 请求，例如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20277"><span data-slate-object="text" data-key="20278"><span data-slate-leaf="true" data-offset-key="20278:0" data-first-offset="true"><span data-slate-string="true">client.Get().AbsPath("/version").Do().Into()</span></span></span></span><span data-slate-object="text" data-key="20279"><span data-slate-leaf="true" data-offset-key="20279:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20280"><span data-slate-object="text" data-key="20281"><span data-slate-leaf="true" data-offset-key="20281:0" data-first-offset="true"><span data-slate-string="true">基于 RESTClient 封装的客户端：例如 AuthzV1Client、APIV1Client 等，执行特定 REST 资源、特定 API 接口的请求，方便开发者调用。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20282"><span data-slate-object="text" data-key="20283"><span data-slate-leaf="true" data-offset-key="20283:0" data-first-offset="true"><span data-slate-string="true">接下来，我们具体看下如何创建 RESTClient 客户端，以及 Request 模块的实现。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20284" id="sr-toc-7"><span data-slate-object="text" data-key="20285"><span data-slate-leaf="true" data-offset-key="20285:0" data-first-offset="true"><span data-slate-string="true">RESTClient 客户端实现</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20286"><span data-slate-object="text" data-key="20287"><span data-slate-leaf="true" data-offset-key="20287:0" data-first-offset="true"><span data-slate-string="true">我通过下面两个步骤，实现了 RESTClient 客户端。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20288"><span data-slate-object="text" data-key="20289"><span data-slate-leaf="true" data-offset-key="20289:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步，创建 </span></span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20290"><span data-slate-object="text" data-key="20291"><span data-slate-leaf="true" data-offset-key="20291:0" data-first-offset="true"><span data-slate-string="true">rest.Config</span></span></span></a><span data-slate-object="text" data-key="20292"><span data-slate-leaf="true" data-offset-key="20292:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true"> 类型的变量。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20293"><a data-slate-type="link" data-slate-object="inline" data-key="20294"><span data-slate-object="text" data-key="20295"><span data-slate-leaf="true" data-offset-key="20295:0" data-first-offset="true"><span data-slate-string="true">BuildConfigFromFlags</span></span></span></a><span data-slate-object="text" data-key="20296"><span data-slate-leaf="true" data-offset-key="20296:0" data-first-offset="true"><span data-slate-string="true"> 函数通过加载 yaml 格式的配置文件，来创建 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20297"><span data-slate-object="text" data-key="20298"><span data-slate-leaf="true" data-offset-key="20298:0" data-first-offset="true"><span data-slate-string="true">rest.Config</span></span></span></span><span data-slate-object="text" data-key="20299"><span data-slate-leaf="true" data-offset-key="20299:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量，加载的 yaml 格式配置文件内容为：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20300"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20301"><span data-slate-object="text" data-key="20302"><span data-slate-leaf="true" data-offset-key="20302:0" data-first-offset="true"><span data-slate-string="true">apiVersion: v1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20303"><span data-slate-object="text" data-key="20304"><span data-slate-leaf="true" data-offset-key="20304:0" data-first-offset="true"><span data-slate-string="true">user:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20305"><span data-slate-object="text" data-key="20306"><span data-slate-leaf="true" data-offset-key="20306:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20307"><span data-slate-leaf="true" data-offset-key="20307:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#token: # JWT Token</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20308"><span data-slate-object="text" data-key="20309"><span data-slate-leaf="true" data-offset-key="20309:0" data-first-offset="true"><span data-slate-string="true">  username: admin </span></span></span><span data-slate-object="text" data-key="20310"><span data-slate-leaf="true" data-offset-key="20310:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 用户名</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20311"><span data-slate-object="text" data-key="20312"><span data-slate-leaf="true" data-offset-key="20312:0" data-first-offset="true"><span data-slate-string="true">  password: Admin@2020 </span></span></span><span data-slate-object="text" data-key="20313"><span data-slate-leaf="true" data-offset-key="20313:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam 密码</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20314"><span data-slate-object="text" data-key="20315"><span data-slate-leaf="true" data-offset-key="20315:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20316"><span data-slate-leaf="true" data-offset-key="20316:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#secret-id: # 密钥 ID</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20317"><span data-slate-object="text" data-key="20318"><span data-slate-leaf="true" data-offset-key="20318:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20319"><span data-slate-leaf="true" data-offset-key="20319:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#secret-key: # 密钥 Key</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20320"><span data-slate-object="text" data-key="20321"><span data-slate-leaf="true" data-offset-key="20321:0" data-first-offset="true"><span data-slate-string="true">  client-certificate: /home/colin/.iam/cert/admin.pem </span></span></span><span data-slate-object="text" data-key="20322"><span data-slate-leaf="true" data-offset-key="20322:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 用于 TLS 的客户端证书文件路径</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20323"><span data-slate-object="text" data-key="20324"><span data-slate-leaf="true" data-offset-key="20324:0" data-first-offset="true"><span data-slate-string="true">  client-key: /home/colin/.iam/cert/admin-key.pem </span></span></span><span data-slate-object="text" data-key="20325"><span data-slate-leaf="true" data-offset-key="20325:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 用于 TLS 的客户端 key 文件路径</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20326"><span data-slate-object="text" data-key="20327"><span data-slate-leaf="true" data-offset-key="20327:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20328"><span data-slate-leaf="true" data-offset-key="20328:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#client-certificate-data:</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20329"><span data-slate-object="text" data-key="20330"><span data-slate-leaf="true" data-offset-key="20330:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20331"><span data-slate-leaf="true" data-offset-key="20331:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#client-key-data:</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20332"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20333"><span data-slate-object="text" data-key="20334"><span data-slate-leaf="true" data-offset-key="20334:0" data-first-offset="true"><span data-slate-string="true">server:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20335"><span data-slate-object="text" data-key="20336"><span data-slate-leaf="true" data-offset-key="20336:0" data-first-offset="true"><span data-slate-string="true">  address: https://127.0.0.1:8443 </span></span></span><span data-slate-object="text" data-key="20337"><span data-slate-leaf="true" data-offset-key="20337:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iam api-server 地址</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20338"><span data-slate-object="text" data-key="20339"><span data-slate-leaf="true" data-offset-key="20339:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20340"><span data-slate-leaf="true" data-offset-key="20340:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">timeout</span></span></span></span><span data-slate-object="text" data-key="20341"><span data-slate-leaf="true" data-offset-key="20341:0" data-first-offset="true"><span data-slate-string="true">: 10s </span></span></span><span data-slate-object="text" data-key="20342"><span data-slate-leaf="true" data-offset-key="20342:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 请求 api-server 超时时间</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20343"><span data-slate-object="text" data-key="20344"><span data-slate-leaf="true" data-offset-key="20344:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20345"><span data-slate-leaf="true" data-offset-key="20345:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#max-retries: # 最大重试次数，默认为 0</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20346"><span data-slate-object="text" data-key="20347"><span data-slate-leaf="true" data-offset-key="20347:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20348"><span data-slate-leaf="true" data-offset-key="20348:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#retry-interval: # 重试间隔，默认为 1s</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20349"><span data-slate-object="text" data-key="20350"><span data-slate-leaf="true" data-offset-key="20350:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20351"><span data-slate-leaf="true" data-offset-key="20351:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#tls-server-name: # TLS 服务器名称</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20352"><span data-slate-object="text" data-key="20353"><span data-slate-leaf="true" data-offset-key="20353:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20354"><span data-slate-leaf="true" data-offset-key="20354:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#insecure-skip-tls-verify: # 设置为 true 表示跳过 TLS 安全验证模式，将使得 HTTPS 连接不安全</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20355"><span data-slate-object="text" data-key="20356"><span data-slate-leaf="true" data-offset-key="20356:0" data-first-offset="true"><span data-slate-string="true">  certificate-authority: /home/colin/.iam/cert/ca.pem </span></span></span><span data-slate-object="text" data-key="20357"><span data-slate-leaf="true" data-offset-key="20357:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 用于 CA 授权的 cert 文件路径</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20358"><span data-slate-object="text" data-key="20359"><span data-slate-leaf="true" data-offset-key="20359:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20360"><span data-slate-leaf="true" data-offset-key="20360:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">#certificate-authority-data:</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20361"><span data-slate-object="text" data-key="20362"><span data-slate-leaf="true" data-offset-key="20362:0" data-first-offset="true"><span data-slate-string="true">在配置文件中，我们可以指定服务的地址、用户名 / 密码、密钥、TLS 证书、超时时间、重试次数等信息。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20363"><span data-slate-object="text" data-key="20364"><span data-slate-leaf="true" data-offset-key="20364:0" data-first-offset="true"><span data-slate-string="true">创建方法如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20365"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20366"><span data-slate-object="text" data-key="20367"><span data-slate-leaf="true" data-offset-key="20367:0" data-first-offset="true"><span data-slate-string="true">config, err := clientcmd.BuildConfigFromFlags(</span></span></span><span data-slate-object="text" data-key="20368"><span data-slate-leaf="true" data-offset-key="20368:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">""</span></span></span></span><span data-slate-object="text" data-key="20369"><span data-slate-leaf="true" data-offset-key="20369:0" data-first-offset="true"><span data-slate-string="true">, *iamconfig)    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20370"><span data-slate-object="text" data-key="20371"><span data-slate-leaf="true" data-offset-key="20371:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20372"><span data-slate-leaf="true" data-offset-key="20372:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="20373"><span data-slate-leaf="true" data-offset-key="20373:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20374"><span data-slate-leaf="true" data-offset-key="20374:0" data-first-offset="true"><span data-slate-string="true"> {                                                  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20375"><span data-slate-object="text" data-key="20376"><span data-slate-leaf="true" data-offset-key="20376:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20377"><span data-slate-leaf="true" data-offset-key="20377:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">panic</span></span></span></span><span data-slate-object="text" data-key="20378"><span data-slate-leaf="true" data-offset-key="20378:0" data-first-offset="true"><span data-slate-string="true">(err.Error())    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20379"><span data-slate-object="text" data-key="20380"><span data-slate-leaf="true" data-offset-key="20380:0" data-first-offset="true"><span data-slate-string="true">}  </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20381"><span data-slate-object="text" data-key="20382"><span data-slate-leaf="true" data-offset-key="20382:0" data-first-offset="true"><span data-slate-string="true">这里的代码中，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20383"><span data-slate-object="text" data-key="20384"><span data-slate-leaf="true" data-offset-key="20384:0" data-first-offset="true"><span data-slate-string="true">*iamconfig</span></span></span></span><span data-slate-object="text" data-key="20385"><span data-slate-leaf="true" data-offset-key="20385:0" data-first-offset="true"><span data-slate-string="true"> 是 yaml 格式的配置文件路径。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20386"><span data-slate-object="text" data-key="20387"><span data-slate-leaf="true" data-offset-key="20387:0" data-first-offset="true"><span data-slate-string="true">BuildConfigFromFlags</span></span></span></span><span data-slate-object="text" data-key="20388"><span data-slate-leaf="true" data-offset-key="20388:0" data-first-offset="true"><span data-slate-string="true"> 函数中，调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20389"><span data-slate-object="text" data-key="20390"><span data-slate-leaf="true" data-offset-key="20390:0" data-first-offset="true"><span data-slate-string="true">LoadFromFile</span></span></span></a><span data-slate-object="text" data-key="20391"><span data-slate-leaf="true" data-offset-key="20391:0" data-first-offset="true"><span data-slate-string="true"> 函数来解析 yaml 配置文件。LoadFromFile 最终是通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20392"><span data-slate-object="text" data-key="20393"><span data-slate-leaf="true" data-offset-key="20393:0" data-first-offset="true"><span data-slate-string="true">yaml.Unmarshal</span></span></span></span><span data-slate-object="text" data-key="20394"><span data-slate-leaf="true" data-offset-key="20394:0" data-first-offset="true"><span data-slate-string="true"> 的方式来解析 yaml 格式的配置文件的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20395"><span data-slate-object="text" data-key="20396"><span data-slate-leaf="true" data-offset-key="20396:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二步，根据 rest.Config 类型的变量，创建 RESTClient 客户端。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20397"><span data-slate-object="text" data-key="20398"><span data-slate-leaf="true" data-offset-key="20398:0" data-first-offset="true"><span data-slate-string="true">通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20399"><span data-slate-object="text" data-key="20400"><span data-slate-leaf="true" data-offset-key="20400:0" data-first-offset="true"><span data-slate-string="true">RESTClientFor</span></span></span></a><span data-slate-object="text" data-key="20401"><span data-slate-leaf="true" data-offset-key="20401:0" data-first-offset="true"><span data-slate-string="true"> 函数来创建 RESTClient 客户端：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20402"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20403"><span data-slate-object="text" data-key="20404"><span data-slate-leaf="true" data-offset-key="20404:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20405"><span data-slate-leaf="true" data-offset-key="20405:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20406"><span data-slate-leaf="true" data-offset-key="20406:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">RESTClientFor</span></span></span></span></span><span data-slate-object="text" data-key="20407"><span data-slate-leaf="true" data-offset-key="20407:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(config *Config)</span></span></span></span></span><span data-slate-object="text" data-key="20408"><span data-slate-leaf="true" data-offset-key="20408:0" data-first-offset="true"><span data-slate-string="true"> (*RESTClient, </span></span></span><span data-slate-object="text" data-key="20409"><span data-slate-leaf="true" data-offset-key="20409:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="20410"><span data-slate-leaf="true" data-offset-key="20410:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20411"><span data-slate-object="text" data-key="20412"><span data-slate-leaf="true" data-offset-key="20412:0" data-first-offset="true"><span data-slate-string="true">    ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20413"><span data-slate-object="text" data-key="20414"><span data-slate-leaf="true" data-offset-key="20414:0" data-first-offset="true"><span data-slate-string="true">    baseURL, versionedAPIPath, err := defaultServerURLFor(config)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20415"><span data-slate-object="text" data-key="20416"><span data-slate-leaf="true" data-offset-key="20416:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20417"><span data-slate-leaf="true" data-offset-key="20417:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20418"><span data-slate-leaf="true" data-offset-key="20418:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="20419"><span data-slate-leaf="true" data-offset-key="20419:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20420"><span data-slate-leaf="true" data-offset-key="20420:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20421"><span data-slate-object="text" data-key="20422"><span data-slate-leaf="true" data-offset-key="20422:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="20423"><span data-slate-leaf="true" data-offset-key="20423:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20424"><span data-slate-leaf="true" data-offset-key="20424:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20425"><span data-slate-leaf="true" data-offset-key="20425:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20426"><span data-slate-leaf="true" data-offset-key="20426:0" data-first-offset="true"><span data-slate-string="true">, err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20427"><span data-slate-object="text" data-key="20428"><span data-slate-leaf="true" data-offset-key="20428:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20429"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20430"><span data-slate-object="text" data-key="20431"><span data-slate-leaf="true" data-offset-key="20431:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20432"><span data-slate-leaf="true" data-offset-key="20432:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// Get the TLS options for this client config</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20433"><span data-slate-object="text" data-key="20434"><span data-slate-leaf="true" data-offset-key="20434:0" data-first-offset="true"><span data-slate-string="true">    tlsConfig, err := TLSConfigFor(config)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20435"><span data-slate-object="text" data-key="20436"><span data-slate-leaf="true" data-offset-key="20436:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20437"><span data-slate-leaf="true" data-offset-key="20437:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20438"><span data-slate-leaf="true" data-offset-key="20438:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="20439"><span data-slate-leaf="true" data-offset-key="20439:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20440"><span data-slate-leaf="true" data-offset-key="20440:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20441"><span data-slate-object="text" data-key="20442"><span data-slate-leaf="true" data-offset-key="20442:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="20443"><span data-slate-leaf="true" data-offset-key="20443:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20444"><span data-slate-leaf="true" data-offset-key="20444:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20445"><span data-slate-leaf="true" data-offset-key="20445:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20446"><span data-slate-leaf="true" data-offset-key="20446:0" data-first-offset="true"><span data-slate-string="true">, err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20447"><span data-slate-object="text" data-key="20448"><span data-slate-leaf="true" data-offset-key="20448:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20449"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20450"><span data-slate-object="text" data-key="20451"><span data-slate-leaf="true" data-offset-key="20451:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20452"><span data-slate-leaf="true" data-offset-key="20452:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// Only retry when get a server side error.</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20453"><span data-slate-object="text" data-key="20454"><span data-slate-leaf="true" data-offset-key="20454:0" data-first-offset="true"><span data-slate-string="true">    client := gorequest.New().TLSClientConfig(tlsConfig).Timeout(config.Timeout).</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20455"><span data-slate-object="text" data-key="20456"><span data-slate-leaf="true" data-offset-key="20456:0" data-first-offset="true"><span data-slate-string="true">        Retry(config.MaxRetries, config.RetryInterval, http.StatusInternalServerError)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20457"><span data-slate-object="text" data-key="20458"><span data-slate-leaf="true" data-offset-key="20458:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20459"><span data-slate-leaf="true" data-offset-key="20459:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// NOTICE: must set DoNotClearSuperAgent to true, or the client will clean header befor http.Do</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20460"><span data-slate-object="text" data-key="20461"><span data-slate-leaf="true" data-offset-key="20461:0" data-first-offset="true"><span data-slate-string="true">    client.DoNotClearSuperAgent = </span></span></span><span data-slate-object="text" data-key="20462"><span data-slate-leaf="true" data-offset-key="20462:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">true</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20463"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20464"><span data-slate-object="text" data-key="20465"><span data-slate-leaf="true" data-offset-key="20465:0" data-first-offset="true"><span data-slate-string="true">    ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20466"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20467"><span data-slate-object="text" data-key="20468"><span data-slate-leaf="true" data-offset-key="20468:0" data-first-offset="true"><span data-slate-string="true">    clientContent := ClientContentConfig{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20469"><span data-slate-object="text" data-key="20470"><span data-slate-leaf="true" data-offset-key="20470:0" data-first-offset="true"><span data-slate-string="true">        Username:           config.Username,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20471"><span data-slate-object="text" data-key="20472"><span data-slate-leaf="true" data-offset-key="20472:0" data-first-offset="true"><span data-slate-string="true">        Password:           config.Password,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20473"><span data-slate-object="text" data-key="20474"><span data-slate-leaf="true" data-offset-key="20474:0" data-first-offset="true"><span data-slate-string="true">        SecretID:           config.SecretID,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20475"><span data-slate-object="text" data-key="20476"><span data-slate-leaf="true" data-offset-key="20476:0" data-first-offset="true"><span data-slate-string="true">        SecretKey:          config.SecretKey,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20477"><span data-slate-object="text" data-key="20478"><span data-slate-leaf="true" data-offset-key="20478:0" data-first-offset="true"><span data-slate-string="true">        ...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20479"><span data-slate-object="text" data-key="20480"><span data-slate-leaf="true" data-offset-key="20480:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20481"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20482"><span data-slate-object="text" data-key="20483"><span data-slate-leaf="true" data-offset-key="20483:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20484"><span data-slate-leaf="true" data-offset-key="20484:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20485"><span data-slate-leaf="true" data-offset-key="20485:0" data-first-offset="true"><span data-slate-string="true"> NewRESTClient(baseURL, versionedAPIPath, clientContent, client)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20486"><span data-slate-object="text" data-key="20487"><span data-slate-leaf="true" data-offset-key="20487:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20488"><span data-slate-object="text" data-key="20489"><span data-slate-leaf="true" data-offset-key="20489:0" data-first-offset="true"><span data-slate-string="true">RESTClientFor 函数调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20490"><span data-slate-object="text" data-key="20491"><span data-slate-leaf="true" data-offset-key="20491:0" data-first-offset="true"><span data-slate-string="true">defaultServerURLFor(config)</span></span></span></a><span data-slate-object="text" data-key="20492"><span data-slate-leaf="true" data-offset-key="20492:0" data-first-offset="true"><span data-slate-string="true"> 生成基本的 HTTP 请求路径：baseURL=http://127.0.0.1:8080，versionedAPIPath=/v1。然后，通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20493"><span data-slate-object="text" data-key="20494"><span data-slate-leaf="true" data-offset-key="20494:0" data-first-offset="true"><span data-slate-string="true">TLSConfigFor</span></span></span></a><span data-slate-object="text" data-key="20495"><span data-slate-leaf="true" data-offset-key="20495:0" data-first-offset="true"><span data-slate-string="true"> 函数生成 TLS 配置，并调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20496"><span data-slate-object="text" data-key="20497"><span data-slate-leaf="true" data-offset-key="20497:0" data-first-offset="true"><span data-slate-string="true">gorequest.New()</span></span></span></span><span data-slate-object="text" data-key="20498"><span data-slate-leaf="true" data-offset-key="20498:0" data-first-offset="true"><span data-slate-string="true"> 创建 gorequest 客户端，将客户端配置信息保存在变量中。最后，调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20499"><span data-slate-object="text" data-key="20500"><span data-slate-leaf="true" data-offset-key="20500:0" data-first-offset="true"><span data-slate-string="true">NewRESTClient</span></span></span></a><span data-slate-object="text" data-key="20501"><span data-slate-leaf="true" data-offset-key="20501:0" data-first-offset="true"><span data-slate-string="true"> 函数创建 RESTClient 客户端。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20502"><span data-slate-object="text" data-key="20503"><span data-slate-leaf="true" data-offset-key="20503:0" data-first-offset="true"><span data-slate-string="true">RESTClient 客户端提供了以下方法，来供调用者完成 HTTP 请求：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20504"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20505"><span data-slate-object="text" data-key="20506"><span data-slate-leaf="true" data-offset-key="20506:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20507"><span data-slate-leaf="true" data-offset-key="20507:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20508"><span data-slate-leaf="true" data-offset-key="20508:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20509"><span data-slate-leaf="true" data-offset-key="20509:0" data-first-offset="true"><span data-slate-string="true"> APIVersion() scheme.GroupVersion</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20510"><span data-slate-object="text" data-key="20511"><span data-slate-leaf="true" data-offset-key="20511:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20512"><span data-slate-leaf="true" data-offset-key="20512:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20513"><span data-slate-leaf="true" data-offset-key="20513:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20514"><span data-slate-leaf="true" data-offset-key="20514:0" data-first-offset="true"><span data-slate-string="true"> Delete() *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20515"><span data-slate-object="text" data-key="20516"><span data-slate-leaf="true" data-offset-key="20516:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20517"><span data-slate-leaf="true" data-offset-key="20517:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20518"><span data-slate-leaf="true" data-offset-key="20518:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20519"><span data-slate-leaf="true" data-offset-key="20519:0" data-first-offset="true"><span data-slate-string="true"> Get() *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20520"><span data-slate-object="text" data-key="20521"><span data-slate-leaf="true" data-offset-key="20521:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20522"><span data-slate-leaf="true" data-offset-key="20522:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20523"><span data-slate-leaf="true" data-offset-key="20523:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20524"><span data-slate-leaf="true" data-offset-key="20524:0" data-first-offset="true"><span data-slate-string="true"> Post() *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20525"><span data-slate-object="text" data-key="20526"><span data-slate-leaf="true" data-offset-key="20526:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20527"><span data-slate-leaf="true" data-offset-key="20527:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20528"><span data-slate-leaf="true" data-offset-key="20528:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20529"><span data-slate-leaf="true" data-offset-key="20529:0" data-first-offset="true"><span data-slate-string="true"> Put() *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20530"><span data-slate-object="text" data-key="20531"><span data-slate-leaf="true" data-offset-key="20531:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20532"><span data-slate-leaf="true" data-offset-key="20532:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20533"><span data-slate-leaf="true" data-offset-key="20533:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="20534"><span data-slate-leaf="true" data-offset-key="20534:0" data-first-offset="true"><span data-slate-string="true"> Verb(verb </span></span></span><span data-slate-object="text" data-key="20535"><span data-slate-leaf="true" data-offset-key="20535:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20536"><span data-slate-leaf="true" data-offset-key="20536:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20537"><span data-slate-object="text" data-key="20538"><span data-slate-leaf="true" data-offset-key="20538:0" data-first-offset="true"><span data-slate-string="true">可以看到，RESTClient 提供了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20539"><span data-slate-object="text" data-key="20540"><span data-slate-leaf="true" data-offset-key="20540:0" data-first-offset="true"><span data-slate-string="true">Delete</span></span></span></span><span data-slate-object="text" data-key="20541"><span data-slate-leaf="true" data-offset-key="20541:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20542"><span data-slate-object="text" data-key="20543"><span data-slate-leaf="true" data-offset-key="20543:0" data-first-offset="true"><span data-slate-string="true">Get</span></span></span></span><span data-slate-object="text" data-key="20544"><span data-slate-leaf="true" data-offset-key="20544:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20545"><span data-slate-object="text" data-key="20546"><span data-slate-leaf="true" data-offset-key="20546:0" data-first-offset="true"><span data-slate-string="true">Post</span></span></span></span><span data-slate-object="text" data-key="20547"><span data-slate-leaf="true" data-offset-key="20547:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20548"><span data-slate-object="text" data-key="20549"><span data-slate-leaf="true" data-offset-key="20549:0" data-first-offset="true"><span data-slate-string="true">Put</span></span></span></span><span data-slate-object="text" data-key="20550"><span data-slate-leaf="true" data-offset-key="20550:0" data-first-offset="true"><span data-slate-string="true"> 方法，分别用来执行 HTTP 的 DELETE、GET、POST、PUT 方法，提供的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20551"><span data-slate-object="text" data-key="20552"><span data-slate-leaf="true" data-offset-key="20552:0" data-first-offset="true"><span data-slate-string="true">Verb</span></span></span></span><span data-slate-object="text" data-key="20553"><span data-slate-leaf="true" data-offset-key="20553:0" data-first-offset="true"><span data-slate-string="true"> 方法可以灵活地指定 HTTP 方法。这些方法都返回了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20554"><span data-slate-object="text" data-key="20555"><span data-slate-leaf="true" data-offset-key="20555:0" data-first-offset="true"><span data-slate-string="true">Request</span></span></span></span><span data-slate-object="text" data-key="20556"><span data-slate-leaf="true" data-offset-key="20556:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20557"><span data-slate-object="text" data-key="20558"><span data-slate-leaf="true" data-offset-key="20558:0" data-first-offset="true"><span data-slate-string="true">Request</span></span></span></span><span data-slate-object="text" data-key="20559"><span data-slate-leaf="true" data-offset-key="20559:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量提供了一些方法，用来完成具体的 HTTP 请求，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20560"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20561"><span data-slate-object="text" data-key="20562"><span data-slate-leaf="true" data-offset-key="20562:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20563"><span data-slate-leaf="true" data-offset-key="20563:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="20564"><span data-slate-leaf="true" data-offset-key="20564:0" data-first-offset="true"><span data-slate-string="true"> Response </span></span></span><span data-slate-object="text" data-key="20565"><span data-slate-leaf="true" data-offset-key="20565:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="20566"><span data-slate-leaf="true" data-offset-key="20566:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20567"><span data-slate-object="text" data-key="20568"><span data-slate-leaf="true" data-offset-key="20568:0" data-first-offset="true"><span data-slate-string="true">    Allowed </span></span></span><span data-slate-object="text" data-key="20569"><span data-slate-leaf="true" data-offset-key="20569:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">bool</span></span></span></span><span data-slate-object="text" data-key="20570"><span data-slate-leaf="true" data-offset-key="20570:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="20571"><span data-slate-leaf="true" data-offset-key="20571:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"allowed"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20572"><span data-slate-object="text" data-key="20573"><span data-slate-leaf="true" data-offset-key="20573:0" data-first-offset="true"><span data-slate-string="true">    Denied  </span></span></span><span data-slate-object="text" data-key="20574"><span data-slate-leaf="true" data-offset-key="20574:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">bool</span></span></span></span><span data-slate-object="text" data-key="20575"><span data-slate-leaf="true" data-offset-key="20575:0" data-first-offset="true"><span data-slate-string="true">   </span></span></span><span data-slate-object="text" data-key="20576"><span data-slate-leaf="true" data-offset-key="20576:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"denied,omitempty"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20577"><span data-slate-object="text" data-key="20578"><span data-slate-leaf="true" data-offset-key="20578:0" data-first-offset="true"><span data-slate-string="true">    Reason  </span></span></span><span data-slate-object="text" data-key="20579"><span data-slate-leaf="true" data-offset-key="20579:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20580"><span data-slate-leaf="true" data-offset-key="20580:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20581"><span data-slate-leaf="true" data-offset-key="20581:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"reason,omitempty"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20582"><span data-slate-object="text" data-key="20583"><span data-slate-leaf="true" data-offset-key="20583:0" data-first-offset="true"><span data-slate-string="true">    Error   </span></span></span><span data-slate-object="text" data-key="20584"><span data-slate-leaf="true" data-offset-key="20584:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20585"><span data-slate-leaf="true" data-offset-key="20585:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20586"><span data-slate-leaf="true" data-offset-key="20586:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">`json:"error,omitempty"`</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20587"><span data-slate-object="text" data-key="20588"><span data-slate-leaf="true" data-offset-key="20588:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20589"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20590"><span data-slate-object="text" data-key="20591"><span data-slate-leaf="true" data-offset-key="20591:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20592"><span data-slate-leaf="true" data-offset-key="20592:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20593"><span data-slate-leaf="true" data-offset-key="20593:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *authz)</span></span></span></span></span><span data-slate-object="text" data-key="20594"><span data-slate-leaf="true" data-offset-key="20594:0" data-first-offset="true"><span data-slate-string="true"> Authorize(ctx context.Context, request *ladon.Request, opts metav1.AuthorizeOptions) (result *Response, err </span></span></span><span data-slate-object="text" data-key="20595"><span data-slate-leaf="true" data-offset-key="20595:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="20596"><span data-slate-leaf="true" data-offset-key="20596:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20597"><span data-slate-object="text" data-key="20598"><span data-slate-leaf="true" data-offset-key="20598:0" data-first-offset="true"><span data-slate-string="true">    result = &amp;Response{}                                         </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20599"><span data-slate-object="text" data-key="20600"><span data-slate-leaf="true" data-offset-key="20600:0" data-first-offset="true"><span data-slate-string="true">    err = c.client.Post().</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20601"><span data-slate-object="text" data-key="20602"><span data-slate-leaf="true" data-offset-key="20602:0" data-first-offset="true"><span data-slate-string="true">        Resource(</span></span></span><span data-slate-object="text" data-key="20603"><span data-slate-leaf="true" data-offset-key="20603:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"authz"</span></span></span></span><span data-slate-object="text" data-key="20604"><span data-slate-leaf="true" data-offset-key="20604:0" data-first-offset="true"><span data-slate-string="true">).</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20605"><span data-slate-object="text" data-key="20606"><span data-slate-leaf="true" data-offset-key="20606:0" data-first-offset="true"><span data-slate-string="true">        VersionedParams(opts).</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20607"><span data-slate-object="text" data-key="20608"><span data-slate-leaf="true" data-offset-key="20608:0" data-first-offset="true"><span data-slate-string="true">        Body(request).</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20609"><span data-slate-object="text" data-key="20610"><span data-slate-leaf="true" data-offset-key="20610:0" data-first-offset="true"><span data-slate-string="true">        Do(ctx).</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20611"><span data-slate-object="text" data-key="20612"><span data-slate-leaf="true" data-offset-key="20612:0" data-first-offset="true"><span data-slate-string="true">        Into(result)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20613"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20614"><span data-slate-object="text" data-key="20615"><span data-slate-leaf="true" data-offset-key="20615:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20616"><span data-slate-leaf="true" data-offset-key="20616:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20617"><span data-slate-object="text" data-key="20618"><span data-slate-leaf="true" data-offset-key="20618:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20619"><span data-slate-object="text" data-key="20620"><span data-slate-leaf="true" data-offset-key="20620:0" data-first-offset="true"><span data-slate-string="true">上面的代码中， </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20621"><span data-slate-object="text" data-key="20622"><span data-slate-leaf="true" data-offset-key="20622:0" data-first-offset="true"><span data-slate-string="true">c.client</span></span></span></span><span data-slate-object="text" data-key="20623"><span data-slate-leaf="true" data-offset-key="20623:0" data-first-offset="true"><span data-slate-string="true"> 是 RESTClient 客户端，通过调用 RESTClient 客户端的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20624"><span data-slate-object="text" data-key="20625"><span data-slate-leaf="true" data-offset-key="20625:0" data-first-offset="true"><span data-slate-string="true">Post</span></span></span></span><span data-slate-object="text" data-key="20626"><span data-slate-leaf="true" data-offset-key="20626:0" data-first-offset="true"><span data-slate-string="true"> 方法，返回了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20627"><span data-slate-object="text" data-key="20628"><span data-slate-leaf="true" data-offset-key="20628:0" data-first-offset="true"><span data-slate-string="true">*Request</span></span></span></span><span data-slate-object="text" data-key="20629"><span data-slate-leaf="true" data-offset-key="20629:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20630"><span data-slate-type="code" data-slate-object="inline" data-key="20631"><span data-slate-object="text" data-key="20632"><span data-slate-leaf="true" data-offset-key="20632:0" data-first-offset="true"><span data-slate-string="true">*Request</span></span></span></span><span data-slate-object="text" data-key="20633"><span data-slate-leaf="true" data-offset-key="20633:0" data-first-offset="true"><span data-slate-string="true"> 类型的变量提供了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20634"><span data-slate-object="text" data-key="20635"><span data-slate-leaf="true" data-offset-key="20635:0" data-first-offset="true"><span data-slate-string="true">Resource</span></span></span></span><span data-slate-object="text" data-key="20636"><span data-slate-leaf="true" data-offset-key="20636:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20637"><span data-slate-object="text" data-key="20638"><span data-slate-leaf="true" data-offset-key="20638:0" data-first-offset="true"><span data-slate-string="true">VersionedParams</span></span></span></span><span data-slate-object="text" data-key="20639"><span data-slate-leaf="true" data-offset-key="20639:0" data-first-offset="true"><span data-slate-string="true"> 方法，来构建请求 HTTP URL 中的路径 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20640"><span data-slate-object="text" data-key="20641"><span data-slate-leaf="true" data-offset-key="20641:0" data-first-offset="true"><span data-slate-string="true">/v1/authz</span></span></span></span><span data-slate-object="text" data-key="20642"><span data-slate-leaf="true" data-offset-key="20642:0" data-first-offset="true"><span data-slate-string="true"> ；通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20643"><span data-slate-object="text" data-key="20644"><span data-slate-leaf="true" data-offset-key="20644:0" data-first-offset="true"><span data-slate-string="true">Body</span></span></span></span><span data-slate-object="text" data-key="20645"><span data-slate-leaf="true" data-offset-key="20645:0" data-first-offset="true"><span data-slate-string="true"> 方法，指定了 HTTP 请求的 Body。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20646"><span data-slate-object="text" data-key="20647"><span data-slate-leaf="true" data-offset-key="20647:0" data-first-offset="true"><span data-slate-string="true">到这里，我们分别构建了 HTTP 请求需要的参数：HTTP Method、请求 URL、请求 Body。所以，之后就可以调用 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20648"><span data-slate-object="text" data-key="20649"><span data-slate-leaf="true" data-offset-key="20649:0" data-first-offset="true"><span data-slate-string="true">Do</span></span></span></span><span data-slate-object="text" data-key="20650"><span data-slate-leaf="true" data-offset-key="20650:0" data-first-offset="true"><span data-slate-string="true"> 方法来执行 HTTP 请求，并将返回结果通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20651"><span data-slate-object="text" data-key="20652"><span data-slate-leaf="true" data-offset-key="20652:0" data-first-offset="true"><span data-slate-string="true">Into</span></span></span></span><span data-slate-object="text" data-key="20653"><span data-slate-leaf="true" data-offset-key="20653:0" data-first-offset="true"><span data-slate-string="true"> 方法保存在传入的 result 变量中。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20654" id="sr-toc-8"><span data-slate-object="text" data-key="20655"><span data-slate-leaf="true" data-offset-key="20655:0" data-first-offset="true"><span data-slate-string="true">Request 模块实现</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20656"><span data-slate-object="text" data-key="20657"><span data-slate-leaf="true" data-offset-key="20657:0" data-first-offset="true"><span data-slate-string="true">RESTClient 客户端的方法会返回 Request 类型的变量，Request 类型的变量提供了一系列的方法用来构建 HTTP 请求参数，并执行 HTTP 请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20658"><span data-slate-object="text" data-key="20659"><span data-slate-leaf="true" data-offset-key="20659:0" data-first-offset="true"><span data-slate-string="true">所以，Request 模块可以理解为最底层的通信层，我们来看下 Request 模块具体是如何完成 HTTP 请求的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20660"><span data-slate-object="text" data-key="20661"><span data-slate-leaf="true" data-offset-key="20661:0" data-first-offset="true"><span data-slate-string="true">我们先来看下 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20662"><span data-slate-object="text" data-key="20663"><span data-slate-leaf="true" data-offset-key="20663:0" data-first-offset="true"><span data-slate-string="true">Request 结构体</span></span></span></a><span data-slate-object="text" data-key="20664"><span data-slate-leaf="true" data-offset-key="20664:0" data-first-offset="true"><span data-slate-string="true">的定义：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20665"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20666"><span data-slate-object="text" data-key="20667"><span data-slate-leaf="true" data-offset-key="20667:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="20668"><span data-slate-leaf="true" data-offset-key="20668:0" data-first-offset="true"><span data-slate-string="true"> RESTClient </span></span></span><span data-slate-object="text" data-key="20669"><span data-slate-leaf="true" data-offset-key="20669:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="20670"><span data-slate-leaf="true" data-offset-key="20670:0" data-first-offset="true"><span data-slate-string="true"> {           </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20671"><span data-slate-object="text" data-key="20672"><span data-slate-leaf="true" data-offset-key="20672:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20673"><span data-slate-leaf="true" data-offset-key="20673:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// base is the root URL for all invocations of the client    </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20674"><span data-slate-object="text" data-key="20675"><span data-slate-leaf="true" data-offset-key="20675:0" data-first-offset="true"><span data-slate-string="true">    base *url.URL    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20676"><span data-slate-object="text" data-key="20677"><span data-slate-leaf="true" data-offset-key="20677:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20678"><span data-slate-leaf="true" data-offset-key="20678:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// group stand for the client group, eg: iam.api, iam.authz                       </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20679"><span data-slate-object="text" data-key="20680"><span data-slate-leaf="true" data-offset-key="20680:0" data-first-offset="true"><span data-slate-string="true">    group </span></span></span><span data-slate-object="text" data-key="20681"><span data-slate-leaf="true" data-offset-key="20681:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20682"><span data-slate-leaf="true" data-offset-key="20682:0" data-first-offset="true"><span data-slate-string="true">                                                                          </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20683"><span data-slate-object="text" data-key="20684"><span data-slate-leaf="true" data-offset-key="20684:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20685"><span data-slate-leaf="true" data-offset-key="20685:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// versionedAPIPath is a path segment connecting the base URL to the resource root    </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20686"><span data-slate-object="text" data-key="20687"><span data-slate-leaf="true" data-offset-key="20687:0" data-first-offset="true"><span data-slate-string="true">    versionedAPIPath </span></span></span><span data-slate-object="text" data-key="20688"><span data-slate-leaf="true" data-offset-key="20688:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20689"><span data-slate-leaf="true" data-offset-key="20689:0" data-first-offset="true"><span data-slate-string="true">                                      </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20690"><span data-slate-object="text" data-key="20691"><span data-slate-leaf="true" data-offset-key="20691:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20692"><span data-slate-leaf="true" data-offset-key="20692:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// content describes how a RESTClient encodes and decodes responses.    </span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20693"><span data-slate-object="text" data-key="20694"><span data-slate-leaf="true" data-offset-key="20694:0" data-first-offset="true"><span data-slate-string="true">    content ClientContentConfig    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20695"><span data-slate-object="text" data-key="20696"><span data-slate-leaf="true" data-offset-key="20696:0" data-first-offset="true"><span data-slate-string="true">    Client  *gorequest.SuperAgent    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20697"><span data-slate-object="text" data-key="20698"><span data-slate-leaf="true" data-offset-key="20698:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20699"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20700"><span data-slate-object="text" data-key="20701"><span data-slate-leaf="true" data-offset-key="20701:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">type</span></span></span></span><span data-slate-object="text" data-key="20702"><span data-slate-leaf="true" data-offset-key="20702:0" data-first-offset="true"><span data-slate-string="true"> Request </span></span></span><span data-slate-object="text" data-key="20703"><span data-slate-leaf="true" data-offset-key="20703:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">struct</span></span></span></span><span data-slate-object="text" data-key="20704"><span data-slate-leaf="true" data-offset-key="20704:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20705"><span data-slate-object="text" data-key="20706"><span data-slate-leaf="true" data-offset-key="20706:0" data-first-offset="true"><span data-slate-string="true">  c *RESTClient</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20707"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20708"><span data-slate-object="text" data-key="20709"><span data-slate-leaf="true" data-offset-key="20709:0" data-first-offset="true"><span data-slate-string="true">  timeout time.Duration</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20710"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20711"><span data-slate-object="text" data-key="20712"><span data-slate-leaf="true" data-offset-key="20712:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20713"><span data-slate-leaf="true" data-offset-key="20713:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// generic components accessible via method setters</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20714"><span data-slate-object="text" data-key="20715"><span data-slate-leaf="true" data-offset-key="20715:0" data-first-offset="true"><span data-slate-string="true">  verb       </span></span></span><span data-slate-object="text" data-key="20716"><span data-slate-leaf="true" data-offset-key="20716:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20717"><span data-slate-object="text" data-key="20718"><span data-slate-leaf="true" data-offset-key="20718:0" data-first-offset="true"><span data-slate-string="true">  pathPrefix </span></span></span><span data-slate-object="text" data-key="20719"><span data-slate-leaf="true" data-offset-key="20719:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20720"><span data-slate-object="text" data-key="20721"><span data-slate-leaf="true" data-offset-key="20721:0" data-first-offset="true"><span data-slate-string="true">  subpath    </span></span></span><span data-slate-object="text" data-key="20722"><span data-slate-leaf="true" data-offset-key="20722:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20723"><span data-slate-object="text" data-key="20724"><span data-slate-leaf="true" data-offset-key="20724:0" data-first-offset="true"><span data-slate-string="true">  params     url.Values</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20725"><span data-slate-object="text" data-key="20726"><span data-slate-leaf="true" data-offset-key="20726:0" data-first-offset="true"><span data-slate-string="true">  headers    http.Header</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20727"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20728"><span data-slate-object="text" data-key="20729"><span data-slate-leaf="true" data-offset-key="20729:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20730"><span data-slate-leaf="true" data-offset-key="20730:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// structural elements of the request that are part of the IAM API conventions</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20731"><span data-slate-object="text" data-key="20732"><span data-slate-leaf="true" data-offset-key="20732:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20733"><span data-slate-leaf="true" data-offset-key="20733:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// namespace    string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20734"><span data-slate-object="text" data-key="20735"><span data-slate-leaf="true" data-offset-key="20735:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20736"><span data-slate-leaf="true" data-offset-key="20736:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// namespaceSet bool</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20737"><span data-slate-object="text" data-key="20738"><span data-slate-leaf="true" data-offset-key="20738:0" data-first-offset="true"><span data-slate-string="true">  resource     </span></span></span><span data-slate-object="text" data-key="20739"><span data-slate-leaf="true" data-offset-key="20739:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20740"><span data-slate-object="text" data-key="20741"><span data-slate-leaf="true" data-offset-key="20741:0" data-first-offset="true"><span data-slate-string="true">  resourceName </span></span></span><span data-slate-object="text" data-key="20742"><span data-slate-leaf="true" data-offset-key="20742:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20743"><span data-slate-object="text" data-key="20744"><span data-slate-leaf="true" data-offset-key="20744:0" data-first-offset="true"><span data-slate-string="true">  subresource  </span></span></span><span data-slate-object="text" data-key="20745"><span data-slate-leaf="true" data-offset-key="20745:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20746"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20747"><span data-slate-object="text" data-key="20748"><span data-slate-leaf="true" data-offset-key="20748:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20749"><span data-slate-leaf="true" data-offset-key="20749:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// output</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20750"><span data-slate-object="text" data-key="20751"><span data-slate-leaf="true" data-offset-key="20751:0" data-first-offset="true"><span data-slate-string="true">  err  </span></span></span><span data-slate-object="text" data-key="20752"><span data-slate-leaf="true" data-offset-key="20752:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20753"><span data-slate-object="text" data-key="20754"><span data-slate-leaf="true" data-offset-key="20754:0" data-first-offset="true"><span data-slate-string="true">  body </span></span></span><span data-slate-object="text" data-key="20755"><span data-slate-leaf="true" data-offset-key="20755:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="20756"><span data-slate-leaf="true" data-offset-key="20756:0" data-first-offset="true"><span data-slate-string="true">{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20757"><span data-slate-object="text" data-key="20758"><span data-slate-leaf="true" data-offset-key="20758:0" data-first-offset="true"><span data-slate-string="true">}  </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20759"><span data-slate-object="text" data-key="20760"><span data-slate-leaf="true" data-offset-key="20760:0" data-first-offset="true"><span data-slate-string="true">再来看下 Request 结构体提供的方法：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20761"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20762"><span data-slate-object="text" data-key="20763"><span data-slate-leaf="true" data-offset-key="20763:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20764"><span data-slate-leaf="true" data-offset-key="20764:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20765"><span data-slate-leaf="true" data-offset-key="20765:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20766"><span data-slate-leaf="true" data-offset-key="20766:0" data-first-offset="true"><span data-slate-string="true"> AbsPath(segments ...</span></span></span><span data-slate-object="text" data-key="20767"><span data-slate-leaf="true" data-offset-key="20767:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20768"><span data-slate-leaf="true" data-offset-key="20768:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20769"><span data-slate-object="text" data-key="20770"><span data-slate-leaf="true" data-offset-key="20770:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20771"><span data-slate-leaf="true" data-offset-key="20771:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20772"><span data-slate-leaf="true" data-offset-key="20772:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20773"><span data-slate-leaf="true" data-offset-key="20773:0" data-first-offset="true"><span data-slate-string="true"> Body(obj </span></span></span><span data-slate-object="text" data-key="20774"><span data-slate-leaf="true" data-offset-key="20774:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="20775"><span data-slate-leaf="true" data-offset-key="20775:0" data-first-offset="true"><span data-slate-string="true">{}) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20776"><span data-slate-object="text" data-key="20777"><span data-slate-leaf="true" data-offset-key="20777:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20778"><span data-slate-leaf="true" data-offset-key="20778:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20779"><span data-slate-leaf="true" data-offset-key="20779:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20780"><span data-slate-leaf="true" data-offset-key="20780:0" data-first-offset="true"><span data-slate-string="true"> Do(ctx context.Context) Result</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20781"><span data-slate-object="text" data-key="20782"><span data-slate-leaf="true" data-offset-key="20782:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20783"><span data-slate-leaf="true" data-offset-key="20783:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20784"><span data-slate-leaf="true" data-offset-key="20784:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20785"><span data-slate-leaf="true" data-offset-key="20785:0" data-first-offset="true"><span data-slate-string="true"> Name(resourceName </span></span></span><span data-slate-object="text" data-key="20786"><span data-slate-leaf="true" data-offset-key="20786:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20787"><span data-slate-leaf="true" data-offset-key="20787:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20788"><span data-slate-object="text" data-key="20789"><span data-slate-leaf="true" data-offset-key="20789:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20790"><span data-slate-leaf="true" data-offset-key="20790:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20791"><span data-slate-leaf="true" data-offset-key="20791:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20792"><span data-slate-leaf="true" data-offset-key="20792:0" data-first-offset="true"><span data-slate-string="true"> Param(paramName, s </span></span></span><span data-slate-object="text" data-key="20793"><span data-slate-leaf="true" data-offset-key="20793:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20794"><span data-slate-leaf="true" data-offset-key="20794:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20795"><span data-slate-object="text" data-key="20796"><span data-slate-leaf="true" data-offset-key="20796:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20797"><span data-slate-leaf="true" data-offset-key="20797:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20798"><span data-slate-leaf="true" data-offset-key="20798:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20799"><span data-slate-leaf="true" data-offset-key="20799:0" data-first-offset="true"><span data-slate-string="true"> Prefix(segments ...</span></span></span><span data-slate-object="text" data-key="20800"><span data-slate-leaf="true" data-offset-key="20800:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20801"><span data-slate-leaf="true" data-offset-key="20801:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20802"><span data-slate-object="text" data-key="20803"><span data-slate-leaf="true" data-offset-key="20803:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20804"><span data-slate-leaf="true" data-offset-key="20804:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20805"><span data-slate-leaf="true" data-offset-key="20805:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20806"><span data-slate-leaf="true" data-offset-key="20806:0" data-first-offset="true"><span data-slate-string="true"> RequestURI(uri </span></span></span><span data-slate-object="text" data-key="20807"><span data-slate-leaf="true" data-offset-key="20807:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20808"><span data-slate-leaf="true" data-offset-key="20808:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20809"><span data-slate-object="text" data-key="20810"><span data-slate-leaf="true" data-offset-key="20810:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20811"><span data-slate-leaf="true" data-offset-key="20811:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20812"><span data-slate-leaf="true" data-offset-key="20812:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20813"><span data-slate-leaf="true" data-offset-key="20813:0" data-first-offset="true"><span data-slate-string="true"> Resource(resource </span></span></span><span data-slate-object="text" data-key="20814"><span data-slate-leaf="true" data-offset-key="20814:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20815"><span data-slate-leaf="true" data-offset-key="20815:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20816"><span data-slate-object="text" data-key="20817"><span data-slate-leaf="true" data-offset-key="20817:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20818"><span data-slate-leaf="true" data-offset-key="20818:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20819"><span data-slate-leaf="true" data-offset-key="20819:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20820"><span data-slate-leaf="true" data-offset-key="20820:0" data-first-offset="true"><span data-slate-string="true"> SetHeader(key </span></span></span><span data-slate-object="text" data-key="20821"><span data-slate-leaf="true" data-offset-key="20821:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20822"><span data-slate-leaf="true" data-offset-key="20822:0" data-first-offset="true"><span data-slate-string="true">, values ...</span></span></span><span data-slate-object="text" data-key="20823"><span data-slate-leaf="true" data-offset-key="20823:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20824"><span data-slate-leaf="true" data-offset-key="20824:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20825"><span data-slate-object="text" data-key="20826"><span data-slate-leaf="true" data-offset-key="20826:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20827"><span data-slate-leaf="true" data-offset-key="20827:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20828"><span data-slate-leaf="true" data-offset-key="20828:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20829"><span data-slate-leaf="true" data-offset-key="20829:0" data-first-offset="true"><span data-slate-string="true"> SubResource(subresources ...</span></span></span><span data-slate-object="text" data-key="20830"><span data-slate-leaf="true" data-offset-key="20830:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20831"><span data-slate-leaf="true" data-offset-key="20831:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20832"><span data-slate-object="text" data-key="20833"><span data-slate-leaf="true" data-offset-key="20833:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20834"><span data-slate-leaf="true" data-offset-key="20834:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20835"><span data-slate-leaf="true" data-offset-key="20835:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20836"><span data-slate-leaf="true" data-offset-key="20836:0" data-first-offset="true"><span data-slate-string="true"> Suffix(segments ...</span></span></span><span data-slate-object="text" data-key="20837"><span data-slate-leaf="true" data-offset-key="20837:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20838"><span data-slate-leaf="true" data-offset-key="20838:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20839"><span data-slate-object="text" data-key="20840"><span data-slate-leaf="true" data-offset-key="20840:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20841"><span data-slate-leaf="true" data-offset-key="20841:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20842"><span data-slate-leaf="true" data-offset-key="20842:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20843"><span data-slate-leaf="true" data-offset-key="20843:0" data-first-offset="true"><span data-slate-string="true"> Timeout(d time.Duration) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20844"><span data-slate-object="text" data-key="20845"><span data-slate-leaf="true" data-offset-key="20845:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20846"><span data-slate-leaf="true" data-offset-key="20846:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20847"><span data-slate-leaf="true" data-offset-key="20847:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20848"><span data-slate-leaf="true" data-offset-key="20848:0" data-first-offset="true"><span data-slate-string="true"> URL() *url.URL</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20849"><span data-slate-object="text" data-key="20850"><span data-slate-leaf="true" data-offset-key="20850:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20851"><span data-slate-leaf="true" data-offset-key="20851:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20852"><span data-slate-leaf="true" data-offset-key="20852:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20853"><span data-slate-leaf="true" data-offset-key="20853:0" data-first-offset="true"><span data-slate-string="true"> Verb(verb </span></span></span><span data-slate-object="text" data-key="20854"><span data-slate-leaf="true" data-offset-key="20854:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="20855"><span data-slate-leaf="true" data-offset-key="20855:0" data-first-offset="true"><span data-slate-string="true">) *Request</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20856"><span data-slate-object="text" data-key="20857"><span data-slate-leaf="true" data-offset-key="20857:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20858"><span data-slate-leaf="true" data-offset-key="20858:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20859"><span data-slate-leaf="true" data-offset-key="20859:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20860"><span data-slate-leaf="true" data-offset-key="20860:0" data-first-offset="true"><span data-slate-string="true"> VersionedParams(v </span></span></span><span data-slate-object="text" data-key="20861"><span data-slate-leaf="true" data-offset-key="20861:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="20862"><span data-slate-leaf="true" data-offset-key="20862:0" data-first-offset="true"><span data-slate-string="true">{}) *Request</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20863"><span data-slate-object="text" data-key="20864"><span data-slate-leaf="true" data-offset-key="20864:0" data-first-offset="true"><span data-slate-string="true">通过 Request 结构体的定义和使用方法，我们不难猜测出：Request 模块通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20865"><span data-slate-object="text" data-key="20866"><span data-slate-leaf="true" data-offset-key="20866:0" data-first-offset="true"><span data-slate-string="true">Name</span></span></span></span><span data-slate-object="text" data-key="20867"><span data-slate-leaf="true" data-offset-key="20867:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20868"><span data-slate-object="text" data-key="20869"><span data-slate-leaf="true" data-offset-key="20869:0" data-first-offset="true"><span data-slate-string="true">Resource</span></span></span></span><span data-slate-object="text" data-key="20870"><span data-slate-leaf="true" data-offset-key="20870:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20871"><span data-slate-object="text" data-key="20872"><span data-slate-leaf="true" data-offset-key="20872:0" data-first-offset="true"><span data-slate-string="true">Body</span></span></span></span><span data-slate-object="text" data-key="20873"><span data-slate-leaf="true" data-offset-key="20873:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20874"><span data-slate-object="text" data-key="20875"><span data-slate-leaf="true" data-offset-key="20875:0" data-first-offset="true"><span data-slate-string="true">SetHeader</span></span></span></span><span data-slate-object="text" data-key="20876"><span data-slate-leaf="true" data-offset-key="20876:0" data-first-offset="true"><span data-slate-string="true"> 等方法来设置 Request 结构体中的各个字段。这些字段最终用来构建出一个 HTTP 请求，并通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20877"><span data-slate-object="text" data-key="20878"><span data-slate-leaf="true" data-offset-key="20878:0" data-first-offset="true"><span data-slate-string="true">Do</span></span></span></span><span data-slate-object="text" data-key="20879"><span data-slate-leaf="true" data-offset-key="20879:0" data-first-offset="true"><span data-slate-string="true"> 方法来执行 HTTP 请求。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20880"><span data-slate-object="text" data-key="20881"><span data-slate-leaf="true" data-offset-key="20881:0" data-first-offset="true"><span data-slate-string="true">那么，如何构建并执行一个 HTTP 请求呢？我们可以通过以下 5 步，来构建并执行 HTTP 请求：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20882"><div data-slate-type="list-line" data-slate-object="block" data-key="20883"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="20884"><span data-slate-leaf="true" data-offset-key="20884:0" data-first-offset="true"><span data-slate-string="true">构建 HTTP URL；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="20885"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="20886"><span data-slate-leaf="true" data-offset-key="20886:0" data-first-offset="true"><span data-slate-string="true">构建 HTTP Method；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="20887"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="20888"><span data-slate-leaf="true" data-offset-key="20888:0" data-first-offset="true"><span data-slate-string="true">构建 HTTP Body；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="20889"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="20890"><span data-slate-leaf="true" data-offset-key="20890:0" data-first-offset="true"><span data-slate-string="true">执行 HTTP 请求；</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="20891"><div data-code-line-number="5"></div><div><span data-slate-object="text" data-key="20892"><span data-slate-leaf="true" data-offset-key="20892:0" data-first-offset="true"><span data-slate-string="true">保存 HTTP 返回结果。</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20893"><span data-slate-object="text" data-key="20894"><span data-slate-leaf="true" data-offset-key="20894:0" data-first-offset="true"><span data-slate-string="true">接下来，我们就来具体看下 Request 模块是如何构建这些请求参数，并发送 HTTP 请求的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20895"><span data-slate-object="text" data-key="20896"><span data-slate-leaf="true" data-offset-key="20896:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步，构建 HTTP URL。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20897"><span data-slate-object="text" data-key="20898"><span data-slate-leaf="true" data-offset-key="20898:0" data-first-offset="true"><span data-slate-string="true">首先，通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20899"><span data-slate-object="text" data-key="20900"><span data-slate-leaf="true" data-offset-key="20900:0" data-first-offset="true"><span data-slate-string="true">defaultServerURLFor</span></span></span></a><span data-slate-object="text" data-key="20901"><span data-slate-leaf="true" data-offset-key="20901:0" data-first-offset="true"><span data-slate-string="true"> 函数返回了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20902"><span data-slate-object="text" data-key="20903"><span data-slate-leaf="true" data-offset-key="20903:0" data-first-offset="true"><span data-slate-string="true"> http://iam.api.marmotedu.com:8080</span></span></span></span><span data-slate-object="text" data-key="20904"><span data-slate-leaf="true" data-offset-key="20904:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20905"><span data-slate-object="text" data-key="20906"><span data-slate-leaf="true" data-offset-key="20906:0" data-first-offset="true"><span data-slate-string="true">/v1</span></span></span></span><span data-slate-object="text" data-key="20907"><span data-slate-leaf="true" data-offset-key="20907:0" data-first-offset="true"><span data-slate-string="true"> ，并将二者分别保存在了 Request 类型结构体变量中 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20908"><span data-slate-object="text" data-key="20909"><span data-slate-leaf="true" data-offset-key="20909:0" data-first-offset="true"><span data-slate-string="true">c</span></span></span></span><span data-slate-object="text" data-key="20910"><span data-slate-leaf="true" data-offset-key="20910:0" data-first-offset="true"><span data-slate-string="true"> 字段的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20911"><span data-slate-object="text" data-key="20912"><span data-slate-leaf="true" data-offset-key="20912:0" data-first-offset="true"><span data-slate-string="true">base</span></span></span></span><span data-slate-object="text" data-key="20913"><span data-slate-leaf="true" data-offset-key="20913:0" data-first-offset="true"><span data-slate-string="true"> 字段和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20914"><span data-slate-object="text" data-key="20915"><span data-slate-leaf="true" data-offset-key="20915:0" data-first-offset="true"><span data-slate-string="true">versionedAPIPath</span></span></span></span><span data-slate-object="text" data-key="20916"><span data-slate-leaf="true" data-offset-key="20916:0" data-first-offset="true"><span data-slate-string="true"> 字段中。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20917"><span data-slate-object="text" data-key="20918"><span data-slate-leaf="true" data-offset-key="20918:0" data-first-offset="true"><span data-slate-string="true">通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20919"><span data-slate-object="text" data-key="20920"><span data-slate-leaf="true" data-offset-key="20920:0" data-first-offset="true"><span data-slate-string="true">Do</span></span></span></a><span data-slate-object="text" data-key="20921"><span data-slate-leaf="true" data-offset-key="20921:0" data-first-offset="true"><span data-slate-string="true"> 方法执行 HTTP 时，会调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20922"><span data-slate-object="text" data-key="20923"><span data-slate-leaf="true" data-offset-key="20923:0" data-first-offset="true"><span data-slate-string="true">r.URL()</span></span></span></a><span data-slate-object="text" data-key="20924"><span data-slate-leaf="true" data-offset-key="20924:0" data-first-offset="true"><span data-slate-string="true"> 方法来构建请求 URL。 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20925"><span data-slate-object="text" data-key="20926"><span data-slate-leaf="true" data-offset-key="20926:0" data-first-offset="true"><span data-slate-string="true">r.URL</span></span></span></span><span data-slate-object="text" data-key="20927"><span data-slate-leaf="true" data-offset-key="20927:0" data-first-offset="true"><span data-slate-string="true"> 方法中，通过以下代码段构建了 HTTP 请求 URL：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20928"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20929"><span data-slate-object="text" data-key="20930"><span data-slate-leaf="true" data-offset-key="20930:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20931"><span data-slate-leaf="true" data-offset-key="20931:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20932"><span data-slate-leaf="true" data-offset-key="20932:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="20933"><span data-slate-leaf="true" data-offset-key="20933:0" data-first-offset="true"><span data-slate-string="true"> URL() *url.URL {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20934"><span data-slate-object="text" data-key="20935"><span data-slate-leaf="true" data-offset-key="20935:0" data-first-offset="true"><span data-slate-string="true">    p := r.pathPrefix</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20936"><span data-slate-object="text" data-key="20937"><span data-slate-leaf="true" data-offset-key="20937:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20938"><span data-slate-leaf="true" data-offset-key="20938:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20939"><span data-slate-leaf="true" data-offset-key="20939:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20940"><span data-slate-leaf="true" data-offset-key="20940:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="20941"><span data-slate-leaf="true" data-offset-key="20941:0" data-first-offset="true"><span data-slate-string="true">(r.resource) != </span></span></span><span data-slate-object="text" data-key="20942"><span data-slate-leaf="true" data-offset-key="20942:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="20943"><span data-slate-leaf="true" data-offset-key="20943:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20944"><span data-slate-object="text" data-key="20945"><span data-slate-leaf="true" data-offset-key="20945:0" data-first-offset="true"><span data-slate-string="true">        p = path.Join(p, strings.ToLower(r.resource))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20946"><span data-slate-object="text" data-key="20947"><span data-slate-leaf="true" data-offset-key="20947:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20948"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20949"><span data-slate-object="text" data-key="20950"><span data-slate-leaf="true" data-offset-key="20950:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20951"><span data-slate-leaf="true" data-offset-key="20951:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20952"><span data-slate-leaf="true" data-offset-key="20952:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20953"><span data-slate-leaf="true" data-offset-key="20953:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="20954"><span data-slate-leaf="true" data-offset-key="20954:0" data-first-offset="true"><span data-slate-string="true">(r.resourceName) != </span></span></span><span data-slate-object="text" data-key="20955"><span data-slate-leaf="true" data-offset-key="20955:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="20956"><span data-slate-leaf="true" data-offset-key="20956:0" data-first-offset="true"><span data-slate-string="true"> || </span></span></span><span data-slate-object="text" data-key="20957"><span data-slate-leaf="true" data-offset-key="20957:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="20958"><span data-slate-leaf="true" data-offset-key="20958:0" data-first-offset="true"><span data-slate-string="true">(r.subpath) != </span></span></span><span data-slate-object="text" data-key="20959"><span data-slate-leaf="true" data-offset-key="20959:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="20960"><span data-slate-leaf="true" data-offset-key="20960:0" data-first-offset="true"><span data-slate-string="true"> || </span></span></span><span data-slate-object="text" data-key="20961"><span data-slate-leaf="true" data-offset-key="20961:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">len</span></span></span></span><span data-slate-object="text" data-key="20962"><span data-slate-leaf="true" data-offset-key="20962:0" data-first-offset="true"><span data-slate-string="true">(r.subresource) != </span></span></span><span data-slate-object="text" data-key="20963"><span data-slate-leaf="true" data-offset-key="20963:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="20964"><span data-slate-leaf="true" data-offset-key="20964:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20965"><span data-slate-object="text" data-key="20966"><span data-slate-leaf="true" data-offset-key="20966:0" data-first-offset="true"><span data-slate-string="true">        p = path.Join(p, r.resourceName, r.subresource, r.subpath)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20967"><span data-slate-object="text" data-key="20968"><span data-slate-leaf="true" data-offset-key="20968:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20969"><span data-slate-object="text" data-key="20970"><span data-slate-leaf="true" data-offset-key="20970:0" data-first-offset="true"><span data-slate-string="true">                                                                                   </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20971"><span data-slate-object="text" data-key="20972"><span data-slate-leaf="true" data-offset-key="20972:0" data-first-offset="true"><span data-slate-string="true">    finalURL := &amp;url.URL{}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20973"><span data-slate-object="text" data-key="20974"><span data-slate-leaf="true" data-offset-key="20974:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20975"><span data-slate-leaf="true" data-offset-key="20975:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20976"><span data-slate-leaf="true" data-offset-key="20976:0" data-first-offset="true"><span data-slate-string="true"> r.c.base != </span></span></span><span data-slate-object="text" data-key="20977"><span data-slate-leaf="true" data-offset-key="20977:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20978"><span data-slate-leaf="true" data-offset-key="20978:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20979"><span data-slate-object="text" data-key="20980"><span data-slate-leaf="true" data-offset-key="20980:0" data-first-offset="true"><span data-slate-string="true">        *finalURL = *r.c.bas</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20981"><span data-slate-object="text" data-key="20982"><span data-slate-leaf="true" data-offset-key="20982:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20983"><span data-slate-object="text" data-key="20984"><span data-slate-leaf="true" data-offset-key="20984:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20985"><span data-slate-object="text" data-key="20986"><span data-slate-leaf="true" data-offset-key="20986:0" data-first-offset="true"><span data-slate-string="true">    finalURL.Path = p</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20987"><span data-slate-object="text" data-key="20988"><span data-slate-leaf="true" data-offset-key="20988:0" data-first-offset="true"><span data-slate-string="true">    ...    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20989"><span data-slate-object="text" data-key="20990"><span data-slate-leaf="true" data-offset-key="20990:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20991"><span data-slate-type="code" data-slate-object="inline" data-key="20992"><span data-slate-object="text" data-key="20993"><span data-slate-leaf="true" data-offset-key="20993:0" data-first-offset="true"><span data-slate-string="true">p := r.pathPrefix</span></span></span></span><span data-slate-object="text" data-key="20994"><span data-slate-leaf="true" data-offset-key="20994:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20995"><span data-slate-object="text" data-key="20996"><span data-slate-leaf="true" data-offset-key="20996:0" data-first-offset="true"><span data-slate-string="true">r.c.base</span></span></span></span><span data-slate-object="text" data-key="20997"><span data-slate-leaf="true" data-offset-key="20997:0" data-first-offset="true"><span data-slate-string="true"> ，是通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20998"><span data-slate-object="text" data-key="20999"><span data-slate-leaf="true" data-offset-key="20999:0" data-first-offset="true"><span data-slate-string="true">defaultServerURLFor</span></span></span></span><span data-slate-object="text" data-key="21000"><span data-slate-leaf="true" data-offset-key="21000:0" data-first-offset="true"><span data-slate-string="true"> 调用返回的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21001"><span data-slate-object="text" data-key="21002"><span data-slate-leaf="true" data-offset-key="21002:0" data-first-offset="true"><span data-slate-string="true">v1</span></span></span></span><span data-slate-object="text" data-key="21003"><span data-slate-leaf="true" data-offset-key="21003:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21004"><span data-slate-object="text" data-key="21005"><span data-slate-leaf="true" data-offset-key="21005:0" data-first-offset="true"><span data-slate-string="true">http://iam.api.marmotedu.com:8080</span></span></span></span><span data-slate-object="text" data-key="21006"><span data-slate-leaf="true" data-offset-key="21006:0" data-first-offset="true"><span data-slate-string="true"> 来构建的。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21007"><span data-slate-type="code" data-slate-object="inline" data-key="21008"><span data-slate-object="text" data-key="21009"><span data-slate-leaf="true" data-offset-key="21009:0" data-first-offset="true"><span data-slate-string="true">resourceName</span></span></span></span><span data-slate-object="text" data-key="21010"><span data-slate-leaf="true" data-offset-key="21010:0" data-first-offset="true"><span data-slate-string="true"> 通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21011"><span data-slate-object="text" data-key="21012"><span data-slate-leaf="true" data-offset-key="21012:0" data-first-offset="true"><span data-slate-string="true">func (r *Request) Resource(resource string) *Request</span></span></span></span><span data-slate-object="text" data-key="21013"><span data-slate-leaf="true" data-offset-key="21013:0" data-first-offset="true"><span data-slate-string="true"> 来指定，例如 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21014"><span data-slate-object="text" data-key="21015"><span data-slate-leaf="true" data-offset-key="21015:0" data-first-offset="true"><span data-slate-string="true">authz</span></span></span></span><span data-slate-object="text" data-key="21016"><span data-slate-leaf="true" data-offset-key="21016:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21017"><span data-slate-object="text" data-key="21018"><span data-slate-leaf="true" data-offset-key="21018:0" data-first-offset="true"><span data-slate-string="true">所以，最终我们构建的请求 URL 为 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21019"><span data-slate-object="text" data-key="21020"><span data-slate-leaf="true" data-offset-key="21020:0" data-first-offset="true"><span data-slate-string="true">http://iam.api.marmotedu.com:8080/v1/authz</span></span></span></span><span data-slate-object="text" data-key="21021"><span data-slate-leaf="true" data-offset-key="21021:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21022"><span data-slate-object="text" data-key="21023"><span data-slate-leaf="true" data-offset-key="21023:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二步，构建 HTTP Method。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21024"><span data-slate-object="text" data-key="21025"><span data-slate-leaf="true" data-offset-key="21025:0" data-first-offset="true"><span data-slate-string="true">HTTP Method 通过 RESTClient 提供的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21026"><span data-slate-object="text" data-key="21027"><span data-slate-leaf="true" data-offset-key="21027:0" data-first-offset="true"><span data-slate-string="true">Post</span></span></span></span><span data-slate-object="text" data-key="21028"><span data-slate-leaf="true" data-offset-key="21028:0" data-first-offset="true"><span data-slate-string="true"> 、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21029"><span data-slate-object="text" data-key="21030"><span data-slate-leaf="true" data-offset-key="21030:0" data-first-offset="true"><span data-slate-string="true">Delete</span></span></span></span><span data-slate-object="text" data-key="21031"><span data-slate-leaf="true" data-offset-key="21031:0" data-first-offset="true"><span data-slate-string="true"> 、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21032"><span data-slate-object="text" data-key="21033"><span data-slate-leaf="true" data-offset-key="21033:0" data-first-offset="true"><span data-slate-string="true">Get</span></span></span></span><span data-slate-object="text" data-key="21034"><span data-slate-leaf="true" data-offset-key="21034:0" data-first-offset="true"><span data-slate-string="true"> 等方法来设置，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="21035"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21036"><span data-slate-object="text" data-key="21037"><span data-slate-leaf="true" data-offset-key="21037:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="21038"><span data-slate-leaf="true" data-offset-key="21038:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="21039"><span data-slate-leaf="true" data-offset-key="21039:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="21040"><span data-slate-leaf="true" data-offset-key="21040:0" data-first-offset="true"><span data-slate-string="true"> Post() *Request {                                                                                 </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21041"><span data-slate-object="text" data-key="21042"><span data-slate-leaf="true" data-offset-key="21042:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21043"><span data-slate-leaf="true" data-offset-key="21043:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21044"><span data-slate-leaf="true" data-offset-key="21044:0" data-first-offset="true"><span data-slate-string="true"> c.Verb(</span></span></span><span data-slate-object="text" data-key="21045"><span data-slate-leaf="true" data-offset-key="21045:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"POST"</span></span></span></span><span data-slate-object="text" data-key="21046"><span data-slate-leaf="true" data-offset-key="21046:0" data-first-offset="true"><span data-slate-string="true">)                                                                                              </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21047"><span data-slate-object="text" data-key="21048"><span data-slate-leaf="true" data-offset-key="21048:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21049"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21050"><span data-slate-object="text" data-key="21051"><span data-slate-leaf="true" data-offset-key="21051:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="21052"><span data-slate-leaf="true" data-offset-key="21052:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="21053"><span data-slate-leaf="true" data-offset-key="21053:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(c *RESTClient)</span></span></span></span></span><span data-slate-object="text" data-key="21054"><span data-slate-leaf="true" data-offset-key="21054:0" data-first-offset="true"><span data-slate-string="true"> Verb(verb </span></span></span><span data-slate-object="text" data-key="21055"><span data-slate-leaf="true" data-offset-key="21055:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">string</span></span></span></span><span data-slate-object="text" data-key="21056"><span data-slate-leaf="true" data-offset-key="21056:0" data-first-offset="true"><span data-slate-string="true">) *Request {                                                                      </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21057"><span data-slate-object="text" data-key="21058"><span data-slate-leaf="true" data-offset-key="21058:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21059"><span data-slate-leaf="true" data-offset-key="21059:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21060"><span data-slate-leaf="true" data-offset-key="21060:0" data-first-offset="true"><span data-slate-string="true"> NewRequest(c).Verb(verb)                                                                                    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21061"><span data-slate-object="text" data-key="21062"><span data-slate-leaf="true" data-offset-key="21062:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21063"><span data-slate-type="code" data-slate-object="inline" data-key="21064"><span data-slate-object="text" data-key="21065"><span data-slate-leaf="true" data-offset-key="21065:0" data-first-offset="true"><span data-slate-string="true">NewRequest(c).Verb(verb)</span></span></span></span><span data-slate-object="text" data-key="21066"><span data-slate-leaf="true" data-offset-key="21066:0" data-first-offset="true"><span data-slate-string="true"> 最终设置了 Request 结构体的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21067"><span data-slate-object="text" data-key="21068"><span data-slate-leaf="true" data-offset-key="21068:0" data-first-offset="true"><span data-slate-string="true">verb</span></span></span></span><span data-slate-object="text" data-key="21069"><span data-slate-leaf="true" data-offset-key="21069:0" data-first-offset="true"><span data-slate-string="true"> 字段，供 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21070"><span data-slate-object="text" data-key="21071"><span data-slate-leaf="true" data-offset-key="21071:0" data-first-offset="true"><span data-slate-string="true">Do</span></span></span></span><span data-slate-object="text" data-key="21072"><span data-slate-leaf="true" data-offset-key="21072:0" data-first-offset="true"><span data-slate-string="true"> 方法使用。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21073"><span data-slate-object="text" data-key="21074"><span data-slate-leaf="true" data-offset-key="21074:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第三步，构建 HTTP Body。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21075"><span data-slate-object="text" data-key="21076"><span data-slate-leaf="true" data-offset-key="21076:0" data-first-offset="true"><span data-slate-string="true">HTTP Body 通过 Request 结构体提供的 Body 方法来指定：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="21077"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21078"><span data-slate-object="text" data-key="21079"><span data-slate-leaf="true" data-offset-key="21079:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="21080"><span data-slate-leaf="true" data-offset-key="21080:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="21081"><span data-slate-leaf="true" data-offset-key="21081:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="21082"><span data-slate-leaf="true" data-offset-key="21082:0" data-first-offset="true"><span data-slate-string="true"> Body(obj </span></span></span><span data-slate-object="text" data-key="21083"><span data-slate-leaf="true" data-offset-key="21083:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="21084"><span data-slate-leaf="true" data-offset-key="21084:0" data-first-offset="true"><span data-slate-string="true">{}) *Request {                    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21085"><span data-slate-object="text" data-key="21086"><span data-slate-leaf="true" data-offset-key="21086:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21087"><span data-slate-leaf="true" data-offset-key="21087:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21088"><span data-slate-leaf="true" data-offset-key="21088:0" data-first-offset="true"><span data-slate-string="true"> v := reflect.ValueOf(obj); v.Kind() == reflect.Struct {              </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21089"><span data-slate-object="text" data-key="21090"><span data-slate-leaf="true" data-offset-key="21090:0" data-first-offset="true"><span data-slate-string="true">        r.SetHeader(</span></span></span><span data-slate-object="text" data-key="21091"><span data-slate-leaf="true" data-offset-key="21091:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Content-Type"</span></span></span></span><span data-slate-object="text" data-key="21092"><span data-slate-leaf="true" data-offset-key="21092:0" data-first-offset="true"><span data-slate-string="true">, r.c.content.ContentType)                </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21093"><span data-slate-object="text" data-key="21094"><span data-slate-leaf="true" data-offset-key="21094:0" data-first-offset="true"><span data-slate-string="true">    }                                                                                                                  </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21095"><span data-slate-object="text" data-key="21096"><span data-slate-leaf="true" data-offset-key="21096:0" data-first-offset="true"><span data-slate-string="true">                                                                                                                       </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21097"><span data-slate-object="text" data-key="21098"><span data-slate-leaf="true" data-offset-key="21098:0" data-first-offset="true"><span data-slate-string="true">    r.body = obj                                                                                                       </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21099"><span data-slate-object="text" data-key="21100"><span data-slate-leaf="true" data-offset-key="21100:0" data-first-offset="true"><span data-slate-string="true">                                                                                                                       </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21101"><span data-slate-object="text" data-key="21102"><span data-slate-leaf="true" data-offset-key="21102:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21103"><span data-slate-leaf="true" data-offset-key="21103:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21104"><span data-slate-leaf="true" data-offset-key="21104:0" data-first-offset="true"><span data-slate-string="true"> r                                                                                                           </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21105"><span data-slate-object="text" data-key="21106"><span data-slate-leaf="true" data-offset-key="21106:0" data-first-offset="true"><span data-slate-string="true">} </span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21107"><span data-slate-object="text" data-key="21108"><span data-slate-leaf="true" data-offset-key="21108:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第四步，执行 HTTP 请求。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21109"><span data-slate-object="text" data-key="21110"><span data-slate-leaf="true" data-offset-key="21110:0" data-first-offset="true"><span data-slate-string="true">通过 Request 结构体提供的 Do 方法来执行具体的 HTTP 请求，代码如下：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="21111"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div><div data-code-line-number="30"></div><div data-code-line-number="31"></div><div data-code-line-number="32"></div><div data-code-line-number="33"></div><div data-code-line-number="34"></div><div data-code-line-number="35"></div><div data-code-line-number="36"></div><div data-code-line-number="37"></div><div data-code-line-number="38"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21112"><span data-slate-object="text" data-key="21113"><span data-slate-leaf="true" data-offset-key="21113:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="21114"><span data-slate-leaf="true" data-offset-key="21114:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="21115"><span data-slate-leaf="true" data-offset-key="21115:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r *Request)</span></span></span></span></span><span data-slate-object="text" data-key="21116"><span data-slate-leaf="true" data-offset-key="21116:0" data-first-offset="true"><span data-slate-string="true"> Do(ctx context.Context) Result {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21117"><span data-slate-object="text" data-key="21118"><span data-slate-leaf="true" data-offset-key="21118:0" data-first-offset="true"><span data-slate-string="true">  client := r.c.Client</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21119"><span data-slate-object="text" data-key="21120"><span data-slate-leaf="true" data-offset-key="21120:0" data-first-offset="true"><span data-slate-string="true">  client.Header = r.headers</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21121"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21122"><span data-slate-object="text" data-key="21123"><span data-slate-leaf="true" data-offset-key="21123:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="21124"><span data-slate-leaf="true" data-offset-key="21124:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21125"><span data-slate-leaf="true" data-offset-key="21125:0" data-first-offset="true"><span data-slate-string="true"> r.timeout &gt; </span></span></span><span data-slate-object="text" data-key="21126"><span data-slate-leaf="true" data-offset-key="21126:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">0</span></span></span></span><span data-slate-object="text" data-key="21127"><span data-slate-leaf="true" data-offset-key="21127:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21128"><span data-slate-object="text" data-key="21129"><span data-slate-leaf="true" data-offset-key="21129:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21130"><span data-slate-leaf="true" data-offset-key="21130:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">var</span></span></span></span><span data-slate-object="text" data-key="21131"><span data-slate-leaf="true" data-offset-key="21131:0" data-first-offset="true"><span data-slate-string="true"> cancel context.CancelFunc</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21132"><span data-slate-object="text" data-key="21133"><span data-slate-leaf="true" data-offset-key="21133:0" data-first-offset="true"><span data-slate-string="true">    ctx, cancel = context.WithTimeout(ctx, r.timeout)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21134"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21135"><span data-slate-object="text" data-key="21136"><span data-slate-leaf="true" data-offset-key="21136:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21137"><span data-slate-leaf="true" data-offset-key="21137:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">defer</span></span></span></span><span data-slate-object="text" data-key="21138"><span data-slate-leaf="true" data-offset-key="21138:0" data-first-offset="true"><span data-slate-string="true"> cancel()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21139"><span data-slate-object="text" data-key="21140"><span data-slate-leaf="true" data-offset-key="21140:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21141"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21142"><span data-slate-object="text" data-key="21143"><span data-slate-leaf="true" data-offset-key="21143:0" data-first-offset="true"><span data-slate-string="true">  client.WithContext(ctx)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21144"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21145"><span data-slate-object="text" data-key="21146"><span data-slate-leaf="true" data-offset-key="21146:0" data-first-offset="true"><span data-slate-string="true">  resp, body, errs := client.CustomMethod(r.verb, r.URL().String()).Send(r.body).EndBytes()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21147"><span data-slate-object="text" data-key="21148"><span data-slate-leaf="true" data-offset-key="21148:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="21149"><span data-slate-leaf="true" data-offset-key="21149:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21150"><span data-slate-leaf="true" data-offset-key="21150:0" data-first-offset="true"><span data-slate-string="true"> err := combineErr(resp, body, errs); err != </span></span></span><span data-slate-object="text" data-key="21151"><span data-slate-leaf="true" data-offset-key="21151:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21152"><span data-slate-leaf="true" data-offset-key="21152:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21153"><span data-slate-object="text" data-key="21154"><span data-slate-leaf="true" data-offset-key="21154:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21155"><span data-slate-leaf="true" data-offset-key="21155:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21156"><span data-slate-leaf="true" data-offset-key="21156:0" data-first-offset="true"><span data-slate-string="true"> Result{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21157"><span data-slate-object="text" data-key="21158"><span data-slate-leaf="true" data-offset-key="21158:0" data-first-offset="true"><span data-slate-string="true">      response: &amp;resp,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21159"><span data-slate-object="text" data-key="21160"><span data-slate-leaf="true" data-offset-key="21160:0" data-first-offset="true"><span data-slate-string="true">      err:      err,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21161"><span data-slate-object="text" data-key="21162"><span data-slate-leaf="true" data-offset-key="21162:0" data-first-offset="true"><span data-slate-string="true">      body:     body,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21163"><span data-slate-object="text" data-key="21164"><span data-slate-leaf="true" data-offset-key="21164:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21165"><span data-slate-object="text" data-key="21166"><span data-slate-leaf="true" data-offset-key="21166:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21167"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21168"><span data-slate-object="text" data-key="21169"><span data-slate-leaf="true" data-offset-key="21169:0" data-first-offset="true"><span data-slate-string="true">  decoder, err := r.c.content.Negotiator.Decoder()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21170"><span data-slate-object="text" data-key="21171"><span data-slate-leaf="true" data-offset-key="21171:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="21172"><span data-slate-leaf="true" data-offset-key="21172:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21173"><span data-slate-leaf="true" data-offset-key="21173:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="21174"><span data-slate-leaf="true" data-offset-key="21174:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21175"><span data-slate-leaf="true" data-offset-key="21175:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21176"><span data-slate-object="text" data-key="21177"><span data-slate-leaf="true" data-offset-key="21177:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21178"><span data-slate-leaf="true" data-offset-key="21178:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21179"><span data-slate-leaf="true" data-offset-key="21179:0" data-first-offset="true"><span data-slate-string="true"> Result{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21180"><span data-slate-object="text" data-key="21181"><span data-slate-leaf="true" data-offset-key="21181:0" data-first-offset="true"><span data-slate-string="true">      response: &amp;resp,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21182"><span data-slate-object="text" data-key="21183"><span data-slate-leaf="true" data-offset-key="21183:0" data-first-offset="true"><span data-slate-string="true">      err:      err,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21184"><span data-slate-object="text" data-key="21185"><span data-slate-leaf="true" data-offset-key="21185:0" data-first-offset="true"><span data-slate-string="true">      body:     body,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21186"><span data-slate-object="text" data-key="21187"><span data-slate-leaf="true" data-offset-key="21187:0" data-first-offset="true"><span data-slate-string="true">      decoder:  decoder,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21188"><span data-slate-object="text" data-key="21189"><span data-slate-leaf="true" data-offset-key="21189:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21190"><span data-slate-object="text" data-key="21191"><span data-slate-leaf="true" data-offset-key="21191:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21192"></div><div data-slate-type="code-line" data-slate-object="block" data-key="21193"><span data-slate-object="text" data-key="21194"><span data-slate-leaf="true" data-offset-key="21194:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="21195"><span data-slate-leaf="true" data-offset-key="21195:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21196"><span data-slate-leaf="true" data-offset-key="21196:0" data-first-offset="true"><span data-slate-string="true"> Result{</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21197"><span data-slate-object="text" data-key="21198"><span data-slate-leaf="true" data-offset-key="21198:0" data-first-offset="true"><span data-slate-string="true">    response: &amp;resp,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21199"><span data-slate-object="text" data-key="21200"><span data-slate-leaf="true" data-offset-key="21200:0" data-first-offset="true"><span data-slate-string="true">    body:     body,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21201"><span data-slate-object="text" data-key="21202"><span data-slate-leaf="true" data-offset-key="21202:0" data-first-offset="true"><span data-slate-string="true">    decoder:  decoder,</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21203"><span data-slate-object="text" data-key="21204"><span data-slate-leaf="true" data-offset-key="21204:0" data-first-offset="true"><span data-slate-string="true">  }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21205"><span data-slate-object="text" data-key="21206"><span data-slate-leaf="true" data-offset-key="21206:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21207"><span data-slate-object="text" data-key="21208"><span data-slate-leaf="true" data-offset-key="21208:0" data-first-offset="true"><span data-slate-string="true">在 Do 方法中，使用了 Request 结构体变量中各个字段的值，通过 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21209"><span data-slate-object="text" data-key="21210"><span data-slate-leaf="true" data-offset-key="21210:0" data-first-offset="true"><span data-slate-string="true">client.CustomMethod</span></span></span></span><span data-slate-object="text" data-key="21211"><span data-slate-leaf="true" data-offset-key="21211:0" data-first-offset="true"><span data-slate-string="true"> 来执行 HTTP 请求。 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21212"><span data-slate-object="text" data-key="21213"><span data-slate-leaf="true" data-offset-key="21213:0" data-first-offset="true"><span data-slate-string="true">client</span></span></span></span><span data-slate-object="text" data-key="21214"><span data-slate-leaf="true" data-offset-key="21214:0" data-first-offset="true"><span data-slate-string="true"> 是 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21215"><span data-slate-object="text" data-key="21216"><span data-slate-leaf="true" data-offset-key="21216:0" data-first-offset="true"><span data-slate-string="true">*gorequest.SuperAgent</span></span></span></span><span data-slate-object="text" data-key="21217"><span data-slate-leaf="true" data-offset-key="21217:0" data-first-offset="true"><span data-slate-string="true"> 类型的客户端。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21218"><span data-slate-object="text" data-key="21219"><span data-slate-leaf="true" data-offset-key="21219:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第五步，保存 HTTP 返回结果。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21220"><span data-slate-object="text" data-key="21221"><span data-slate-leaf="true" data-offset-key="21221:0" data-first-offset="true"><span data-slate-string="true">通过 Request 结构体的 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21222"><span data-slate-object="text" data-key="21223"><span data-slate-leaf="true" data-offset-key="21223:0" data-first-offset="true"><span data-slate-string="true">Into</span></span></span></span><span data-slate-object="text" data-key="21224"><span data-slate-leaf="true" data-offset-key="21224:0" data-first-offset="true"><span data-slate-string="true"> 方法来保存 HTTP 返回结果：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="21225"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21226"><span data-slate-object="text" data-key="21227"><span data-slate-leaf="true" data-offset-key="21227:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="21228"><span data-slate-leaf="true" data-offset-key="21228:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="21229"><span data-slate-leaf="true" data-offset-key="21229:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(r Result)</span></span></span></span></span><span data-slate-object="text" data-key="21230"><span data-slate-leaf="true" data-offset-key="21230:0" data-first-offset="true"><span data-slate-string="true"> Into(v </span></span></span><span data-slate-object="text" data-key="21231"><span data-slate-leaf="true" data-offset-key="21231:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">interface</span></span></span></span><span data-slate-object="text" data-key="21232"><span data-slate-leaf="true" data-offset-key="21232:0" data-first-offset="true"><span data-slate-string="true">{}) </span></span></span><span data-slate-object="text" data-key="21233"><span data-slate-leaf="true" data-offset-key="21233:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="21234"><span data-slate-leaf="true" data-offset-key="21234:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21235"><span data-slate-object="text" data-key="21236"><span data-slate-leaf="true" data-offset-key="21236:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21237"><span data-slate-leaf="true" data-offset-key="21237:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21238"><span data-slate-leaf="true" data-offset-key="21238:0" data-first-offset="true"><span data-slate-string="true"> r.err != </span></span></span><span data-slate-object="text" data-key="21239"><span data-slate-leaf="true" data-offset-key="21239:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21240"><span data-slate-leaf="true" data-offset-key="21240:0" data-first-offset="true"><span data-slate-string="true"> {                                          </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21241"><span data-slate-object="text" data-key="21242"><span data-slate-leaf="true" data-offset-key="21242:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="21243"><span data-slate-leaf="true" data-offset-key="21243:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21244"><span data-slate-leaf="true" data-offset-key="21244:0" data-first-offset="true"><span data-slate-string="true"> r.Error()</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21245"><span data-slate-object="text" data-key="21246"><span data-slate-leaf="true" data-offset-key="21246:0" data-first-offset="true"><span data-slate-string="true">    }                                                                                 </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21247"><span data-slate-object="text" data-key="21248"><span data-slate-leaf="true" data-offset-key="21248:0" data-first-offset="true"><span data-slate-string="true">                                                         </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21249"><span data-slate-object="text" data-key="21250"><span data-slate-leaf="true" data-offset-key="21250:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21251"><span data-slate-leaf="true" data-offset-key="21251:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21252"><span data-slate-leaf="true" data-offset-key="21252:0" data-first-offset="true"><span data-slate-string="true"> r.decoder == </span></span></span><span data-slate-object="text" data-key="21253"><span data-slate-leaf="true" data-offset-key="21253:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21254"><span data-slate-leaf="true" data-offset-key="21254:0" data-first-offset="true"><span data-slate-string="true"> {                                                                    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21255"><span data-slate-object="text" data-key="21256"><span data-slate-leaf="true" data-offset-key="21256:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="21257"><span data-slate-leaf="true" data-offset-key="21257:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21258"><span data-slate-leaf="true" data-offset-key="21258:0" data-first-offset="true"><span data-slate-string="true"> fmt.Errorf(</span></span></span><span data-slate-object="text" data-key="21259"><span data-slate-leaf="true" data-offset-key="21259:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"serializer doesn't exist"</span></span></span></span><span data-slate-object="text" data-key="21260"><span data-slate-leaf="true" data-offset-key="21260:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21261"><span data-slate-object="text" data-key="21262"><span data-slate-leaf="true" data-offset-key="21262:0" data-first-offset="true"><span data-slate-string="true">    }                            </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21263"><span data-slate-object="text" data-key="21264"><span data-slate-leaf="true" data-offset-key="21264:0" data-first-offset="true"><span data-slate-string="true">                             </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21265"><span data-slate-object="text" data-key="21266"><span data-slate-leaf="true" data-offset-key="21266:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21267"><span data-slate-leaf="true" data-offset-key="21267:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="21268"><span data-slate-leaf="true" data-offset-key="21268:0" data-first-offset="true"><span data-slate-string="true"> err := r.decoder.Decode(r.body, &amp;v); err != </span></span></span><span data-slate-object="text" data-key="21269"><span data-slate-leaf="true" data-offset-key="21269:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21270"><span data-slate-leaf="true" data-offset-key="21270:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21271"><span data-slate-object="text" data-key="21272"><span data-slate-leaf="true" data-offset-key="21272:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="21273"><span data-slate-leaf="true" data-offset-key="21273:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21274"><span data-slate-leaf="true" data-offset-key="21274:0" data-first-offset="true"><span data-slate-string="true"> err                                                                    </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21275"><span data-slate-object="text" data-key="21276"><span data-slate-leaf="true" data-offset-key="21276:0" data-first-offset="true"><span data-slate-string="true">    }                                                                                        </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21277"><span data-slate-object="text" data-key="21278"><span data-slate-leaf="true" data-offset-key="21278:0" data-first-offset="true"><span data-slate-string="true">                                                             </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21279"><span data-slate-object="text" data-key="21280"><span data-slate-leaf="true" data-offset-key="21280:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21281"><span data-slate-leaf="true" data-offset-key="21281:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="21282"><span data-slate-leaf="true" data-offset-key="21282:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="21283"><span data-slate-leaf="true" data-offset-key="21283:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="21284"><span data-slate-leaf="true" data-offset-key="21284:0" data-first-offset="true"><span data-slate-string="true">                                                                      </span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21285"><span data-slate-object="text" data-key="21286"><span data-slate-leaf="true" data-offset-key="21286:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21287"><span data-slate-type="code" data-slate-object="inline" data-key="21288"><span data-slate-object="text" data-key="21289"><span data-slate-leaf="true" data-offset-key="21289:0" data-first-offset="true"><span data-slate-string="true">r.body</span></span></span></span><span data-slate-object="text" data-key="21290"><span data-slate-leaf="true" data-offset-key="21290:0" data-first-offset="true"><span data-slate-string="true"> 是在 Do 方法中，执行完 HTTP 请求后设置的，它的值为 HTTP 请求返回的 Body。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="21291" id="sr-toc-9"><span data-slate-object="text" data-key="21292"><span data-slate-leaf="true" data-offset-key="21292:0" data-first-offset="true"><span data-slate-string="true">请求认证</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="21293"><span data-slate-object="text" data-key="21294"><span data-slate-leaf="true" data-offset-key="21294:0" data-first-offset="true"><span data-slate-string="true">接下来，我再来介绍下 marmotedu-sdk-go 另外一个比较核心的功能：请求认证。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21295"><span data-slate-object="text" data-key="21296"><span data-slate-leaf="true" data-offset-key="21296:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 支持两种认证方式：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="21297"><div data-slate-type="list-line" data-slate-object="block" data-key="21298"><span data-slate-object="text" data-key="21299"><span data-slate-leaf="true" data-offset-key="21299:0" data-first-offset="true"><span data-slate-string="true">Basic 认证：通过给请求添加 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21300"><span data-slate-object="text" data-key="21301"><span data-slate-leaf="true" data-offset-key="21301:0" data-first-offset="true"><span data-slate-string="true">Authorization: Basic xxxx</span></span></span></span><span data-slate-object="text" data-key="21302"><span data-slate-leaf="true" data-offset-key="21302:0" data-first-offset="true"><span data-slate-string="true"> 来实现。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="21303"><span data-slate-object="text" data-key="21304"><span data-slate-leaf="true" data-offset-key="21304:0" data-first-offset="true"><span data-slate-string="true">Bearer 认证：通过给请求添加 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21305"><span data-slate-object="text" data-key="21306"><span data-slate-leaf="true" data-offset-key="21306:0" data-first-offset="true"><span data-slate-string="true">Authorization: Bearer xxxx</span></span></span></span><span data-slate-object="text" data-key="21307"><span data-slate-leaf="true" data-offset-key="21307:0" data-first-offset="true"><span data-slate-string="true"> 来实现。这种方式又支持直接指定 JWT Token，或者通过指定密钥对由 SDK 自动生成 JWT Token。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21308"><span data-slate-object="text" data-key="21309"><span data-slate-leaf="true" data-offset-key="21309:0" data-first-offset="true"><span data-slate-string="true">Basic 认证和 Bearer 认证，我在 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21310"><span data-slate-object="text" data-key="21311"><span data-slate-leaf="true" data-offset-key="21311:0" data-first-offset="true"><span data-slate-string="true">25 讲</span></span></span></a><span data-slate-object="text" data-key="21312"><span data-slate-leaf="true" data-offset-key="21312:0" data-first-offset="true"><span data-slate-string="true">介绍过，你可以返回查看下。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21313"><span data-slate-object="text" data-key="21314"><span data-slate-leaf="true" data-offset-key="21314:0" data-first-offset="true"><span data-slate-string="true">认证头是 RESTClient 客户端发送 HTTP 请求时指定的，具体实现位于 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21315"><span data-slate-object="text" data-key="21316"><span data-slate-leaf="true" data-offset-key="21316:0" data-first-offset="true"><span data-slate-string="true">NewRequest</span></span></span></a><span data-slate-object="text" data-key="21317"><span data-slate-leaf="true" data-offset-key="21317:0" data-first-offset="true"><span data-slate-string="true"> 函数中：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="21318"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21319"><span data-slate-object="text" data-key="21320"><span data-slate-leaf="true" data-offset-key="21320:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">switch</span></span></span></span><span data-slate-object="text" data-key="21321"><span data-slate-leaf="true" data-offset-key="21321:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21322"><span data-slate-object="text" data-key="21323"><span data-slate-leaf="true" data-offset-key="21323:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21324"><span data-slate-leaf="true" data-offset-key="21324:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">case</span></span></span></span><span data-slate-object="text" data-key="21325"><span data-slate-leaf="true" data-offset-key="21325:0" data-first-offset="true"><span data-slate-string="true"> c.content.HasTokenAuth():</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21326"><span data-slate-object="text" data-key="21327"><span data-slate-leaf="true" data-offset-key="21327:0" data-first-offset="true"><span data-slate-string="true">        r.SetHeader(</span></span></span><span data-slate-object="text" data-key="21328"><span data-slate-leaf="true" data-offset-key="21328:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization"</span></span></span></span><span data-slate-object="text" data-key="21329"><span data-slate-leaf="true" data-offset-key="21329:0" data-first-offset="true"><span data-slate-string="true">, fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="21330"><span data-slate-leaf="true" data-offset-key="21330:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Bearer %s"</span></span></span></span><span data-slate-object="text" data-key="21331"><span data-slate-leaf="true" data-offset-key="21331:0" data-first-offset="true"><span data-slate-string="true">, c.content.BearerToken))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21332"><span data-slate-object="text" data-key="21333"><span data-slate-leaf="true" data-offset-key="21333:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21334"><span data-slate-leaf="true" data-offset-key="21334:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">case</span></span></span></span><span data-slate-object="text" data-key="21335"><span data-slate-leaf="true" data-offset-key="21335:0" data-first-offset="true"><span data-slate-string="true"> c.content.HasKeyAuth():</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21336"><span data-slate-object="text" data-key="21337"><span data-slate-leaf="true" data-offset-key="21337:0" data-first-offset="true"><span data-slate-string="true">        tokenString := auth.Sign(c.content.SecretID, c.content.SecretKey, </span></span></span><span data-slate-object="text" data-key="21338"><span data-slate-leaf="true" data-offset-key="21338:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"marmotedu-sdk-go"</span></span></span></span><span data-slate-object="text" data-key="21339"><span data-slate-leaf="true" data-offset-key="21339:0" data-first-offset="true"><span data-slate-string="true">, c.group+</span></span></span><span data-slate-object="text" data-key="21340"><span data-slate-leaf="true" data-offset-key="21340:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">".marmotedu.com"</span></span></span></span><span data-slate-object="text" data-key="21341"><span data-slate-leaf="true" data-offset-key="21341:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21342"><span data-slate-object="text" data-key="21343"><span data-slate-leaf="true" data-offset-key="21343:0" data-first-offset="true"><span data-slate-string="true">        r.SetHeader(</span></span></span><span data-slate-object="text" data-key="21344"><span data-slate-leaf="true" data-offset-key="21344:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization"</span></span></span></span><span data-slate-object="text" data-key="21345"><span data-slate-leaf="true" data-offset-key="21345:0" data-first-offset="true"><span data-slate-string="true">, fmt.Sprintf(</span></span></span><span data-slate-object="text" data-key="21346"><span data-slate-leaf="true" data-offset-key="21346:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Bearer %s"</span></span></span></span><span data-slate-object="text" data-key="21347"><span data-slate-leaf="true" data-offset-key="21347:0" data-first-offset="true"><span data-slate-string="true">, tokenString))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21348"><span data-slate-object="text" data-key="21349"><span data-slate-leaf="true" data-offset-key="21349:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="21350"><span data-slate-leaf="true" data-offset-key="21350:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">case</span></span></span></span><span data-slate-object="text" data-key="21351"><span data-slate-leaf="true" data-offset-key="21351:0" data-first-offset="true"><span data-slate-string="true"> c.content.HasBasicAuth():</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21352"><span data-slate-object="text" data-key="21353"><span data-slate-leaf="true" data-offset-key="21353:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="21354"><span data-slate-leaf="true" data-offset-key="21354:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">// </span></span></span></span><span data-slate-object="text" data-key="21355"><span data-slate-leaf="true" data-offset-key="21355:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">TODO:</span></span></span></span></span><span data-slate-object="text" data-key="21356"><span data-slate-leaf="true" data-offset-key="21356:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> get token and set header</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21357"><span data-slate-object="text" data-key="21358"><span data-slate-leaf="true" data-offset-key="21358:0" data-first-offset="true"><span data-slate-string="true">        r.SetHeader(</span></span></span><span data-slate-object="text" data-key="21359"><span data-slate-leaf="true" data-offset-key="21359:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization"</span></span></span></span><span data-slate-object="text" data-key="21360"><span data-slate-leaf="true" data-offset-key="21360:0" data-first-offset="true"><span data-slate-string="true">, </span></span></span><span data-slate-object="text" data-key="21361"><span data-slate-leaf="true" data-offset-key="21361:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Basic"</span></span></span></span><span data-slate-object="text" data-key="21362"><span data-slate-leaf="true" data-offset-key="21362:0" data-first-offset="true"><span data-slate-string="true">+basicAuth(c.content.Username, c.content.Password))</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="21363"><span data-slate-object="text" data-key="21364"><span data-slate-leaf="true" data-offset-key="21364:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21365"><span data-slate-object="text" data-key="21366"><span data-slate-leaf="true" data-offset-key="21366:0" data-first-offset="true"><span data-slate-string="true">上面的代码会根据配置信息，自动判断使用哪种认证方式。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="21367" id="sr-toc-10"><span data-slate-object="text" data-key="21368"><span data-slate-leaf="true" data-offset-key="21368:0" data-first-offset="true"><span data-slate-string="true">总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="21369"><span data-slate-object="text" data-key="21370"><span data-slate-leaf="true" data-offset-key="21370:0" data-first-offset="true"><span data-slate-string="true">这一讲中，我介绍了 Kubernetes client-go 风格的 SDK 实现方式。和公有云厂商的 SDK 设计相比，client-go 风格的 SDK 设计有很多优点。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21371"><span data-slate-object="text" data-key="21372"><span data-slate-leaf="true" data-offset-key="21372:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 在设计时，通过接口实现了 3 类客户端，分别是项目级别的客户端、应用级别的客户端和服务级别的客户端。开发人员可以根据需要，自行创建客户端类型。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21373"><span data-slate-object="text" data-key="21374"><span data-slate-leaf="true" data-offset-key="21374:0" data-first-offset="true"><span data-slate-string="true">marmotedu-sdk-go 通过 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21375"><span data-slate-object="text" data-key="21376"><span data-slate-leaf="true" data-offset-key="21376:0" data-first-offset="true"><span data-slate-string="true">RESTClientFor</span></span></span></a><span data-slate-object="text" data-key="21377"><span data-slate-leaf="true" data-offset-key="21377:0" data-first-offset="true"><span data-slate-string="true">，创建了 RESTClient 类型的客户端，RESTClient 向下通过调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21378"><span data-slate-object="text" data-key="21379"><span data-slate-leaf="true" data-offset-key="21379:0" data-first-offset="true"><span data-slate-string="true">Request</span></span></span></a><span data-slate-object="text" data-key="21380"><span data-slate-leaf="true" data-offset-key="21380:0" data-first-offset="true"><span data-slate-string="true"> 模块，来完成 HTTP 请求方法、请求路径、请求体、认证信息的构建。Request 模块最终通过调用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21381"><span data-slate-object="text" data-key="21382"><span data-slate-leaf="true" data-offset-key="21382:0" data-first-offset="true"><span data-slate-string="true">gorequest</span></span></span></a><span data-slate-object="text" data-key="21383"><span data-slate-leaf="true" data-offset-key="21383:0" data-first-offset="true"><span data-slate-string="true"> 包提供的方法，完成 HTTP 的 POST、PUT、GET、DELETE 等请求，获取 HTTP 返回结果，并解析到指定的结构体中。RESTClient 向上提供 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21384"><span data-slate-object="text" data-key="21385"><span data-slate-leaf="true" data-offset-key="21385:0" data-first-offset="true"><span data-slate-string="true">Post()</span></span></span></span><span data-slate-object="text" data-key="21386"><span data-slate-leaf="true" data-offset-key="21386:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21387"><span data-slate-object="text" data-key="21388"><span data-slate-leaf="true" data-offset-key="21388:0" data-first-offset="true"><span data-slate-string="true">Put()</span></span></span></span><span data-slate-object="text" data-key="21389"><span data-slate-leaf="true" data-offset-key="21389:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21390"><span data-slate-object="text" data-key="21391"><span data-slate-leaf="true" data-offset-key="21391:0" data-first-offset="true"><span data-slate-string="true">Get()</span></span></span></span><span data-slate-object="text" data-key="21392"><span data-slate-leaf="true" data-offset-key="21392:0" data-first-offset="true"><span data-slate-string="true"> 、 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21393"><span data-slate-object="text" data-key="21394"><span data-slate-leaf="true" data-offset-key="21394:0" data-first-offset="true"><span data-slate-string="true">Delete()</span></span></span></span><span data-slate-object="text" data-key="21395"><span data-slate-leaf="true" data-offset-key="21395:0" data-first-offset="true"><span data-slate-string="true"> 等方法，来供客户端完成 HTTP 请求。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="21396" id="sr-toc-11"><span data-slate-object="text" data-key="21397"><span data-slate-leaf="true" data-offset-key="21397:0" data-first-offset="true"><span data-slate-string="true">课后练习</span></span></span></h2><div data-slate-type="list" data-slate-object="block" data-key="21398"><div data-slate-type="list-line" data-slate-object="block" data-key="21399"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="21400"><span data-slate-leaf="true" data-offset-key="21400:0" data-first-offset="true"><span data-slate-string="true">阅读 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21401"><span data-slate-object="text" data-key="21402"><span data-slate-leaf="true" data-offset-key="21402:0" data-first-offset="true"><span data-slate-string="true">defaultServerURLFor</span></span></span></a><span data-slate-object="text" data-key="21403"><span data-slate-leaf="true" data-offset-key="21403:0" data-first-offset="true"><span data-slate-string="true"> 源码，思考下 defaultServerURLFor 是如何构建请求地址 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21404"><span data-slate-object="text" data-key="21405"><span data-slate-leaf="true" data-offset-key="21405:0" data-first-offset="true"><span data-slate-string="true">http://iam.api.marmotedu.com:8080</span></span></span></span><span data-slate-object="text" data-key="21406"><span data-slate-leaf="true" data-offset-key="21406:0" data-first-offset="true"><span data-slate-string="true"> 和 API 版本 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="21407"><span data-slate-object="text" data-key="21408"><span data-slate-leaf="true" data-offset-key="21408:0" data-first-offset="true"><span data-slate-string="true">/v1</span></span></span></span><span data-slate-object="text" data-key="21409"><span data-slate-leaf="true" data-offset-key="21409:0" data-first-offset="true"><span data-slate-string="true"> 的。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="21410"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="21411"><span data-slate-leaf="true" data-offset-key="21411:0" data-first-offset="true"><span data-slate-string="true">使用 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="21412"><span data-slate-object="text" data-key="21413"><span data-slate-leaf="true" data-offset-key="21413:0" data-first-offset="true"><span data-slate-string="true">gorequest</span></span></span></a><span data-slate-object="text" data-key="21414"><span data-slate-leaf="true" data-offset-key="21414:0" data-first-offset="true"><span data-slate-string="true"> 包，编写一个可以执行以下 HTTP 请求的示例：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="21415"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="21416"><span data-slate-object="text" data-key="21417"><span data-slate-leaf="true" data-offset-key="21417:0" data-first-offset="true"><span data-slate-string="true">curl -XPOST http://example.com/v1/user -d </span></span></span><span data-slate-object="text" data-key="21418"><span data-slate-leaf="true" data-offset-key="21418:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"username":"colin","address":"shenzhen"}'</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="21419"><span data-slate-object="text" data-key="21420"><span data-slate-leaf="true" data-offset-key="21420:0" data-first-offset="true"><span data-slate-string="true">欢迎你在留言区与我交流讨论，我们下一讲见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/1f/81/1f6c18433af717a740f1e49389f2f981.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-12">精选留言 (6)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>Sch0ng</span></div></div><div>K8s client-go 风格的 sdk 实现方式比公有云普遍采用的 sdk 更灵活，调用和扩展都更方便，还可以多版本共存。</div><div><div>2021-08-17</div><div><div><i></i><span></span></div><div><i></i><span>6</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132"></div></div><div><div><div><span>ppd0705</span></div></div><div>这种分层设计好妙，可以按需创建某层客户端</div><div><div>2021-11-02</div><div><div><i></i><span>1</span></div><div><i></i><span>4</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>yandongxiao</span></div></div><div>总结：
client-go 风格的 SDK 从项目、应用、服务 都有客户端，且上一层客户端封装了下层的客户端。
1. NewForConfig 操作，会将下层的客户端都创建出来。
2. clientset.Iam ().AuthzV1 () 就是指定客户端的过程。
3. 在要创建具体的资源时，客户端作为参数，动态创建一个资源的 “客户端”。这是在服务客户端做的
4. 资源客户端拿到了 “RESTClient” 对象，开始操作资源。

在服务级别的接口，不但提供了 RESTClient () rest.Interface 来操作资源，也可以调用 AuthzGetter 封装的接口，更加友好。</div><div><p>作者回复: 666</p></div><div><div>2021-12-04</div><div><div><i></i></div><div><i></i><span>2</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/28/83/17/df99b53d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 随风而过</span></div></div><div>K8s client-go 风格确实比公有云的 sdk 风格有很多优势，目前项目基本都是采用公有云的方式，get 到老师的点，学习了</div><div><div>2021-09-08</div><div><div><i></i><span></span></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/ff/c6/3586506e.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_28"></div></div><div><div><div><span> 筱泉</span></div></div><div>老师￼，这个 example 代码怎么跑起来
</div><div><p>作者回复：服务部署起来。go run</p></div><div><div>2022-03-18</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/13/51/84/5b7d4d95.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>冷峰</span></div></div><div>authz 默认使用的 jwt 认证， 这个例子中的认证方式使用的是 basic , 会导致认证失败</div><div><p>作者回复：感谢反馈，这个地方我考虑下怎么兼容下，不过不影响学习。</p></div><div><div>2021-08-29</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".14"><outline class="toc-level-h1" data-reactid=".14.0" style="width: 175px;"><active data-reactid=".14.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".14.0.1"><span data-reactid=".14.0.1.0"> 34 | SDK 设计（下）：IAM 项目 Go SDK 设计和实现</span></a></outline><outline class="toc-level-h2" data-reactid=".14.1" style="width: 165px;"><active data-reactid=".14.1.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".14.1.1"><span data-reactid=".14.1.1.0">marmotedu-sdk-go 设计</span></a></outline><outline class="toc-level-h3" data-reactid=".14.2" style="width: 155px;"><active data-reactid=".14.2.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".14.2.1"><span data-reactid=".14.2.1.0">marmotedu-sdk-go 客户端设计</span></a></outline><outline class="toc-level-h3" data-reactid=".14.3" style="width: 155px;"><active data-reactid=".14.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".14.3.1"><span data-reactid=".14.3.1.0">项目级别客户端创建</span></a></outline><outline class="toc-level-h3" data-reactid=".14.4" style="width: 155px;"><active data-reactid=".14.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-4" data-reactid=".14.4.1"><span data-reactid=".14.4.1.0">应用级别客户端创建</span></a></outline><outline class="toc-level-h3" data-reactid=".14.5" style="width: 155px;"><active data-reactid=".14.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".14.5.1"><span data-reactid=".14.5.1.0">服务级别客户端创建</span></a></outline><outline class="toc-level-h2" data-reactid=".14.6" style="width: 165px;"><active data-reactid=".14.6.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".14.6.1"><span data-reactid=".14.6.1.0">marmotedu-sdk-go 的实现</span></a></outline><outline class="toc-level-h3" data-reactid=".14.7" style="width: 155px;"><active data-reactid=".14.7.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".14.7.1"><span data-reactid=".14.7.1.0">RESTClient 客户端实现</span></a></outline><outline class="toc-level-h3" data-reactid=".14.8" style="width: 155px;"><active data-reactid=".14.8.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".14.8.1"><span data-reactid=".14.8.1.0">Request 模块实现</span></a></outline><outline class="toc-level-h3" data-reactid=".14.9" style="width: 155px;"><active data-reactid=".14.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".14.9.1"><span data-reactid=".14.9.1.0">请求认证</span></a></outline><outline class="toc-level-h2" data-reactid=".14.a" style="width: 165px;"><active data-reactid=".14.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".14.a.1"><span data-reactid=".14.a.1.0">总结</span></a></outline><outline class="toc-level-h2" data-reactid=".14.b" style="width: 165px;"><active data-reactid=".14.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".14.b.1"><span data-reactid=".14.b.1.0">课后练习</span></a></outline><outline class="toc-level-h2" data-reactid=".14.c" style="width: 165px;"><active data-reactid=".14.c.0"></active><a class="toc-outline-theme-github" href="#sr-toc-12" data-reactid=".14.c.1"><span data-reactid=".14.c.1.0">精选留言 (6)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/407186" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>