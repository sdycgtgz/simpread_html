
                <html lang="en" class="simpread-font simpread-theme-root" style=''>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-github{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{position:relative;margin-top:1em;margin-bottom:1pc;font-weight:700;line-height:1.4;text-align:left;color:#363636}sr-rd-content h1{padding-bottom:.3em;font-size:57.6px;font-size:3.6rem;line-height:1.2}sr-rd-content h2{padding-bottom:.3em;font-size:44.8px;font-size:2.8rem;line-height:1.225}sr-rd-content h3{font-size:38.4px;font-size:2.4rem;line-height:1.43}sr-rd-content h4{font-size:32px;font-size:2rem}sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{list-style-type:disc;padding:0;padding-left:2em}sr-rd-content ol ol,sr-rd-content ul ol{list-style-type:lower-roman}sr-rd-content ol ol ol,sr-rd-content ol ul ol,sr-rd-content ul ol ol,sr-rd-content ul ul ol{list-style-type:lower-alpha}sr-rd-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{padding:6px 13px;border:1px solid #ddd}sr-rd-content table tr{background-color:#fff;border-top:1px solid #ccc}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{border-left:4px solid #ddd}.simpread-theme-root{background-color:#fff;color:#333}sr-rd-title{font-family:PT Sans,SF UI Display,\.PingFang SC,PingFang SC,Neue Haas Grotesk Text Pro,Arial Nova,Segoe UI,Microsoft YaHei,Microsoft JhengHei,Helvetica Neue,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,Hiragino Sans GB,sans-serif;font-size:54.4px;font-size:3.4rem;font-weight:700;line-height:1.3}sr-rd-desc{position:relative;margin:0;margin-bottom:30px;padding:25px;padding-left:56px;font-size:28.8px;font-size:1.8rem;color:#777;background-color:rgba(0,0,0,.05);box-sizing:border-box}sr-rd-desc:before{content:"\201C";position:absolute;top:-28px;left:16px;font-size:80px;font-family:Arial;color:rgba(0,0,0,.15)}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#363636;font-weight:400;line-height:1.8}sr-rd-content b *,sr-rd-content strong,sr-rd-content strong * sr-rd-content b{-webkit-animation:none 0s ease 0s 1 normal none running;animation:none 0s ease 0s 1 normal none running;-webkit-backface-visibility:visible;backface-visibility:visible;background:transparent none repeat 0 0/auto auto padding-box border-box scroll;border:medium none currentColor;border-collapse:separate;-o-border-image:none;border-image:none;border-radius:0;border-spacing:0;bottom:auto;box-shadow:none;box-sizing:content-box;caption-side:top;clear:none;clip:auto;color:#000;-webkit-columns:auto;-moz-columns:auto;columns:auto;-webkit-column-count:auto;-moz-column-count:auto;column-count:auto;-webkit-column-fill:balance;-moz-column-fill:balance;column-fill:balance;-webkit-column-gap:normal;-moz-column-gap:normal;column-gap:normal;-webkit-column-rule:medium none currentColor;-moz-column-rule:medium none currentColor;column-rule:medium none currentColor;-webkit-column-span:1;-moz-column-span:1;column-span:1;-webkit-column-width:auto;-moz-column-width:auto;column-width:auto;content:normal;counter-increment:none;counter-reset:none;cursor:auto;direction:ltr;display:inline;empty-cells:show;float:none;font-family:serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;line-height:normal;height:auto;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;left:auto;letter-spacing:normal;list-style:disc outside none;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;opacity:1;orphans:2;outline:medium none invert;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;-webkit-perspective:none;perspective:none;-webkit-perspective-origin:50% 50%;perspective-origin:50% 50%;position:static;right:auto;-moz-tab-size:8;-o-tab-size:8;tab-size:8;table-layout:auto;text-align:left;text-align-last:auto;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;top:auto;-webkit-transform:none;transform:none;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;-webkit-transform-style:flat;transform-style:flat;-webkit-transition:none 0s ease 0s;transition:none 0s ease 0s;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:2;width:auto;word-spacing:normal;z-index:auto;all:initial}sr-rd-content a,sr-rd-content a:link{color:#4183c4;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#4183c4;text-decoration:underline}sr-rd-content pre{background-color:#f7f7f7;border-radius:3px}sr-rd-content li code,sr-rd-content p code{background-color:rgba(0,0,0,.04);border-radius:3px}.simpread-multi-root{background:#f8f9fa}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">undefinedsr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        <script>document.addEventListener("DOMContentLoaded",function(){if("localhost"==location.hostname){const t=document.getElementsByTagName("img");for(let o of t){const t=o.src;t.startsWith("http")&&(o.src=location.origin+"/proxy?url="+t)}}},!1);</script>
                        <style>toc a {font-size: inherit!important;font-weight: 300!important;}</style><script>setTimeout(()=>{const max=document.getElementsByTagName('sr-annote-note-tip').length;for(let i=0;i<max;i++){const target=document.getElementsByTagName('sr-annote-note-tip')[i],value=target.dataset.value;value&&(target.innerText=value)}},1000);</script><title>简悦 | 特别放送 | IAM 排障指南</title>
                    </head>
                    <body>
                        <sr-read style='font-family: "LXGW WenKai Screen";'>
                            <sr-rd-title>特别放送 | IAM 排障指南</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">每种语言通常都有自己的测试包 / 模块，Go 语言也不例外。在 Go 中，我们可以通过 testing 包对代码进行单元测试和性能测试。今天，我会用一些示</sr-rd-desc>
                    <sr-rd-content><h1 id="sr-toc-0">特别放送 | IAM 排障指南</h1><div><span>孔令飞</span> <span> 2021-09-18</span></div><div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/0d/5f/0dc6f1031a2d398ba17074252815035f.jpg"></div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAABCAYAAAB35kaxAAAAAXNSR0IArs4c6QAAAChJREFUGFdjfPfu3X8GKBAUFASz3r9/DxNiQBbDxcamn1yzSLEDZi8A2agny86FR+IAAAAASUVORK5CYII="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAABCAYAAAA8TpVcAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFCYtjkAcT9D8ti7hUOAAAAAElFTkSuQmCC"></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAABCAYAAABt2qY/AAAAAXNSR0IArs4c6QAAACdJREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULy2PQQK0YLewiZCQDhUS3LBhDf1QAAAABJRU5ErkJggg=="></div><div class="sr-rd-content-center-small"><img class="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAABCAYAAAA4u0VhAAAAAXNSR0IArs4c6QAAAB1JREFUGFdjfPfu3X9BQUEGEHj//j2YBgFkMULyAF6lD8tbqYWOAAAAAElFTkSuQmCC"></div></div></div><div><div><div></div></div><div><div><div><div><div><div>00:00</div></div><div></div></div></div><a href="javascript:;"> 1.0x <i><span></span></i></a></div><div><span>讲述：孔令飞</span><span>大小：13.79M</span><span> 时长：15:06</span></div></div><audio title="特别放送 | IAM排障指南" src="https://res001.geekbang.org/media/audio/b5/eb/b599d5becd855925d90387318943baeb/ld/ld.m3u8" __idm_id__="327700"></audio></div><div><div><div><div data-slate-editor="true" data-key="19651" autocorrect="off" spellcheck="false" data-gramm="false"><div data-slate-type="paragraph" data-slate-object="block" data-key="19652"><span data-slate-object="text" data-key="19653"><span data-slate-leaf="true" data-offset-key="19653:0" data-first-offset="true"><span data-slate-string="true">你好，我是孔令飞。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19654"><span data-slate-object="text" data-key="19655"><span data-slate-leaf="true" data-offset-key="19655:0" data-first-offset="true"><span data-slate-string="true">今天我们更新一期特别放送作为加餐。在部署和使用 IAM 的过程中，难免会出现一些异常 (也称为故障、问题)。这时候，就需要我们能够定位故障，并修复故障。这里，我总结了一些 IAM 的排障方法，以及一些常见故障的解决方法，供你参考。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="19656" id="sr-toc-1"><span data-slate-object="text" data-key="19657"><span data-slate-leaf="true" data-offset-key="19657:0" data-first-offset="true"><span data-slate-string="true">如何排障？</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="19658"><span data-slate-object="text" data-key="19659"><span data-slate-leaf="true" data-offset-key="19659:0" data-first-offset="true"><span data-slate-string="true">首先，我们需要发现问题，然后定位问题。我们可能需要经过多轮分析排查才能定位到问题的根因，最后去解决问题。排障流程如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="19660"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/73/0f/7330d836e7c4b5052c79bbd365abdd0f.jpg?wh=2248x535"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19661"><span data-slate-object="text" data-key="19662"><span data-slate-leaf="true" data-offset-key="19662:0" data-first-offset="true"><span data-slate-string="true">如果想排查问题并解决问题，你还需要具备这两个基本能力：能够理解错误日志的内容；根据错误日志，找出解决方案。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19663"><span data-slate-object="text" data-key="19664"><span data-slate-leaf="true" data-offset-key="19664:0" data-first-offset="true"><span data-slate-string="true">我们举个例子来说吧。有以下错误：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="19665"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19666"><span data-slate-object="text" data-key="19667"><span data-slate-leaf="true" data-offset-key="19667:0" data-first-offset="true"><span data-slate-string="true">[going@dev iam]$ mysql -h127.0.0.1 -uroot -p</span></span></span><span data-slate-object="text" data-key="19668"><span data-slate-leaf="true" data-offset-key="19668:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'iam59!z$'</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19669"><span data-slate-object="text" data-key="19670"><span data-slate-leaf="true" data-offset-key="19670:0" data-first-offset="true"><span data-slate-string="true">bash: /usr/bin/mysql: 没有那个文件或目录</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19671"><span data-slate-object="text" data-key="19672"><span data-slate-leaf="true" data-offset-key="19672:0" data-first-offset="true"><span data-slate-string="true">[going@dev iam]$</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19673"><span data-slate-object="text" data-key="19674"><span data-slate-leaf="true" data-offset-key="19674:0" data-first-offset="true"><span data-slate-string="true">对于这个错误，我们首先来理解错误内容：mysql 命令没有找到，说明没有安装 mysql，或者安装 mysql 失败。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19675"><span data-slate-object="text" data-key="19676"><span data-slate-leaf="true" data-offset-key="19676:0" data-first-offset="true"><span data-slate-string="true">那么，我们的解决方案就是重新执行 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19677"><span data-slate-object="text" data-key="19678"><span data-slate-leaf="true" data-offset-key="19678:0" data-first-offset="true"><span data-slate-string="true">03 讲</span></span></span></a><span data-slate-object="text" data-key="19679"><span data-slate-leaf="true" data-offset-key="19679:0" data-first-offset="true"><span data-slate-string="true"> 中安装 MariaDB 的步骤：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="19680"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19681"><span data-slate-object="text" data-key="19682"><span data-slate-leaf="true" data-offset-key="19682:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="19683"><span data-slate-leaf="true" data-offset-key="19683:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="19684"><span data-slate-leaf="true" data-offset-key="19684:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19685"><span data-slate-leaf="true" data-offset-key="19685:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$IAM_ROOT</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19686"><span data-slate-object="text" data-key="19687"><span data-slate-leaf="true" data-offset-key="19687:0" data-first-offset="true"><span data-slate-string="true">$ ./scripts/install/mariadb.sh iam::mariadb::install</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19688"><span data-slate-object="text" data-key="19689"><span data-slate-leaf="true" data-offset-key="19689:0" data-first-offset="true"><span data-slate-string="true">接下来，我会以</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19690"><span data-slate-object="text" data-key="19691"><span data-slate-leaf="true" data-offset-key="19691:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19692"><span data-slate-leaf="true" data-offset-key="19692:0" data-first-offset="true"><span data-slate-string="true"> 服务为例，给你演示下具体如何排障并解决问题。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="19693" id="sr-toc-2"><span data-slate-object="text" data-key="19694"><span data-slate-leaf="true" data-offset-key="19694:0" data-first-offset="true"><span data-slate-string="true">发现问题</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="19695"><span data-slate-object="text" data-key="19696"><span data-slate-leaf="true" data-offset-key="19696:0" data-first-offset="true"><span data-slate-string="true">要排障，首先我们需要发现问题。我们通常用下面这几种方式来发现问题。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19697"><div data-slate-type="list-line" data-slate-object="block" data-key="19698"><span data-slate-object="text" data-key="19699"><span data-slate-leaf="true" data-offset-key="19699:0" data-first-offset="true"><span data-slate-string="true">检查服务状态：启动 iam-apiserver 服务后，执行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19700"><span data-slate-object="text" data-key="19701"><span data-slate-leaf="true" data-offset-key="19701:0" data-first-offset="true"><span data-slate-string="true"> systemctl status iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19702"><span data-slate-leaf="true" data-offset-key="19702:0" data-first-offset="true"><span data-slate-string="true"> 发现 iam-apiserver 启动失败，即</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19703"><span data-slate-object="text" data-key="19704"><span data-slate-leaf="true" data-offset-key="19704:0" data-first-offset="true"><span data-slate-string="true"> Active</span></span></span></span><span data-slate-object="text" data-key="19705"><span data-slate-leaf="true" data-offset-key="19705:0" data-first-offset="true"><span data-slate-string="true"> 的值不为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19706"><span data-slate-object="text" data-key="19707"><span data-slate-leaf="true" data-offset-key="19707:0" data-first-offset="true"><span data-slate-string="true"> active (running)</span></span></span></span><span data-slate-object="text" data-key="19708"><span data-slate-leaf="true" data-offset-key="19708:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19709"><span data-slate-object="text" data-key="19710"><span data-slate-leaf="true" data-offset-key="19710:0" data-first-offset="true"><span data-slate-string="true">功能异常：访问 iam-apiserver 服务，功能异常或者报错，例如接口返回值跟预期不一样等。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19711"><span data-slate-object="text" data-key="19712"><span data-slate-leaf="true" data-offset-key="19712:0" data-first-offset="true"><span data-slate-string="true">日志报错：在 iam-apiserver 的日志中发现一些</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19713"><span data-slate-object="text" data-key="19714"><span data-slate-leaf="true" data-offset-key="19714:0" data-first-offset="true"><span data-slate-string="true"> WARN</span></span></span></span><span data-slate-object="text" data-key="19715"><span data-slate-leaf="true" data-offset-key="19715:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19716"><span data-slate-object="text" data-key="19717"><span data-slate-leaf="true" data-offset-key="19717:0" data-first-offset="true"><span data-slate-string="true">ERROR</span></span></span></span><span data-slate-object="text" data-key="19718"><span data-slate-leaf="true" data-offset-key="19718:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19719"><span data-slate-object="text" data-key="19720"><span data-slate-leaf="true" data-offset-key="19720:0" data-first-offset="true"><span data-slate-string="true">PANIC</span></span></span></span><span data-slate-object="text" data-key="19721"><span data-slate-leaf="true" data-offset-key="19721:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19722"><span data-slate-object="text" data-key="19723"><span data-slate-leaf="true" data-offset-key="19723:0" data-first-offset="true"><span data-slate-string="true">FATAL</span></span></span></span><span data-slate-object="text" data-key="19724"><span data-slate-leaf="true" data-offset-key="19724:0" data-first-offset="true"><span data-slate-string="true"> 等级别的错误日志。</span></span></span></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="19725" id="sr-toc-3"><span data-slate-object="text" data-key="19726"><span data-slate-leaf="true" data-offset-key="19726:0" data-first-offset="true"><span data-slate-string="true">定位问题</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="19727"><span data-slate-object="text" data-key="19728"><span data-slate-leaf="true" data-offset-key="19728:0" data-first-offset="true"><span data-slate-string="true">发现问题之后，就需要我们定位出问题的根本原因。我们可以通过下面这三种方式来定位问题。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19729"><div data-slate-type="list-line" data-slate-object="block" data-key="19730"><span data-slate-object="text" data-key="19731"><span data-slate-leaf="true" data-offset-key="19731:0" data-first-offset="true"><span data-slate-string="true">查看日志，它是最简单的排障方式。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19732"><span data-slate-object="text" data-key="19733"><span data-slate-leaf="true" data-offset-key="19733:0" data-first-offset="true"><span data-slate-string="true">使用 Go 调试工具 Delve 来定位问题。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19734"><span data-slate-object="text" data-key="19735"><span data-slate-leaf="true" data-offset-key="19735:0" data-first-offset="true"><span data-slate-string="true">添加 Debug 日志，从程序入口处跟读代码，在关键位置处打印 Debug 日志，来定位问题。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19736"><span data-slate-object="text" data-key="19737"><span data-slate-leaf="true" data-offset-key="19737:0" data-first-offset="true"><span data-slate-string="true">在定位问题的过程中，我们可以采用 “顺藤摸瓜” 的思路去排查问题。比如，我们的程序执行流程是：A -&gt; B -&gt; … -&gt; N。其中 A、B、N 都可以理解为一个排查点。所谓的排查点，就是需要在该处定位问题的点，这些点可能是导致问题的根因所在。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19738"><span data-slate-object="text" data-key="19739"><span data-slate-leaf="true" data-offset-key="19739:0" data-first-offset="true"><span data-slate-string="true">在排障过程中，你可以根据最上层的日志报错，找到下一个排查点 B。如果经过定位，发现 B 没有问题，那继续根据程序执行流程，找下一个排查点排查问题。如此反复，直到找到最终的排查点，也就是出问题的根因 N，N 即为 Bug 点。执行流程如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="19740"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/cc/6d/cc26b83cb2177106695e1a9f7f09ae6d.jpg?wh=2248x931"></div></div><h3 data-slate-type="heading" data-slate-object="block" data-key="19741" id="sr-toc-4"></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="19742"><span data-slate-object="text" data-key="19743"><span data-slate-leaf="true" data-offset-key="19743:0" data-first-offset="true"><span data-slate-string="true">下面，我们来具体看看这三种定位问题的方法。</span></span></span></div><h4 data-slate-type="heading" data-slate-object="block" data-key="19744" id="sr-toc-5"><span data-slate-object="text" data-key="19745"><span data-slate-leaf="true" data-offset-key="19745:0" data-first-offset="true"><span data-slate-string="true">查看日志定位问题</span></span></span></h4><div data-slate-type="paragraph" data-slate-object="block" data-key="19746"><span data-slate-object="text" data-key="19747"><span data-slate-leaf="true" data-offset-key="19747:0" data-first-offset="true"><span data-slate-string="true">我们首先应该通过日志来定位问题，这是最简单高效的方式。要通过日志来定位问题，你不仅要会看日志，还要能读懂日志，也就是理解日志报错的原因。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19748"><span data-slate-object="text" data-key="19749"><span data-slate-leaf="true" data-offset-key="19749:0" data-first-offset="true"><span data-slate-string="true">下面我来具体讲解用这种方法定位问题的步骤。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19750"><span data-slate-object="text" data-key="19751"><span data-slate-leaf="true" data-offset-key="19751:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步，确保服务运行正常。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19752"><span data-slate-object="text" data-key="19753"><span data-slate-leaf="true" data-offset-key="19753:0" data-first-offset="true"><span data-slate-string="true">你可以通过执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19754"><span data-slate-object="text" data-key="19755"><span data-slate-leaf="true" data-offset-key="19755:0" data-first-offset="true"><span data-slate-string="true">systemctl status</span></span></span></span><span data-slate-object="text" data-key="19756"><span data-slate-leaf="true" data-offset-key="19756:0" data-first-offset="true"><span data-slate-string="true"> 命令来查看服务的运行状况：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="19757"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19758"><span data-slate-object="text" data-key="19759"><span data-slate-leaf="true" data-offset-key="19759:0" data-first-offset="true"><span data-slate-string="true">$ systemctl status iam-apiserver</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19760"><span data-slate-object="text" data-key="19761"><span data-slate-leaf="true" data-offset-key="19761:0" data-first-offset="true"><span data-slate-string="true">● iam-apiserver.service - IAM APIServer</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19762"><span data-slate-object="text" data-key="19763"><span data-slate-leaf="true" data-offset-key="19763:0" data-first-offset="true"><span data-slate-string="true">   Loaded: loaded (/etc/systemd/system/iam-apiserver.service; enabled; vendor preset: disabled)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19764"><span data-slate-object="text" data-key="19765"><span data-slate-leaf="true" data-offset-key="19765:0" data-first-offset="true"><span data-slate-string="true">   Active: activating (auto-restart) (Result: exit-code) since Thu 2021-09-09 13:47:56 CST; 2s ago</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19766"><span data-slate-object="text" data-key="19767"><span data-slate-leaf="true" data-offset-key="19767:0" data-first-offset="true"><span data-slate-string="true">     Docs: https://github.com/marmotedu/iam/blob/master/init/README.md</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19768"><span data-slate-object="text" data-key="19769"><span data-slate-leaf="true" data-offset-key="19769:0" data-first-offset="true"><span data-slate-string="true">  Process: 119463 ExecStart=/opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml (code=exited, status=1/FAILURE)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19770"><span data-slate-object="text" data-key="19771"><span data-slate-leaf="true" data-offset-key="19771:0" data-first-offset="true"><span data-slate-string="true">  Process: 119461 ExecStartPre=/usr/bin/mkdir -p /var/log/iam (code=exited, status=0/SUCCESS)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19772"><span data-slate-object="text" data-key="19773"><span data-slate-leaf="true" data-offset-key="19773:0" data-first-offset="true"><span data-slate-string="true">  Process: 119460 ExecStartPre=/usr/bin/mkdir -p /data/iam/iam-apiserver (code=exited, status=0/SUCCESS)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19774"><span data-slate-object="text" data-key="19775"><span data-slate-leaf="true" data-offset-key="19775:0" data-first-offset="true"><span data-slate-string="true"> Main PID: 119463 (code=exited, status=1/FAILURE)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19776"><span data-slate-object="text" data-key="19777"><span data-slate-leaf="true" data-offset-key="19777:0" data-first-offset="true"><span data-slate-string="true">可以看到，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19778"><span data-slate-object="text" data-key="19779"><span data-slate-leaf="true" data-offset-key="19779:0" data-first-offset="true"><span data-slate-string="true">Active</span></span></span></span><span data-slate-object="text" data-key="19780"><span data-slate-leaf="true" data-offset-key="19780:0" data-first-offset="true"><span data-slate-string="true"> 不是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19781"><span data-slate-object="text" data-key="19782"><span data-slate-leaf="true" data-offset-key="19782:0" data-first-offset="true"><span data-slate-string="true"> active (running)</span></span></span></span><span data-slate-object="text" data-key="19783"><span data-slate-leaf="true" data-offset-key="19783:0" data-first-offset="true"><span data-slate-string="true">，说明 iam-apiserver 服务没有正常运行。从上面输出中的</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19784"><span data-slate-object="text" data-key="19785"><span data-slate-leaf="true" data-offset-key="19785:0" data-first-offset="true"><span data-slate-string="true"> Process: 119463 ExecStart=/opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml (code=exited, status=1/FAILURE)</span></span></span></span><span data-slate-object="text" data-key="19786"><span data-slate-leaf="true" data-offset-key="19786:0" data-first-offset="true"><span data-slate-string="true"> 信息中，我们可以获取以下信息：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19787"><div data-slate-type="list-line" data-slate-object="block" data-key="19788"><span data-slate-object="text" data-key="19789"><span data-slate-leaf="true" data-offset-key="19789:0" data-first-offset="true"><span data-slate-string="true">iam-apiserver 服务启动命令为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19790"><span data-slate-object="text" data-key="19791"><span data-slate-leaf="true" data-offset-key="19791:0" data-first-offset="true"><span data-slate-string="true"> /opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="19792"><span data-slate-leaf="true" data-offset-key="19792:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19793"><span data-slate-type="code" data-slate-object="inline" data-key="19794"><span data-slate-object="text" data-key="19795"><span data-slate-leaf="true" data-offset-key="19795:0" data-first-offset="true"><span data-slate-string="true">/opt/iam/bin/iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19796"><span data-slate-leaf="true" data-offset-key="19796:0" data-first-offset="true"><span data-slate-string="true"> 加载的配置文件为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19797"><span data-slate-object="text" data-key="19798"><span data-slate-leaf="true" data-offset-key="19798:0" data-first-offset="true"><span data-slate-string="true"> /etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="19799"><span data-slate-leaf="true" data-offset-key="19799:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="19800"><span data-slate-type="code" data-slate-object="inline" data-key="19801"><span data-slate-object="text" data-key="19802"><span data-slate-leaf="true" data-offset-key="19802:0" data-first-offset="true"><span data-slate-string="true">/opt/iam/bin/iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19803"><span data-slate-leaf="true" data-offset-key="19803:0" data-first-offset="true"><span data-slate-string="true"> 命令执行失败，退出码为 1，其进程 ID 为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19804"><span data-slate-object="text" data-key="19805"><span data-slate-leaf="true" data-offset-key="19805:0" data-first-offset="true"><span data-slate-string="true"> 119463</span></span></span></span><span data-slate-object="text" data-key="19806"><span data-slate-leaf="true" data-offset-key="19806:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19807"><span data-slate-object="text" data-key="19808"><span data-slate-leaf="true" data-offset-key="19808:0" data-first-offset="true"><span data-slate-string="true">这里注意，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19809"><span data-slate-object="text" data-key="19810"><span data-slate-leaf="true" data-offset-key="19810:0" data-first-offset="true"><span data-slate-string="true">systemctl status</span></span></span></span><span data-slate-object="text" data-key="19811"><span data-slate-leaf="true" data-offset-key="19811:0" data-first-offset="true"><span data-slate-string="true"> 会将超过一定长度的行的后半部分用省略号替代，如果想查看完整的信息，可以追加</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19812"><span data-slate-object="text" data-key="19813"><span data-slate-leaf="true" data-offset-key="19813:0" data-first-offset="true"><span data-slate-string="true"> -l</span></span></span></span><span data-slate-object="text" data-key="19814"><span data-slate-leaf="true" data-offset-key="19814:0" data-first-offset="true"><span data-slate-string="true"> 参数，也就是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19815"><span data-slate-object="text" data-key="19816"><span data-slate-leaf="true" data-offset-key="19816:0" data-first-offset="true"><span data-slate-string="true"> systemctl status -l</span></span></span></span><span data-slate-object="text" data-key="19817"><span data-slate-leaf="true" data-offset-key="19817:0" data-first-offset="true"><span data-slate-string="true"> 来查看。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19818"><span data-slate-object="text" data-key="19819"><span data-slate-leaf="true" data-offset-key="19819:0" data-first-offset="true"><span data-slate-string="true">既然 iam-apiserver 命令启动失败，那我们就需要查看 iam-apiserver 启动时的日志，看看有没有一些报错日志。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19820"><span data-slate-object="text" data-key="19821"><span data-slate-leaf="true" data-offset-key="19821:0" data-first-offset="true"><span data-slate-string="true">接下来，就进入</span></span></span><span data-slate-object="text" data-key="19822"><span data-slate-leaf="true" data-offset-key="19822:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二步，查看</span></span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19823"><span data-slate-object="text" data-key="19824"><span data-slate-leaf="true" data-offset-key="19824:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19825"><span data-slate-leaf="true" data-offset-key="19825:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true"> 运行日志。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19826"><span data-slate-object="text" data-key="19827"><span data-slate-leaf="true" data-offset-key="19827:0" data-first-offset="true"><span data-slate-string="true">这里提一句，如果你对 systemd 不了解，也可以趁机恶补一波。你可以参考阮一峰大佬的两篇博客：</span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19828"><span data-slate-object="text" data-key="19829"><span data-slate-leaf="true" data-offset-key="19829:0" data-first-offset="true"><span data-slate-string="true">Systemd 入门教程：命令篇</span></span></span></a><span data-slate-object="text" data-key="19830"><span data-slate-leaf="true" data-offset-key="19830:0" data-first-offset="true"><span data-slate-string="true">和 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="19831"><span data-slate-object="text" data-key="19832"><span data-slate-leaf="true" data-offset-key="19832:0" data-first-offset="true"><span data-slate-string="true">Systemd 入门教程：实战篇</span></span></span></a><span data-slate-object="text" data-key="19833"><span data-slate-leaf="true" data-offset-key="19833:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19834"><span data-slate-object="text" data-key="19835"><span data-slate-leaf="true" data-offset-key="19835:0" data-first-offset="true"><span data-slate-string="true">那么如何查看呢？我们有 3 种查看方式，我在下面按优先级顺序排列了下。你在定位问题和查看日志时，按优先级 3 选 1 即可，1 &gt; 2 &gt; 3。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="19836"><div data-slate-type="list-line" data-slate-object="block" data-key="19837"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="19838"><span data-slate-leaf="true" data-offset-key="19838:0" data-first-offset="true"><span data-slate-string="true">通过</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19839"><span data-slate-object="text" data-key="19840"><span data-slate-leaf="true" data-offset-key="19840:0" data-first-offset="true"><span data-slate-string="true"> journalctl -u iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19841"><span data-slate-leaf="true" data-offset-key="19841:0" data-first-offset="true"><span data-slate-string="true"> 查看。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="19842"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="19843"><span data-slate-leaf="true" data-offset-key="19843:0" data-first-offset="true"><span data-slate-string="true">通过 iam-apiserver 日志文件查看。</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="19844"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="19845"><span data-slate-leaf="true" data-offset-key="19845:0" data-first-offset="true"><span data-slate-string="true">通过 console 查看。</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19846"><span data-slate-object="text" data-key="19847"><span data-slate-leaf="true" data-offset-key="19847:0" data-first-offset="true"><span data-slate-string="true">下面我来分别介绍下这三种查看方式。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19848"><span data-slate-object="text" data-key="19849"><span data-slate-leaf="true" data-offset-key="19849:0" data-first-offset="true"><span data-slate-string="true">先来看优先级最高的方式，通过</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19850"><span data-slate-object="text" data-key="19851"><span data-slate-leaf="true" data-offset-key="19851:0" data-first-offset="true"><span data-slate-string="true"> journalctl -u iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19852"><span data-slate-leaf="true" data-offset-key="19852:0" data-first-offset="true"><span data-slate-string="true"> 查看。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19853"><span data-slate-object="text" data-key="19854"><span data-slate-leaf="true" data-offset-key="19854:0" data-first-offset="true"><span data-slate-string="true">systemd 提供了自己的日志系统，称为 journal。我们可以使用</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19855"><span data-slate-object="text" data-key="19856"><span data-slate-leaf="true" data-offset-key="19856:0" data-first-offset="true"><span data-slate-string="true"> journalctl</span></span></span></span><span data-slate-object="text" data-key="19857"><span data-slate-leaf="true" data-offset-key="19857:0" data-first-offset="true"><span data-slate-string="true"> 命令来读取 journal 日志。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19858"><span data-slate-object="text" data-key="19859"><span data-slate-leaf="true" data-offset-key="19859:0" data-first-offset="true"><span data-slate-string="true">journalctl</span></span></span></span><span data-slate-object="text" data-key="19860"><span data-slate-leaf="true" data-offset-key="19860:0" data-first-offset="true"><span data-slate-string="true"> 提供了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19861"><span data-slate-object="text" data-key="19862"><span data-slate-leaf="true" data-offset-key="19862:0" data-first-offset="true"><span data-slate-string="true"> -u</span></span></span></span><span data-slate-object="text" data-key="19863"><span data-slate-leaf="true" data-offset-key="19863:0" data-first-offset="true"><span data-slate-string="true"> 选项来查看某个 Unit 的日志，提供了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19864"><span data-slate-object="text" data-key="19865"><span data-slate-leaf="true" data-offset-key="19865:0" data-first-offset="true"><span data-slate-string="true">_PID</span></span></span></span><span data-slate-object="text" data-key="19866"><span data-slate-leaf="true" data-offset-key="19866:0" data-first-offset="true"><span data-slate-string="true"> 来查看指定进程 ID 的日志。在</span></span></span><span data-slate-object="text" data-key="19867"><span data-slate-leaf="true" data-offset-key="19867:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步</span></span></span></span><span data-slate-object="text" data-key="19868"><span data-slate-leaf="true" data-offset-key="19868:0" data-first-offset="true"><span data-slate-string="true">中，我们知道服务启动失败的进程 ID 为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19869"><span data-slate-object="text" data-key="19870"><span data-slate-leaf="true" data-offset-key="19870:0" data-first-offset="true"><span data-slate-string="true"> 119463</span></span></span></span><span data-slate-object="text" data-key="19871"><span data-slate-leaf="true" data-offset-key="19871:0" data-first-offset="true"><span data-slate-string="true">。执行以下命令来查看这次启动的日志：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="19872"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19873"><span data-slate-object="text" data-key="19874"><span data-slate-leaf="true" data-offset-key="19874:0" data-first-offset="true"><span data-slate-string="true">$ sudo journalctl _PID=119463</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19875"><span data-slate-object="text" data-key="19876"><span data-slate-leaf="true" data-offset-key="19876:0" data-first-offset="true"><span data-slate-string="true">-- Logs begin at Thu 2021-09-09 09:12:25 CST, end at Thu 2021-09-09 14:40:48 CST. --</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19877"><span data-slate-object="text" data-key="19878"><span data-slate-leaf="true" data-offset-key="19878:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19879"><span data-slate-object="text" data-key="19880"><span data-slate-leaf="true" data-offset-key="19880:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: 2021-09-09 13:47:56.727        INFO        apiserver        gorm@v1.21.12/gorm.go:202        mysql/mysql.go:75[error] faile&gt;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19881"><span data-slate-object="text" data-key="19882"><span data-slate-leaf="true" data-offset-key="19882:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: 2021-09-09 13:47:56.727        FATAL        apiserver        apiserver/server.go:139        Failed to get cache instance: g&gt;</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19883"><span data-slate-object="text" data-key="19884"><span data-slate-leaf="true" data-offset-key="19884:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/internal/apiserver.(*completedExtraConfig).New</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19885"><span data-slate-object="text" data-key="19886"><span data-slate-leaf="true" data-offset-key="19886:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:139</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19887"><span data-slate-object="text" data-key="19888"><span data-slate-leaf="true" data-offset-key="19888:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/internal/apiserver.createAPIServer</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19889"><span data-slate-object="text" data-key="19890"><span data-slate-leaf="true" data-offset-key="19890:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:66</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19891"><span data-slate-object="text" data-key="19892"><span data-slate-leaf="true" data-offset-key="19892:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/internal/apiserver.Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19893"><span data-slate-object="text" data-key="19894"><span data-slate-leaf="true" data-offset-key="19894:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/run.go:11</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19895"><span data-slate-object="text" data-key="19896"><span data-slate-leaf="true" data-offset-key="19896:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/internal/apiserver.run.func1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19897"><span data-slate-object="text" data-key="19898"><span data-slate-leaf="true" data-offset-key="19898:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/app.go:46</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19899"><span data-slate-object="text" data-key="19900"><span data-slate-leaf="true" data-offset-key="19900:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/pkg/app.(*App).runCommand</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19901"><span data-slate-object="text" data-key="19902"><span data-slate-leaf="true" data-offset-key="19902:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:278</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19903"><span data-slate-object="text" data-key="19904"><span data-slate-leaf="true" data-offset-key="19904:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/spf13/cobra.(*Command).execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19905"><span data-slate-object="text" data-key="19906"><span data-slate-leaf="true" data-offset-key="19906:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:856</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19907"><span data-slate-object="text" data-key="19908"><span data-slate-leaf="true" data-offset-key="19908:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/spf13/cobra.(*Command).ExecuteC</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19909"><span data-slate-object="text" data-key="19910"><span data-slate-leaf="true" data-offset-key="19910:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:974</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19911"><span data-slate-object="text" data-key="19912"><span data-slate-leaf="true" data-offset-key="19912:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/spf13/cobra.(*Command).Execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19913"><span data-slate-object="text" data-key="19914"><span data-slate-leaf="true" data-offset-key="19914:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:902</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19915"><span data-slate-object="text" data-key="19916"><span data-slate-leaf="true" data-offset-key="19916:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: github.com/marmotedu/iam/pkg/app.(*App).Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19917"><span data-slate-object="text" data-key="19918"><span data-slate-leaf="true" data-offset-key="19918:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:233</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19919"><span data-slate-object="text" data-key="19920"><span data-slate-leaf="true" data-offset-key="19920:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: main.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19921"><span data-slate-object="text" data-key="19922"><span data-slate-leaf="true" data-offset-key="19922:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/workspace/golang/src/github.com/marmotedu/iam/cmd/iam-apiserver/apiserver.go:24</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19923"><span data-slate-object="text" data-key="19924"><span data-slate-leaf="true" data-offset-key="19924:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]: runtime.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19925"><span data-slate-object="text" data-key="19926"><span data-slate-leaf="true" data-offset-key="19926:0" data-first-offset="true"><span data-slate-string="true">Sep 09 13:47:56 VM-200-70-centos iam-apiserver[119463]:         /home/going/go/go1.16.2/src/runtime/proc.go:225</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19927"><span data-slate-object="text" data-key="19928"><span data-slate-leaf="true" data-offset-key="19928:0" data-first-offset="true"><span data-slate-string="true">lines 10-54/54 (END)</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19929"><span data-slate-object="text" data-key="19930"><span data-slate-leaf="true" data-offset-key="19930:0" data-first-offset="true"><span data-slate-string="true">从上面的日志中，我们找到了服务启动失败的原因：</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19931"><span data-slate-object="text" data-key="19932"><span data-slate-leaf="true" data-offset-key="19932:0" data-first-offset="true"><span data-slate-string="true">iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19933"><span data-slate-leaf="true" data-offset-key="19933:0" data-first-offset="true"><span data-slate-string="true"> 启动时，发生了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19934"><span data-slate-object="text" data-key="19935"><span data-slate-leaf="true" data-offset-key="19935:0" data-first-offset="true"><span data-slate-string="true"> FATAL</span></span></span></span><span data-slate-object="text" data-key="19936"><span data-slate-leaf="true" data-offset-key="19936:0" data-first-offset="true"><span data-slate-string="true"> 级别的错误。到这里，你已经初步定位到问题原因了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19937"><span data-slate-object="text" data-key="19938"><span data-slate-leaf="true" data-offset-key="19938:0" data-first-offset="true"><span data-slate-string="true">我们再来看通过 iam-apiserver 日志文件查看的方式。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19939"><span data-slate-object="text" data-key="19940"><span data-slate-leaf="true" data-offset-key="19940:0" data-first-offset="true"><span data-slate-string="true">作为一个企业级的实战项目，iam-apiserver 的日志当然是会记录到日志文件中的。在</span></span></span><span data-slate-object="text" data-key="19941"><span data-slate-leaf="true" data-offset-key="19941:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步</span></span></span></span><span data-slate-object="text" data-key="19942"><span data-slate-leaf="true" data-offset-key="19942:0" data-first-offset="true"><span data-slate-string="true">中，我们通过</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19943"><span data-slate-object="text" data-key="19944"><span data-slate-leaf="true" data-offset-key="19944:0" data-first-offset="true"><span data-slate-string="true"> systemctl status iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="19945"><span data-slate-leaf="true" data-offset-key="19945:0" data-first-offset="true"><span data-slate-string="true"> 输出的信息，知道了 iam-apiserver 启动时加载的配置文件为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19946"><span data-slate-object="text" data-key="19947"><span data-slate-leaf="true" data-offset-key="19947:0" data-first-offset="true"><span data-slate-string="true"> /etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="19948"><span data-slate-leaf="true" data-offset-key="19948:0" data-first-offset="true"><span data-slate-string="true">。所以，我们可以通过 iam-apiserver 的配置文件 iam-apiserver.yaml 中的</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19949"><span data-slate-object="text" data-key="19950"><span data-slate-leaf="true" data-offset-key="19950:0" data-first-offset="true"><span data-slate-string="true"> log.output-paths</span></span></span></span><span data-slate-object="text" data-key="19951"><span data-slate-leaf="true" data-offset-key="19951:0" data-first-offset="true"><span data-slate-string="true"> 配置项，查看记录日志文件的位置：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="19952"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="19953"><span data-slate-object="text" data-key="19954"><span data-slate-leaf="true" data-offset-key="19954:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">log</span></span></span></span><span data-slate-object="text" data-key="19955"><span data-slate-leaf="true" data-offset-key="19955:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19956"><span data-slate-object="text" data-key="19957"><span data-slate-leaf="true" data-offset-key="19957:0" data-first-offset="true"><span data-slate-string="true">    name: apiserver </span></span></span><span data-slate-object="text" data-key="19958"><span data-slate-leaf="true" data-offset-key="19958:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># Logger 的名字</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19959"><span data-slate-object="text" data-key="19960"><span data-slate-leaf="true" data-offset-key="19960:0" data-first-offset="true"><span data-slate-string="true">    development: </span></span></span><span data-slate-object="text" data-key="19961"><span data-slate-leaf="true" data-offset-key="19961:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">true</span></span></span></span><span data-slate-object="text" data-key="19962"><span data-slate-leaf="true" data-offset-key="19962:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19963"><span data-slate-leaf="true" data-offset-key="19963:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 是否是开发模式。如果是开发模式，会对 DPanicLevel 进行堆栈跟踪。</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19964"><span data-slate-object="text" data-key="19965"><span data-slate-leaf="true" data-offset-key="19965:0" data-first-offset="true"><span data-slate-string="true">    level: debug </span></span></span><span data-slate-object="text" data-key="19966"><span data-slate-leaf="true" data-offset-key="19966:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 日志级别，优先级从低到高依次为：debug, info, warn, error, dpanic, panic, fatal。</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19967"><span data-slate-object="text" data-key="19968"><span data-slate-leaf="true" data-offset-key="19968:0" data-first-offset="true"><span data-slate-string="true">    format: console </span></span></span><span data-slate-object="text" data-key="19969"><span data-slate-leaf="true" data-offset-key="19969:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 支持的日志输出格式，目前支持 console 和 json 两种。console 其实就是 text 格式。</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19970"><span data-slate-object="text" data-key="19971"><span data-slate-leaf="true" data-offset-key="19971:0" data-first-offset="true"><span data-slate-string="true">    enable-color: </span></span></span><span data-slate-object="text" data-key="19972"><span data-slate-leaf="true" data-offset-key="19972:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">true</span></span></span></span><span data-slate-object="text" data-key="19973"><span data-slate-leaf="true" data-offset-key="19973:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19974"><span data-slate-leaf="true" data-offset-key="19974:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 是否开启颜色输出，true: 是，false: 否</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19975"><span data-slate-object="text" data-key="19976"><span data-slate-leaf="true" data-offset-key="19976:0" data-first-offset="true"><span data-slate-string="true">    disable-caller: </span></span></span><span data-slate-object="text" data-key="19977"><span data-slate-leaf="true" data-offset-key="19977:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">false</span></span></span></span><span data-slate-object="text" data-key="19978"><span data-slate-leaf="true" data-offset-key="19978:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19979"><span data-slate-leaf="true" data-offset-key="19979:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 是否开启 caller，如果开启会在日志中显示调用日志所在的文件、函数和行号</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19980"><span data-slate-object="text" data-key="19981"><span data-slate-leaf="true" data-offset-key="19981:0" data-first-offset="true"><span data-slate-string="true">    disable-stacktrace: </span></span></span><span data-slate-object="text" data-key="19982"><span data-slate-leaf="true" data-offset-key="19982:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">false</span></span></span></span><span data-slate-object="text" data-key="19983"><span data-slate-leaf="true" data-offset-key="19983:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="19984"><span data-slate-leaf="true" data-offset-key="19984:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 是否在 panic 及以上级别禁止打印堆栈信息</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19985"><span data-slate-object="text" data-key="19986"><span data-slate-leaf="true" data-offset-key="19986:0" data-first-offset="true"><span data-slate-string="true">    output-paths: /var/log/iam/iam-apiserver.log,stdout </span></span></span><span data-slate-object="text" data-key="19987"><span data-slate-leaf="true" data-offset-key="19987:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># 支持输出到多个输出，逗号分开。支持输出到标准输出（stdout）和文件。</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="19988"><span data-slate-object="text" data-key="19989"><span data-slate-leaf="true" data-offset-key="19989:0" data-first-offset="true"><span data-slate-string="true">    error-output-paths: /var/log/iam/iam-apiserver.error.log </span></span></span><span data-slate-object="text" data-key="19990"><span data-slate-leaf="true" data-offset-key="19990:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># zap 内部 (非业务) 错误日志输出路径，多个输出，逗号分开</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="19991"><span data-slate-object="text" data-key="19992"><span data-slate-leaf="true" data-offset-key="19992:0" data-first-offset="true"><span data-slate-string="true">可以看到，iam-apiserver 将日志分别记录到了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19993"><span data-slate-object="text" data-key="19994"><span data-slate-leaf="true" data-offset-key="19994:0" data-first-offset="true"><span data-slate-string="true"> /var/log/iam/iam-apiserver.log</span></span></span></span><span data-slate-object="text" data-key="19995"><span data-slate-leaf="true" data-offset-key="19995:0" data-first-offset="true"><span data-slate-string="true"> 和</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19996"><span data-slate-object="text" data-key="19997"><span data-slate-leaf="true" data-offset-key="19997:0" data-first-offset="true"><span data-slate-string="true"> stdout</span></span></span></span><span data-slate-object="text" data-key="19998"><span data-slate-leaf="true" data-offset-key="19998:0" data-first-offset="true"><span data-slate-string="true"> 中。所以，我们可以通过查看</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="19999"><span data-slate-object="text" data-key="20000"><span data-slate-leaf="true" data-offset-key="20000:0" data-first-offset="true"><span data-slate-string="true"> /var/log/iam/iam-apiserver.log</span></span></span></span><span data-slate-object="text" data-key="20001"><span data-slate-leaf="true" data-offset-key="20001:0" data-first-offset="true"><span data-slate-string="true"> 日志文件，来查看报错信息：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20002"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20003"><span data-slate-object="text" data-key="20004"><span data-slate-leaf="true" data-offset-key="20004:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20005"><span data-slate-leaf="true" data-offset-key="20005:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">tail</span></span></span></span><span data-slate-object="text" data-key="20006"><span data-slate-leaf="true" data-offset-key="20006:0" data-first-offset="true"><span data-slate-string="true"> -25 /var/log/iam/iam-apiserver.log</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20007"><span data-slate-object="text" data-key="20008"><span data-slate-leaf="true" data-offset-key="20008:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20009"><span data-slate-object="text" data-key="20010"><span data-slate-leaf="true" data-offset-key="20010:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:42:35.231  INFO  apiserver  server/genericapiserver.go:88  GET    /version --&gt; github.com/marmotedu/iam/internal/pkg/server.(*GenericAPIServer).InstallAPIs.func2 (10 handlers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20011"><span data-slate-object="text" data-key="20012"><span data-slate-leaf="true" data-offset-key="20012:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:42:35.232  INFO  apiserver  gorm@v1.21.12/gorm.go:202  mysql/mysql.go:75[error] failed to initialize database, got error dial tcp 127.0.0.1:3309: connect: connection refused</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20013"><span data-slate-object="text" data-key="20014"><span data-slate-leaf="true" data-offset-key="20014:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:42:35.232  FATAL  apiserver  apiserver/server.go:139  Failed to get cache instance: got nil cache server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20015"><span data-slate-object="text" data-key="20016"><span data-slate-leaf="true" data-offset-key="20016:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.(*completedExtraConfig).New</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20017"><span data-slate-object="text" data-key="20018"><span data-slate-leaf="true" data-offset-key="20018:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:139</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20019"><span data-slate-object="text" data-key="20020"><span data-slate-leaf="true" data-offset-key="20020:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.createAPIServer</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20021"><span data-slate-object="text" data-key="20022"><span data-slate-leaf="true" data-offset-key="20022:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:66</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20023"><span data-slate-object="text" data-key="20024"><span data-slate-leaf="true" data-offset-key="20024:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20025"><span data-slate-object="text" data-key="20026"><span data-slate-leaf="true" data-offset-key="20026:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/run.go:11</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20027"><span data-slate-object="text" data-key="20028"><span data-slate-leaf="true" data-offset-key="20028:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.run.func1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20029"><span data-slate-object="text" data-key="20030"><span data-slate-leaf="true" data-offset-key="20030:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/app.go:46</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20031"><span data-slate-object="text" data-key="20032"><span data-slate-leaf="true" data-offset-key="20032:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/pkg/app.(*App).runCommand</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20033"><span data-slate-object="text" data-key="20034"><span data-slate-leaf="true" data-offset-key="20034:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:278</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20035"><span data-slate-object="text" data-key="20036"><span data-slate-leaf="true" data-offset-key="20036:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20037"><span data-slate-object="text" data-key="20038"><span data-slate-leaf="true" data-offset-key="20038:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:856</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20039"><span data-slate-object="text" data-key="20040"><span data-slate-leaf="true" data-offset-key="20040:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).ExecuteC</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20041"><span data-slate-object="text" data-key="20042"><span data-slate-leaf="true" data-offset-key="20042:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:974</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20043"><span data-slate-object="text" data-key="20044"><span data-slate-leaf="true" data-offset-key="20044:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).Execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20045"><span data-slate-object="text" data-key="20046"><span data-slate-leaf="true" data-offset-key="20046:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:902</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20047"><span data-slate-object="text" data-key="20048"><span data-slate-leaf="true" data-offset-key="20048:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/pkg/app.(*App).Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20049"><span data-slate-object="text" data-key="20050"><span data-slate-leaf="true" data-offset-key="20050:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:233</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20051"><span data-slate-object="text" data-key="20052"><span data-slate-leaf="true" data-offset-key="20052:0" data-first-offset="true"><span data-slate-string="true">main.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20053"><span data-slate-object="text" data-key="20054"><span data-slate-leaf="true" data-offset-key="20054:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/cmd/iam-apiserver/apiserver.go:24</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20055"><span data-slate-object="text" data-key="20056"><span data-slate-leaf="true" data-offset-key="20056:0" data-first-offset="true"><span data-slate-string="true">runtime.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20057"><span data-slate-object="text" data-key="20058"><span data-slate-leaf="true" data-offset-key="20058:0" data-first-offset="true"><span data-slate-string="true">  /home/going/go/go1.16.2/src/runtime/proc.go:225</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20059"><span data-slate-object="text" data-key="20060"><span data-slate-leaf="true" data-offset-key="20060:0" data-first-offset="true"><span data-slate-string="true">我们再来看最后一种查看方式，通过 console 查看。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20061"><span data-slate-object="text" data-key="20062"><span data-slate-leaf="true" data-offset-key="20062:0" data-first-offset="true"><span data-slate-string="true">当然，我们也可以直接通过 console 来看日志，这就需要我们在 Linux 终端前台运行 iam-apiserver（在</span></span></span><span data-slate-object="text" data-key="20063"><span data-slate-leaf="true" data-offset-key="20063:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步</span></span></span></span><span data-slate-object="text" data-key="20064"><span data-slate-leaf="true" data-offset-key="20064:0" data-first-offset="true"><span data-slate-string="true">中，我们已经知道了启动命令）：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20065"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div><div data-code-line-number="14"></div><div data-code-line-number="15"></div><div data-code-line-number="16"></div><div data-code-line-number="17"></div><div data-code-line-number="18"></div><div data-code-line-number="19"></div><div data-code-line-number="20"></div><div data-code-line-number="21"></div><div data-code-line-number="22"></div><div data-code-line-number="23"></div><div data-code-line-number="24"></div><div data-code-line-number="25"></div><div data-code-line-number="26"></div><div data-code-line-number="27"></div><div data-code-line-number="28"></div><div data-code-line-number="29"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20066"><span data-slate-object="text" data-key="20067"><span data-slate-leaf="true" data-offset-key="20067:0" data-first-offset="true"><span data-slate-string="true">$ sudo /opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20068"><span data-slate-object="text" data-key="20069"><span data-slate-leaf="true" data-offset-key="20069:0" data-first-offset="true"><span data-slate-string="true">...</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20070"><span data-slate-object="text" data-key="20071"><span data-slate-leaf="true" data-offset-key="20071:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:47:00.660  INFO  apiserver  server/genericapiserver.go:88  GET    /debug/pprof/mutex --&gt; github.com/gin-contrib/pprof.pprofHandler.func1 (10 handlers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20072"><span data-slate-object="text" data-key="20073"><span data-slate-leaf="true" data-offset-key="20073:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:47:00.660  INFO  apiserver  server/genericapiserver.go:88  GET    /debug/pprof/threadcreate --&gt; github.com/gin-contrib/pprof.pprofHandler.func1 (10 handlers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20074"><span data-slate-object="text" data-key="20075"><span data-slate-leaf="true" data-offset-key="20075:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:47:00.660  INFO  apiserver  server/genericapiserver.go:88  GET    /version --&gt; github.com/marmotedu/iam/internal/pkg/server.(*GenericAPIServer).InstallAPIs.func2 (10 handlers)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20076"><span data-slate-object="text" data-key="20077"><span data-slate-leaf="true" data-offset-key="20077:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:47:00.661  INFO  apiserver  gorm@v1.21.12/gorm.go:202  mysql/mysql.go:75[error] failed to initialize database, got error dial tcp 127.0.0.1:3309: connect: connection refused</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20078"><span data-slate-object="text" data-key="20079"><span data-slate-leaf="true" data-offset-key="20079:0" data-first-offset="true"><span data-slate-string="true">2021-09-09 15:47:00.661  FATAL  apiserver  apiserver/server.go:139  Failed to get cache instance: got nil cache server</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20080"><span data-slate-object="text" data-key="20081"><span data-slate-leaf="true" data-offset-key="20081:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.(*completedExtraConfig).New</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20082"><span data-slate-object="text" data-key="20083"><span data-slate-leaf="true" data-offset-key="20083:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:139</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20084"><span data-slate-object="text" data-key="20085"><span data-slate-leaf="true" data-offset-key="20085:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.createAPIServer</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20086"><span data-slate-object="text" data-key="20087"><span data-slate-leaf="true" data-offset-key="20087:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/server.go:66</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20088"><span data-slate-object="text" data-key="20089"><span data-slate-leaf="true" data-offset-key="20089:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20090"><span data-slate-object="text" data-key="20091"><span data-slate-leaf="true" data-offset-key="20091:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/run.go:11</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20092"><span data-slate-object="text" data-key="20093"><span data-slate-leaf="true" data-offset-key="20093:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/internal/apiserver.run.func1</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20094"><span data-slate-object="text" data-key="20095"><span data-slate-leaf="true" data-offset-key="20095:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/internal/apiserver/app.go:46</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20096"><span data-slate-object="text" data-key="20097"><span data-slate-leaf="true" data-offset-key="20097:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/pkg/app.(*App).runCommand</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20098"><span data-slate-object="text" data-key="20099"><span data-slate-leaf="true" data-offset-key="20099:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:278</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20100"><span data-slate-object="text" data-key="20101"><span data-slate-leaf="true" data-offset-key="20101:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20102"><span data-slate-object="text" data-key="20103"><span data-slate-leaf="true" data-offset-key="20103:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:856</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20104"><span data-slate-object="text" data-key="20105"><span data-slate-leaf="true" data-offset-key="20105:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).ExecuteC</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20106"><span data-slate-object="text" data-key="20107"><span data-slate-leaf="true" data-offset-key="20107:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:974</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20108"><span data-slate-object="text" data-key="20109"><span data-slate-leaf="true" data-offset-key="20109:0" data-first-offset="true"><span data-slate-string="true">github.com/spf13/cobra.(*Command).Execute</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20110"><span data-slate-object="text" data-key="20111"><span data-slate-leaf="true" data-offset-key="20111:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/pkg/mod/github.com/spf13/cobra@v1.2.1/command.go:902</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20112"><span data-slate-object="text" data-key="20113"><span data-slate-leaf="true" data-offset-key="20113:0" data-first-offset="true"><span data-slate-string="true">github.com/marmotedu/iam/pkg/app.(*App).Run</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20114"><span data-slate-object="text" data-key="20115"><span data-slate-leaf="true" data-offset-key="20115:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/pkg/app/app.go:233</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20116"><span data-slate-object="text" data-key="20117"><span data-slate-leaf="true" data-offset-key="20117:0" data-first-offset="true"><span data-slate-string="true">main.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20118"><span data-slate-object="text" data-key="20119"><span data-slate-leaf="true" data-offset-key="20119:0" data-first-offset="true"><span data-slate-string="true">  /home/going/workspace/golang/src/github.com/marmotedu/iam/cmd/iam-apiserver/apiserver.go:24</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20120"><span data-slate-object="text" data-key="20121"><span data-slate-leaf="true" data-offset-key="20121:0" data-first-offset="true"><span data-slate-string="true">runtime.main</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20122"><span data-slate-object="text" data-key="20123"><span data-slate-leaf="true" data-offset-key="20123:0" data-first-offset="true"><span data-slate-string="true">  /home/going/go/go1.16.2/src/runtime/proc.go:225</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20124"><span data-slate-object="text" data-key="20125"><span data-slate-leaf="true" data-offset-key="20125:0" data-first-offset="true"><span data-slate-string="true">通过上面这 3 种查看方式，我们均能初步定位到服务异常的原因。</span></span></span></div><h4 data-slate-type="heading" data-slate-object="block" data-key="20126" id="sr-toc-6"><span data-slate-object="text" data-key="20127"><span data-slate-leaf="true" data-offset-key="20127:0" data-first-offset="true"><span data-slate-string="true">使用 Go 调试工具 Delve 来定位问题</span></span></span></h4><div data-slate-type="paragraph" data-slate-object="block" data-key="20128"><span data-slate-object="text" data-key="20129"><span data-slate-leaf="true" data-offset-key="20129:0" data-first-offset="true"><span data-slate-string="true">查看日志是最简单的排障方式，通过查看日志，我们可能定位出问题的根本原因，这种情况下问题就能得到快速的解决。但有些情况下，我们通过日志并不一定能定位出问题，例如：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20130"><div data-slate-type="list-line" data-slate-object="block" data-key="20131"><span data-slate-object="text" data-key="20132"><span data-slate-leaf="true" data-offset-key="20132:0" data-first-offset="true"><span data-slate-string="true">程序异常，但是没有错误日志。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20133"><span data-slate-object="text" data-key="20134"><span data-slate-leaf="true" data-offset-key="20134:0" data-first-offset="true"><span data-slate-string="true">日志有报错，但只能判断问题的面，还不能精准找到问题的根因。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20135"><span data-slate-object="text" data-key="20136"><span data-slate-leaf="true" data-offset-key="20136:0" data-first-offset="true"><span data-slate-string="true">遇到上面这两种情况，我们都需要再进一步地定位问题。这时候，我们可以使用 Delve 调试工具来尝试定位问题。Delve 工具的用法你可以参考 </span></span></span><a data-slate-type="link" data-slate-object="inline" data-key="20137"><span data-slate-object="text" data-key="20138"><span data-slate-leaf="true" data-offset-key="20138:0" data-first-offset="true"><span data-slate-string="true">Delve 使用详解</span></span></span></a><span data-slate-object="text" data-key="20139"><span data-slate-leaf="true" data-offset-key="20139:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><h4 data-slate-type="heading" data-slate-object="block" data-key="20140" id="sr-toc-7"><span data-slate-object="text" data-key="20141"><span data-slate-leaf="true" data-offset-key="20141:0" data-first-offset="true"><span data-slate-string="true">添加 Debug 日志定位问题</span></span></span></h4><div data-slate-type="paragraph" data-slate-object="block" data-key="20142"><span data-slate-object="text" data-key="20143"><span data-slate-leaf="true" data-offset-key="20143:0" data-first-offset="true"><span data-slate-string="true">如果使用 Delve 工具仍然没有定位出问题，接下来你可以尝试最原始的方法：添加 Debug 日志来定位问题。这种方法具体可以分为两个步骤。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20144"><span data-slate-object="text" data-key="20145"><span data-slate-leaf="true" data-offset-key="20145:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第一步，在关键代码段添加 Debug 日志。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20146"><span data-slate-object="text" data-key="20147"><span data-slate-leaf="true" data-offset-key="20147:0" data-first-offset="true"><span data-slate-string="true">你需要根据自己对代码的理解来决定关键代码段。如果不确定哪段代码出问题，可以从请求入口处添加 Debug 日志，然后跟着代码流程一步步往下排查，并在需要的地方添加 Debug 日志。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20148"><span data-slate-object="text" data-key="20149"><span data-slate-leaf="true" data-offset-key="20149:0" data-first-offset="true"><span data-slate-string="true">例如，通过排查日志，我们定位到</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20150"><span data-slate-object="text" data-key="20151"><span data-slate-leaf="true" data-offset-key="20151:0" data-first-offset="true"><span data-slate-string="true"> internal/apiserver/server.go:139</span></span></span></span><span data-slate-object="text" data-key="20152"><span data-slate-leaf="true" data-offset-key="20152:0" data-first-offset="true"><span data-slate-string="true"> 位置的代码导致程序 FATAL，FATAL 原因是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20153"><span data-slate-object="text" data-key="20154"><span data-slate-leaf="true" data-offset-key="20154:0" data-first-offset="true"><span data-slate-string="true"> Failed to get cache instance: got nil cache server</span></span></span></span><span data-slate-object="text" data-key="20155"><span data-slate-leaf="true" data-offset-key="20155:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20156"><span data-slate-object="text" data-key="20157"><span data-slate-leaf="true" data-offset-key="20157:0" data-first-offset="true"><span data-slate-string="true">cache server</span></span></span></span><span data-slate-object="text" data-key="20158"><span data-slate-leaf="true" data-offset-key="20158:0" data-first-offset="true"><span data-slate-string="true"> 是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20159"><span data-slate-object="text" data-key="20160"><span data-slate-leaf="true" data-offset-key="20160:0" data-first-offset="true"><span data-slate-string="true"> nil</span></span></span></span><span data-slate-object="text" data-key="20161"><span data-slate-leaf="true" data-offset-key="20161:0" data-first-offset="true"><span data-slate-string="true">，说明</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20162"><span data-slate-object="text" data-key="20163"><span data-slate-leaf="true" data-offset-key="20163:0" data-first-offset="true"><span data-slate-string="true"> cache server</span></span></span></span><span data-slate-object="text" data-key="20164"><span data-slate-leaf="true" data-offset-key="20164:0" data-first-offset="true"><span data-slate-string="true"> 没有被初始化。查看</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20165"><span data-slate-object="text" data-key="20166"><span data-slate-leaf="true" data-offset-key="20166:0" data-first-offset="true"><span data-slate-string="true"> cache server</span></span></span></span><span data-slate-object="text" data-key="20167"><span data-slate-leaf="true" data-offset-key="20167:0" data-first-offset="true"><span data-slate-string="true"> 初始化函数：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20168"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div><div data-code-line-number="13"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20169"><span data-slate-object="text" data-key="20170"><span data-slate-leaf="true" data-offset-key="20170:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20171"><span data-slate-leaf="true" data-offset-key="20171:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"> </span></span></span></span><span data-slate-object="text" data-key="20172"><span data-slate-leaf="true" data-offset-key="20172:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">GetCacheInsOr</span></span></span></span></span><span data-slate-object="text" data-key="20173"><span data-slate-leaf="true" data-offset-key="20173:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">(store store.Factory)</span></span></span></span></span><span data-slate-object="text" data-key="20174"><span data-slate-leaf="true" data-offset-key="20174:0" data-first-offset="true"><span data-slate-string="true"> (*Cache, </span></span></span><span data-slate-object="text" data-key="20175"><span data-slate-leaf="true" data-offset-key="20175:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">error</span></span></span></span><span data-slate-object="text" data-key="20176"><span data-slate-leaf="true" data-offset-key="20176:0" data-first-offset="true"><span data-slate-string="true">) {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20177"><span data-slate-object="text" data-key="20178"><span data-slate-leaf="true" data-offset-key="20178:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20179"><span data-slate-leaf="true" data-offset-key="20179:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20180"><span data-slate-leaf="true" data-offset-key="20180:0" data-first-offset="true"><span data-slate-string="true"> store != </span></span></span><span data-slate-object="text" data-key="20181"><span data-slate-leaf="true" data-offset-key="20181:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20182"><span data-slate-leaf="true" data-offset-key="20182:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20183"><span data-slate-object="text" data-key="20184"><span data-slate-leaf="true" data-offset-key="20184:0" data-first-offset="true"><span data-slate-string="true">        once.Do(</span></span></span><span data-slate-object="text" data-key="20185"><span data-slate-leaf="true" data-offset-key="20185:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">func</span></span></span></span></span><span data-slate-object="text" data-key="20186"><span data-slate-leaf="true" data-offset-key="20186:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">()</span></span></span></span></span><span data-slate-object="text" data-key="20187"><span data-slate-leaf="true" data-offset-key="20187:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20188"><span data-slate-object="text" data-key="20189"><span data-slate-leaf="true" data-offset-key="20189:0" data-first-offset="true"><span data-slate-string="true">            cacheServer = &amp;Cache{store}</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20190"><span data-slate-object="text" data-key="20191"><span data-slate-leaf="true" data-offset-key="20191:0" data-first-offset="true"><span data-slate-string="true">        })</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20192"><span data-slate-object="text" data-key="20193"><span data-slate-leaf="true" data-offset-key="20193:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20194"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20195"><span data-slate-object="text" data-key="20196"><span data-slate-leaf="true" data-offset-key="20196:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20197"><span data-slate-leaf="true" data-offset-key="20197:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20198"><span data-slate-leaf="true" data-offset-key="20198:0" data-first-offset="true"><span data-slate-string="true"> cacheServer == </span></span></span><span data-slate-object="text" data-key="20199"><span data-slate-leaf="true" data-offset-key="20199:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20200"><span data-slate-leaf="true" data-offset-key="20200:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20201"><span data-slate-object="text" data-key="20202"><span data-slate-leaf="true" data-offset-key="20202:0" data-first-offset="true"><span data-slate-string="true">        </span></span></span><span data-slate-object="text" data-key="20203"><span data-slate-leaf="true" data-offset-key="20203:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20204"><span data-slate-leaf="true" data-offset-key="20204:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20205"><span data-slate-leaf="true" data-offset-key="20205:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20206"><span data-slate-leaf="true" data-offset-key="20206:0" data-first-offset="true"><span data-slate-string="true">, fmt.Errorf(</span></span></span><span data-slate-object="text" data-key="20207"><span data-slate-leaf="true" data-offset-key="20207:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"got nil cache server"</span></span></span></span><span data-slate-object="text" data-key="20208"><span data-slate-leaf="true" data-offset-key="20208:0" data-first-offset="true"><span data-slate-string="true">)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20209"><span data-slate-object="text" data-key="20210"><span data-slate-leaf="true" data-offset-key="20210:0" data-first-offset="true"><span data-slate-string="true">    }</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20211"></div><div data-slate-type="code-line" data-slate-object="block" data-key="20212"><span data-slate-object="text" data-key="20213"><span data-slate-leaf="true" data-offset-key="20213:0" data-first-offset="true"><span data-slate-string="true">    </span></span></span><span data-slate-object="text" data-key="20214"><span data-slate-leaf="true" data-offset-key="20214:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20215"><span data-slate-leaf="true" data-offset-key="20215:0" data-first-offset="true"><span data-slate-string="true"> cacheServer, </span></span></span><span data-slate-object="text" data-key="20216"><span data-slate-leaf="true" data-offset-key="20216:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20217"><span data-slate-object="text" data-key="20218"><span data-slate-leaf="true" data-offset-key="20218:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20219"><span data-slate-object="text" data-key="20220"><span data-slate-leaf="true" data-offset-key="20220:0" data-first-offset="true"><span data-slate-string="true">我们不难分析出，是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20221"><span data-slate-object="text" data-key="20222"><span data-slate-leaf="true" data-offset-key="20222:0" data-first-offset="true"><span data-slate-string="true"> store == nil</span></span></span></span><span data-slate-object="text" data-key="20223"><span data-slate-leaf="true" data-offset-key="20223:0" data-first-offset="true"><span data-slate-string="true"> 导致</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20224"><span data-slate-object="text" data-key="20225"><span data-slate-leaf="true" data-offset-key="20225:0" data-first-offset="true"><span data-slate-string="true"> cacheServer</span></span></span></span><span data-slate-object="text" data-key="20226"><span data-slate-leaf="true" data-offset-key="20226:0" data-first-offset="true"><span data-slate-string="true"> 没有被初始化。再来看下 store 的初始化代码，并加一些 Debug 日志，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="20227"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/cc/15/cc50c340e4ff0e5401b3d89430456b15.png?wh=1669x1025"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20228"><span data-slate-object="text" data-key="20229"><span data-slate-leaf="true" data-offset-key="20229:0" data-first-offset="true"><span data-slate-string="true">我们添加完 Debug 代码后，就可以重新编译并运行程序了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20230"><span data-slate-object="text" data-key="20231"><span data-slate-leaf="true" data-offset-key="20231:0" data-first-offset="true"><span data-slate-string="true">这里有个小技巧：可以在错误返回的位置添加 Debug 日志，这样能大概率帮助你定位到出错的位置，例如：</span></span></span></div><div data-code-language="go" data-slate-type="pre" data-slate-object="block" data-key="20232"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20233"><span data-slate-object="text" data-key="20234"><span data-slate-leaf="true" data-offset-key="20234:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">if</span></span></span></span><span data-slate-object="text" data-key="20235"><span data-slate-leaf="true" data-offset-key="20235:0" data-first-offset="true"><span data-slate-string="true"> err != </span></span></span><span data-slate-object="text" data-key="20236"><span data-slate-leaf="true" data-offset-key="20236:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">nil</span></span></span></span><span data-slate-object="text" data-key="20237"><span data-slate-leaf="true" data-offset-key="20237:0" data-first-offset="true"><span data-slate-string="true"> {</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20238"><span data-slate-object="text" data-key="20239"><span data-slate-leaf="true" data-offset-key="20239:0" data-first-offset="true"><span data-slate-string="true">  log.Debugf(</span></span></span><span data-slate-object="text" data-key="20240"><span data-slate-leaf="true" data-offset-key="20240:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"DEBUG POINT - 1: %v"</span></span></span></span><span data-slate-object="text" data-key="20241"><span data-slate-leaf="true" data-offset-key="20241:0" data-first-offset="true"><span data-slate-string="true">, err)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20242"><span data-slate-object="text" data-key="20243"><span data-slate-leaf="true" data-offset-key="20243:0" data-first-offset="true"><span data-slate-string="true">  </span></span></span><span data-slate-object="text" data-key="20244"><span data-slate-leaf="true" data-offset-key="20244:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">return</span></span></span></span><span data-slate-object="text" data-key="20245"><span data-slate-leaf="true" data-offset-key="20245:0" data-first-offset="true"><span data-slate-string="true"> err</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20246"><span data-slate-object="text" data-key="20247"><span data-slate-leaf="true" data-offset-key="20247:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20248"><span data-slate-object="text" data-key="20249"><span data-slate-leaf="true" data-offset-key="20249:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">第二步，重新编译源码，并启动。</span></span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20250"><span data-slate-object="text" data-key="20251"><span data-slate-leaf="true" data-offset-key="20251:0" data-first-offset="true"><span data-slate-string="true">这里为了调试、看日志方便，我们直接在 Linux 终端的前端运行 iam-apiserver：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20252"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20253"><span data-slate-object="text" data-key="20254"><span data-slate-leaf="true" data-offset-key="20254:0" data-first-offset="true"><span data-slate-string="true">$ sudo /opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20255"><span data-slate-object="text" data-key="20256"><span data-slate-leaf="true" data-offset-key="20256:0" data-first-offset="true"><span data-slate-string="true">查看我们添加的 Debug 日志打印的内容，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="20257"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/61/03/61f31a4b9e45ed9079470e928f7d3b03.png?wh=1920x265"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20258"><span data-slate-object="text" data-key="20259"><span data-slate-leaf="true" data-offset-key="20259:0" data-first-offset="true"><span data-slate-string="true">从 Debug 日志中，可以看到用来创建 MySQL 实例的端口是错误的，正确的端口应该是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20260"><span data-slate-object="text" data-key="20261"><span data-slate-leaf="true" data-offset-key="20261:0" data-first-offset="true"><span data-slate-string="true"> 3306</span></span></span></span><span data-slate-object="text" data-key="20262"><span data-slate-leaf="true" data-offset-key="20262:0" data-first-offset="true"><span data-slate-string="true">，而不是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20263"><span data-slate-object="text" data-key="20264"><span data-slate-leaf="true" data-offset-key="20264:0" data-first-offset="true"><span data-slate-string="true"> 3309</span></span></span></span><span data-slate-object="text" data-key="20265"><span data-slate-leaf="true" data-offset-key="20265:0" data-first-offset="true"><span data-slate-string="true">。MySQL 服务器的端口是在 iam-apiserver.yaml 中配置的。修改 iam-apiserver.yaml 为正确的配置，并启动：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20266"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20267"><span data-slate-object="text" data-key="20268"><span data-slate-leaf="true" data-offset-key="20268:0" data-first-offset="true"><span data-slate-string="true">$ sudo /opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20269"><span data-slate-object="text" data-key="20270"><span data-slate-leaf="true" data-offset-key="20270:0" data-first-offset="true"><span data-slate-string="true">再次查看 console 日志，如下图所示：</span></span></span></div><div data-slate-type="image" data-slate-object="block" data-key="20271"><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/f7/9d/f72b766b7504016259bef04eb03dac9d.png?wh=1920x271"></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20272"><span data-slate-object="text" data-key="20273"><span data-slate-leaf="true" data-offset-key="20273:0" data-first-offset="true"><span data-slate-string="true">可以看到问题已经修复，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20274"><span data-slate-object="text" data-key="20275"><span data-slate-leaf="true" data-offset-key="20275:0" data-first-offset="true"><span data-slate-string="true">dbIns</span></span></span></span><span data-slate-object="text" data-key="20276"><span data-slate-leaf="true" data-offset-key="20276:0" data-first-offset="true"><span data-slate-string="true"> 不为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20277"><span data-slate-object="text" data-key="20278"><span data-slate-leaf="true" data-offset-key="20278:0" data-first-offset="true"><span data-slate-string="true"> nil</span></span></span></span><span data-slate-object="text" data-key="20279"><span data-slate-leaf="true" data-offset-key="20279:0" data-first-offset="true"><span data-slate-string="true">，程序正常运行：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20280"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div><div data-code-line-number="5"></div><div data-code-line-number="6"></div><div data-code-line-number="7"></div><div data-code-line-number="8"></div><div data-code-line-number="9"></div><div data-code-line-number="10"></div><div data-code-line-number="11"></div><div data-code-line-number="12"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20281"><span data-slate-object="text" data-key="20282"><span data-slate-leaf="true" data-offset-key="20282:0" data-first-offset="true"><span data-slate-string="true">$ systemctl status iam-apiserver</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20283"><span data-slate-object="text" data-key="20284"><span data-slate-leaf="true" data-offset-key="20284:0" data-first-offset="true"><span data-slate-string="true">● iam-apiserver.service - IAM APIServer</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20285"><span data-slate-object="text" data-key="20286"><span data-slate-leaf="true" data-offset-key="20286:0" data-first-offset="true"><span data-slate-string="true">   Loaded: loaded (/etc/systemd/system/iam-apiserver.service; enabled; vendor preset: disabled)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20287"><span data-slate-object="text" data-key="20288"><span data-slate-leaf="true" data-offset-key="20288:0" data-first-offset="true"><span data-slate-string="true">   Active: active (running) since Thu 2021-09-09 20:48:18 CST; 17s ago</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20289"><span data-slate-object="text" data-key="20290"><span data-slate-leaf="true" data-offset-key="20290:0" data-first-offset="true"><span data-slate-string="true">     Docs: https://github.com/marmotedu/iam/blob/master/init/README.md</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20291"><span data-slate-object="text" data-key="20292"><span data-slate-leaf="true" data-offset-key="20292:0" data-first-offset="true"><span data-slate-string="true">  Process: 255648 ExecStartPre=/usr/bin/mkdir -p /var/log/iam (code=exited, status=0/SUCCESS)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20293"><span data-slate-object="text" data-key="20294"><span data-slate-leaf="true" data-offset-key="20294:0" data-first-offset="true"><span data-slate-string="true">  Process: 255647 ExecStartPre=/usr/bin/mkdir -p /data/iam/iam-apiserver (code=exited, status=0/SUCCESS)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20295"><span data-slate-object="text" data-key="20296"><span data-slate-leaf="true" data-offset-key="20296:0" data-first-offset="true"><span data-slate-string="true"> Main PID: 255650 (iam-apiserver)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20297"><span data-slate-object="text" data-key="20298"><span data-slate-leaf="true" data-offset-key="20298:0" data-first-offset="true"><span data-slate-string="true">    Tasks: 5 (</span></span></span><span data-slate-object="text" data-key="20299"><span data-slate-leaf="true" data-offset-key="20299:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">limit</span></span></span></span><span data-slate-object="text" data-key="20300"><span data-slate-leaf="true" data-offset-key="20300:0" data-first-offset="true"><span data-slate-string="true">: 23724)</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20301"><span data-slate-object="text" data-key="20302"><span data-slate-leaf="true" data-offset-key="20302:0" data-first-offset="true"><span data-slate-string="true">   Memory: 7.3M</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20303"><span data-slate-object="text" data-key="20304"><span data-slate-leaf="true" data-offset-key="20304:0" data-first-offset="true"><span data-slate-string="true">   CGroup: /system.slice/iam-apiserver.service</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20305"><span data-slate-object="text" data-key="20306"><span data-slate-leaf="true" data-offset-key="20306:0" data-first-offset="true"><span data-slate-string="true">           └─255650 /opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20307"><span data-slate-object="text" data-key="20308"><span data-slate-leaf="true" data-offset-key="20308:0" data-first-offset="true"><span data-slate-string="true">在这里，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20309"><span data-slate-object="text" data-key="20310"><span data-slate-leaf="true" data-offset-key="20310:0" data-first-offset="true"><span data-slate-string="true">Active</span></span></span></span><span data-slate-object="text" data-key="20311"><span data-slate-leaf="true" data-offset-key="20311:0" data-first-offset="true"><span data-slate-string="true"> 为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20312"><span data-slate-object="text" data-key="20313"><span data-slate-leaf="true" data-offset-key="20313:0" data-first-offset="true"><span data-slate-string="true"> active (running)</span></span></span></span><span data-slate-object="text" data-key="20314"><span data-slate-leaf="true" data-offset-key="20314:0" data-first-offset="true"><span data-slate-string="true"> 状态。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20315"><span data-slate-object="text" data-key="20316"><span data-slate-leaf="true" data-offset-key="20316:0" data-first-offset="true"><span data-slate-string="true">因为这些 Debug 日志能够协助你定位问题，从侧面说明这些日志是有用的，所以你可以保留这些 Debug 日志调用代码。</span></span></span></div><h3 data-slate-type="heading" data-slate-object="block" data-key="20317" id="sr-toc-8"><span data-slate-object="text" data-key="20318"><span data-slate-leaf="true" data-offset-key="20318:0" data-first-offset="true"><span data-slate-string="true">解决问题</span></span></span></h3><div data-slate-type="paragraph" data-slate-object="block" data-key="20319"><span data-slate-object="text" data-key="20320"><span data-slate-leaf="true" data-offset-key="20320:0" data-first-offset="true"><span data-slate-string="true">在定位问题阶段，我们已经找到了问题的原因，接下来就可以根据自己对业务、底层代码实现的掌握和理解，修复这个问题了。至于怎么修复，你需要结合具体情况来判断，并没有统一的流程和方法论，这里就不多介绍了。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20321"><span data-slate-object="text" data-key="20322"><span data-slate-leaf="true" data-offset-key="20322:0" data-first-offset="true"><span data-slate-string="true">上面，我介绍了排查问题的思路和方法。接下来，我来向你展示 9 个在部署和使用 IAM 系统时容易遇到的问题，并提供解决方法。这些问题基本上都是由服务器环境引起的。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="20323" id="sr-toc-9"><span data-slate-object="text" data-key="20324"><span data-slate-leaf="true" data-offset-key="20324:0" data-first-offset="true"><span data-slate-string="true">IAM 常见故障及解决办法</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="20325"><span data-slate-object="text" data-key="20326"><span data-slate-leaf="true" data-offset-key="20326:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题一：</span></span></span></span><span data-slate-object="text" data-key="20327"><span data-slate-leaf="true" data-offset-key="20327:0" data-first-offset="true"><span data-slate-string="true">安装 neovim，报 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20328"><span data-slate-object="text" data-key="20329"><span data-slate-leaf="true" data-offset-key="20329:0" data-first-offset="true"><span data-slate-string="true">No match for argument: neovim</span></span></span></span><span data-slate-object="text" data-key="20330"><span data-slate-leaf="true" data-offset-key="20330:0" data-first-offset="true"><span data-slate-string="true"> 错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20331"><span data-slate-object="text" data-key="20332"><span data-slate-leaf="true" data-offset-key="20332:0" data-first-offset="true"><span data-slate-string="true">解决方法是安装 EPEL 源：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20333"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20334"><span data-slate-object="text" data-key="20335"><span data-slate-leaf="true" data-offset-key="20335:0" data-first-offset="true"><span data-slate-string="true">$ sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20336"><span data-slate-object="text" data-key="20337"><span data-slate-leaf="true" data-offset-key="20337:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题二：</span></span></span></span><span data-slate-object="text" data-key="20338"><span data-slate-leaf="true" data-offset-key="20338:0" data-first-offset="true"><span data-slate-string="true">安装 protoc-gen-go 失败（超时、报错等）。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20339"><span data-slate-object="text" data-key="20340"><span data-slate-leaf="true" data-offset-key="20340:0" data-first-offset="true"><span data-slate-string="true">这个故障出现，可能是因为你当前服务器所在的网络环境无法访问</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20341"><span data-slate-object="text" data-key="20342"><span data-slate-leaf="true" data-offset-key="20342:0" data-first-offset="true"><span data-slate-string="true"> github.com</span></span></span></span><span data-slate-object="text" data-key="20343"><span data-slate-leaf="true" data-offset-key="20343:0" data-first-offset="true"><span data-slate-string="true">，或者访问</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20344"><span data-slate-object="text" data-key="20345"><span data-slate-leaf="true" data-offset-key="20345:0" data-first-offset="true"><span data-slate-string="true"> github.com</span></span></span></span><span data-slate-object="text" data-key="20346"><span data-slate-leaf="true" data-offset-key="20346:0" data-first-offset="true"><span data-slate-string="true"> 速度太慢。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20347"><span data-slate-object="text" data-key="20348"><span data-slate-leaf="true" data-offset-key="20348:0" data-first-offset="true"><span data-slate-string="true">解决方法是手动编译安装，方法如下：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20349"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20350"><span data-slate-object="text" data-key="20351"><span data-slate-leaf="true" data-offset-key="20351:0" data-first-offset="true"><span data-slate-string="true">$ git </span></span></span><span data-slate-object="text" data-key="20352"><span data-slate-leaf="true" data-offset-key="20352:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">clone</span></span></span></span><span data-slate-object="text" data-key="20353"><span data-slate-leaf="true" data-offset-key="20353:0" data-first-offset="true"><span data-slate-string="true"> --depth 1 https://github.com/golang/protobuf </span></span></span><span data-slate-object="text" data-key="20354"><span data-slate-leaf="true" data-offset-key="20354:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$GOPATH</span></span></span></span><span data-slate-object="text" data-key="20355"><span data-slate-leaf="true" data-offset-key="20355:0" data-first-offset="true"><span data-slate-string="true">/src/github.com/golang/protobuf</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20356"><span data-slate-object="text" data-key="20357"><span data-slate-leaf="true" data-offset-key="20357:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20358"><span data-slate-leaf="true" data-offset-key="20358:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="20359"><span data-slate-leaf="true" data-offset-key="20359:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20360"><span data-slate-leaf="true" data-offset-key="20360:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$GOPATH</span></span></span></span><span data-slate-object="text" data-key="20361"><span data-slate-leaf="true" data-offset-key="20361:0" data-first-offset="true"><span data-slate-string="true">/src/github.com/golang/protobuf/protoc-gen-go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20362"><span data-slate-object="text" data-key="20363"><span data-slate-leaf="true" data-offset-key="20363:0" data-first-offset="true"><span data-slate-string="true">$ go install -v .</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20364"><span data-slate-object="text" data-key="20365"><span data-slate-leaf="true" data-offset-key="20365:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题三：</span></span></span></span><span data-slate-object="text" data-key="20366"><span data-slate-leaf="true" data-offset-key="20366:0" data-first-offset="true"><span data-slate-string="true">遇到</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20367"><span data-slate-object="text" data-key="20368"><span data-slate-leaf="true" data-offset-key="20368:0" data-first-offset="true"><span data-slate-string="true"> xxx: permission denied</span></span></span></span><span data-slate-object="text" data-key="20369"><span data-slate-leaf="true" data-offset-key="20369:0" data-first-offset="true"><span data-slate-string="true"> 这类的错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20370"><span data-slate-object="text" data-key="20371"><span data-slate-leaf="true" data-offset-key="20371:0" data-first-offset="true"><span data-slate-string="true">出现这种错误，是因为你没有权限执行当前的操作。解决方法是排查自己是否有权限执行当前操作。如果没有权限，需要你切换到有权限的用户，或者放弃执行当前操作。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20372"><span data-slate-object="text" data-key="20373"><span data-slate-leaf="true" data-offset-key="20373:0" data-first-offset="true"><span data-slate-string="true">为了说明问题，这里我举一个错误例子，并给出排查思路。例子的错误日志如下：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20374"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20375"><span data-slate-object="text" data-key="20376"><span data-slate-leaf="true" data-offset-key="20376:0" data-first-offset="true"><span data-slate-string="true">[going@VM-8-9-centos /]$ go get -u github.com/golang/protobuf/protoc-gen-go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20377"><span data-slate-object="text" data-key="20378"><span data-slate-leaf="true" data-offset-key="20378:0" data-first-offset="true"><span data-slate-string="true">go: could not create module cache: </span></span></span><span data-slate-object="text" data-key="20379"><span data-slate-leaf="true" data-offset-key="20379:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">mkdir</span></span></span></span><span data-slate-object="text" data-key="20380"><span data-slate-leaf="true" data-offset-key="20380:0" data-first-offset="true"><span data-slate-string="true"> /golang: permission denied</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20381"><span data-slate-object="text" data-key="20382"><span data-slate-leaf="true" data-offset-key="20382:0" data-first-offset="true"><span data-slate-string="true">[going@VM-8-9-centos /]$ sudo go get -u github.com/golang/protobuf/protoc-gen-go</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20383"><span data-slate-object="text" data-key="20384"><span data-slate-leaf="true" data-offset-key="20384:0" data-first-offset="true"><span data-slate-string="true">sudo: go: </span></span></span><span data-slate-object="text" data-key="20385"><span data-slate-leaf="true" data-offset-key="20385:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">command</span></span></span></span><span data-slate-object="text" data-key="20386"><span data-slate-leaf="true" data-offset-key="20386:0" data-first-offset="true"><span data-slate-string="true"> not found</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20387"><span data-slate-object="text" data-key="20388"><span data-slate-leaf="true" data-offset-key="20388:0" data-first-offset="true"><span data-slate-string="true">上述错误中， 一共报了两个错误，分别是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20389"><span data-slate-object="text" data-key="20390"><span data-slate-leaf="true" data-offset-key="20390:0" data-first-offset="true"><span data-slate-string="true"> mkdir /golang: permission denied</span></span></span></span><span data-slate-object="text" data-key="20391"><span data-slate-leaf="true" data-offset-key="20391:0" data-first-offset="true"><span data-slate-string="true"> 和</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20392"><span data-slate-object="text" data-key="20393"><span data-slate-leaf="true" data-offset-key="20393:0" data-first-offset="true"><span data-slate-string="true"> sudo: go: command not found</span></span></span></span><span data-slate-object="text" data-key="20394"><span data-slate-leaf="true" data-offset-key="20394:0" data-first-offset="true"><span data-slate-string="true">。我们先来看</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20395"><span data-slate-object="text" data-key="20396"><span data-slate-leaf="true" data-offset-key="20396:0" data-first-offset="true"><span data-slate-string="true"> mkdir /golang: permission denied</span></span></span></span><span data-slate-object="text" data-key="20397"><span data-slate-leaf="true" data-offset-key="20397:0" data-first-offset="true"><span data-slate-string="true"> 错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20398"><span data-slate-object="text" data-key="20399"><span data-slate-leaf="true" data-offset-key="20399:0" data-first-offset="true"><span data-slate-string="true">通过命令行提示符</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20400"><span data-slate-object="text" data-key="20401"><span data-slate-leaf="true" data-offset-key="20401:0" data-first-offset="true"><span data-slate-string="true"> $</span></span></span></span><span data-slate-object="text" data-key="20402"><span data-slate-leaf="true" data-offset-key="20402:0" data-first-offset="true"><span data-slate-string="true"> 可以知道，当前登陆用户是普通用户；通过报错</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20403"><span data-slate-object="text" data-key="20404"><span data-slate-leaf="true" data-offset-key="20404:0" data-first-offset="true"><span data-slate-string="true"> mkdir /golang: permission denied</span></span></span></span><span data-slate-object="text" data-key="20405"><span data-slate-leaf="true" data-offset-key="20405:0" data-first-offset="true"><span data-slate-string="true"> 可以知道</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20406"><span data-slate-object="text" data-key="20407"><span data-slate-leaf="true" data-offset-key="20407:0" data-first-offset="true"><span data-slate-string="true"> go get -u github.com/golang/protobuf/protoc-gen-go</span></span></span></span><span data-slate-object="text" data-key="20408"><span data-slate-leaf="true" data-offset-key="20408:0" data-first-offset="true"><span data-slate-string="true"> 命令底层执行了</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20409"><span data-slate-object="text" data-key="20410"><span data-slate-leaf="true" data-offset-key="20410:0" data-first-offset="true"><span data-slate-string="true"> mkdir /golang</span></span></span></span><span data-slate-object="text" data-key="20411"><span data-slate-leaf="true" data-offset-key="20411:0" data-first-offset="true"><span data-slate-string="true">，因为普通用户没有写</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20412"><span data-slate-object="text" data-key="20413"><span data-slate-leaf="true" data-offset-key="20413:0" data-first-offset="true"><span data-slate-string="true"> /</span></span></span></span><span data-slate-object="text" data-key="20414"><span data-slate-leaf="true" data-offset-key="20414:0" data-first-offset="true"><span data-slate-string="true"> 目录的权限，所以会报权限错误。解决方法是切换到用户的目录下，执行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20415"><span data-slate-object="text" data-key="20416"><span data-slate-leaf="true" data-offset-key="20416:0" data-first-offset="true"><span data-slate-string="true"> go get -u</span></span></span></span><span data-slate-object="text" data-key="20417"><span data-slate-leaf="true" data-offset-key="20417:0" data-first-offset="true"><span data-slate-string="true"> 命令。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20418"><span data-slate-object="text" data-key="20419"><span data-slate-leaf="true" data-offset-key="20419:0" data-first-offset="true"><span data-slate-string="true">我们再来看下</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20420"><span data-slate-object="text" data-key="20421"><span data-slate-leaf="true" data-offset-key="20421:0" data-first-offset="true"><span data-slate-string="true"> sudo: go: command not found</span></span></span></span><span data-slate-object="text" data-key="20422"><span data-slate-leaf="true" data-offset-key="20422:0" data-first-offset="true"><span data-slate-string="true"> 错误。</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20423"><span data-slate-object="text" data-key="20424"><span data-slate-leaf="true" data-offset-key="20424:0" data-first-offset="true"><span data-slate-string="true">sudo</span></span></span></span><span data-slate-object="text" data-key="20425"><span data-slate-leaf="true" data-offset-key="20425:0" data-first-offset="true"><span data-slate-string="true"> 命令会将命令执行的环境切换到</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20426"><span data-slate-object="text" data-key="20427"><span data-slate-leaf="true" data-offset-key="20427:0" data-first-offset="true"><span data-slate-string="true"> root</span></span></span></span><span data-slate-object="text" data-key="20428"><span data-slate-leaf="true" data-offset-key="20428:0" data-first-offset="true"><span data-slate-string="true"> 用户，</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20429"><span data-slate-object="text" data-key="20430"><span data-slate-leaf="true" data-offset-key="20430:0" data-first-offset="true"><span data-slate-string="true">root</span></span></span></span><span data-slate-object="text" data-key="20431"><span data-slate-leaf="true" data-offset-key="20431:0" data-first-offset="true"><span data-slate-string="true"> 用户显然是没有安装</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20432"><span data-slate-object="text" data-key="20433"><span data-slate-leaf="true" data-offset-key="20433:0" data-first-offset="true"><span data-slate-string="true"> go</span></span></span></span><span data-slate-object="text" data-key="20434"><span data-slate-leaf="true" data-offset-key="20434:0" data-first-offset="true"><span data-slate-string="true"> 命令的，所以会导致</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20435"><span data-slate-object="text" data-key="20436"><span data-slate-leaf="true" data-offset-key="20436:0" data-first-offset="true"><span data-slate-string="true"> command not found</span></span></span></span><span data-slate-object="text" data-key="20437"><span data-slate-leaf="true" data-offset-key="20437:0" data-first-offset="true"><span data-slate-string="true"> 错误。解决方式是去掉 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20438"><span data-slate-object="text" data-key="20439"><span data-slate-leaf="true" data-offset-key="20439:0" data-first-offset="true"><span data-slate-string="true">sudo</span></span></span></span><span data-slate-object="text" data-key="20440"><span data-slate-leaf="true" data-offset-key="20440:0" data-first-offset="true"><span data-slate-string="true"> ，直接执行 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20441"><span data-slate-object="text" data-key="20442"><span data-slate-leaf="true" data-offset-key="20442:0" data-first-offset="true"><span data-slate-string="true">$ go get -u xxx</span></span></span></span><span data-slate-object="text" data-key="20443"><span data-slate-leaf="true" data-offset-key="20443:0" data-first-offset="true"><span data-slate-string="true"> 。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20444"><span data-slate-object="text" data-key="20445"><span data-slate-leaf="true" data-offset-key="20445:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题四：</span></span></span></span><span data-slate-object="text" data-key="20446"><span data-slate-leaf="true" data-offset-key="20446:0" data-first-offset="true"><span data-slate-string="true">VimIDE 使用过程中，报各类错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20447"><span data-slate-object="text" data-key="20448"><span data-slate-leaf="true" data-offset-key="20448:0" data-first-offset="true"><span data-slate-string="true">这里的报错原因跟环境有关系，安装 VimIDE 时的系统环境、包的版本等等，都可能会导致使用 VimIDE 报错。因为错误类型太多，没法一一说明，所以我建议你忽略这些错误，其实完全不影响后面的学习。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20449"><span data-slate-object="text" data-key="20450"><span data-slate-leaf="true" data-offset-key="20450:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题五：</span></span></span></span><span data-slate-object="text" data-key="20451"><span data-slate-leaf="true" data-offset-key="20451:0" data-first-offset="true"><span data-slate-string="true">访问 iam-authz-server 的</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20452"><span data-slate-object="text" data-key="20453"><span data-slate-leaf="true" data-offset-key="20453:0" data-first-offset="true"><span data-slate-string="true"> /v1/authz</span></span></span></span><span data-slate-object="text" data-key="20454"><span data-slate-leaf="true" data-offset-key="20454:0" data-first-offset="true"><span data-slate-string="true"> 接口报</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20455"><span data-slate-object="text" data-key="20456"><span data-slate-leaf="true" data-offset-key="20456:0" data-first-offset="true"><span data-slate-string="true"> {"code":100202,"message":"Signature is invalid"}</span></span></span></span><span data-slate-object="text" data-key="20457"><span data-slate-leaf="true" data-offset-key="20457:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20458"><span data-slate-object="text" data-key="20459"><span data-slate-leaf="true" data-offset-key="20459:0" data-first-offset="true"><span data-slate-string="true">这时可能是签发的 Token 有问题，建议重新执行以下 5 个步骤：</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20460"><div data-slate-type="list-line" data-slate-object="block" data-key="20461"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="20462"><span data-slate-leaf="true" data-offset-key="20462:0" data-first-offset="true"><span data-slate-string="true">重新登陆系统，并获取访问令牌：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20463"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20464"><span data-slate-object="text" data-key="20465"><span data-slate-leaf="true" data-offset-key="20465:0" data-first-offset="true"><span data-slate-string="true">$ token=`curl -s -XPOST -H</span></span></span><span data-slate-object="text" data-key="20466"><span data-slate-leaf="true" data-offset-key="20466:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Content-Type: application/json'</span></span></span></span><span data-slate-object="text" data-key="20467"><span data-slate-leaf="true" data-offset-key="20467:0" data-first-offset="true"><span data-slate-string="true"> -d</span></span></span><span data-slate-object="text" data-key="20468"><span data-slate-leaf="true" data-offset-key="20468:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"username":"admin","password":"Admin@2021"}'</span></span></span></span><span data-slate-object="text" data-key="20469"><span data-slate-leaf="true" data-offset-key="20469:0" data-first-offset="true"><span data-slate-string="true"> http://127.0.0.1:8080/login | jq -r .token`</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20470"><span data-slate-object="text" data-key="20471"><span data-slate-leaf="true" data-offset-key="20471:0" data-first-offset="true"><span data-slate-string="true">如果没有安装</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20472"><span data-slate-object="text" data-key="20473"><span data-slate-leaf="true" data-offset-key="20473:0" data-first-offset="true"><span data-slate-string="true"> jq</span></span></span></span><span data-slate-object="text" data-key="20474"><span data-slate-leaf="true" data-offset-key="20474:0" data-first-offset="true"><span data-slate-string="true"> 命令，可以执行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20475"><span data-slate-object="text" data-key="20476"><span data-slate-leaf="true" data-offset-key="20476:0" data-first-offset="true"><span data-slate-string="true"> sudo yum -y install jq</span></span></span></span><span data-slate-object="text" data-key="20477"><span data-slate-leaf="true" data-offset-key="20477:0" data-first-offset="true"><span data-slate-string="true"> 命令来安装。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20478"><div data-slate-type="list-line" data-slate-object="block" data-key="20479"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="20480"><span data-slate-leaf="true" data-offset-key="20480:0" data-first-offset="true"><span data-slate-string="true">创建授权策略：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20481"><div><span></span></div><div><div data-code-line-number="1"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20482"><span data-slate-object="text" data-key="20483"><span data-slate-leaf="true" data-offset-key="20483:0" data-first-offset="true"><span data-slate-string="true">$ curl -s -XPOST -H</span></span></span><span data-slate-object="text" data-key="20484"><span data-slate-leaf="true" data-offset-key="20484:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Content-Type: application/json"</span></span></span></span><span data-slate-object="text" data-key="20485"><span data-slate-leaf="true" data-offset-key="20485:0" data-first-offset="true"><span data-slate-string="true"> -H</span></span></span><span data-slate-object="text" data-key="20486"><span data-slate-leaf="true" data-offset-key="20486:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization: Bearer </span></span></span></span><span data-slate-object="text" data-key="20487"><span data-slate-leaf="true" data-offset-key="20487:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$token</span></span></span></span></span><span data-slate-object="text" data-key="20488"><span data-slate-leaf="true" data-offset-key="20488:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"</span></span></span></span><span data-slate-object="text" data-key="20489"><span data-slate-leaf="true" data-offset-key="20489:0" data-first-offset="true"><span data-slate-string="true"> -d</span></span></span><span data-slate-object="text" data-key="20490"><span data-slate-leaf="true" data-offset-key="20490:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"metadata":{"name":"authztest"},"policy":{"description":"One policy to rule them all.","subjects":["users:&lt;peter|ken&gt;","users:maria","groups:admins"],"actions":["delete","&lt;create|update&gt;"],"effect":"allow","resources":["resources:articles:&lt;.*&gt;","resources:printer"],"conditions":{"remoteIPAddress":{"type":"CIDRCondition","options":{"cidr":"192.168.0.1/16"}}}}}'</span></span></span></span><span data-slate-object="text" data-key="20491"><span data-slate-leaf="true" data-offset-key="20491:0" data-first-offset="true"><span data-slate-string="true"> http://127.0.0.1:8080/v1/policies</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="20492"><div data-slate-type="list-line" data-slate-object="block" data-key="20493"><div data-code-line-number="3"></div><div><span data-slate-object="text" data-key="20494"><span data-slate-leaf="true" data-offset-key="20494:0" data-first-offset="true"><span data-slate-string="true">创建密钥，并从命令的输出中提取 secretID 和 secretKey：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20495"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20496"><span data-slate-object="text" data-key="20497"><span data-slate-leaf="true" data-offset-key="20497:0" data-first-offset="true"><span data-slate-string="true">$ curl -s -XPOST -H</span></span></span><span data-slate-object="text" data-key="20498"><span data-slate-leaf="true" data-offset-key="20498:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Content-Type: application/json"</span></span></span></span><span data-slate-object="text" data-key="20499"><span data-slate-leaf="true" data-offset-key="20499:0" data-first-offset="true"><span data-slate-string="true"> -H</span></span></span><span data-slate-object="text" data-key="20500"><span data-slate-leaf="true" data-offset-key="20500:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"Authorization: Bearer </span></span></span></span><span data-slate-object="text" data-key="20501"><span data-slate-leaf="true" data-offset-key="20501:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$token</span></span></span></span></span><span data-slate-object="text" data-key="20502"><span data-slate-leaf="true" data-offset-key="20502:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"</span></span></span></span><span data-slate-object="text" data-key="20503"><span data-slate-leaf="true" data-offset-key="20503:0" data-first-offset="true"><span data-slate-string="true"> -d</span></span></span><span data-slate-object="text" data-key="20504"><span data-slate-leaf="true" data-offset-key="20504:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"metadata":{"name":"authztest"},"expires":0,"description":"admin secret"}'</span></span></span></span><span data-slate-object="text" data-key="20505"><span data-slate-leaf="true" data-offset-key="20505:0" data-first-offset="true"><span data-slate-string="true"> http://127.0.0.1:8080/v1/secrets</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20506"><span data-slate-object="text" data-key="20507"><span data-slate-leaf="true" data-offset-key="20507:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="20508"><span data-slate-leaf="true" data-offset-key="20508:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"metadata"</span></span></span></span><span data-slate-object="text" data-key="20509"><span data-slate-leaf="true" data-offset-key="20509:0" data-first-offset="true"><span data-slate-string="true">:{</span></span></span><span data-slate-object="text" data-key="20510"><span data-slate-leaf="true" data-offset-key="20510:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"id"</span></span></span></span><span data-slate-object="text" data-key="20511"><span data-slate-leaf="true" data-offset-key="20511:0" data-first-offset="true"><span data-slate-string="true">:23,</span></span></span><span data-slate-object="text" data-key="20512"><span data-slate-leaf="true" data-offset-key="20512:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"name"</span></span></span></span><span data-slate-object="text" data-key="20513"><span data-slate-leaf="true" data-offset-key="20513:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20514"><span data-slate-leaf="true" data-offset-key="20514:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"authztest"</span></span></span></span><span data-slate-object="text" data-key="20515"><span data-slate-leaf="true" data-offset-key="20515:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="20516"><span data-slate-leaf="true" data-offset-key="20516:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"createdAt"</span></span></span></span><span data-slate-object="text" data-key="20517"><span data-slate-leaf="true" data-offset-key="20517:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20518"><span data-slate-leaf="true" data-offset-key="20518:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"2021-04-08T07:24:50.071671422+08:00"</span></span></span></span><span data-slate-object="text" data-key="20519"><span data-slate-leaf="true" data-offset-key="20519:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="20520"><span data-slate-leaf="true" data-offset-key="20520:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"updatedAt"</span></span></span></span><span data-slate-object="text" data-key="20521"><span data-slate-leaf="true" data-offset-key="20521:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20522"><span data-slate-leaf="true" data-offset-key="20522:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"2021-04-08T07:24:50.071671422+08:00"</span></span></span></span><span data-slate-object="text" data-key="20523"><span data-slate-leaf="true" data-offset-key="20523:0" data-first-offset="true"><span data-slate-string="true">},</span></span></span><span data-slate-object="text" data-key="20524"><span data-slate-leaf="true" data-offset-key="20524:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"username"</span></span></span></span><span data-slate-object="text" data-key="20525"><span data-slate-leaf="true" data-offset-key="20525:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20526"><span data-slate-leaf="true" data-offset-key="20526:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"admin"</span></span></span></span><span data-slate-object="text" data-key="20527"><span data-slate-leaf="true" data-offset-key="20527:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="20528"><span data-slate-leaf="true" data-offset-key="20528:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"secretID"</span></span></span></span><span data-slate-object="text" data-key="20529"><span data-slate-leaf="true" data-offset-key="20529:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20530"><span data-slate-leaf="true" data-offset-key="20530:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"ZuxvXNfG08BdEMqkTaP41L2DLArlE6Jpqoox"</span></span></span></span><span data-slate-object="text" data-key="20531"><span data-slate-leaf="true" data-offset-key="20531:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="20532"><span data-slate-leaf="true" data-offset-key="20532:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"secretKey"</span></span></span></span><span data-slate-object="text" data-key="20533"><span data-slate-leaf="true" data-offset-key="20533:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20534"><span data-slate-leaf="true" data-offset-key="20534:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"7Sfa5EfAPIwcTLGCfSvqLf0zZGCjF3l8"</span></span></span></span><span data-slate-object="text" data-key="20535"><span data-slate-leaf="true" data-offset-key="20535:0" data-first-offset="true"><span data-slate-string="true">,</span></span></span><span data-slate-object="text" data-key="20536"><span data-slate-leaf="true" data-offset-key="20536:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"expires"</span></span></span></span><span data-slate-object="text" data-key="20537"><span data-slate-leaf="true" data-offset-key="20537:0" data-first-offset="true"><span data-slate-string="true">:0,</span></span></span><span data-slate-object="text" data-key="20538"><span data-slate-leaf="true" data-offset-key="20538:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"description"</span></span></span></span><span data-slate-object="text" data-key="20539"><span data-slate-leaf="true" data-offset-key="20539:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20540"><span data-slate-leaf="true" data-offset-key="20540:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"admin secret"</span></span></span></span><span data-slate-object="text" data-key="20541"><span data-slate-leaf="true" data-offset-key="20541:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="20542"><div data-slate-type="list-line" data-slate-object="block" data-key="20543"><div data-code-line-number="4"></div><div><span data-slate-object="text" data-key="20544"><span data-slate-leaf="true" data-offset-key="20544:0" data-first-offset="true"><span data-slate-string="true">生成访问 iam-authz-server 的 Token</span></span></span></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20545"><span data-slate-object="text" data-key="20546"><span data-slate-leaf="true" data-offset-key="20546:0" data-first-offset="true"><span data-slate-string="true">iamctl 提供了 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20547"><span data-slate-object="text" data-key="20548"><span data-slate-leaf="true" data-offset-key="20548:0" data-first-offset="true"><span data-slate-string="true">jwt sigin</span></span></span></span><span data-slate-object="text" data-key="20549"><span data-slate-leaf="true" data-offset-key="20549:0" data-first-offset="true"><span data-slate-string="true"> 命令，你可以根据 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20550"><span data-slate-object="text" data-key="20551"><span data-slate-leaf="true" data-offset-key="20551:0" data-first-offset="true"><span data-slate-string="true">secretID</span></span></span></span><span data-slate-object="text" data-key="20552"><span data-slate-leaf="true" data-offset-key="20552:0" data-first-offset="true"><span data-slate-string="true"> 和 </span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20553"><span data-slate-object="text" data-key="20554"><span data-slate-leaf="true" data-offset-key="20554:0" data-first-offset="true"><span data-slate-string="true">secretKey</span></span></span></span><span data-slate-object="text" data-key="20555"><span data-slate-leaf="true" data-offset-key="20555:0" data-first-offset="true"><span data-slate-string="true"> 签发 Token，方便你使用。签发 Token 的具体命令如下：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20556"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20557"><span data-slate-object="text" data-key="20558"><span data-slate-leaf="true" data-offset-key="20558:0" data-first-offset="true"><span data-slate-string="true">$ iamctl jwt sign ZuxvXNfG08BdEMqkTaP41L2DLArlE6Jpqoox 7Sfa5EfAPIwcTLGCfSvqLf0zZGCjF3l8 </span></span></span><span data-slate-object="text" data-key="20559"><span data-slate-leaf="true" data-offset-key="20559:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true"># iamctl jwt sign $secretID $secretKey</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20560"><span data-slate-object="text" data-key="20561"><span data-slate-leaf="true" data-offset-key="20561:0" data-first-offset="true"><span data-slate-string="true">eyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="list" data-slate-object="block" data-key="20562"><div data-slate-type="list-line" data-slate-object="block" data-key="20563"><div data-code-line-number="5"></div><div><span data-slate-object="text" data-key="20564"><span data-slate-leaf="true" data-offset-key="20564:0" data-first-offset="true"><span data-slate-string="true">测试资源授权是否通过：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20565"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20566"><span data-slate-object="text" data-key="20567"><span data-slate-leaf="true" data-offset-key="20567:0" data-first-offset="true"><span data-slate-string="true">$ curl -s -XPOST -H</span></span></span><span data-slate-object="text" data-key="20568"><span data-slate-leaf="true" data-offset-key="20568:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Content-Type: application/json'</span></span></span></span><span data-slate-object="text" data-key="20569"><span data-slate-leaf="true" data-offset-key="20569:0" data-first-offset="true"><span data-slate-string="true"> -H</span></span></span><span data-slate-object="text" data-key="20570"><span data-slate-leaf="true" data-offset-key="20570:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ'</span></span></span></span><span data-slate-object="text" data-key="20571"><span data-slate-leaf="true" data-offset-key="20571:0" data-first-offset="true"><span data-slate-string="true"> -d</span></span></span><span data-slate-object="text" data-key="20572"><span data-slate-leaf="true" data-offset-key="20572:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"subject":"users:maria","action":"delete","resource":"resources:articles:ladon-introduction","context":{"remoteIPAddress":"192.168.0.5"}}'</span></span></span></span><span data-slate-object="text" data-key="20573"><span data-slate-leaf="true" data-offset-key="20573:0" data-first-offset="true"><span data-slate-string="true"> http://127.0.0.1:9090/v1/authz</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20574"><span data-slate-object="text" data-key="20575"><span data-slate-leaf="true" data-offset-key="20575:0" data-first-offset="true"><span data-slate-string="true">{</span></span></span><span data-slate-object="text" data-key="20576"><span data-slate-leaf="true" data-offset-key="20576:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">"allowed"</span></span></span></span><span data-slate-object="text" data-key="20577"><span data-slate-leaf="true" data-offset-key="20577:0" data-first-offset="true"><span data-slate-string="true">:</span></span></span><span data-slate-object="text" data-key="20578"><span data-slate-leaf="true" data-offset-key="20578:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">true</span></span></span></span><span data-slate-object="text" data-key="20579"><span data-slate-leaf="true" data-offset-key="20579:0" data-first-offset="true"><span data-slate-string="true">}</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20580"><span data-slate-object="text" data-key="20581"><span data-slate-leaf="true" data-offset-key="20581:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题六：</span></span></span></span><span data-slate-object="text" data-key="20582"><span data-slate-leaf="true" data-offset-key="20582:0" data-first-offset="true"><span data-slate-string="true">执行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20583"><span data-slate-object="text" data-key="20584"><span data-slate-leaf="true" data-offset-key="20584:0" data-first-offset="true"><span data-slate-string="true"> iamctl user list</span></span></span></span><span data-slate-object="text" data-key="20585"><span data-slate-leaf="true" data-offset-key="20585:0" data-first-offset="true"><span data-slate-string="true"> 报</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20586"><span data-slate-object="text" data-key="20587"><span data-slate-leaf="true" data-offset-key="20587:0" data-first-offset="true"><span data-slate-string="true"> error: {"code":100207,"message":"Permission denied"}</span></span></span></span><span data-slate-object="text" data-key="20588"><span data-slate-leaf="true" data-offset-key="20588:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20589"><span data-slate-object="text" data-key="20590"><span data-slate-leaf="true" data-offset-key="20590:0" data-first-offset="true"><span data-slate-string="true">出现这种情况，可能是密码没有配置正确。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20591"><span data-slate-object="text" data-key="20592"><span data-slate-leaf="true" data-offset-key="20592:0" data-first-offset="true"><span data-slate-string="true">你可以看下</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20593"><span data-slate-object="text" data-key="20594"><span data-slate-leaf="true" data-offset-key="20594:0" data-first-offset="true"><span data-slate-string="true"> $HOME/.iam/iamctl.yaml</span></span></span></span><span data-slate-object="text" data-key="20595"><span data-slate-leaf="true" data-offset-key="20595:0" data-first-offset="true"><span data-slate-string="true"> 配置文件中的用户名和密码配置的是不是 admin，以及 admin 的密码是否是</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20596"><span data-slate-object="text" data-key="20597"><span data-slate-leaf="true" data-offset-key="20597:0" data-first-offset="true"><span data-slate-string="true"> Admin@2021</span></span></span></span><span data-slate-object="text" data-key="20598"><span data-slate-leaf="true" data-offset-key="20598:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20599"><span data-slate-object="text" data-key="20600"><span data-slate-leaf="true" data-offset-key="20600:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题七：</span></span></span></span><span data-slate-object="text" data-key="20601"><span data-slate-leaf="true" data-offset-key="20601:0" data-first-offset="true"><span data-slate-string="true">在创建用户时报</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20602"><span data-slate-object="text" data-key="20603"><span data-slate-leaf="true" data-offset-key="20603:0" data-first-offset="true"><span data-slate-string="true"> {"code":100101,"message":"Database error"}</span></span></span></span><span data-slate-object="text" data-key="20604"><span data-slate-leaf="true" data-offset-key="20604:0" data-first-offset="true"><span data-slate-string="true"> 错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20605"><span data-slate-object="text" data-key="20606"><span data-slate-leaf="true" data-offset-key="20606:0" data-first-offset="true"><span data-slate-string="true">出现这种情况，可能是用户名重了，建议换个新的用户名再次创建。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20607"><span data-slate-object="text" data-key="20608"><span data-slate-leaf="true" data-offset-key="20608:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题八：</span></span></span></span><span data-slate-object="text" data-key="20609"><span data-slate-leaf="true" data-offset-key="20609:0" data-first-offset="true"><span data-slate-string="true">报</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20610"><span data-slate-object="text" data-key="20611"><span data-slate-leaf="true" data-offset-key="20611:0" data-first-offset="true"><span data-slate-string="true"> No such file or directory</span></span></span></span><span data-slate-object="text" data-key="20612"><span data-slate-leaf="true" data-offset-key="20612:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20613"><span data-slate-object="text" data-key="20614"><span data-slate-leaf="true" data-offset-key="20614:0" data-first-offset="true"><span data-slate-string="true">command not found</span></span></span></span><span data-slate-object="text" data-key="20615"><span data-slate-leaf="true" data-offset-key="20615:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20616"><span data-slate-object="text" data-key="20617"><span data-slate-leaf="true" data-offset-key="20617:0" data-first-offset="true"><span data-slate-string="true">permission denied</span></span></span></span><span data-slate-object="text" data-key="20618"><span data-slate-leaf="true" data-offset-key="20618:0" data-first-offset="true"><span data-slate-string="true"> 错误。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20619"><span data-slate-object="text" data-key="20620"><span data-slate-leaf="true" data-offset-key="20620:0" data-first-offset="true"><span data-slate-string="true">遇到这类错误，要根据提示排查和解决问题。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20621"><div data-slate-type="list-line" data-slate-object="block" data-key="20622"><span data-slate-type="code" data-slate-object="inline" data-key="20623"><span data-slate-object="text" data-key="20624"><span data-slate-leaf="true" data-offset-key="20624:0" data-first-offset="true"><span data-slate-string="true">No such file or directory</span></span></span></span><span data-slate-object="text" data-key="20625"><span data-slate-leaf="true" data-offset-key="20625:0" data-first-offset="true"><span data-slate-string="true">：确认文件是否存在，不存在的原因是什么。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20626"><span data-slate-type="code" data-slate-object="inline" data-key="20627"><span data-slate-object="text" data-key="20628"><span data-slate-leaf="true" data-offset-key="20628:0" data-first-offset="true"><span data-slate-string="true">command not found</span></span></span></span><span data-slate-object="text" data-key="20629"><span data-slate-leaf="true" data-offset-key="20629:0" data-first-offset="true"><span data-slate-string="true">：确认命令是否存在，如果不存在，可以重新安装命令。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20630"><span data-slate-type="code" data-slate-object="inline" data-key="20631"><span data-slate-object="text" data-key="20632"><span data-slate-leaf="true" data-offset-key="20632:0" data-first-offset="true"><span data-slate-string="true">permission denied</span></span></span></span><span data-slate-object="text" data-key="20633"><span data-slate-leaf="true" data-offset-key="20633:0" data-first-offset="true"><span data-slate-string="true">：确认是否有操作权限，如果没有，要切换到有权限的用户或者目录。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20634"><span data-slate-object="text" data-key="20635"><span data-slate-leaf="true" data-offset-key="20635:0" data-first-offset="true"><span data-slate-type="bold" data-slate-object="mark"><span data-slate-string="true">问题九：</span></span></span></span><span data-slate-object="text" data-key="20636"><span data-slate-leaf="true" data-offset-key="20636:0" data-first-offset="true"><span data-slate-string="true">报</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20637"><span data-slate-object="text" data-key="20638"><span data-slate-leaf="true" data-offset-key="20638:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver.service</span></span></span></span><span data-slate-object="text" data-key="20639"><span data-slate-leaf="true" data-offset-key="20639:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20640"><span data-slate-object="text" data-key="20641"><span data-slate-leaf="true" data-offset-key="20641:0" data-first-offset="true"><span data-slate-string="true">/opt/iam/bin/iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="20642"><span data-slate-leaf="true" data-offset-key="20642:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20643"><span data-slate-object="text" data-key="20644"><span data-slate-leaf="true" data-offset-key="20644:0" data-first-offset="true"><span data-slate-string="true">/etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="20645"><span data-slate-leaf="true" data-offset-key="20645:0" data-first-offset="true"><span data-slate-string="true"> 文件不存在。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20646"><span data-slate-object="text" data-key="20647"><span data-slate-leaf="true" data-offset-key="20647:0" data-first-offset="true"><span data-slate-string="true">我来介绍下这些文件的作用。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20648"><div data-slate-type="list-line" data-slate-object="block" data-key="20649"><span data-slate-type="code" data-slate-object="inline" data-key="20650"><span data-slate-object="text" data-key="20651"><span data-slate-leaf="true" data-offset-key="20651:0" data-first-offset="true"><span data-slate-string="true">/etc/systemd/system/iam-apiserver.service</span></span></span></span><span data-slate-object="text" data-key="20652"><span data-slate-leaf="true" data-offset-key="20652:0" data-first-offset="true"><span data-slate-string="true">：iam-apiserver 的 sysmted Unit 文件。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20653"><span data-slate-type="code" data-slate-object="inline" data-key="20654"><span data-slate-object="text" data-key="20655"><span data-slate-leaf="true" data-offset-key="20655:0" data-first-offset="true"><span data-slate-string="true">/opt/iam/bin/iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="20656"><span data-slate-leaf="true" data-offset-key="20656:0" data-first-offset="true"><span data-slate-string="true">：iam-apiserver 的二进制启动命令。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20657"><span data-slate-type="code" data-slate-object="inline" data-key="20658"><span data-slate-object="text" data-key="20659"><span data-slate-leaf="true" data-offset-key="20659:0" data-first-offset="true"><span data-slate-string="true">/etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="20660"><span data-slate-leaf="true" data-offset-key="20660:0" data-first-offset="true"><span data-slate-string="true">：iam-apiserver 的配置文件。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20661"><span data-slate-object="text" data-key="20662"><span data-slate-leaf="true" data-offset-key="20662:0" data-first-offset="true"><span data-slate-string="true">如果某个文件不存在，那就需要你重新安装这些文件。我来分别介绍这三个文件的安装方法。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20663"><span data-slate-type="code" data-slate-object="inline" data-key="20664"><span data-slate-object="text" data-key="20665"><span data-slate-leaf="true" data-offset-key="20665:0" data-first-offset="true"><span data-slate-string="true">/etc/systemd/system/iam-apiserver.service</span></span></span></span><span data-slate-object="text" data-key="20666"><span data-slate-leaf="true" data-offset-key="20666:0" data-first-offset="true"><span data-slate-string="true"> 安装方法：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20667"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20668"><span data-slate-object="text" data-key="20669"><span data-slate-leaf="true" data-offset-key="20669:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20670"><span data-slate-leaf="true" data-offset-key="20670:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="20671"><span data-slate-leaf="true" data-offset-key="20671:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20672"><span data-slate-leaf="true" data-offset-key="20672:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$IAM_ROOT</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20673"><span data-slate-object="text" data-key="20674"><span data-slate-leaf="true" data-offset-key="20674:0" data-first-offset="true"><span data-slate-string="true">$ ./scripts/genconfig.sh scripts/install/environment.sh init/iam-apiserver.service &gt; iam-apiserver.service</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20675"><span data-slate-object="text" data-key="20676"><span data-slate-leaf="true" data-offset-key="20676:0" data-first-offset="true"><span data-slate-string="true">$ sudo </span></span></span><span data-slate-object="text" data-key="20677"><span data-slate-leaf="true" data-offset-key="20677:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">mv</span></span></span></span><span data-slate-object="text" data-key="20678"><span data-slate-leaf="true" data-offset-key="20678:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver.service /etc/systemd/system/</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20679"><span data-slate-type="code" data-slate-object="inline" data-key="20680"><span data-slate-object="text" data-key="20681"><span data-slate-leaf="true" data-offset-key="20681:0" data-first-offset="true"><span data-slate-string="true">/opt/iam/bin/iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="20682"><span data-slate-leaf="true" data-offset-key="20682:0" data-first-offset="true"><span data-slate-string="true"> 安装方法：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20683"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div><div data-code-line-number="4"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20684"><span data-slate-object="text" data-key="20685"><span data-slate-leaf="true" data-offset-key="20685:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20686"><span data-slate-leaf="true" data-offset-key="20686:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="20687"><span data-slate-leaf="true" data-offset-key="20687:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20688"><span data-slate-leaf="true" data-offset-key="20688:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$IAM_ROOT</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20689"><span data-slate-object="text" data-key="20690"><span data-slate-leaf="true" data-offset-key="20690:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20691"><span data-slate-leaf="true" data-offset-key="20691:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">source</span></span></span></span><span data-slate-object="text" data-key="20692"><span data-slate-leaf="true" data-offset-key="20692:0" data-first-offset="true"><span data-slate-string="true"> scripts/install/environment.sh</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20693"><span data-slate-object="text" data-key="20694"><span data-slate-leaf="true" data-offset-key="20694:0" data-first-offset="true"><span data-slate-string="true">$ make build BINS=iam-apiserver</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20695"><span data-slate-object="text" data-key="20696"><span data-slate-leaf="true" data-offset-key="20696:0" data-first-offset="true"><span data-slate-string="true">$ sudo </span></span></span><span data-slate-object="text" data-key="20697"><span data-slate-leaf="true" data-offset-key="20697:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cp</span></span></span></span><span data-slate-object="text" data-key="20698"><span data-slate-leaf="true" data-offset-key="20698:0" data-first-offset="true"><span data-slate-string="true"> _output/platforms/linux/amd64/iam-apiserver </span></span></span><span data-slate-object="text" data-key="20699"><span data-slate-leaf="true" data-offset-key="20699:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">${IAM_INSTALL_DIR}</span></span></span></span><span data-slate-object="text" data-key="20700"><span data-slate-leaf="true" data-offset-key="20700:0" data-first-offset="true"><span data-slate-string="true">/bin</span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20701"><span data-slate-type="code" data-slate-object="inline" data-key="20702"><span data-slate-object="text" data-key="20703"><span data-slate-leaf="true" data-offset-key="20703:0" data-first-offset="true"><span data-slate-string="true">/etc/iam/iam-apiserver.yaml</span></span></span></span><span data-slate-object="text" data-key="20704"><span data-slate-leaf="true" data-offset-key="20704:0" data-first-offset="true"><span data-slate-string="true"> 安装方法：</span></span></span></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20705"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div><div data-code-line-number="3"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20706"><span data-slate-object="text" data-key="20707"><span data-slate-leaf="true" data-offset-key="20707:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20708"><span data-slate-leaf="true" data-offset-key="20708:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">cd</span></span></span></span><span data-slate-object="text" data-key="20709"><span data-slate-leaf="true" data-offset-key="20709:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20710"><span data-slate-leaf="true" data-offset-key="20710:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$IAM_ROOT</span></span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20711"><span data-slate-object="text" data-key="20712"><span data-slate-leaf="true" data-offset-key="20712:0" data-first-offset="true"><span data-slate-string="true">$ ./scripts/genconfig.sh scripts/install/environment.sh configs/iam-apiserver.yaml &gt; iam-apiserver.yaml</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20713"><span data-slate-object="text" data-key="20714"><span data-slate-leaf="true" data-offset-key="20714:0" data-first-offset="true"><span data-slate-string="true">$ sudo </span></span></span><span data-slate-object="text" data-key="20715"><span data-slate-leaf="true" data-offset-key="20715:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">mv</span></span></span></span><span data-slate-object="text" data-key="20716"><span data-slate-leaf="true" data-offset-key="20716:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver.yaml </span></span></span><span data-slate-object="text" data-key="20717"><span data-slate-leaf="true" data-offset-key="20717:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">${IAM_CONFIG_DIR}</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><h2 data-slate-type="heading" data-slate-object="block" data-key="20718" id="sr-toc-10"><span data-slate-object="text" data-key="20719"><span data-slate-leaf="true" data-offset-key="20719:0" data-first-offset="true"><span data-slate-string="true">总结</span></span></span></h2><div data-slate-type="paragraph" data-slate-object="block" data-key="20720"><span data-slate-object="text" data-key="20721"><span data-slate-leaf="true" data-offset-key="20721:0" data-first-offset="true"><span data-slate-string="true">这一讲，我以</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20722"><span data-slate-object="text" data-key="20723"><span data-slate-leaf="true" data-offset-key="20723:0" data-first-offset="true"><span data-slate-string="true"> iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="20724"><span data-slate-leaf="true" data-offset-key="20724:0" data-first-offset="true"><span data-slate-string="true"> 服务为例，向你介绍了排障的基本流程：发现问题 -&gt; 定位问题 -&gt; 解决问题。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20725"><span data-slate-object="text" data-key="20726"><span data-slate-leaf="true" data-offset-key="20726:0" data-first-offset="true"><span data-slate-string="true">你可以通过三种方式来发现问题。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20727"><div data-slate-type="list-line" data-slate-object="block" data-key="20728"><span data-slate-object="text" data-key="20729"><span data-slate-leaf="true" data-offset-key="20729:0" data-first-offset="true"><span data-slate-string="true">检查服务状态：启动 iam-apiserver 服务后，执行</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20730"><span data-slate-object="text" data-key="20731"><span data-slate-leaf="true" data-offset-key="20731:0" data-first-offset="true"><span data-slate-string="true"> systemctl status iam-apiserver</span></span></span></span><span data-slate-object="text" data-key="20732"><span data-slate-leaf="true" data-offset-key="20732:0" data-first-offset="true"><span data-slate-string="true"> 发现 iam-apiserver 启动失败，即</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20733"><span data-slate-object="text" data-key="20734"><span data-slate-leaf="true" data-offset-key="20734:0" data-first-offset="true"><span data-slate-string="true"> Active</span></span></span></span><span data-slate-object="text" data-key="20735"><span data-slate-leaf="true" data-offset-key="20735:0" data-first-offset="true"><span data-slate-string="true"> 的值不为</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20736"><span data-slate-object="text" data-key="20737"><span data-slate-leaf="true" data-offset-key="20737:0" data-first-offset="true"><span data-slate-string="true"> active (running)</span></span></span></span><span data-slate-object="text" data-key="20738"><span data-slate-leaf="true" data-offset-key="20738:0" data-first-offset="true"><span data-slate-string="true">。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20739"><span data-slate-object="text" data-key="20740"><span data-slate-leaf="true" data-offset-key="20740:0" data-first-offset="true"><span data-slate-string="true">功能异常：访问 iam-apiserver 服务，功能异常或者报错，例如接口返回值跟预期不一样；接口报错。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20741"><span data-slate-object="text" data-key="20742"><span data-slate-leaf="true" data-offset-key="20742:0" data-first-offset="true"><span data-slate-string="true">日志报错：在 iam-apiserver 的日志中发现一些</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20743"><span data-slate-object="text" data-key="20744"><span data-slate-leaf="true" data-offset-key="20744:0" data-first-offset="true"><span data-slate-string="true"> WARN</span></span></span></span><span data-slate-object="text" data-key="20745"><span data-slate-leaf="true" data-offset-key="20745:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20746"><span data-slate-object="text" data-key="20747"><span data-slate-leaf="true" data-offset-key="20747:0" data-first-offset="true"><span data-slate-string="true">ERROR</span></span></span></span><span data-slate-object="text" data-key="20748"><span data-slate-leaf="true" data-offset-key="20748:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20749"><span data-slate-object="text" data-key="20750"><span data-slate-leaf="true" data-offset-key="20750:0" data-first-offset="true"><span data-slate-string="true">PANIC</span></span></span></span><span data-slate-object="text" data-key="20751"><span data-slate-leaf="true" data-offset-key="20751:0" data-first-offset="true"><span data-slate-string="true">、</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20752"><span data-slate-object="text" data-key="20753"><span data-slate-leaf="true" data-offset-key="20753:0" data-first-offset="true"><span data-slate-string="true">FATAL</span></span></span></span><span data-slate-object="text" data-key="20754"><span data-slate-leaf="true" data-offset-key="20754:0" data-first-offset="true"><span data-slate-string="true"> 等高级别的错误日志。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20755"><span data-slate-object="text" data-key="20756"><span data-slate-leaf="true" data-offset-key="20756:0" data-first-offset="true"><span data-slate-string="true">发现问题之后，你可以通过查看日志、使用 Go 调试工具 Delve 和添加 Debug 日志这三种方式来定位问题。</span></span></span></div><div data-slate-type="list" data-slate-object="block" data-key="20757"><div data-slate-type="list-line" data-slate-object="block" data-key="20758"><span data-slate-object="text" data-key="20759"><span data-slate-leaf="true" data-offset-key="20759:0" data-first-offset="true"><span data-slate-string="true">查看日志：查看日志是最简单的排障方式。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20760"><span data-slate-object="text" data-key="20761"><span data-slate-leaf="true" data-offset-key="20761:0" data-first-offset="true"><span data-slate-string="true">使用 Go 调试工具 Delve 来定位问题。</span></span></span></div><div data-slate-type="list-line" data-slate-object="block" data-key="20762"><span data-slate-object="text" data-key="20763"><span data-slate-leaf="true" data-offset-key="20763:0" data-first-offset="true"><span data-slate-string="true">添加 Debug 日志：从程序入口处跟读代码，在关键位置处打印 Debug 日志，来定位问题。</span></span></span></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20764"><span data-slate-object="text" data-key="20765"><span data-slate-leaf="true" data-offset-key="20765:0" data-first-offset="true"><span data-slate-string="true">找到问题根因之后，就要解决问题。你需要根据自己对业务、底层代码实现的掌握和理解，解决这个问题。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20766"><span data-slate-object="text" data-key="20767"><span data-slate-leaf="true" data-offset-key="20767:0" data-first-offset="true"><span data-slate-string="true">最后，我向你展示了 9 个在部署和使用 IAM 系统时容易遇到的问题，并提供了解决方法，希望能给你一些切实的帮助。</span></span></span></div><h2 data-slate-type="heading" data-slate-object="block" data-key="20768" id="sr-toc-11"><span data-slate-object="text" data-key="20769"><span data-slate-leaf="true" data-offset-key="20769:0" data-first-offset="true"><span data-slate-string="true">课后练习</span></span></span></h2><div data-slate-type="list" data-slate-object="block" data-key="20770"><div data-slate-type="list-line" data-slate-object="block" data-key="20771"><div data-code-line-number="1"></div><div><span data-slate-object="text" data-key="20772"><span data-slate-leaf="true" data-offset-key="20772:0" data-first-offset="true"><span data-slate-string="true">思考下，如何查找 iam-apiserver 的 systemd Unit 文件的路径？</span></span></span></div></div><div data-slate-type="list-line" data-slate-object="block" data-key="20773"><div data-code-line-number="2"></div><div><span data-slate-object="text" data-key="20774"><span data-slate-leaf="true" data-offset-key="20774:0" data-first-offset="true"><span data-slate-string="true">执行以下命令：</span></span></span></div></div></div><div data-code-language="bash" data-slate-type="pre" data-slate-object="block" data-key="20775"><div><span></span></div><div><div data-code-line-number="1"></div><div data-code-line-number="2"></div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><div data-origin="pm_code_preview"><div data-slate-type="code-line" data-slate-object="block" data-key="20776"><span data-slate-object="text" data-key="20777"><span data-slate-leaf="true" data-offset-key="20777:0" data-first-offset="true"><span data-slate-string="true">$ token=`curl -s -XPOST -H</span></span></span><span data-slate-object="text" data-key="20778"><span data-slate-leaf="true" data-offset-key="20778:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'Content-Type: application/json'</span></span></span></span><span data-slate-object="text" data-key="20779"><span data-slate-leaf="true" data-offset-key="20779:0" data-first-offset="true"><span data-slate-string="true"> -d</span></span></span><span data-slate-object="text" data-key="20780"><span data-slate-leaf="true" data-offset-key="20780:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">'{"username":"admin","password":"Admin@2021"}'</span></span></span></span><span data-slate-object="text" data-key="20781"><span data-slate-leaf="true" data-offset-key="20781:0" data-first-offset="true"><span data-slate-string="true"> http://127.0.0.1:8080/login | jq -r .token`</span></span></span></div><div data-slate-type="code-line" data-slate-object="block" data-key="20782"><span data-slate-object="text" data-key="20783"><span data-slate-leaf="true" data-offset-key="20783:0" data-first-offset="true"><span data-slate-string="true">$ </span></span></span><span data-slate-object="text" data-key="20784"><span data-slate-leaf="true" data-offset-key="20784:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">echo</span></span></span></span><span data-slate-object="text" data-key="20785"><span data-slate-leaf="true" data-offset-key="20785:0" data-first-offset="true"><span data-slate-string="true"> </span></span></span><span data-slate-object="text" data-key="20786"><span data-slate-leaf="true" data-offset-key="20786:0" data-first-offset="true"><span data-slate-type="mark-class" data-slate-object="mark"><span data-slate-string="true">$token</span></span></span></span></div></div></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div></div></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20787"><span data-slate-object="text" data-key="20788"><span data-slate-leaf="true" data-offset-key="20788:0" data-first-offset="true"><span data-slate-string="true">可以获取</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20789"><span data-slate-object="text" data-key="20790"><span data-slate-leaf="true" data-offset-key="20790:0" data-first-offset="true"><span data-slate-string="true"> token</span></span></span></span><span data-slate-object="text" data-key="20791"><span data-slate-leaf="true" data-offset-key="20791:0" data-first-offset="true"><span data-slate-string="true">，但发现</span></span></span><span data-slate-type="code" data-slate-object="inline" data-key="20792"><span data-slate-object="text" data-key="20793"><span data-slate-leaf="true" data-offset-key="20793:0" data-first-offset="true"><span data-slate-string="true"> token</span></span></span></span><span data-slate-object="text" data-key="20794"><span data-slate-leaf="true" data-offset-key="20794:0" data-first-offset="true"><span data-slate-string="true"> 值为空。请给出你的排障流程和方法。</span></span></span></div><div data-slate-type="paragraph" data-slate-object="block" data-key="20795"><span data-slate-object="text" data-key="20796"><span data-slate-leaf="true" data-offset-key="20796:0" data-first-offset="true"><span data-slate-string="true">欢迎你在留言区与我交流讨论，我们下一讲见。</span></span></span></div></div></div></div><div><div></div><div></div><div><div data-simplebar="init"><div><div><div></div></div><div><div><div><div><textarea placeholder="将学到的知识总结成笔记，方便日后快速查找及复习"></textarea></div></div></div></div><div></div></div><div><div></div></div><div><div></div></div></div><div><div>确认放弃笔记？</div><div>放弃后所记笔记将不保留。</div></div><div><div>新功能上线，你的历史笔记已初始化为私密笔记，是否一键批量公开？</div><div>批量公开的笔记不会为你同步至部落</div></div><div></div></div><div><div><div>公开</div><div>同步至部落</div></div><div>取消</div><div>完成</div></div><div><span>0/2000</span></div></div><div><div><span>划线</span></div><div></div><div></div><div></div><div><span>笔记</span></div><div></div><div><span>复制</span></div></div></div><div><div><div><span></span></div><p><a href="javascript:void(0);">给文章提建议</a></p></div></div><div><div class="sr-rd-content-center"><img class="sr-rd-content-img" src="https://static001.geekbang.org/resource/image/1f/81/1f6c18433af717a740f1e49389f2f981.png"></div></div><div><span>©</span> 版权归极客邦科技所有，未经许可不得传播售卖。 页面已增加防盗追踪，如有侵权极客邦将依法追究其法律责任。 </div></div><div><div><div class="sr-rd-content-center-small"><img class="" src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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"></div><div>Geek__653581f21177</div></div><div><textarea placeholder="由作者筛选后的优质留言将会公开显示，欢迎踊跃留言。" rows="16"></textarea></div><div><div>Ctrl + Enter 发表</div><div>0/2000 字符</div><div>提交留言</div></div></div><div><h2 id="sr-toc-12">精选留言 (4)</h2><ul><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/28/83/17/df99b53d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>随风而过</span></div></div><div>借助前面讲过的日志工具辅助快速定位，token 为空这个是最常见的错误，生成 token 的重要信息显示日志，为空的情况做一些处理，禁止 token 值为空</div><div><p>作者回复: 
$ token=`curl -s -XPOST -H'Content-Type: application/json' -d'{"username":"admin","password":"Admin@2021"}' http://127.0.0.1:8080/login | jq -r .token`
$ echo $token

1. token 为空，是因为 jq -r .token 这个命令输出为空，接着要判断为啥 jq -r .token 输出为空
2. 很可能是因为 curl 命令返回报错，导致标准输出输出的内容为空，从而导致 jq -r .token 值为空
3. 所以去掉 | jq -r .token 看看 curl 命令到底返回什么信息。大概率是返回了错误的信息。
</p></div><div><div>2021-09-22</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>helloworld</span></div></div><div>文中提到添加已存在用户导致的 500 错误 db error，个人认为用户已存在这种是否应该加一层校验，返回 400 错误，直接提示用户已存在信息</div><div><p>作者回复：是的，我记个 todo，后面优化下</p></div><div><div>2021-11-14</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/0f/80/b2/2e9f442d.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span> 文武木子</span></div></div><div>systemtcl 和 supervisor 哪个好点，我们公司运维都用 supervisor 管理部署发布的应用进程</div><div><p>作者回复：都可以，根据需要选择即可。腾讯哪个都有用</p></div><div><div>2021-10-19</div><div><div><i></i></div><div><i></i><span></span></div></div></div></div></div></li><li><div><div data-v-3d2acdda=""><div class="sr-rd-content-center-small"><img class="" src="https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg?x-oss-process=image/resize,m_fill,h_68,w_68"></div></div><div><div><div><span>lesserror</span></div></div><div>多谢老师，这些排障技巧在日常开发中也很用。</div><div><p>作者回复：感觉老哥支持！</p></div><div><div>2021-09-18</div><div><div><i></i></div><div><i></i><span>1</span></div></div></div></div></div></li></ul><div> 收起评论<span></span></div></div></sr-rd-content>
                            <toc-bg><toc style="width: initial;overflow: auto!important;"class="simpread-font simpread-theme-root" data-reactid=".1m"><outline class="toc-level-h1" data-reactid=".1m.0" style="width: 175px;"><active data-reactid=".1m.0.0" ></active><a class="toc-outline-theme-github" href="#sr-toc-0" data-reactid=".1m.0.1"><span data-reactid=".1m.0.1.0">特别放送 | IAM 排障指南</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.1" style="width: 165px;"><active data-reactid=".1m.1.0"></active><a class="toc-outline-theme-github" href="#sr-toc-1" data-reactid=".1m.1.1"><span data-reactid=".1m.1.1.0">如何排障？</span></a></outline><outline class="toc-level-h3" data-reactid=".1m.2" style="width: 155px;"><active data-reactid=".1m.2.0"></active><a class="toc-outline-theme-github" href="#sr-toc-2" data-reactid=".1m.2.1"><span data-reactid=".1m.2.1.0">发现问题</span></a></outline><outline class="toc-level-h3" data-reactid=".1m.3" style="width: 155px;"><active data-reactid=".1m.3.0"></active><a class="toc-outline-theme-github" href="#sr-toc-3" data-reactid=".1m.3.1"><span data-reactid=".1m.3.1.0">定位问题</span></a></outline><outline class="toc-level-h4" data-reactid=".1m.4" style="width: 145px;"><active data-reactid=".1m.4.0"></active><a class="toc-outline-theme-github" href="#sr-toc-5" data-reactid=".1m.4.1"><span data-reactid=".1m.4.1.0">查看日志定位问题</span></a></outline><outline class="toc-level-h4" data-reactid=".1m.5" style="width: 145px;"><active data-reactid=".1m.5.0"></active><a class="toc-outline-theme-github" href="#sr-toc-6" data-reactid=".1m.5.1"><span data-reactid=".1m.5.1.0">使用 Go 调试工具 Delve 来定位问题</span></a></outline><outline class="toc-level-h4" data-reactid=".1m.6" style="width: 145px;"><active data-reactid=".1m.6.0"></active><a class="toc-outline-theme-github" href="#sr-toc-7" data-reactid=".1m.6.1"><span data-reactid=".1m.6.1.0">添加 Debug 日志定位问题</span></a></outline><outline class="toc-level-h3" data-reactid=".1m.7" style="width: 155px;"><active data-reactid=".1m.7.0"></active><a class="toc-outline-theme-github" href="#sr-toc-8" data-reactid=".1m.7.1"><span data-reactid=".1m.7.1.0">解决问题</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.8" style="width: 165px;"><active data-reactid=".1m.8.0"></active><pangu> </pangu><a class="toc-outline-theme-github" href="#sr-toc-9" data-reactid=".1m.8.1"><span data-reactid=".1m.8.1.0">IAM 常见故障及解决办法</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.9" style="width: 165px;"><active data-reactid=".1m.9.0"></active><a class="toc-outline-theme-github" href="#sr-toc-10" data-reactid=".1m.9.1"><span data-reactid=".1m.9.1.0">总结</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.a" style="width: 165px;"><active data-reactid=".1m.a.0"></active><a class="toc-outline-theme-github" href="#sr-toc-11" data-reactid=".1m.a.1"><span data-reactid=".1m.a.1.0">课后练习</span></a></outline><outline class="toc-level-h2" data-reactid=".1m.b" style="width: 165px;"><active data-reactid=".1m.b.0"></active><a class="toc-outline-theme-github" href="#sr-toc-12" data-reactid=".1m.b.1"><span data-reactid=".1m.b.1.0">精选留言 (4)</span></a></outline></toc></toc-bg>
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://time.geekbang.org/column/article/419674" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>